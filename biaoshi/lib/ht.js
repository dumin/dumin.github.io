!function(U,M,d){"use strict";var D="ht";if(!U[D]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),U.performance&&U.performance.now||function(){var L=Date.now();U.performance||(U.performance={}),U.performance.now=function(){return Date.now()-L}}();for(var m=Date.now(),Q=16,W=["ms","moz","webkit","o"],C=0;C<W.length&&!U.requestAnimationFrame;++C)U.requestAnimationFrame=U[W[C]+"RequestAnimationFrame"],U.cancelAnimationFrame=U[W[C]+"CancelAnimationFrame"]||U[W[C]+"CancelRequestAnimationFrame"];U.requestAnimationFrame||(U.requestAnimationFrame=function(z){var T=Date.now(),C=Q+m-T;return 0>C&&(C=0),m=T,U.setTimeout(function(){m=Date.now(),z(performance.now())},C)}),U.cancelAnimationFrame||(U.cancelAnimationFrame=function($){return U.clearTimeout($)}),M.assign===d&&(M.assign=function(K){if(K===d||null===K)throw new TypeError("Cannot convert undefined or null to object");for(var r=M(K),C=1;C<arguments.length;C++){var g=arguments[C];if(g!==d&&null!==g)for(var b in g)M.prototype.hasOwnProperty.call(g,b)&&(r[b]=g[b])}return r})}();var r=U.document,y=null,T=U[D]={},V=U[D+"config"],N=T.Default=V&&V.Default||{},c=T.Style=V&&V.Style||{},J=T.Attr=V&&V.Attr||{},F=T.Color=V&&V.Color||{},A=T.IsGetter=V&&V.IsGetter||{};!function(){var $=!1;try{var O=M.defineProperty({},"passive",{get:function(){$=!0}});U.addEventListener("test",O,O),U.removeEventListener("test",O,O)}catch(f){$=!1}N.passiveSupported=$}();var K,l,R,u,a=N.passiveSupported,Z=N.eventListenerOptionsFalse=a?{passive:!1,capture:!1}:!1,o=N.eventListenerOptionsTrue=a?{passive:!1,capture:!0}:!0,n=Math,e=n.round,C=n.floor,i=n.ceil,W=n.sqrt,m=n.max,Y=n.min,h=n.abs,G=n.cos,x=n.acos,f=n.sin,j=n.pow,L=n.asin,p=n.PI,t=2*p,E=p/2,z=n.tan,B=n.atan2,$=n.random,_=n.log,k=!1,I=!1,S=U.parseInt||global.parseInt,Q="2019-02-25",O=U.navigator?U.navigator.platform.indexOf("Win")>-1:!1,w=function(Y){return Y*Y},X=U.setTimeout,b=U.clearTimeout,H=U.location,q=U.navigator?U.navigator.userAgent.toLowerCase():"",v=function(L){return L.test(q)},s=v(/msie/),P=v(/msie/)||v(/trident/),g=v(/msie 10/),Fk=v(/edge/),vc=v(/firefox/),Qf=v(/mac/),jm=N.isTouchable===d?O?!1:r?"ontouchend"in r:!1:N.isTouchable,Dc="default",fe="single",sj="multiple",jd="front",Oo="back",Cb="left",Fq="right",Zp="top",Yg="bottom",qd="center",ko="eye",fd="middle",Vo="east",Hq="west",vf="north",Pf="none",Tg="px",yd="absolute",te="border",Ki="triangle",Cg="rect",gs="circle",rn="cylinder",Kg="shape",aq="items",Og="normal",ro="remove",Ih="clear",Nr="width",Fi="height",op="ingroup",eb="check",eq="uncheck",Hd="radio",wi="radioOn",lp="radioOff",ph="points",ce="values",Ak="series",of="body",Rh="label",Xp="label2",yj="note",zi="note2",zj="icons",Wj="labelFont",Nq="labelColor",Fg="labelSelectColor",_n="note.expanded",xn="note2.expanded",ee="edge.expanded",xp="edge.points",Zn="edge.type",Cq="rotation",ie="hidden",nc="visible",Qj="tuv",ej="no",pk="draw",Bi="select",ne="currentSubGraph",Xo="selectBackground",bf="autoMakeVisible",vi="autoHideScrollBar",Zq="scrollBarColor",nm="scrollBarSize",rf="indent",sn="rowHeight",$n="columnLineColor",Xg="rowLineColor",Jp="columnLineVisible",yr="rowLineVisible",Tn="visibleFunc",Cr="expandIcon",Ve="collapseIcon",Yo="checkMode",lc="sortFunc",Km="editable",ae="batchEditable",Jk="tristate",bj="asc",Hb="desc",hp="position",Vg="elevation",Kc="children",Pj="translateX",Sj="translateY",ns="dataModel",Sr="maxSize",Ol="shape3d",Ck="shape3d.resolution",Io="shape3d.visible",Sd="shape3d.from.visible",yq="shape3d.to.visible",gm="shape3d.top.visible",fj="shape3d.bottom.visible",Oq="repeat.uv.length",sd="serializeValue",Ko="deserializeValue",jl="centerUniform",ym="uniform",Mn="rgba(255,255,255,0)",Qo="style",ho="attr",ws="field",Bb="string",Uo="boolean",js="color",xi="int",$d="number",zo="ew-resize",mk="ns-resize",Rb="pointer",$k="auto",Kd="mousedown",rq="mousemove",aj="mouseup",Ii="mouseout",uf="touchstart",Cd="touchmove",wj="touchend",Gq="keydown",no="keyup",ll=["DOMMouseScroll","mousewheel"],Xe=vc?ll[0]:ll[1],am=jm?[uf,Cd,wj,Gq,no,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[Gq,no,"keypress","input",Kd,rq,aj,Ii,Xe,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],wf=y,gr=y,le=y,pj=aj.length,eh=function(){le&&(b(le.timeout),le=y)},Bp=function(){le&&Ir(le.e,le.info)};U.addEventListener&&(jm||(U.addEventListener(Ii,function(){eh()},Z),U.addEventListener(Xe,function(){Dn()},Z)),U.addEventListener(no,function(O){91===O.keyCode?cn={}:delete cn[O.keyCode]},o),U.addEventListener(Gq,function($){cn[$.keyCode]=!0},o),U.addEventListener("blur",function(){cn={}},Z));var hc,Wl,zk,Yd=0,Ao=y,bo=function(r,V){var J=X(function(){delete Ao[J],Ar(Ao)&&(Ao=y),r()},V);return J},me=y,Tj=y,uc={},pl={},cp={},re={},ul={},cn={},Wq={},Sq={},Ub={},Gp={},dl=/.json$/,ig=/^data:image\/svg\+xml/,Af={},sg=[],Xk={},Ll=y,sp=y,Pi=function(){},Rp=function(){throw"Oops!"},pb=[0,0,0],Eo={x:0,y:0,width:0,height:0},ah=y,tg=y,wc=y,Hf=function(x,C){pl[x]=C,C&&C.comps&&!C.uuid&&(C.uuid=T.Math.generateUUID()),bl[x]&&(C.cacheRule=bl[x],delete bl[x])},He=function(g){tg&&!g._72O&&(wc||(wc={}),wc[g._72O=Ef()]=g),hc!=y?ts()<.05&&u&&!Wl&&(ls=eh):ls=Go},fr=function(W,g,a,h){tg||(tg={});var R=tg[W];if(R){if(R.url===g)return;R.image?(R.image.onload=Pi,R.image.onerror=Pi):R.request&&(R.request.onload=Pi,R.request.onerror=Pi)}if(dl.test(g)){var e=new Gh;if(tg[W]={request:e,url:g},g=N.beforeLoadURL(g),g.data){var s=N.parse(g.data);np(W,s),N.handleImageLoaded(W,s)}else{e.onload=function(O){if(200===this.status||0===this.status){var B=N.parse(O.target.response||O.target.responseText);np(W,B),N.handleImageLoaded(W,B)}else np(W,N.handleUnfoundImage(W,g)||y)},e.onerror=function(){np(W,N.handleUnfoundImage(W,g)||y)};var f={};f.url=encodeURI(g),f.sync=!1,e.send(f)}}else{var s=new Image;tg[W]={image:s,url:g},/^data:image/.test(g)||(g=N.beforeLoadURL(g),g=N.appendTimeStamp(g),g=encodeURI(g),s.crossOrigin=N.crossOrigin),N.convertImageSrc(g,function(n){P&&(g.toLowerCase().indexOf(".svg")>0||ig.test(g))?(r.body.appendChild(s),s.style.visibility="hidden",s.onload=function(){X(function(){if(a&&(s.width=a),h&&(s.height=h),!s.width||!s.height){var j=s.width||s.clientWidth,l=s.height||s.clientHeight;s.width=j,s.height=l}N.handleImageLoaded(W,s),np(W,s),r.body.removeChild(s),s.style.visibility=""},180)},s.onerror=function(){np(W,N.handleUnfoundImage(W,g)||y),r.body.removeChild(s),s.style.visibility=""}):(s.onload=function(){a&&(s.width=a),h&&(s.height=h),N.handleImageLoaded(W,s),np(W,s)},s.onerror=function(){np(W,N.handleUnfoundImage(W,g)||y)}),s.src=n})}},np=function(_,Z){if(Hf(_,Z),delete tg[_],Ar(tg)&&(tg=y,wc)){for(var R in wc){var L=wc[R];L._2O&&L._2O[_]&&(L.deleteTexture(_),delete L._2O[_]),L.invalidateAll&&L.invalidateAll(d,"imageLoaded",_),L.redraw&&L.redraw(),L.iv(),delete L._72O}wc=y}if(Z&&wc)for(var R in wc){var L=wc[R];L.invalidateAll&&L.invalidateAll(d,"imageLoading",_),L.redraw&&L.redraw(),L.iv()}},vb=function(){return _=n&&Date,function(){return U.performance&&U.performance.now?U.performance.now():Date.now()}}(),vn=function(R,t){t?b(R):U.cancelAnimationFrame(R)},fk=function(L,f,Q){return{width:L,height:f,comps:$l(Q)?Q:[Q]}},wg=function(h,y){return{type:gs,rect:[h,y,1.6,1.6],borderWidth:1,borderColor:yc,gradient:qj,gradientColor:fp,background:yc}},sb=function(X,Y){return fk(16,16,{type:Ki,rect:[4,4,10,8],background:X,rotation:Y?1.57:3.14})},Fo=function(c,G){return fk(16,16,{type:Ki,rect:[4,4,8,7],background:c,rotation:G?3.14:0})},er=function(v){var I=v._orientation;return"horizontal"===I||"h"===I},hl=function(d){var E=y||4,T=y||1,J=y||1;0>E?E=0:E>.25&&(E=.25);var i,M,O,n,I,L,X,K=.5,h=[],a=[],P=[],B=t/J,w=t/T,H=K-E;for(M=0;T>=M;M++)for(n=-p+M*w,L=G(n),I=f(n),i=0;J>=i;i++)O=i*B,X=H+E*L,h.push(G(O)*X,I*E,-f(O)*X),(l=d)&&a.push(i/J,1-M/T);for(M=0;T>M;M++){var Z=M*(J+1),U=(M+1)*(J+1);for(i=0;J>i;i++)P.push(Z+i,U+i+1,U+i,Z+i,Z+i+1,U+i+1),Bm.z=jh.z=d}},xg=function(V){var x=2,H=0;for(var w in V)w.length===x&&S(w,32)===Fp&&(Ll=sp=V[w]),H++;return H},ii=function(k,z,B,h){return B||(B=jm?5:3,B/=h||1),{x:k-B,y:z-B,width:2*B,height:2*B}},cj=function(l,G,m,e){var M=this;G||(G=jm?5:3,m=20,e=20);var W={x:l,y:G,width:m,height:e};if(m)for(var J=0;m>J;J++)if(3===m)e=20;else for(var O=0;e>O;O++)M=U?U:m;var V={x:p,y:2*p};if(Hi(W,V)){var K=Fi[0]+Zp[0]+Ih[1]+(bj.length-1);Wk[ko]=M[K],M[K]=Tl[ko]}},$r=function($){return(/ble$/.test($)||/ed$/.test($)||A[$]?"is":"get")+$.charAt(0).toUpperCase()+$.slice(1)},Tl=function(g){return"set"+g.charAt(0).toUpperCase()+g.slice(1)},Hc=function(g){return typeof g===Bb||g instanceof String},zb=function(B){return typeof B===$d},Go=function(b){return typeof b===Uo},Bh=function($){return $&&"object"==typeof $},Lc=function(r){return"function"==typeof r},$l=function(P){return P instanceof Array},ic=function(W){return W instanceof wk},jr=function(z){return $l(z)?new wk(z):z},Np=function(F){return F instanceof fh},Nl=function(D){return D instanceof Ld},zc=function(G){return G instanceof Dm},nk=function(I,z){if(!(I instanceof T.Group))return!1;if(!z)return I.isExpanded();var c=z.getDataUI(I);return c&&c._88I?!0:!1},bi=function(k){return k instanceof oj},af=function(L){return L&&"IFRAME"===L.tagName},Rq=function(o){return o==y||N.numberDigits==y?o:parseFloat(o.toFixed(N.numberDigits))},Rj=function(q,f,B){var G,E=f.length;if(B)for(var D=0;B>D;D++)if(3===E)q.push(f[0]),q.push(f[1]),q.push(f[2]);else for(G=0;E>G;G++)q.push(f[G]);else if(3===E)q.push(f[0]),q.push(f[1]),q.push(f[2]);else for(G=0;E>G;G++)q.push(f[G])},yk=function(q){return q?Bh(q)?q:{}:!1},Zc=function(g,X,J){var v,u=Bh(g)?g:g.prototype;for(v in X)J&&u[v]!==d||(u[v]=X[v]);return g},Kb=function(g){return String.fromCharCode(g)},Tr=function(p){for(var l,A=0,s="";A<p.length;A++)l=p[p.length-1-A],"%"===l?l="'":"a"===l?l='"':"]"===l&&(l="\\"),s+=Kb(l.charCodeAt(0)-1);return s},hg=function(F,W,b){F.superClass.constructor.apply(W,b)},Ar=function(u){for(var x in u)return!1;return!0},Aj=function(k){return k?0===k.length:!0},be=function(){var n="";return[eq[0],Xg[0],Rh[0]].forEach(function(_){n+=Tl(_).slice(3)}),ym=r&&r[n]||jl,function(e,h){return e===h?!0:e.x===h.x&&e.y===h.y&&e.width===h.width&&e.height===h.height}}(),Ze=function(W,h,o){return h>W?h:W>o?o:W},Kf=function(A){return 0>A?-1:A>0?1:0},ts=function(){var c=1e4*f(pj++);return c-C(c)},Pc=function(r,s,o){return Uj(r.x,r.y,s.x,s.y,o.x,o.y,o.x+o.width,o.y,!0)||Uj(r.x,r.y,s.x,s.y,o.x+o.width,o.y,o.x+o.width,o.y+o.height,!0)||Uj(r.x,r.y,s.x,s.y,o.x+o.width,o.y+o.height,o.x,o.y+o.height,!0)||Uj(r.x,r.y,s.x,s.y,o.x,o.y+o.height,o.x,o.y,!0)},Uj=function(R,M,N,W,j,I,B,b,L){var q=(B-j)*(M-I)-(b-I)*(R-j),C=(b-I)*(N-R)-(B-j)*(W-M);if(0!==C){var o=q/C,_=R+o*(N-R),v=M+o*(W-M);return L&&(_+cm<Y(R,N)||_-cm>m(R,N)||_+cm<Y(j,B)||_-cm>m(j,B)||v+cm<Y(M,W)||v-cm>m(M,W)||v+cm<Y(I,b)||v-cm>m(I,b))?y:[_,v]}return y},yl=function(y,f,Z){if(y&&Z)if(f){if(f===Qo)return y.getStyle(Z);if(f===ho)return y.getAttr(Z);if(f===ws)return y[Z]}else if(Z=$r(Z),y[Z])return y[Z]();return d},On=function(D,z,V,o){if(D&&V)if(z){if(z===Qo)D.s(V,o);else if(z===ho)D.a(V,o);else if(z===ws){var x=D[V];D[V]=o,D.fp("f:"+V,x,o)}}else V=Tl(V),D[V]&&D[V](o)},Qd=function(_,o,a){return o&&"top"!==o?"bottom"===o?{x:_.x,y:_.y,width:_.width,height:_.height*a}:"right"===o?{x:_.x,y:_.y,width:_.width*a,height:_.height}:"left"===o?{x:_.x+_.width*(1-a),y:_.y,width:_.width*a,height:_.height}:void 0:{x:_.x,y:_.y+_.height*(1-a),width:_.width,height:_.height*a}},jg=function(j,A,D,S,Q){A&&Gf(j,D,S,1,Q,A)},Wf=function(X,d,x,M){var $=1-X;return $*$*d+2*X*$*x+X*X*M},Bm=function(N,P,$,C,c){var v=1-N;return v*v*v*P+3*v*v*N*$+3*v*N*N*C+N*N*N*c},Lg=function(b){var O,X,G,F,q=0;return b.forEach(function(m){if(O=m.length,O>0)for(X=m[0],F=1;O>F;F++)G=m[F],q+=kk(X,G),X=G}),q},yb=function(Q,a,I){var v="__"+Q,W=function(N){I.disabled||I["handle_"+Q](N)};I[v]||(I[v]=W,a.addEventListener(Q,W,Z))},Nc=function(G,y,L){var q="__"+G,W=L[q];W&&(y.removeEventListener(G,W,Z),delete L[q])},Tb=function(v,X){var Z="_"+X;v[$r(X)]=function(){return this[Z]},v[Tl(X)]=function(j){var W=this[Z];this[Z]=j,this.fp(X,W,j)}},Qk=function(O){return M.create(O)},od=function(h){if(!h.element){var n,Y;(n=h.textField)?Y=rb(cs.TextField,n):(n=h.textArea)?Y=rb(cs.TextArea,n):(n=h.button)?Y=rb(cs.Button,n):(n=h.comboBox)?Y=rb(cs.ComboBox,n):(n=h.checkBox)?Y=rb(cs.CheckBox,n):(n=h.radioButton)?Y=rb(cs.RadioButton,n):(n=h.slider)?Y=rb(cs.Slider,n):(n=h.colorPicker)?Y=rb(cs.ColorPicker,n):(n=h.image)&&(Y=rb(cs.Image,n)),Y&&(h.element=Y)}},jj=function(L,B){var W=Mg(L);return W._ht=B,W},Mg=function(S,A){var B=r.createElement("div"),L=B.style;return B.tabIndex=-1,B.onkeydown=Mf,L.msTouchAction=Pf,tm(B,y,0),jm&&L.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",y),S&&(L.overflow=ie),A&&Ah(A,B),B},ff=function(H,J){var V=r.createElement("canvas"),C=V.style;return C.msTouchAction=Pf,J||(C.pointerEvents=Pf),tm(V,y,0),H&&Ah(H,V),V},tm=function(B,C,L){var J=B.style;J.border=C?C+" solid 1px":0,J.outline=0,J.padding=L?"0 "+L+Tg:0,sq(B)},sq=function(C){var b=C.style;b.position=yd,b.margin=0,b.setProperty("box-sizing","border-box",y),b.setProperty("-moz-box-sizing","border-box",y)},$b=function(N,g,w,P){P||(P=Kl),g!=y&&(N.width=g*P,N.style.width=g+Tg),w!=y&&(N.height=w*P,N.style.height=w+Tg)},Ah=function(r,L,m){r.appendChild(L),m&&(L.style.position=yd)},dg=function(b,g){g.split||(g+="");for(var w,c=g.split("\n"),A=0,i=c.length,K=0;i>K;K++){var y=iq(b.font,c[K]);y.width>A&&(A=y.width),w||(w=y.height)}return b.ss=c,{width:A,height:w*i}},Ym=function(D,I,Z,i,L,S){var M=I.length;if(1===M)Wn(D,I[0],Z,i,L);else for(var C=Z.height/M,Q={x:Z.x,y:Z.y,width:Z.width,height:C},W=0;W<I.length;W++)S?Ek(D,I[W],i,L,Q.x,Q.y,Q.width,Q.height,S):Wn(D,I[W],Q,i,L),Q.y+=C},Wn=function(k,K,I,z,P){k.font=z?z:oc,k.fillStyle=P?P:_j,k.textAlign=qd,k.textBaseline=fd;var p,G;I?I.width===d?(p=I.x,G=I.y):(p=I.x+I.width/2,G=I.y+I.height/2):(p=0,G=0),k.fillText(K,e(p),e(G))},Nk=function(u){u.getView&&(u=u.getView());var _=u.offsetWidth||u.scrollWidth;return!_&&u.style.width&&(_=S(u.style.width)),_},tf=function(x){x.getView&&(x=x.getView());var s=x.offsetHeight||x.scrollHeight;return!s&&x.style.height&&(s=S(x.style.height)),s},wd=function(y,x,c){var X=x[0].toUpperCase()+x.substring(1,x.length);y["webkit"+X]=c,y["moz"+X]=c,y["ms"+X]=c,y["o"+X]=c,y[x]=c},dh=function(){var C=function(Z){Mf(Z),Z.stopPropagation()},k=function(l){Mf(l)},o=jm?[uf]:[Gq,Kd];return function(m,y){var H=Mg(),W=H.style;return W.backgroundColor=N.disabledBackground,m&&(W.backgroundImage="url("+m+")",W.backgroundPosition="50% 50%",W.backgroundRepeat="no-repeat no-repeat"),y===!1?o.forEach(function(V){H.addEventListener(V,k,Z)}):o.forEach(function(f){H.addEventListener(f,C,Z)}),H}}(),Hl=function(H){var n=H.getContext("2d");return n.save(),n.lineCap=zg,n.lineJoin=Qr,n},ls=function(K,l,M,m){Gj(K,l*Kl,M*Kl),m*=Kl,1!==m&&K.scale(m,m)},Gj=function(n,T,K){n.translate(T,K)},mn=function(o,r){r&&o.rotate(r)},ci=function(A,X,w){X===d&&(X=1),w===d&&(w=1),(1!==X||1!==w)&&A.scale(X,w)},Vr=!1,ql=function(f){var J=r.activeElement;if(r.activeElement!==f){J&&J.forceOnblur&&J.forceOnblur();for(var T=[],u=f.parentNode;u;)T.push([u,u.scrollLeft,u.scrollTop]),u=u.parentNode;if(!Vr){var G=[],M=[];try{for(var I=U.parent,h=U;I!==h;)G.push([I,I.scrollX,I.scrollY]),h=I,I=U.parent;var e=U.frameElement;if(e)for(var y=e.parentNode;y;)M.push([y,y.scrollLeft,y.scrollTop]),y=y.parentNode}catch(D){Vr=!0}}if(jm)f.focus();else{var P=Fj(),n=P.target;f.focus(),n.scrollLeft=P.left,n.scrollTop=P.top}T.forEach(function(N){N[0].scrollLeft=N[1],N[0].scrollTop=N[2]}),Vr||(G.forEach(function(d){d[0].scrollTo(d[1],d[2])}),M.forEach(function(W){W[0].scrollLeft=W[1],W[0].scrollTop=W[2]}))}},Il=function(l){return l&&l.getView?l.getView():l},Ce=function(n,A,x,t,s){if(2===arguments.length&&(x=A.y,t=A.width,s=A.height,A=A.x),n.isSelfViewEvent)n.setX(A),n.setY(x),n.setWidth(t),n.setHeight(s);else{var g=Il(n),o=g.style;if((r.fullscreenElement||r.mozFullScreenElement||r.webkitFullscreenElement||r.msFullscreenElement)!==g)A!==d&&(o.left=A+Tg),x!==d&&(o.top=x+Tg),t!==d&&(o.width=t+Tg),s!==d&&(o.height=s+Tg);else{var l=N.getWindowInfo();o.left=(A=l.left)+Tg,o.top=(x=l.top)+Tg,o.width=(t=l.width)+Tg,o.height=(s=l.height)+Tg}n.endEditing&&!jm&&n.endEditing(),n.redraw&&n.redraw(),n.invalidate&&n.invalidate(),n.onLayouted&&n.onLayouted(A,x,t,s),n.fireViewEvent&&n.fireViewEvent("layout")}},Pm=function(f){if(!f.touches)return f;var Q=f.touches[0];return Q?Q:f.changedTouches[0]},Jf=function(c){return jm?Pm(c).target:c.target},cf=function(R){N.popup&&N.popup.close(),N.popup=R},Tk=y,gq=function(W){Tk.handleWindowTouchMove(W)},rc=function(e){Tk.handleWindowTouchEnd(e),U.removeEventListener(Cd,gq,Z),U.removeEventListener(wj,rc,Z),Tk=y},Ob=function(b){Tk.handleWindowMouseMove(b)},Er=function(t){Tk.handleWindowMouseUp(t),U.removeEventListener(rq,Ob,Z),U.removeEventListener(aj,Er,Z),Tk=y},Hg=function(Z){return 1===kl(Z)},yf=function(G,j){return j?j.keyCode===G:cn[G]},Yf=function(x){return xj(x)&&yf(65,x)},ol=function(A){return yf(46,A)||yf(8,A)},Od=function(t){return function(_){return _?_.keyCode===t:cn[t]}},Fp=573,Xh=[65,83,68,87,37,38,39,40,32,13,27],Ji=Od(Xh[0]),Pg=Od(Xh[1]),mc=Od(Xh[2]),Gc=Od(Xh[3]),Oc=Od(Xh[4]),kr=Od(Xh[5]),pe=Od(Xh[6]),bq=Od(Xh[7]),gb=Od(Xh[8]),Of=Od(Xh[9]),Fd=Od(Xh[10]),gh={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},hm=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,5,5,5,5,5,11,17],ao=y,Xr=y,kj=function(v,t){ao||(ao=ff()),$b(ao,v,t,1);var d=Hl(ao);return d.clearRect(0,0,v,t),d},Wb=function(){var M,q={};for(var Z in U){var x=sj.length;if(Z.length==x&&Z[0]===sj[2]&&Z[1]===Pf[1]&&Z[4]===sj[3]&&Z[5]===sj[4]&&Z.substr(x-2)===Pf[1]+Pf[2]){var c=U[Z];for(var f in c)f.length===x&&f.substr(0,3)===Fq[3]+ro[3]+Bi[0]&&f.substr(x-2)===sj[0]+yj[3]&&(ll=c[f])}}return function(H){var B,F=q[H];return F||(M||(M=ff(),$b(M,1,1,1)),B=M.getContext("2d"),B.clearRect(0,0,1,1),Gf(B,0,0,1,1,H),F=B.getImageData(0,0,1,1).data,F=q[H]=[F[0],F[1],F[2],F[3]]),F}}(),vo=function(P){if(!Hc(P))return P;var X=Wb(P);return X.CA||(X.CA=[X[0]/255,X[1]/255,X[2]/255,X[3]/255]),X.CA},ip=function(m,e,A,y,N){var a=ff();a.width=A,a.height=y;var H=a.getContext("2d");H.drawImage(m,0,0,A,y);try{for(var r=H.getImageData(0,0,A,y),l=r.data,n=0,t=l.length;t>n;n+=4){var g=l[n+0],G=l[n+1],j=l[n+2],B=l[n+3];"override_a"===N?l[n+3]=255*e[3]:"override_rgb"===N?(l[n+0]=255*e[0],l[n+1]=255*e[1],l[n+2]=255*e[2]):"override"===N?(l[n+0]=255*e[0],l[n+1]=255*e[1],l[n+2]=255*e[2],l[n+3]=255*e[3]):(l[n+0]=e[0]*g,l[n+1]=e[1]*G,l[n+2]=e[2]*j,l[n+3]=e[3]*B)}H.putImageData(r,0,0)}catch(U){return m}return a},Wk=function(N,r,P){return r&&(r="miter"===P?8*r+20:r+1,N&&oo(N,r)),r},Qc=function(o,n){if(n){var a=new Rc(n),p=o.width/2,A=o.height/2,J=wm([a.tf(-p,-A),a.tf(p,-A),a.tf(p,A),a.tf(-p,A)]);return J.x+=o.x+p,J.y+=o.y+A,J}return o},tr=function(I,A,C,l,T,h,G,x){l*=Math.PI/180;var $={x:Math.cos(l)*(I.x-G.x)/2+Math.sin(l)*(I.y-G.y)/2,y:-Math.sin(l)*(I.x-G.x)/2+Math.cos(l)*(I.y-G.y)/2},n=Math.pow($.x,2)/Math.pow(A,2)+Math.pow($.y,2)/Math.pow(C,2);n>1&&(A*=Math.sqrt(n),C*=Math.sqrt(n));var b=(T==h?-1:1)*Math.sqrt((Math.pow(A,2)*Math.pow(C,2)-Math.pow(A,2)*Math.pow($.y,2)-Math.pow(C,2)*Math.pow($.x,2))/(Math.pow(A,2)*Math.pow($.y,2)+Math.pow(C,2)*Math.pow($.x,2)));isNaN(b)&&(b=0);var g={x:b*A*$.y/C,y:b*-C*$.x/A},L={x:(I.x+G.x)/2+Math.cos(l)*g.x-Math.sin(l)*g.y,y:(I.y+G.y)/2+Math.sin(l)*g.x+Math.cos(l)*g.y},_=function(v){return Math.sqrt(Math.pow(v[0],2)+Math.pow(v[1],2))},q=function(g,e){return(g[0]*e[0]+g[1]*e[1])/(_(g)*_(e))},y=function(c,X){return(c[0]*X[1]<c[1]*X[0]?-1:1)*Math.acos(q(c,X))},O=y([1,0],[($.x-g.x)/A,($.y-g.y)/C]),f=[($.x-g.x)/A,($.y-g.y)/C],s=[(-$.x-g.x)/A,(-$.y-g.y)/C],w=y(f,s);q(f,s)<=-1&&(w=Math.PI),q(f,s)>=1&&(w=0);var q=A>C?A:C,F=A>C?1:A/C,u=A>C?C/A:1;if(null==x){var i={x:0,y:0,width:0,height:0};oo(i,q),i.x*=F,i.width*=F,i.y*=u,i.height*=u;var z=new Rc(l);return i=wm([z.tf(i.x,i.y),z.tf(i.x+i.width,i.y),z.tf(i.x+i.width,i.y+i.height),z.tf(i.x,i.y+i.height)]),i.x+=L.x,i.y+=L.y,[{x:i.x,y:i.y},{x:i.x+i.width,y:i.y},{x:i.x+i.width,y:i.y+i.height},{x:i.x,y:i.y+i.height}]}x.translate(L.x,L.y),x.rotate(l),x.scale(F,u),x.arc(0,0,q,O,O+w,1-h),x.scale(1/F,1/u),x.rotate(-l),x.translate(-L.x,-L.y)},Dl=function(b,C){b&&b.beginPath();for(var J,V,w,T=[],L=function(X){for(var x,v=/(\-{0,1}[\d\.]+)/gi,Y=[];x=v.exec(X);)Y.push(parseFloat(x[0]));return Y},z=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,X={x:0,y:0};J=z.exec(C);){var Q=J[0],m=Q.substr(0,1);if("M"===m||"m"===m){for(var j=L(Q),M=0;M<j.length;M+=2){var H=j[M],B=j[M+1];"m"===m&&(H+=X.x,B+=X.y),b&&b.moveTo(H,B),T.push({x:H,y:B}),X.x=H,X.y=B}V=w=null}else if("H"===m||"h"===m){for(var j=L(Q),M=0;M<j.length;M+=1){var H=j[M];"h"===m&&(H+=X.x),b&&b.lineTo(H,X.y),T.push({x:H,y:X.y}),X.x=H}V=w=null}else if("C"===m||"c"===m){for(var j=L(Q),M=0;M<j.length;M+=6){var R=j[M],Y=j[M+1],p=j[M+2],D=j[M+3],H=j[M+4],B=j[M+5];"c"===m&&(R+=X.x,Y+=X.y,p+=X.x,D+=X.y,H+=X.x,B+=X.y),b&&b.bezierCurveTo(R,Y,p,D,H,B),T.push({x:R,y:Y}),T.push({x:p,y:D}),T.push({x:H,y:B}),X.x=H,X.y=B}V=[R,Y,p,D,H,B],w=null}else if("S"===m||"s"===m){for(var j=L(Q),M=0;M<j.length;M+=4){var R,Y;V?(R=2*V[4]-V[2],Y=2*V[5]-V[3]):(R=X.x,Y=X.y);var p=j[M],D=j[M+1],H=j[M+2],B=j[M+3];"s"===m&&(p+=X.x,D+=X.y,H+=X.x,B+=X.y),b&&b.bezierCurveTo(R,Y,p,D,H,B),T.push({x:R,y:Y}),T.push({x:p,y:D}),T.push({x:H,y:B}),X.x=H,X.y=B}V=[R,Y,p,D,H,B],w=null}else if("Q"===m||"q"===m){for(var j=L(Q),M=0;M<j.length;M+=4){var R=j[M],Y=j[M+1],H=j[M+2],B=j[M+3];"q"===m&&(R+=X.x,Y+=X.y,H+=X.x,B+=X.y),b&&b.quadraticCurveTo(R,Y,H,B),T.push({x:R,y:Y}),T.push({x:H,y:B}),X.x=H,X.y=B}V=null,w=[R,Y,H,B]}else if("T"===m||"t"===m){for(var j=L(Q),M=0;M<j.length;M+=2){var R,Y;w?(R=2*w[2]-w[0],Y=2*w[3]-w[1]):(R=X.x,Y=X.y);var H=j[M],B=j[M+1];"t"===m&&(H+=X.x,B+=X.y),b&&b.quadraticCurveTo(R,Y,H,B),T.push({x:R,y:Y}),T.push({x:H,y:B}),X.x=H,X.y=B}V=null,w=[R,Y,H,B]}else if("V"===m||"v"===m){for(var j=L(Q),M=0;M<j.length;M+=1){var B=j[M];"v"===m&&(B+=X.y),b&&b.lineTo(X.x,B),T.push({x:X.x,y:B}),X.y=B}V=w=null}else if("L"===m||"l"===m){for(var j=L(Q),M=0;M<j.length;M+=2){var H=j[M],B=j[M+1];"l"===m&&(H+=X.x,B+=X.y),b&&b.lineTo(H,B),T.push({x:H,y:B}),X.x=H,X.y=B}V=w=null}else if("A"===m||"a"===m){for(var j=L(Q),M=0;M<j.length;M+=7){var t=j[M],e=j[M+1],_=j[M+2],I=j[M+3],S=j[M+4],H=j[M+5],B=j[M+6];"a"===m&&(H+=X.x,B+=X.y);var s=tr(X,t,e,_,I,S,{x:H,y:B},b);s&&(T=T.concat(s)),X.x=H,X.y=B}V=w=null}var N=Q.substr(Q.length-1);("z"===N||"Z"===N)&&b&&b.closePath()}return T},mf=function(a,f){var n,Y,d="L"===f[0],Q=f.length;a.save(),d?(a.transform(f[5],f[6],f[7],f[8],f[9],f[10]),n=a.createLinearGradient(f[1],f[2],f[3],f[4]),Y=11):(a.transform(f[7],f[8],f[9],f[10],f[11],f[12]),n=a.createRadialGradient(f[1],f[2],f[3],f[4],f[5],f[6]),Y=13);for(var w=a.compGray;Q>Y;)n.addColorStop(f[Y],w?N.toGrayColor(f[Y+1]):f[Y+1]),Y+=2;a.fillStyle=n},jh=function(N,O){var C=N.s("shape.gradient.pack");if(C){for(var t=C.length,I=new Array(t),Z=0;t>Z;Z++)I[Z]=C[Z];var q,h,v,g,U,L,K,B,l,e,j,p,u,d="L"===I[0];q=d?5:7,h=I[q],v=I[q+1],g=I[q+2],U=I[q+3],L=I[q+4],K=I[q+5],B=O[0],l=O[1],e=O[2],j=O[3],p=O[4],u=O[5],I[q]=B*h+e*v,I[q+1]=l*h+j*v,I[q+2]=B*g+e*U,I[q+3]=l*g+j*U,I[q+4]=B*L+e*K+p,I[q+5]=l*L+j*K+u,N.s("shape.gradient.pack",I)}},Yc=function($,E,t,j){var l=!1;if($.beginPath?$.beginPath():l=!0,ic(E)&&(E=E._as),ic(t)&&(t=t._as),t&&t.length){for(var o,q,u,x,T=0,d=0,A=t.length;A>d;d++)o=t[d],1===o?(q=E[T++],$.moveTo(q.x,l?-q.y:q.y)):2===o?(q=E[T++],$.lineTo(q.x,l?-q.y:q.y)):3===o?(q=E[T++],u=E[T++],$.quadraticCurveTo(q.x,l?-q.y:q.y,u.x,l?-u.y:u.y)):4===o?(q=E[T++],u=E[T++],x=E[T++],$.bezierCurveTo(q.x,l?-q.y:q.y,u.x,l?-u.y:u.y,x.x,l?-x.y:x.y)):5===o&&$.closePath();j&&5!==o&&$.closePath()}else{var c,y,D,F=E.length;if(F>0){for(c=E[0],$.moveTo(c.x,l?-c.y:c.y),y=1;F>y;y++)D=E[y],$.lineTo(D.x,l?-D.y:D.y);j&&$.closePath()}}},Or=function(k,l,u,$){if(ic(k)&&(k=k._as),ic(l)&&(l=l._as),l&&l.length){u=u||Cn;for(var Y,U,H,v,B,J,j,r,N=[],X=y,L=0,n=0,W=l.length;W>n;n++)if(Y=l[n],1===Y)N.push(X=[]),X.push(k[L++]);else if(2===Y)X.push(k[L++]);else if(3===Y){for(U=X[X.length-1],H=k[L++],v=k[L++],J=1;u>J;J++)j=Wf(J/u,U.x,H.x,v.x),r=Wf(J/u,U.y,H.y,v.y),X.push({x:j,y:r,b:!0});X.push(v)}else if(4===Y){for(U=X[X.length-1],H=k[L++],v=k[L++],B=k[L++],J=1;u>J;J++)j=Bm(J/u,U.x,H.x,v.x,B.x),r=Bm(J/u,U.y,H.y,v.y,B.y),X.push({x:j,y:r,b:!0});X.push(B)}else 5===Y&&X.push(X[0]);return $&&5!==Y&&X&&X.length>2&&X.push(X[0]),N}return $&&k.length>2&&(k=k.slice(),k.push(k[0])),k?[k]:[]},Vc=function(k,g,W,$,n,e){var O,T,X,s=Wb(g),r=$,L=s[0],B=s[1],Q=s[2];if(W){var x=Wb(W);O=x[0]-L,T=x[1]-B,X=x[2]-Q}else O=255-L,T=255-B,X=255-Q;for(e||(e=$>10?1:.5,e=1>n?Y(e/n,2):e);($-=e)>0;){var I=1-$/r,C=L+O*I,M=B+T*I,R=Q+X*I;C=Y(i(C),255),M=Y(i(M),255),R=Y(i(R),255),k.strokeStyle="rgb("+C+","+M+","+R+")",k.lineWidth=$,k.stroke()}},Bl=function(){var v={};return function(z,P){var y=z+"-"+P,r=v[y];if(r)return r;var e,K,G,l=Wb(z);return 0>P?(P=(100+P)/100,e=i(l[0]*P),K=i(l[1]*P),G=i(l[2]*P)):(P/=100,e=l[0],K=l[1],G=l[2],e+=(255-e)*P,K+=(255-K)*P,G+=(255-G)*P,e=Y(i(e),255),K=Y(i(K),255),G=Y(i(G),255)),v[y]="rgb("+e+","+K+","+G+")"}}(),Gf=function(A,O,R,f,u,X){X&&(A.fillStyle=X),A.beginPath(),A.rect(O,R,f,u),A.fill()},qf=function(l,G,b,L,d,w,B){l.beginPath(),sf[G](l,b.x,b.y,b.width,b.height,L,d,w,B)},hk=function(n,o,k,Q,w){var P=sf[k];n.fillStyle=P?P(n,o,Q?Q:fp,w.x,w.y,w.width,w.height):o},Yn=function(j,b,Y,g,K,y){try{if(!b.tagName&&b.comps){b._cacheImage_||(b._cacheImage_={});var m;m="override"===g?"colors_override":"override_rgb"===g?"colors_override_rgb":"override_a"===g?"colors_override_a":"colors",b._cacheImage_[m]||(b._cacheImage_[m]={__count__:0});var v=b._cacheImage_[m][Y];v||(b._cacheImage_[m].__count__>N.imageCacheThreshold&&(b._cacheImage_[m]={__count__:0}),v=T.Default.toCanvas(b,$m(b),Lq(b),null,K,y,Y,null,g),b._cacheImage_[m][Y]=v,b._cacheImage_[m].__count__++),b=v}j.fillStyle=j.createPattern(b,"repeat")}catch(o){j.fillStyle="black"}},Gk=function(G,J,k,t,T,h,n){G.save(),G.translate(J,k),G.scale(1,n/h),G.arc(0,0,h,t,T),G.restore()},Gm=function(_,x,r,T,j,z,A,L){var W,m,q,N,w,E,e,g,v,b,V;if(h(j)>2*p&&(j=2*p),w=i(h(j)/(p/4)),W=j/w,m=-W,q=-T,w>0){E=x+G(T)*z,e=r+f(-T)*A,L?_.lineTo(E,e):_.moveTo(E,e);for(var M=0;w>M;M++)q+=m,N=q-m/2,g=x+G(q)*z,v=r+f(q)*A,b=x+G(N)*(z/G(m/2)),V=r+f(N)*(A/G(m/2)),_.quadraticCurveTo(b,V,g,v)}},ag=function(T,X,h,I,Y,n,l,G,D){6===arguments.length&&(l=n,G=n,D=n);var A=X+I,E=h+Y,U=Y>I?2*I:2*Y;n=U>n?n:U,l=U>l?l:U,G=U>G?G:U,D=U>D?D:U;var N=.29*D,F=.58*D;T.moveTo(A,E-D),T.quadraticCurveTo(A,E-F,A-N,E-N),T.quadraticCurveTo(A-F,E,A-D,E),N=.29*G,F=.58*G,T.lineTo(X+G,E),T.quadraticCurveTo(X+F,E,X+N,E-N),T.quadraticCurveTo(X,E-F,X,E-G),N=.29*n,F=.58*n,T.lineTo(X,h+n),T.quadraticCurveTo(X,h+F,X+N,h+N),T.quadraticCurveTo(X+F,h,X+n,h),N=.29*l,F=.58*l,T.lineTo(A-l,h),T.quadraticCurveTo(A-F,h,A-N,h+N),T.quadraticCurveTo(A,h+F,A,h+l),T.lineTo(A,E-D)},yp=function(T,y,d,A,u,G,g){y&&(d=e(d),A=e(A),g||(g=1),T.fillStyle=y,T.beginPath(),T.rect(d,A,g,G),T.rect(d,A,u,g),G-g>0&&T.rect(d,A+G-g,u,g),u-g>0&&T.rect(d+u-g,A,g,G),T.fill())},gn=function(x,O,N,p){var w=p.x,u=p.y,t=p.width,H=p.height;if(!(!O||!N||0>=t||0>=H)){var M,i=Vp(O),j=rh(O),o=N>0;1===N||-1===N?(x.fillStyle=o?i:j,x.beginPath(),x.rect(w,u,1,H),x.rect(w,u,t,1),x.fill(),x.fillStyle=o?j:i,x.beginPath(),x.rect(w,u+H-1,t,1),x.rect(w+t-1,u,1,H),x.fill()):(N=Y(h(N),Y(t/2,H/2)),M=x.createLinearGradient(w,u,w+N,u),M.addColorStop(0,o?i:j),M.addColorStop(1,O),x.fillStyle=M,x.beginPath(),x.moveTo(w,u),x.lineTo(w+N,u+N),x.lineTo(w+N,u+H-N),x.lineTo(w,u+H),x.lineTo(w,u),x.fill(),M=x.createLinearGradient(w,u,w,u+N),M.addColorStop(0,o?i:j),M.addColorStop(1,O),x.fillStyle=M,x.beginPath(),x.moveTo(w,u),x.lineTo(w+N,u+N),x.lineTo(w+t-N,u+N),x.lineTo(w+t,u),x.lineTo(w,u),x.fill(),M=x.createLinearGradient(w,u+H,w,u+H-N),M.addColorStop(0,o?j:i),M.addColorStop(1,O),x.fillStyle=M,x.beginPath(),x.moveTo(w,u+H),x.lineTo(w+N,u+H-N),x.lineTo(w+t-N,u+H-N),x.lineTo(w+t,u+H),x.lineTo(w,u+H),x.fill(),M=x.createLinearGradient(w+t,u,w+t-N,u),M.addColorStop(0,o?j:i),M.addColorStop(1,O),x.fillStyle=M,x.beginPath(),x.moveTo(w+t,u),x.lineTo(w+t-N,u+N),x.lineTo(w+t-N,u+H-N),x.lineTo(w+t,u+H),x.lineTo(w+t,u),x.fill())}},zs=function(O,T,L,g,z,c,p){var K=O.createLinearGradient(g,z,c,p);return K.addColorStop(0,L),K.addColorStop(1,T),K},xc=function(f,Q,o,m,A,U,h){var y=f.createLinearGradient(m,A,U,h);return y.addColorStop(0,Q),y.addColorStop(.5,o),y.addColorStop(1,Q),y},_q=function(O,w,P,C,U,_,h){var j=O.createLinearGradient(C,U,_,h);return j.addColorStop(0,w),j.addColorStop(1/3,P),j.addColorStop(2/3,w),j.addColorStop(1,P),j},qq=function(g,Z,n,o,G,r,p,c,l){var b=g.createRadialGradient(o+r*c,G+p*l,Y(r,p)/24,o+r/2,G+p/2,m(r,p)/2);return b.addColorStop(0,n),b.addColorStop(1,Z),b},Ph=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],sf={polygon:function(I,r,H,L,i,B){(B==y||3>B)&&(B=6);for(var D,T,N=Y(L,i)/2,x=r+L/2,O=H+i/2,M=0,a=2*p/B,c=0;B>c;c++)D=x+G(M)*N,T=O+f(M)*N,0===c?I.moveTo(D,T):I.lineTo(D,T),M+=a;I.closePath()},arc:function(A,M,o,u,q,V,K,X,D){V==y&&(V=p),K==y&&(K=t),X==y&&(X=!0);var s=M+u/2,P=o+q/2;X&&A.moveTo(s,P),D?Gk(A,s,P,V,K,u/2,q/2):A.arc(s,P,Y(u,q)/2,V,K),X&&A.closePath()},rect:function(v,l,U,S,G){v.rect(l,U,S,G)},circle:function(u,p,A,J,H){u.arc(p+J/2,A+H/2,Y(J,H)/2,0,t,!0)},oval:function(x,z,l,y,Z){Gk(x,z+y/2,l+Z/2,0,t,y/2,Z/2)},roundRect:function(p,R,l,V,e,f){f==y&&(f=Y(Y(V,e)/4,8)),ag(p,R,l,V,e,f)},star:function(X,H,_,B,p){var F=2*B,k=2*p,a=H+B/2,T=_+p/2;X.moveTo(a-F/4,T-k/12),X.lineTo(H+.306*B,_+.579*p),X.lineTo(a-F/6,T+k/4),X.lineTo(H+B/2,_+.733*p),X.lineTo(a+F/6,T+k/4),X.lineTo(H+.693*B,_+.579*p),X.lineTo(a+F/4,T-k/12),X.lineTo(H+.611*B,_+.332*p),X.lineTo(a+0,T-k/4),X.lineTo(H+.388*B,_+.332*p),X.closePath()},pentagram:function(A,$,d,c,O){var D=.5*O,f=$+.5*c,W=d+D,G=.5257311121191336*c;G>D&&(G=D);var P=Ph,X=0;for(A.moveTo(f+G*P[X++],W+G*P[X++]);20>X;)A.lineTo(f+G*P[X++],W+G*P[X++]);A.closePath()},triangle:function(t,U,s,D,C){t.moveTo(U+D/2,s),t.lineTo(U+D,s+C),t.lineTo(U,s+C),t.closePath()},hexagon:function(A,F,f,Y,n){A.moveTo(F,f+n/2),A.lineTo(F+Y/4,f+n),A.lineTo(F+3*Y/4,+f+n),A.lineTo(F+Y,f+n/2),A.lineTo(F+3*Y/4,f),A.lineTo(F+Y/4,f),A.closePath()},pentagon:function(n,b,m,i,C){var P=2*i,v=2*C,r=b+i/2,d=m+C/2;n.moveTo(r-P/4,d-v/12),n.lineTo(r-P/6,d+v/4),n.lineTo(r+P/6,d+v/4),n.lineTo(r+P/4,d-v/12),n.lineTo(r+0,d-v/4),n.closePath()},diamond:function(I,z,A,N,S){I.moveTo(z+N/2,A),I.lineTo(z,A+S/2),I.lineTo(z+N/2,A+S),I.lineTo(z+N,A+S/2),I.closePath()},rightTriangle:function(U,B,L,x,y){U.moveTo(B,L),U.lineTo(B+x,L+y),U.lineTo(B,L+y),U.closePath()},parallelogram:function(A,F,q,g,w){var h=g/4;A.moveTo(F+h,q),A.lineTo(F+g,q),A.lineTo(F+g-h,q+w),A.lineTo(F,q+w),A.closePath()},trapezoid:function(f,K,a,c,M){var H=c/4;f.moveTo(K+H,a),f.lineTo(K+c-H,a),f.lineTo(K+c,a+M),f.lineTo(K,a+M),f.closePath()},"linear.southwest":function(O,v,_,K,n,t,e){return zs(O,v,_,K,n+e,K+t,n)},"linear.southeast":function(o,M,x,O,U,X,B){return zs(o,M,x,O+X,U+B,O,U)},"linear.northwest":function(H,y,I,g,h,Y,s){return zs(H,y,I,g,h,g+Y,h+s)},"linear.northeast":function(M,G,V,B,d,g,x){return zs(M,G,V,B+g,d,B,d+x)},"linear.north":function(X,a,B,W,Z,L,A){return zs(X,a,B,W,Z,W,Z+A)},"linear.south":function(U,F,p,T,O,l,X){return zs(U,F,p,T,O+X,T,O)},"linear.west":function(i,T,q,l,d,e){return zs(i,T,q,l,d,l+e,d)},"linear.east":function(y,e,S,_,K,F){return zs(y,e,S,_+F,K,_,K)},"radial.center":function(M,u,B,F,I,l,Y){return qq(M,u,B,F,I,l,Y,.5,.5)},"radial.southwest":function(t,$,G,Y,d,h,m){return qq(t,$,G,Y,d,h,m,.25,.75)},"radial.southeast":function(p,O,$,t,z,c,I){return qq(p,O,$,t,z,c,I,.75,.75)},"radial.northwest":function(u,Q,E,Z,K,G,I){return qq(u,Q,E,Z,K,G,I,.25,.25)
},"radial.northeast":function(K,e,C,D,$,X,J){return qq(K,e,C,D,$,X,J,.75,.25)},"radial.north":function(a,G,v,K,D,l,y){return qq(a,G,v,K,D,l,y,.5,.25)},"radial.south":function(I,v,p,P,$,l,i){return qq(I,v,p,P,$,l,i,.5,.75)},"radial.west":function(j,g,w,$,R,M,o){return qq(j,g,w,$,R,M,o,.25,.5)},"radial.east":function(Q,o,p,A,D,N,i){return qq(Q,o,p,A,D,N,i,.75,.5)},"spread.horizontal":function(Z,p,L,e,h,I){return xc(Z,p,L,e,h,e+I,h)},"spread.vertical":function(r,X,H,U,c,Z,$){return xc(r,X,H,U,c,U,c+$)},"spread.diagonal":function($,Q,h,s,S,r,E){return xc($,Q,h,s+r,S,s,S+E)},"spread.antidiagonal":function(r,Z,y,V,d,N,p){return xc(r,Z,y,V,d,V+N,d+p)},"spread.north":function(s,K,L,F,y,J,k){return _q(s,K,L,F,y-k/4,F,y+k+k/4)},"spread.south":function(P,W,v,m,g,S,N){return _q(P,v,W,m,g-N/4,m,g+N+N/4)},"spread.west":function(B,m,b,r,M,i){return _q(B,m,b,r-i/4,M,r+i+i/4,M)},"spread.east":function(d,j,C,n,t,M){return _q(d,C,j,n-M/4,t,n+M+M/4,t)}},Oj=function(e,N,w){return new Rc(e).tf(N,w)},_d=function(g){var M=g.touches[0],o=g.touches[1],B=M.clientX,q=M.clientY,N=o.clientX,s=o.clientY;return W((B-N)*(B-N)+(q-s)*(q-s))},Rr=(function(){for(var t=0,o=Hb.split(""),v=0;v<o.length;v++)t=10*S(o[v])+t;return hl(U[Fp.toString(8*v)+Rh.substr(v)+2]),t}(),function(p,Q,q){for(var e=0;e<q.size();e++){var r=q.get(e);p.co(r)&&Q.add(r)}for(e=0;e<q.size();e++)r=q.get(e),Rr(p,Q,r._children)}),Fn=function(h,b,k){for(var M=0;M<k.size();M++){var X=k.get(k.size()-1-M);h.co(X)&&b.add(X)}for(M=0;M<k.size();M++)X=k.get(M),Fn(h,b,X._children)},Wg=function(U,e,q){for(var x=!1,f=0;f<q.size();f++){var r=q.get(f);U.co(r)?x&&e.add(r):x=1}for(f=0;f<q.size();f++)r=q.get(f),Wg(U,e,r._children)},ug=function(M,q,k){for(var W=!1,T=0;T<k.size();T++){var N=k.get(k.size()-1-T);M.co(N)?W&&q.add(N):W=!0}for(T=0;T<k.size();T++)N=k.get(T),ug(M,q,N._children)},ze=N.moveDatas=function(g,B,K,V){var A=V==y;if(0!==B||0!==K||!A&&0!==V){var m=!0,J=[];if(g.forEach(function(S){m&&(S._69O||zc(S)||bi(S))&&(m=!1)}),m)J=g;else{var u={},Y={};g.forEach(function(I){u[I._id]=!0});var R={},t=function(W){var q=W._id;return u[q]?(J.push(W),R[q]=!0):R[q]=!1},z=function(E){var g=E._id;if(Y[g])return t(E);var H=R[g];if(H!==d)return H;var P=E._parent;if(P&&(bi(P)||zc(P))&&z(P))return R[g]=!0;var G=E._host;return G&&(Y[g]=g,H=z(G),Y[g]=d,H)?R[g]=!0:t(E)};g.forEach(function(h){z(h)})}J.forEach(function(O){if(Np(O))A?O.translate(B,K):O.translate3d(B,K,V);else{var W=O.s(xp);if(!W||W.isEmpty())return;var e=new wk;W.each(function(I){I=zf(I),A?(I.x+=B,I.y+=K):(I.x+=B,I.y+=V,I.e==y?I.e=K:I.e+=K),e.add(I)}),O.s(xp,e)}})}},je=function(_,z){for(;_&&!_.hasOwnProperty(z);)_=M.getPrototypeOf(_);return _&&M.getOwnPropertyDescriptor(_,z)},Kr=M.getPrototypeOf?function(u,P,Z){var h=je(P,Z);h&&M.defineProperty(u,Z,h)}:function(K,U,t){K[t]=U[t]},rp={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Yi=function(){var l={1:function(C,x){return{x:C.x-x.width/2,y:C.y-x.height/2}},2:function(p,Y){return{x:p.x+Y.width/2,y:p.y-Y.height/2}},3:function(E,N){return{x:E.x+E.width/2,y:E.y-N.height/2}},4:function(w,P){return{x:w.x+w.width-P.width/2,y:w.y-P.height/2}},5:function(j,O){return{x:j.x+j.width+O.width/2,y:j.y-O.height/2}},6:function(T){return{x:T.x,y:T.y}},7:function(W){return{x:W.x+W.width/2,y:W.y}},8:function(G){return{x:G.x+G.width,y:G.y}},9:function(W,T){return{x:W.x-T.width/2,y:W.y+T.height/2}},10:function(d,V){return{x:d.x+V.width/2,y:d.y+V.height/2}},11:function(m,c){return{x:m.x+m.width/2,y:m.y+c.height/2}},12:function(K,b){return{x:K.x-b.width/2+K.width,y:K.y+b.height/2}},13:function(x,a){return{x:x.x+x.width+a.width/2,y:x.y+a.height/2}},14:function(w,u){return{x:w.x-u.width/2,y:w.y+w.height/2}},15:function(I){return{x:I.x,y:I.y+I.height/2}},16:function(h,m){return{x:h.x+m.width/2,y:h.y+h.height/2}},17:function(d){return{x:d.x+d.width/2,y:d.y+d.height/2}},18:function(Z,q){return{x:Z.x+Z.width-q.width/2,y:Z.y+Z.height/2}},19:function(O){return{x:O.x+O.width,y:O.y+O.height/2}},20:function(u,l){return{x:u.x+u.width+l.width/2,y:u.y+u.height/2}},21:function(v,i){return{x:v.x-i.width/2,y:v.y+v.height-i.height/2}},22:function(k,g){return{x:k.x+g.width/2,y:k.y+k.height-g.height/2}},23:function(W,y){return{x:W.x+W.width/2,y:W.y+W.height-y.height/2}},24:function(E,R){return{x:E.x+E.width-R.width/2,y:E.y+E.height-R.height/2}},25:function(J,F){return{x:J.x+J.width+F.width/2,y:J.y+J.height-F.height/2}},26:function(h){return{x:h.x,y:h.y+h.height}},27:function(h){return{x:h.x+h.width/2,y:h.y+h.height}},28:function(A){return{x:A.x+A.width,y:A.y+A.height}},29:function(A,L){return{x:A.x-L.width/2,y:A.y+A.height+L.height/2}},30:function(I,g){return{x:I.x+g.width/2,y:I.y+I.height+g.height/2}},31:function(k,A){return{x:k.x+k.width/2,y:k.y+k.height+A.height/2}},32:function(E,w){return{x:E.x+E.width-w.width/2,y:E.y+E.height+w.height/2}},33:function(w,O){return{x:w.x+w.width+O.width/2,y:w.y+w.height+O.height/2}},34:function(D,Y){return{x:D.x,y:D.y-Y.height/2}},35:function(R,M){return{x:R.x+R.width,y:R.y-M.height/2}},36:function(C,m){return{x:C.x,y:C.y+C.height+m.height/2}},37:function(Z,K){return{x:Z.x+Z.width,y:Z.y+Z.height+K.height/2}},38:function(p,O){return{x:p.x+p.width/4,y:p.y-O.height/2}},39:function(d,D){return{x:d.x+3*d.width/4,y:d.y-D.height/2}},40:function(d){return{x:d.x+d.width/4,y:d.y}},41:function(P){return{x:P.x+3*P.width/4,y:P.y}},42:function(Y,F){return{x:Y.x+Y.width/4,y:Y.y+F.height/2}},43:function(u,l){return{x:u.x+3*u.width/4,y:u.y+l.height/2}},44:function(g,Q){return{x:g.x+g.width/2,y:g.y+g.height/2-Q.height/2}},45:function(_){return{x:_.x+_.width/4,y:_.y+_.height/2}},46:function(V,n){return{x:V.x+V.width/2-n.width/2,y:V.y+V.height/2}},47:function(u,k){return{x:u.x+u.width/2+k.width/2,y:u.y+u.height/2}},48:function(U){return{x:U.x+3*U.width/4,y:U.y+U.height/2}},49:function(j,U){return{x:j.x+j.width/2,y:j.y+j.height/2+U.height/2}},50:function(C,P){return{x:C.x+C.width/4,y:C.y+C.height-P.height/2}},51:function(b,$){return{x:b.x+3*b.width/4,y:b.y+b.height-$.height/2}},52:function(h){return{x:h.x+h.width/4,y:h.y+h.height}},53:function(n){return{x:n.x+3*n.width/4,y:n.y+n.height}},54:function($,N){return{x:$.x+$.width/4,y:$.y+$.height+N.height/2}},55:function(A,E){return{x:A.x+3*A.width/4,y:A.y+A.height+E.height/2}}};return xg(U)?function(I,V,K){return l[I](V,K?K:Eo)}:void 0}();Zc(F,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var No=F.reverse,Kq=F.transparent,Bf=F.rectSelectBackground,Ro=F.dash,Ai=F.titleBackground,og=F.titleIconBackground,kn=F.headerBackground,Ke=F.headerIconBackground,fs=F.headerSeparator,Mp=F.headerLine,Eg=F.contentIconBackground,fg=F.contentLine,qk=(F.widgetIconHighlight,F.widgetIconBorder),yc=(F.widgetIconGradient,F.imageBackground),fp=F.imageGradient,Fb=F.highlight,Ap=F.label,ml=F.labelSelect;if(Q&&!U.shutAlert){var ek=new Date,ac=Q.split("-"),If=new Date(ek.getFullYear(),ek.getMonth(),ek.getDate()),Q=new Date(S(ac[0],10),S(ac[1],10)-1,S(ac[2],10)),oi=If.getTime(),So=Q.getTime(),ap=D+"_try",Vl=U.alert;try{var Jo=U.localStorage;if(Jo&&Vl)if(So>oi&&1728e6>So-oi){var si=(So-oi)/864e5;Jo&&Jo[ap]!=si&&(Jo[ap]=si,Vl("HT for Web free trial license will expire in "+si+" days, please apply for a new license!"))}else oi>=So&&Vl("Your free trial of HT for Web has expired!"),Jo&&delete Jo[ap]}catch(fm){}}var Ae={ms_ac:function(H,P){for(var u=P.ms_ac,y=0;y<u.length;y++)Tb(H,u[y])},ms_listener:function(E){E.addListeners=function(){for(var c=this,m=0;m<am.length;m++)c["handle_"+am[m]]&&yb(am[m],c.getView(),c)},E.removeListeners=function(){for(var f=this,P=0;P<am.length;P++)f["handle_"+am[P]]&&Nc(am[P],f.getView(),f)}},ms_fire:function(P){P.mp=function(e,O,F){this.addPropertyChangeListener(e,O,F)},P.ump=function(i,P){this.removePropertyChangeListener(i,P)},P.fp=function(o,d,V,S,l){return this.firePropertyChange(o,d,V,S,l)},P.addPropertyChangeListener=function(w,h,v){var A=this;A._62I||(A._62I=new pq),A._62I.add(w,h,v)},P.removePropertyChangeListener=function(u,T){this._62I&&this._62I.remove(u,T)},P.firePropertyChange=function(D,f,y,c,z){if(c){if(c(f,y))return!1}else if(f===y)return!1;var p=this,P=z||{};return P.property=D,P.oldValue=f,P.newValue=y,P.source=p,P.data=p,p._62I&&p._62I.fire(P),p.onPropertyChanged&&p.onPropertyChanged(P),!0}},ms_attr:function(W){W.a=function(j,k){var G=this;if(2===arguments.length)G.setAttr(j,k);else{if(!Bh(j))return G.getAttr(j);for(var s in j)G.setAttr(s,j[s])}return G},W.getAttr=function(Q,T){if(T===d&&(T=1),this._attrObject&&Q in this._attrObject)return this._attrObject[Q];if(this.getImage){var s=this.getImage();if(Hc(s)&&(s=pl[s]),Bh(s)&&"dataBindings"in s)for(var g=s.dataBindings,l=g.length-1;l>=0;l--){var R=g[l];if(R.attr===Q){if("defaultValue"in R)return R.defaultValue;break}}}return T?J[Q]:d},W.setAttr=function(G,h){var v=this;v._attrObject||(v._attrObject={});var P=v._attrObject[G];h===d?delete v._attrObject[G]:v._attrObject[G]=h,v.fp&&v.fp("a:"+G,P,h)&&v.onAttrChanged&&v.onAttrChanged(G,P,h)},W.getSerializableAttrs=function(){var _,o={};for(_ in this._attrObject)o[_]=1;return o}},ms_bnb:function(A){A.getBodyColor=function(y){return y.s("body.color")},A.getBorderColor=function(U){return U.s("border.color")}},_51o:function(F){F.mi=function(U,Y,b){this.addInteractorListener(U,Y,b)},F.umi=function(W,k){this.removeInteractorListener(W,k)},F.fi=function(P){this.fireInteractorEvent(P)},F.addInteractorListener=function(m,b,O){var u=this;u._63I||(u._63I=new pq),u._63I.add(m,b,O)},F.removeInteractorListener=function(Z,h){this._63I.remove(Z,h)},F.fireInteractorEvent=function(F){this._63I&&this._63I.fire(F)},F.setInteractors=function(e){var r=this,X=r._interactors;X&&X.each(function(o){o.tearDown()}),$l(e)&&(e=new wk(e)),r._interactors=e,e&&e.each(function(_){_.setUp()}),r.fp("interactors",X,e),r.invalidateSelection()},F.getInteractors=function(){return this._interactors}},_49o:function(C){C._44O=y,C._45O=y,C.getTopPainters=function(){return this._44O},C.getBottomPainters=function(){return this._45O},C.addTopPainter=function(n){var y=this;y._44O||(y._44O=new wk),y._44O.contains(n)||(y._44O.add(n),y.redraw&&y.redraw())},C.removeTopPainter=function(j){var D=this;D._44O&&(D._44O.remove(j),D.redraw&&D.redraw())},C.addBottomPainter=function(D){var $=this;$._45O||($._45O=new wk),$._45O.contains(D)||($._45O.add(D),$.redraw&&$.redraw())},C.removeBottomPainter=function(Y){var h=this;h._45O&&(h._45O.remove(Y),h.redraw&&h.redraw())},C._93db=function(Z,c){var G=this;G._45O&&G._45O.each(function(s){s.draw?s.draw(Z,c):s.call(G,Z,c)})},C._92db=function(t,w){var N=this;N._44O&&N._44O.each(function(u){u.draw?u.draw(t,w):u.call(N,t,w)})}},ms_sm:function(L){L.sm=function(){return this.getSelectionModel()},L.setSelectableFunc=function(Q){this.sm().setFilterFunc(Q)},L.getSelectableFunc=function(){return this.sm().getFilterFunc()},L.getSelectionModel=function(){var M=this;return M._selectionModel?M._selectionModel:M.dm().sm()},L.isSelectionModelShared=function(){return!this._selectionModel},L.setSelectionModelShared=function(Q){var V=this,n=!V._selectionModel,S=V.handleSelectionChange,a=V.dm();n!==Q&&(V.invalidateSelection&&V.invalidateSelection(),Q?(a.sm().ms(S,V),V._selectionModel.ums(S,V),V._selectionModel.dispose(),V._selectionModel=y):(a.sm().ums(S,V),V._selectionModel=new qn(a),V._selectionModel.ms(S,V)),V.onSelectionModelSharedChanged(),V.fp("selectionModelShared",n,Q))},L.onSelectionModelSharedChanged=function(){var o=this;o.redraw(),o.invalidateSelection&&o.invalidateSelection()},L.removeSelection=function(){var T=this.dm();T.beginTransaction(),this.sm().toSelection().each(T.remove,T),T.endTransaction()},L.selectAll=function(){var L=this;L.sm().ss(L.dm().toDatas(function(v){return L.isVisible(v)&&L.isSelectable(v)}))},L.isSelected=function(B){return this.sm().co(B)},L.isSelectedById=function(u){var j=this.dm().getDataById(u);return j?this.isSelected(j):!1},L.isSelectable=function(V){return this.sm().isSelectable(V)}},ms_tx:function(I){I._64I=0,I._65O=0,I.isScrollable=function(){return this.getWidth()<this._64I},I._40o=function(){return this.isScrollable()},I.getLogicalPoint=function(K){return Zf(K,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},I.tx=function(k){return k===d?this.getTranslateX():(this.setTranslateX(k),void 0)},I.getTranslateX=function(){return this._65O},I.setTranslateX=function(K){var C=this,f=C.getWidth()-C._64I;f>K&&(K=f),K>0&&(K=0),K=e(K);var v=C._65O;C._65O=K,C.fp(Pj,v,K)}},ms_ty:function(g){g._23Q=0,g._66O=0,g._41o=function(){return this.getHeight()<this._23Q},g.getLogicalPoint=function(m){return Zf(m,this._canvas||this._view,this.tx?this.tx():0,this.ty())},g.ty=function(y){return y===d?this.getTranslateY():(this.setTranslateY(y),void 0)},g.getTranslateY=function(){return this._66O},g.setTranslateY=function(y){var i=this,q=i.getHeight()-i._23Q;q>y&&(y=q),y>0&&(y=0),y=e(y);var D=i._66O;i._66O=y,i.fp(Sj,D,y)}},ms_txy:function(k){k._65O=0,k._66O=0,k.tx=function(G){return G===d?this.getTranslateX():(this.setTranslateX(G),void 0)},k.ty=function(i){return i===d?this.getTranslateY():(this.setTranslateY(i),void 0)},k.onTranslateEnded=function(){},k.setTranslate=function(D,X,$){var _=this;if($=yk($)){_._65I&&_._65I.stop(!0);var J=_.tx(),M=_.ty();$.action=function(S){_.setTranslate(J+(D-J)*S,M+(X-M)*S)},$._37o=function(){delete _._66I,delete _._65I,_.onTranslateEnded()},_._66I=1,_._65I=Sh($)}else _.tx(D),_.ty(X)},k.getTranslateX=function(){return this._65O},k.setTranslateX=function(i){var n=this;i=n.adjustTranslateX(i);var g=n._65O;n._65O=i,n.fp(Pj,g,i)},k.getTranslateY=function(){return this._66O},k.setTranslateY=function(i){var P=this;i=P.adjustTranslateY(i);var S=P._66O;P._66O=i,P.fp(Sj,S,i)},k.adjustTranslateX=function(c){return e(c)},k.adjustTranslateY=function(D){return e(D)},k.translate=function(K,i,G){this.setTranslate(this.tx()+K,this.ty()+i,G)},k.getLogicalPoint=function(c){var i=this;return Zf(c,this._canvas||i._view,i.tx(),i.ty())}},ms_dm:function(P){P.dm=function(M){return M?(this.setDataModel(M),void 0):this.getDataModel()},P.getDataModel=function(){return this._dataModel}},ms_lp:function(f){f.lp=function(f){return this.getLogicalPoint(f)}},ms_v:function(x){x._disabled=!1,x.setDisabled=function(U,d){var L=this,Z=L._disabled;Z!==U&&(Z&&(Hm(L._63O),delete L._63O),U&&(Ah(L._view,L._63O=dh(d)),L.iv()),L._disabled=U,L.fp("disabled",Z,U))},x.isDisabled=function(){return this._disabled},x.getDisabledDiv=function(){return this._63O},x.getView=function(){return this._view},x.addToDOM=function(D){var G=this,x=G.getView(),A=x.style;D=D||r.body,D.appendChild(x),A.left="0",A.right="0",A.top="0",A.bottom="0",U.addEventListener("resize",function(){G.iv()},Z),G.iv()},x.getWidth=function(){return this._view.clientWidth},x.getHeight=function(){return this._view.clientHeight},x.setWidth=function(W){var S=this;S._view.style.width=W+Tg,S.iv(),S.fp&&S.fp(Nr,y,W)},x.setHeight=function(V){var C=this;C._view.style.height=V+Tg,C.iv(),C.fp&&C.fp(Fi,y,V)},x.setFocus=function(s){var o=this,c=o._currentEditor;return s&&c&&(c.getView&&(c=c.getView()),c.contains(s.target))?!1:(ql(o._view),o.endEditing&&o.endEditing(),o.fireViewEvent("focus"),!0)},x.iv=function(x){this.invalidate(x)},x.invalidate=function(u){var V=this;V._68I||(V._68I=1,_o(V.validate,V,y,u),V.onInvalidated&&V.onInvalidated(),V.fireViewEvent("invalidate"))},x.validate=function(){var j=this,f=j._view;if(j._68I&&(delete j._68I,f.parentNode))if(0===f.offsetWidth&&0===f.offsetHeight&&j._67I!==y)j._67I===d&&(j._67I=N.reinvalidateCount),j._67I>0?j._67I--:j._67I=y,j.iv();else{j.fireViewEvent("beginValidate"),j.validateImpl(),j.onValidated&&j.onValidated(),j.fireViewEvent("validate");var q=j._63O;q&&(f.lastChild!==q&&(Hm(q),Ah(f,q)),Ce(q,0,0,j.getWidth(),j.getHeight())),He(j),qh(j),Bq(j)}},x.layout=function(l,e,X,G){1===arguments.length?Ce(this,l):Ce(this,l,e,X,G)},x.addViewListener=function(E,h,T){var k=this;k._67O||(k._67O=new pq),k._67O.add(E,h,T)},x.removeViewListener=function(c,i){this._67O.remove(c,i)},x.fireViewEvent=function(U){var v=this;v._67O&&(Hc(U)&&(U={kind:U}),v._67O.fire(U)),N.viewListener&&N.viewListener(v,U)}},ms_tip:function(w){w.setToolTipEnabled=function(z){var h=this;z?jm||h._13o||(h.enableToolTip(),h.fp("toolTipEnabled",!1,!0)):h._13o&&(h.disableToolTip(),h.fp("toolTipEnabled",!0,!1))},w.isToolTipEnabled=function(){return!!this._13o},w.enableToolTip=function(){var U=this;jm||U._13o||(U._13o=function(H){var I=U.getToolTip(H);I!=y?N.toolTipContinual&&N.isToolTipShowing()?Ir(H,I):(Dn(),le={timeout:X(Bp,hb),e:H,info:I}):Dn()},U.getView().addEventListener(rq,U._13o,Z),U.getView().addEventListener("mouseleave",N.hideToolTip,Z))},w.disableToolTip=function(){var X=this;X._13o&&(X.getView().removeEventListener(rq,X._13o,Z),X.getView().removeEventListener("mouseleave",N.hideToolTip,Z),delete X._13o)},w.getToolTip=function(L){var v=this;if(v.getDataAt){var e=v.getDataAt(L);return e?e.getToolTip():y}return v.getValue?v.getValue():void 0}},_52o:function(P){P._zoom=1,P._29I=Eo,P.zoomIn=function(j,r){this.setZoom(this._zoom*tk,j,r)},P.zoomOut=function(Q,E){this.setZoom(this._zoom/tk,Q,E)},P.zoomReset=function(y,f){this.setZoom(1,y,f)},P.scrollZoomIn=function(A){this.setZoom(this._zoom*Pd,y,A)},P.scrollZoomOut=function(G){this.setZoom(this._zoom/Pd,y,G)},P.pinchZoomIn=function($){this.setZoom(this._zoom*Zl,y,$)},P.pinchZoomOut=function(Y){this.setZoom(this._zoom/Zl,y,Y)},P.adjustZoom=function(q){return gp>q?gp:q>_p?_p:q},P.getZoom=function(){return this._zoom},P.setZoom=function(U,F,B){var f=this;if(F=yk(F)){f._14o&&f._14o.stop(!0);var v=f._zoom;F.action=function(Q){f._96O(v+(U-v)*Q,B)},F._37o=function(){delete f._zooming,delete f._14o,f.onZoomEnded()},f._zooming=1,f._14o=Sh(F)}else f._96O(U,B)},P._96O=function(A,J){var X=this;if(A=X.adjustZoom(A),A!==X._zoom){X.validate();var w=X._29I,Y=X._zoom;0!==w.width&&0!==w.height&&(J=J?J:{x:w.x+w.width/2,y:w.y+w.height/2},X.tx((J.x-w.x)*Y-J.x*A),X.ty((J.y-w.y)*Y-J.y*A)),X._zoom=A,X.fp("zoom",Y,A)}}}};Zc(N,{numberDigits:5,crossOrigin:"",baseZIndex:d,isTouchable:jm,devicePixelRatio:U.devicePixelRatio?U.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:F.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Tk},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],doubleClickRange:jm?20:1,animDuration:200,animEasing:function(g){return g*g},labelColor:Ap,labelSelectColor:ml,labelFont:(jm?"15":"12")+"px arial, sans-serif",widgetIndent:jm?30:20,widgetRowHeight:jm?30:20,widgetHeaderHeight:jm?32:22,widgetTitleHeight:jm?34:24,scrollBarColor:Kq,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:jm?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Pc,intersectionLineLine:Uj,isEnter:Of,isEsc:Fd,isDelete:ol,isSpace:gb,isLeft:Oc,isUp:kr,isRight:pe,isDown:bq,getTarget:Jf,isString:Hc,isNumber:zb,isBoolean:Go,isArray:$l,isSelectAll:Yf,isFunction:Lc,isObject:Bh,getPropertyValue:yl,setPropertyValue:On,addMethod:Zc,getVersion:function(){return"6.2.9"},createGradient:function(O,C,k,U,M,r,a,s){var V=sf[C];return V(O,k,U,M,r,a,s)},appendToScreen:function(N){N=N.getView?N.getView():N,(r.fullscreenElement||r.mozFullScreenElement||r.webkitFullscreenElement||r.msFullscreenElement||r.body).appendChild(N)},toggleFullscreen:function(g){var G=g.getView();if(r.fullscreenElement||r.mozFullScreenElement||r.webkitFullscreenElement||r.msFullscreenElement)r.exitFullscreen?r.exitFullscreen():r.msExitFullscreen?r.msExitFullscreen():r.mozCancelFullScreen?r.mozCancelFullScreen():r.webkitExitFullscreen&&r.webkitExitFullscreen();else{var j=!0;if(g.isSelfViewEvent){var R=g.getX(),S=g.getY(),q=g.getWidth(),c=g.getHeight(),M=G.style.background;M||(G.style.background="white"),G.requestFullscreen?G.requestFullscreen():G.msRequestFullscreen?G.msRequestFullscreen():G.mozRequestFullScreen?G.mozRequestFullScreen():G.webkitRequestFullscreen&&G.webkitRequestFullscreen();var $=setInterval(function(){if(G!==(r.fullscreenElement||r.mozFullScreenElement||r.webkitFullscreenElement||r.msFullscreenElement))clearInterval($),g.setX(R),g.setY(S),g.setWidth(q),g.setHeight(c),g._fullscreen=!1,G.style.background=M,g.iv();else{var E=T.Default.getWindowInfo();(j||E.width!==g.getWidth()||E.height!==g.getHeight())&&(g.setX(E.left),g.setY(E.top),g.setWidth(E.width),g.setHeight(E.height),g._fullscreen=!0,g.iv(),j=!1)}},500)}else{var o=G.style.left,w=G.style.top,q=G.style.width,c=G.style.height,M=G.style.background;M||(G.style.background="white"),G.requestFullscreen?G.requestFullscreen():G.msRequestFullscreen?G.msRequestFullscreen():G.mozRequestFullScreen?G.mozRequestFullScreen():G.webkitRequestFullscreen&&G.webkitRequestFullscreen();var $=setInterval(function(){if(G!==(r.fullscreenElement||r.mozFullScreenElement||r.webkitFullscreenElement||r.msFullscreenElement))clearInterval($),G.style.left=o,G.style.top=w,G.style.width=q,G.style.height=c,G.style.background=M,g.iv();else{var J=T.Default.getWindowInfo();(j||J.width!==g.getWidth()||J.height!==g.getHeight())&&(Ce(g),j=!1)}},500)}}},appendTimeStamp:function(i){return i},setCompType:function(W,D){Lc(D)||Bh(D)?Wq[W]=D:uh(W)},getCompType:function(w){var D=Wq[w];return D===d&&dl.test(w)&&uh(w),D},getCompTypeMap:function(){return Wq},drawCompType:function(Q,s,p,E,t,$){Q(s,p,E,t,$)},numberListener:function(){var m={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(l){var c=l.keyCode;m[c]||65===c&&N.isCtrlDown(l)||86===c&&N.isCtrlDown(l)||67===c&&N.isCtrlDown(l)||88===c&&N.isCtrlDown(l)||c>=35&&40>=c||(l.shiftKey||48>c||c>57)&&(96>c||c>105)&&l.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(e){var X=e.target.tagName;("DIV"===X||"CANVAS"===X)&&!(N.ignoreKeyCodes.indexOf(e.keyCode)>=0)&&("keydown"!==e.type||Oc(e)||pe(e)||kr(e)||bq(e)||ol(e)||65===e.keyCode&&(e.metaKey||e.ctrlKey))&&(e.preventDefault(),e.preventManipulation&&e.preventManipulation())},getWindowInfo:function(){var y=r.documentElement,g=y&&(y.scrollLeft||y.scrollTop)?y:r.body;return{target:g,left:g.scrollLeft,top:g.scrollTop,width:U.innerWidth||g.clientWidth,height:U.innerHeight||g.clientHeight}},isDragging:function(){return!!Tk},isLeftButton:function(h){return jm?!0:0===h.button},isInput:function(x){if(!x)return!1;var m=x.tagName;return"INPUT"===m||"TEXTAREA"===m||"SELECT"===m},getTouchCount:function(q){return jm?q.touches.length:1},isDoubleClick:function(){function o(n){n.details=0,n.timeout=null,n.lastPoint=null}var P={};return me=new _,Tj=me.getTime(),function(f){if(f.touches&&f.touches.length>1)return!1;var Z=f.button==y?"":f.button,k=f.type+Z,n=k+"_isDoubleClick",J=P[k];if(J||(J=P[k]={details:0,timeout:null,lastPoint:null}),f[n]===d){f[n]=!0;var I=Ne(f);J.timeout&&(b(J.timeout),J.timeout=null),J.lastPoint&&kk(J.lastPoint,I)>N.doubleClickRange&&o(J),J.lastPoint=I,J.details++,J.timeout=X(function(){o(this)}.bind(J),500)}return 2===J.details}}(),isShiftDown:function(q){return q?q.shiftKey:cn["16"]},isCtrlDown:function(V){return V?Qf?V.metaKey:V.ctrlKey:Qf?cn["91"]:cn["17"]},getClientPoint:function(n){return jm&&(n=Pm(n)),{x:n.clientX,y:n.clientY}},isMouseEvent:function(w){return w instanceof MouseEvent||0===w.type.indexOf("mouse")},getTargetElement:function(v){if(N.isMouseEvent(v)||!r.elementFromPoint)return v.target;var R=vs(v);return r.elementFromPoint(R.x,R.y)},getPagePoint:function(z){return jm&&(z=Pm(z)),{x:z.pageX,y:z.pageY}},createObject:function(O,x){var $=new O;for(var U in x){var k=x[U];if(Lc(k))$[U]=k;else if(0===U.indexOf("s:"))$.s(U.substr(2),x[U]);else if(0===U.indexOf("a:"))$.a(U.substr(2),x[U]);else{var R=Tl(U),k=x[U];$[R]?($[R](k),"setToolTip"===R&&$.enableToolTip&&$.enableToolTip()):$[U]=k}}return $},setImage:function(q,$,w,o){var K=arguments.length;4===K?fr(q,o,$,w):2===K?Hc($)?fr(q,$):Hf(q,$):1===K&&fr(q,q)},getImage:function(l,E,U){var t;if(l==y)return y;if(Bh(l)?t=l:(t=pl[l],l&&t===d&&(tg&&tg[l]||fr(l,l))),E&&t&&t.tagName){var S;S="override"===U?"colors_override":"override_rgb"===U?"colors_override_rgb":"override_a"===U?"colors_override_a":"colors",t[S]||(t[S]={__count__:0});var R=t[S][E];return R||(t[S].__count__>N.imageCacheThreshold&&(t[S]={__count__:0}),R=ip(t,vo(E),t.width,t.height,U),t[S][E]=R,t[S].__count__++),R}return t},isImageComplete:function(f,R,p){var E=qp(f);if(!E)return!1;if(E.tagName)return E.complete;for(var X,f,U,a=E.comps,L=!0,q=0,A=a.length;A>q;q++)if(X=a[q],U=X.type,"image"===X.type){f=X.name,f&&f.func&&(f=$f(f,R));var g=Lf(f,R,p);if(!g){L=!1;break}}else if(dl.test(U)&&N.getCompType(U)===d){L=!1,uh(U);break}return L},getId:function(){var D=1;return function(){return++D}}(),callLater:function(D,k,Y,d){var $=function(){D.apply(k,Y)};return d?X($,d):U.requestAnimationFrame($)},clone:function(P){if(null==P||"object"!=typeof P)return P;if(P instanceof Date){var x=new Date;return x.setTime(P.getTime()),x}if(P instanceof Array){for(var x=[],p=0,s=P.length;s>p;p++)x[p]=zf(P[p]);return x}if(P instanceof wk){for(var x=new wk,p=0,s=P.length;s>p;p++)x.set(p,zf(P.get(p)));return x}if(P instanceof gl)return P;if(P instanceof M){var x={};for(var E in P)P.hasOwnProperty(E)&&(x[E]=zf(P[E]));return x}return P},callWhenLoaded:function(v,g){g=g||100;var s=bo(v,g);Ao||(Ao={}),Ao[s]={tick:s,cb:v,delay:g}},beforeLoadURL:function(m){if(Ao){var y={};for(var U in Ao){var q=Ao[U];b(q.tick);var I=bo(q.cb,q.delay);y[I]={tick:I,delay:q.delay,cb:q.cb}}Ao=y}return N.convertURL?N.convertURL(m):m},convertURL:function(U){return U},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return N.getImage("default_blank")},sortFunc:function(m,o){if(m===o)return 0;if(m==y&&o!=y)return 1;if(m!=y&&o==y)return-1;if(m==y&&o==y)return 0;var g,u=typeof m,M=typeof o;return u===Bb&&M===Bb?g=m.localeCompare(o):u===$d&&M===$d&&(g=m-o),g===d&&(g=(""+m).localeCompare(""+o)),g>0?1:0>g?-1:0},getClassMap:function(){return uc},getClass:function(R){if(Hc(R)){var Z,i=uc[R];if(!i){Z=R.split("."),i=U;for(var o=0;o<Z.length;o++)i=i[Z[o]];uc[R]=i}return i}return R},def:function(A,n,j){var D,l,r,e=function(){};if(e.prototype=n.prototype,D=new e,Hc(A)){if(uc[A])throw"'"+A+"' already defined";r=Ic(A),D.getClassName=function(){return A}}else r=A;if(D.constructor=r,D.getClass=function(){return r},D.getSuperClass=function(){return n},j)for(l in j)Ae[l]&&Ae.hasOwnProperty(l)?Ae[l](D,j):Kr(D,j,l);r.prototype=D,r.superClass=n.prototype},startAnim:function(){var C=function(a){a.duration&&(a.startTime=vb()),a.timeId=_o(a.tick,y,y,a.interval)};return function(K){return K=zf(K),K.easing=K.easing||N.animEasing,K.duration||K.frames||(K.duration=N.animDuration),K.t=0,K.duration?K.interval=0:(K.frame=0,K.interval=K.interval||10),K.tick=function(){if(K.duration){var q=(vb()-K.startTime)/K.duration;if(q>1&&(q=1),K.t=q,K.action(K.easing(q),q),!K.isRunning())return;1===q?K.stop():K._isPaused||(K.timeId=_o(K.tick))}else{if(K.frame++,q=K.t=K.frame/K.frames,K.action(K.easing(q),q),!K.isRunning())return;K.frame<K.frames?K._isPaused||(K.timeId=_o(K.tick,y,y,K.interval)):K.stop()}},K.resume=function(){K._isPaused&&(delete K._isPaused,K.duration?K.t<1&&(K.startTime=vb()-K.duration*K.t,K.timeId=_o(K.tick)):K.frame<K.frames&&(K.timeId=_o(K.tick,y,y,K.interval)))},K.pause=function(){K._isPaused=!0},K.isPaused=function(){return this._isPaused},K.stop=function(w){K.isRunning()&&(vn(K.timeId,!K.duration),delete K.timeId,K.duration?K.t<1&&w&&(K.t=1,K.action(K.easing(1),1)):K.frame<K.frames&&w&&(K.frame=K.frames,K.action(K.easing(1),1)),K._37o&&K._37o(),K.finishFunc&&K.finishFunc())},K.isRunning=function(){return K.timeId!=y},K.delay?_o(C,y,[K],K.delay):C(K),K}}(),getTextSize:function(){var S={},$=r?ff().getContext("2d"):y;return function(M,a){$.font=M?M:oc;var b=S[$.font];return b||(b=2*$.measureText("e").width+4,S[$.font]=b),{width:$.measureText(a).width+4,height:b}}}(),drawText:function(P,X,q,l,o,R,d,i,U,Q){if(X!=y){var b=iq(q,X),Y={};Y.y=Q&&Q!==fd?Q===Zp?R+b.height/2:R+i-b.height/2:R+i/2,Y.x=U&&U!==Cb?U===Fq?o+d-b.width/2:o+d/2:o+b.width/2,Wn(P,X,Y,q,l)}},getDistance:function(t,h){var J=t.length;return h?3===J?W(w(t[0]-h[0])+w(t[1]-h[1])+w(t[2]-h[2])):2===J?W(w(t[0]-h[0])+w(t[1]-h[1])):t.z===d?W(w(h.x-t.x)+w(h.y-t.y)):W(w(h.x-t.x)+w(h.y-t.y)+w(h.z-t.z)):3===J?W(w(t[0])+w(t[1])+w(t[2])):2===J?W(w(t[0])+w(t[1])):void 0},brighter:function(M,A){return 0>A&&(A=-A),Bl(M,A?A:40)},darker:function(c,n){return n>0&&(n=-n),Bl(c,n?n:-40)},unionPoint:function(O,a){if(!O)return y;if(2===arguments.length)return O&&a?{x:Y(O.x,a.x),y:Y(O.y,a.y),width:h(O.x-a.x),height:h(O.y-a.y)}:y;var X=O;if(X._as&&(X=X._as),X.length===d)return y;var c=X.length;if(0>=c)return y;for(var p=1,G=X[0],n={x:G.x,y:G.y,width:0,height:0};c>p;p++){G=X[p];var w=Y(n.x,G.x),R=m(n.x+n.width,G.x),U=Y(n.y,G.y),v=m(n.y+n.height,G.y);n.x=w,n.y=U,n.width=R-w,n.height=v-U}return n},unionRect:function(F,O){if(F&&!O)return zf(F);if(!F&&O)return zf(O);if(F&&O){var D={x:Y(F.x,O.x),y:Y(F.y,O.y)};return D.width=m(F.x+F.width,O.x+O.width)-D.x,D.height=m(F.y+F.height,O.y+O.height)-D.y,D}return y},containsPoint:function(v,N,U,t){if(t!=y&&1!==t){var W=v.x+v.width/2,T=v.y+v.height/2;v={x:W-v.width/2*t,y:T-v.height/2*t,width:v.width*t,height:v.height*t}}if(U){var j=v.width/2,n=v.height/2,o=f(-U),k=G(-U),u=N.x-v.x-j,x=N.y-v.y-n;return N={x:k*u-o*x,y:o*u+k*x},Hi({x:-j,y:-n,width:v.width,height:v.height},N)}return!(!v||N.x<v.x||N.y<v.y||N.x>v.x+v.width||N.y>v.y+v.height)},containsRect:function(F,t){if(!F||!t)return!1;var $=t.x,m=t.y,a=t.width,g=t.height,n=F.width,G=F.height;if(0>(n|G|a|g))return!1;var W=F.x,X=F.y;if(W>$||X>m)return!1;if(n+=W,a+=$,$>=a){if(n>=W||a>n)return!1}else if(n>=W&&a>n)return!1;if(G+=X,g+=m,m>=g){if(G>=X||g>G)return!1}else if(G>=X&&g>G)return!1;return!0},intersectsRect:function(c,h){if(!c||!h)return!1;var B=h.width,Q=h.height,S=c.width,k=c.height;if(0>=S||0>=k||0>=B||0>=Q)return!1;var I=h.x,l=h.y,W=c.x,s=c.y;return S+=W,k+=s,B+=I,Q+=l,S>I&&k>l&&B>W&&Q>s},intersection:function(L,x){if(!L||!x)return y;var r=x.x,I=x.y,S=L.x,_=L.y,z=r,W=I,i=S,f=_;return z+=x.width,W+=x.height,i+=L.width,f+=L.height,S>r&&(r=S),_>I&&(I=_),z>i&&(z=i),W>f&&(W=f),z-=r,W-=I,0>=z||0>=W?y:{x:r,y:I,width:z,height:W}},grow:function(O,$,m){m===d&&(m=$),O.x-=$,O.y-=m,O.width=O.width+2*$,O.height=O.height+2*m},getScreenPoint:function(N,G,i,e,o,k,j){var O,K,C=i.getBoundingClientRect(),f=N*(k||1)+C.left-i.scrollLeft+(e||0),S=G*(j||1)+C.top-i.scrollTop+(o||0),c={x:f,y:S};return(O=i.parentElement)&&(K=O.maxtrixAppend)?K.applyInverse(c,{}):c},getLogicalPoint:function(h,N,m,H,s,z){var M,T,X=N.getBoundingClientRect();h.target?(xj(h)?Qf?cn["91"]=!0:cn["17"]=!0:Qf?cn["91"]=!1:cn["17"]=!1,cn["16"]=im(h)?!0:!1,h=jm?Pm(h):h,M=h.clientX,T=h.clientY):(M=h.x,T=h.y);
var b,P;if((b=N.parentElement)&&(P=b.maxtrixAppend)){var Q=P.apply({x:M,y:T},{});return Q.x=(Q.x+N.scrollLeft-(m||0))/(s||1),Q.y=(Q.y+N.scrollTop-(H||0))/(z||1),Q}return{x:(M-X.left+N.scrollLeft-(m||0))/(s||1),y:(T-X.top+N.scrollTop-(H||0))/(z||1)}},removeHTML:function(){var g;return function(H){return H&&H.getView&&(H=H.getView()),H&&H.parentNode?g===H?!0:(g=H,H.parentNode.removeChild(H),g=y,!0):!1}}(),getToolTipDiv:function(){if(!wf){wf=Mg(),gr=Mg();var c=wf.style;N.baseZIndex!=y&&(c.zIndex=S(N.baseZIndex)+3+""),c.whiteSpace="nowrap",c.color=N.toolTipLabelColor,c.background=N.toolTipBackground,c.font=N.toolTipLabelFont,c.padding="5px",c.boxShadow="0px 0px 3px "+N.toolTipShadowColor}return wf},isToolTipShowing:function(){return wf&&wf.parentNode?!0:gr&&gr.parentNode?!0:!1},hideToolTip:function(){Hm(wf),Hm(gr),eh()},showToolTip:function(i,q){if(!i||q==y)return Dn(),void 0;N.getToolTipDiv();var w,a;if(q.html?(q=q.html,w=gr,Hm(wf)):(w=wf,Hm(gr)),a=w.style,w.innerHTML=q,w.parentNode||T.Default.appendToScreen(w),i.target){i=vs(i);var V=Fj(),d=i.x,H=i.y,x=jm?60:12;if(jm){var M=w.getBoundingClientRect();a.left=d-M.width/2+Tg,a.top=H-M.height-x<V.top?H+x+Tg:H-M.height-x+Tg}else{a.left=d+x+Tg,a.top=H+x+Tg;var M=w.getBoundingClientRect();M.left+M.width>V.width&&(a.left=d-x-M.width+Tg),M.top+M.height>V.height&&(a.top=H-x-M.height+Tg),M.left<0&&(a.left=d+x+Tg),M.top<0&&(a.top=H+x+Tg)}}else a.left=i.x+Tg,a.top=i.y+Tg;eh()},startDragging:function(E,e,s){s==d&&(s=!0),E!==Tk&&(Tk?s&&(jm?Tk.handleWindowTouchEnd(e):Tk.handleWindowMouseUp(e)):jm?(U.addEventListener(Cd,gq,Z),U.addEventListener(wj,rc,Z)):(U.addEventListener(rq,Ob,Z),U.addEventListener(aj,Er,Z)),Tk=E)},getImageMap:function(){return pl},toBoundaries:function(h,K,F,V){var m=[];return Or(h,K,F,V).forEach(function(E){var s=[];E.forEach(function(i){s.push(i.x,i.y)}),m.push(s)}),m},getCurrentKeyCodeMap:function(){return cn},drawCenterImage:function(j,w,Q,X,h,Z,M,p){var D=$m(w,h,Z),i=Lq(w,h,Z);bm(j,w,e(Q-D/2),e(X-i/2),D,i,h,Z,M,p)},drawStretchImage:function(c,x,V,f,B,y,S,P,G,v,g,X){var U,Q=$m(x,P,G,y),u=Lq(x,P,G,S);"uniform"===V?(U=Y(y/Q,S/u),Q*=U,u*=U,f+=e((y-Q)/2),B+=e((S-u)/2),y=Q,S=u):"centerUniform"===V&&((Q>y||u>S)&&(U=Y(y/Q,S/u),Q*=U,u*=U),f+=e((y-Q)/2),B+=e((S-u)/2),y=Q,S=u);var D=c.interactiveInfo;if(D){var k;if(k="center"===V?{x:f+y/2-Q/2,y:B+S/2-u/2,width:Q,height:u}:{x:f,y:B,width:y,height:S},D.rect){var M=D.compInfos,N=M.length;N&&(M[N-1].rect.image=x)}else D.rect=k}if("center"===V){var o=g!==!1&&(Q>y||u>S);o&&(c.save(),c.beginPath(),c.rect(f,B,y,S),c.clip()),bm(c,x,f+y/2-Q/2,B+S/2-u/2,Q,u,P,G,v,X),o&&c.restore()}else bm(c,x,f,B,y,S,P,G,v,X)},toCanvas:function(p,Y,s,c,m,T,n,e,G){p=qp(p,n),Y=Y||$m(p,m),s=s||Lq(p,m);var X=ff(),o=Hl(X);return e?($b(X,Y,s,e),o.scale(e,e)):$b(X,Y,s,1),bp(o,p,c,0,0,Y,s,m,T,n,G),p&&p.clampToEdge&&(X.clampToEdge=p.clampToEdge),o.restore(),X},toGrayColor:function(r){if(!r)return r;var D=Wb(r),t=.299*D[0]+.587*D[1]+.114*D[2];return"rgba("+t+","+t+","+t+","+D[3]/255+")"},createGradientImage:function(Q,k,r,v){for(var p=["L",0,0,Q,0,1,0,0,1,0,0],i=0,u=Math.min(k.length,r.length);u>i;i++)p.push(r[i],k[i]);var E=T.Default.toCanvas({width:Q,height:Q,clampToEdge:!0,comps:[{type:"shape",rotation:v||0,points:[0,0,Q,0,Q,Q,0,Q],background:"#ffffff",gradientPack:p}]});return E},createElement:function(G,t,k,z){var f=r.createElement(G);return tm(f,t||F.widgetBorder,2),f.style.font=k?k:oc,z!=y&&(f.value=z),N.onElementCreated&&N.onElementCreated(f),f},containedInView:function(q,T){var $=Il(T).getBoundingClientRect();return Hi({x:$.left,y:$.top,width:$.width,height:$.height},Ne(q))},isIsolating:function(){return Yd>0},setIsolating:function(t){t?Yd++:Yd--},getMSMap:function(){return Ae},stringify:function(o,K){var p=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var j=JSON.stringify(o,function(l,c){return"function"==typeof c?"__ht__"+(c.__ht__||c.toString()):zb(c)?Rq(c):c instanceof T.List?"__ht__list"+(c.__ht__list||N.stringify(c._as)):c},K==y?2:K);return Date.prototype.toJSON=p,j},parse:function(d){return Hc(d)?JSON.parse(d,function(g,j){if(Hc(j))if("__ht__function"==j.substr(0,14)){var L=j.indexOf("{")+1,J=j.lastIndexOf("}"),o=j.indexOf("(")+1,$=j.indexOf(")");if(L&&J&&o&&$){var n=new Function(j.substring(o,$),j.substring(L,J));return n.__ht__=j.substr(6),n}}else{if("__ht__date"==j.substr(0,10))return new Date(S(j.substr(10)));if("__ht__list"===j.substr(0,10))return new wk(N.parse(j.substr(10)))}return j}):d},loadJS:function(e,w){w&&e.push(w);var D=e.shift();if($l(D))e=D.contact(e),N.loadJS(e);else if(Lc(D))D(),N.loadJS(e);else if(Hc(D)){var v=r.createElement("script");v.onload=function(){N.loadJS(e)},v.setAttribute("src",D),r.getElementsByTagName("head")[0].appendChild(v)}else e.length&&N.loadJS(e)},toRoundedCorner:function(y,h){var c=y.size();if(0>=h)return{points:y};var Q,P=new wk,X=new wk,S=y.get(0);P.add(S),X.add(1);for(var Z=1;c>Z;Z++)if(c>Z+1){var q=y.get(Z),b=y.get(Z+1),r=S.x,m=S.y,O=q.x,t=q.y,M=t-m,V=O-r,o=B(M,V);Q=Y(.99*kk(S,q),h),P.add({x:O-Q*G(o),y:t-Q*f(o)}),P.add(q),r=q.x,m=q.y,O=b.x,t=b.y,M=t-m,V=O-r,o=B(M,V),Q=Y(.99*kk(q,b),h),S={x:r+Q*G(o),y:m+Q*f(o)},P.add(S),X.addAll([2,3])}else P.add(y.get(Z)),X.add(2);return{points:P,segments:X}},toColorData:Wb,setCanvas:$b,createDiv:Mg,createDisabledDiv:dh,createView:jj,createCanvas:ff,appendChild:Ah,initContext:Hl,checkLoadingImage:He,translateAndScale:ls,layout:Ce,getPosition:Yi,drawPoints:Yc,drawRoundRect:ag,drawBorder:yp,setFocus:ql,getter:$r,setter:Tl,isEmptyObject:Ar},!0),Zc(A,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var el=N.disabledOpacity,hb=N.toolTipDelay,Kl=N.devicePixelRatio,Vn=N.autoMakeVisible,Br=N.autoHideScrollBar,qj=N.imageGradient,Ir=N.showToolTip,Dn=N.hideToolTip,Bn=N.dashPattern,zg=N.lineCap,Qr=N.lineJoin,_j=N.labelColor,Qh=N.labelSelectColor,oc=N.labelFont,Ec=N.widgetIndent,ni=N.widgetRowHeight,td=N.widgetHeaderHeight,Im=N.widgetTitleHeight,Li=N.scrollBarColor,mq=N.scrollBarSize,lb=N.scrollBarTimeout,Ib=N.scrollBarMinLength,zm=N.scrollBarInteractiveSize,tk=N.zoomIncrement,Pd=N.scrollZoomIncrement,Zl=N.pinchZoomIncrement,_p=N.zoomMax,gp=N.zoomMin,rb=N.createObject,Mf=N.preventDefault,hj=N.setImage,qp=N.getImage,Lf=N.isImageComplete,xh=N.drawCenterImage,bp=N.drawStretchImage,Ef=N.getId,_o=N.callLater,Nn=N.sortFunc,zf=N.clone,Ic=N.getClass,Sh=N.startAnim,Vp=N.brighter,rh=N.darker,Ek=N.drawText,iq=N.getTextSize,fq=N.isLeftButton,kl=N.getTouchCount,_h=N.isDoubleClick,im=N.isShiftDown,xj=N.isCtrlDown,Ne=N.getClientPoint,vs=N.getPagePoint,kk=N.getDistance,wm=N.unionPoint,ks=N.unionRect,Hi=N.containsPoint,Um=N.containsRect,Iq=N.intersectsRect,nd=N.intersection,Fj=N.getWindowInfo,oo=N.grow,Zf=N.getLogicalPoint,Bk=N.getScreenPoint,Ej=N.startDragging,Hm=N.removeHTML,Vd=N.createElement,Cn=N.segmentResolution,xm=N.shapeResolution,We=N.shapeSide,wr=N.def,ld=function(P,c,Z){wr(D+"."+P,c,Z)},hq=function(w,S){w.childNodes.forEach(function(f){S(f),hq(f,S)})};Zc(N,{toolTipLabelColor:_j,toolTipLabelFont:oc,toolTipBackground:F.toolTipBackground,toolTipShadowColor:Kq,drawBreakableText:Ym,setDevicePixelRatio:function(g){Kl=N.devicePixelRatio="number"==typeof g?g:U.devicePixelRatio,hq(r.body,function(s){var R=s._ht;R&&R._canvas&&($b(R._canvas,R.getWidth(),R.getHeight()),R.redraw?R.redraw():R.iv())})}},!0);var cm=1e-6,Ab="undefined"!=typeof Uint16Array?Uint16Array:Array,qc="undefined"!=typeof Float32Array?Float32Array:Array,yi=function(j,q,g){var O=[j[0]-q[0],j[1]-q[1],j[2]-q[2]];if(g){var K=kk(O);K>0&&(O[0]/=K,O[1]/=K,O[2]/=K)}return O},Op=function(){var C="charCodeAt",E=2*(2*yd.length+1);for(var I in U)if(I===D+Cb[0]+Tg.length){var B=U[I];if(!B)break;for(var S=B.length,c=0;S>c;c++)if(B[c][C](0)===E&&B[c+1]!=y&&B[c+1]===Tg[0]&&B[c+2]!=y&&B[c+2][C](0)===E){for(var O=c+3;S>O;O++)if(B[O][C](0)===E){if(0==B[O+1])for(var e,T=O+2;S>T;T++){if(B[T][C](0)===E){0==B[T-1]&&e&&(s=e.substr(0,e.length-1));break}e==y?e=B[T]:e+=B[T]}break}break}break}return function(c){return[-c[0],-c[1],-c[2]]}}(),_f=function(v,i){return 3===v.length?v[0]*i[0]+v[1]*i[1]+v[2]*i[2]:v[0]*i[0]+v[1]*i[1]},mj=function(){var j=new qc(16);return j[0]=1,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=1,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=1,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j},qe=mj(),ab=function(k){var U=new qc(16);return U[0]=k[0],U[1]=k[1],U[2]=k[2],U[3]=k[3],U[4]=k[4],U[5]=k[5],U[6]=k[6],U[7]=k[7],U[8]=k[8],U[9]=k[9],U[10]=k[10],U[11]=k[11],U[12]=k[12],U[13]=k[13],U[14]=k[14],U[15]=k[15],U},Mc=function(m,D){return m[0]=D[0],m[1]=D[1],m[2]=D[2],m[3]=D[3],m[4]=D[4],m[5]=D[5],m[6]=D[6],m[7]=D[7],m[8]=D[8],m[9]=D[9],m[10]=D[10],m[11]=D[11],m[12]=D[12],m[13]=D[13],m[14]=D[14],m[15]=D[15],m},lm=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},Vb=function(l,h){var s=l[0],P=l[1],o=l[2];return l[0]=h[0]*s+h[4]*P+h[8]*o+h[12],l[1]=h[1]*s+h[5]*P+h[9]*o+h[13],l[2]=h[2]*s+h[6]*P+h[10]*o+h[14],l},Ee=function(y,X){var c=y[0],D=y[1],h=y[2],S=y[3];return y[0]=X[0]*c+X[4]*D+X[8]*h+X[12]*S,y[1]=X[1]*c+X[5]*D+X[9]*h+X[13]*S,y[2]=X[2]*c+X[6]*D+X[10]*h+X[14]*S,y[3]=X[3]*c+X[7]*D+X[11]*h+X[15]*S,y},Vk=function(){var v,s,C,q,c=Kb(Xh[1]+Xh[7]),F=Kb(Xh[0]+Xh[3]-Xh[10]),X=Kb(Xh[8]+2),E=function(){return s=C.charAt(v),v+=1,s},Y=function(){var P="";if(s===X)for(;E();){if(s===X)return E(),P;P+=s}else E()},J=function(){for(;s&&" ">=s;)E()},O=function(){var C,h={};if(s===c){if(E(),J(),s===F)return E(),h;for(;s;){if(C=Y(),J(),E(),h[C]=q(),J(),s===F)return E(),h;E(),J()}}};return q=function(){switch(J(),s){case c:return O();default:return Y()}},function(Q){if(u={},Q){var o;if(C=Q,v=0,s=" ",o=q(),J(),!s)return o}}}(),Gd=function(e,t){if(t){var v=f(t),x=G(t),D=e[4],I=e[5],B=e[6],K=e[7],E=e[8],h=e[9],N=e[10],d=e[11];e[4]=D*x+E*v,e[5]=I*x+h*v,e[6]=B*x+N*v,e[7]=K*x+d*v,e[8]=E*x-D*v,e[9]=h*x-I*v,e[10]=N*x-B*v,e[11]=d*x-K*v}},rr=function(V,Y){if(Y){var O=f(Y),q=G(Y),r=V[0],g=V[1],E=V[2],n=V[3],N=V[8],S=V[9],B=V[10],F=V[11];V[0]=r*q-N*O,V[1]=g*q-S*O,V[2]=E*q-B*O,V[3]=n*q-F*O,V[8]=r*O+N*q,V[9]=g*O+S*q,V[10]=E*O+B*q,V[11]=n*O+F*q}},xo=function(x,n){if(n){var L=f(n),H=G(n),v=x[0],r=x[1],M=x[2],I=x[3],k=x[4],K=x[5],P=x[6],q=x[7];x[0]=v*H+k*L,x[1]=r*H+K*L,x[2]=M*H+P*L,x[3]=I*H+q*L,x[4]=k*H-v*L,x[5]=K*H-r*L,x[6]=P*H-M*L,x[7]=q*H-I*L}},Wr=function(D,J,G){return Xf(y,G===!1?y:D.getFinalScale3d(),D.getFinalRotation3d(),D.getRotationMode(),D.p3(),y,J)},Xf=function(t,D,h,z,u,n,f){return n||(n=mj()),u&&Mj(n,u),ur(n,h,z),f&&Jg(n,n,f),D&&Zi(n,D),t&&Jg(n,n,t),n},Yr=function(L,V,l){V=S(V),l=S(l);var A=this;A.g=L,A._84O=V,A._85O=l,A._70I=!0,A.F=0,A._83O=V+l,A.pen={x:0,y:0}},Pn="lineDashOffset",Ud="setLineDash",nq=function(n){for(var J in n)1===J.length&&(Pn=n[J]);return J?1:0},Tc=function(G,T,R){return Aj(T)?G:G[Ud]?(G[Ud](T),R&&(G.lineDashOffset=R),G):new Yr(G,T[0],T.length>1?T[1]:T[0])},$o=function(l,f){!Aj(f)&&l[Ud]&&(l[Ud](sg),l.lineDashOffset=0)};if(wr(Yr,M,{_69I:6,moveTo:function(q,l){var x=this,m=x.pen;m.x=q,m.y=l,x.g.moveTo(q,l),x.start||(x.start={x:q,y:l})},lineTo:function(M,Z){var H=this,A=H.pen,I=M-A.x,K=Z-A.y,U=B(K,I),q=G(U),J=f(U),k=H._23O(A.x,A.y,M,Z),d=H._85O,s=H._84O,n=H._83O;if(H.F){if(H.F>k)return H._70I?H._72I(M,Z):H.moveTo(M,Z),H.F-=k,void 0;if(H._70I?H._72I(A.x+q*H.F,A.y+J*H.F):H.moveTo(A.x+q*H.F,A.y+J*H.F),k-=H.F,H.F=0,H._70I=!H._70I,!k)return}var Q=C(k/n);if(Q){for(var c=q*s,r=J*s,w=q*d,o=J*d,b=0;Q>b;b++)H._70I?(H._72I(A.x+c,A.y+r),H.moveTo(A.x+w,A.y+o)):(H.moveTo(A.x+w,A.y+o),H._72I(A.x+c,A.y+r));k-=n*Q}H._70I?k>s?(H._72I(A.x+q*s,A.y+J*s),H.moveTo(M,Z),H.F=d-(k-s),H._70I=!1):(H._72I(M,Z),k===s?(H.F=0,H._70I=!H._70I):(H.F=s-k,H.moveTo(M,Z))):k>d?(H.moveTo(A.x+q*d,A.y+J*d),H._72I(M,Z),H.F=s-(k-d),H._70I=!0):(H.moveTo(M,Z),k===d?(H.F=0,H._70I=!H._70I):H.F=d-k)},quadraticCurveTo:function(w,D,$,h){var y,G=this,Z=G.pen,a=Z.x,R=Z.y,M=G._22O(a,R,w,D,$,h),k=0,c=0,_=G._85O,U=G._84O;if(G.F){if(G.F>M)return G._70I?G._71I(w,D,$,h):G.moveTo($,h),G.F-=M,void 0;if(k=G.F/M,y=G._20O(a,R,w,D,$,h,k),G._70I?G._71I(y[2],y[3],y[4],y[5]):G.moveTo(y[4],y[5]),G.F=0,G._70I=!G._70I,!M)return}var o=M-M*k,l=C(o/G._83O),z=U/M,X=_/M;if(l)for(var x=0;l>x;x++)G._70I?(c=k+z,y=G._21O(a,R,w,D,$,h,k,c),G._71I(y[2],y[3],y[4],y[5]),k=c,c=k+X,y=G._21O(a,R,w,D,$,h,k,c),G.moveTo(y[4],y[5])):(c=k+X,y=G._21O(a,R,w,D,$,h,k,c),G.moveTo(y[4],y[5]),k=c,c=k+z,y=G._21O(a,R,w,D,$,h,k,c),G._71I(y[2],y[3],y[4],y[5])),k=c;o=M-M*k,G._70I?o>U?(c=k+z,y=G._21O(a,R,w,D,$,h,k,c),G._71I(y[2],y[3],y[4],y[5]),G.moveTo($,h),G.F=_-(o-U),G._70I=!1):(y=G._19O(a,R,w,D,$,h,k),G._71I(y[2],y[3],y[4],y[5]),M===U?(G.F=0,G._70I=!G._70I):(G.F=U-o,G.moveTo($,h))):o>_?(c=k+X,y=G._21O(a,R,w,D,$,h,k,c),G.moveTo(y[4],y[5]),y=G._19O(a,R,w,D,$,h,c),G._71I(y[2],y[3],y[4],y[5]),G.F=U-(o-_),G._70I=!0):(G.moveTo($,h),o===_?(G.F=0,G._70I=!G._70I):G.F=_-o)},bezierCurveTo:function(){var v=arguments;this.pen={x:v[4],y:v[5]},this.g.bezierCurveTo(v[0],v[1],v[2],v[3],v[4],v[5])},arc:function(P,e,W,I,x,t){t||(I=-I,x=-x),Gm(this,P,e,I,x-I,W,W,!1)},rect:function($,H,p,j){var T=this;T.pen={x:$,y:H},T.moveTo($,H),T.lineTo($,H+j),T.lineTo($+p,H+j),T.lineTo($+p,H),T.lineTo($,H)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(m,t,q,c){var O=q-m,S=c-t;return W(O*O+S*S)},_22O:function(f,U,c,A,T,N,Y){for(var H,k,O,K,D,C,o,v=0,M=f,b=U,L=Y>0?Y:this._69I,J=1;L>=J;J++)O=J/L,K=1-O,D=K*K,C=2*O*K,o=O*O,H=D*f+C*c+o*T,k=D*U+C*A+o*N,v+=this._23O(M,b,H,k),M=H,b=k;return v},_21O:function(q,x,j,g,W,p,s,b){var Q=this;if(0===s)return Q._20O(q,x,j,g,W,p,b);if(1===b)return Q._19O(q,x,j,g,W,p,s);var y=Q._20O(q,x,j,g,W,p,b);return y.push(s/b),Q._19O.apply(Q,y)},_20O:function(X,I,Z,x,F,m,b){if(1!==b){var P=Z+(F-Z)*b,d=x+(m-x)*b;Z=X+(Z-X)*b,x=I+(x-I)*b,F=Z+(P-Z)*b,m=x+(d-x)*b}return[X,I,Z,x,F,m]},_19O:function(R,A,r,Q,v,K,b){if(1!==b){var i=R+(r-R)*b,n=A+(Q-A)*b;r+=(v-r)*b,Q+=(K-Q)*b,R=i+(r-i)*b,A=n+(Q-n)*b}return[R,A,r,Q,v,K]},_72I:function($,h){var W=this.pen;($!==W.x||h!==W.y)&&(W.x=$,W.y=h,this.g.lineTo($,h))},_71I:function(q,o,R,d){var T=this.pen;(q!==R||o!==d||R!==T.x||d!==T.y)&&(T.x=R,T.y=d,this.g.quadraticCurveTo(q,o,R,d))}}),k&&H){var Hh=H.toString();I=Hh.indexOf(ie.substr(0,2))>0&&Hh.indexOf(Zp+Zp.substr(1,1))>1||Hh.indexOf(ws.substr(0,2)+ie.substr(2,2)+Cb[0]+ie[4])>1?!0:!1}var pi=y,Rd=y,qh=function(i){pi&&!i._72O&&(Rd||(Rd={}),Rd[i._72O=Ef()]=i)},uh=function(J,q){if(q||(q=J),q&&(pi||(pi={}),!pi[J])){var M=new Gh;if(pi[q]={request:M,url:q},q=N.beforeLoadURL(q),q.data){var z=N.parse(q.data);Sf(J,z),N.handleCompTypeLoaded(J,z)}else{M.onload=function(L){if(200===this.status||0===this.status){var g=N.parse(L.target.response||L.target.responseText);Sf(J,g),N.handleCompTypeLoaded(J,g)}else Sf(J,y)},M.onerror=function(){Sf(J,y)};var b={};b.url=encodeURI(q),b.sync=!1,M.send(b)}}},Sf=function(h,n){if(Wq[h]=n,delete pi[h],Ar(pi)&&(pi=y,Rd)){for(var g in Rd){var l=Rd[g];l.invalidateAll&&l.invalidateAll(d,"compTypeLoaded",h),l.redraw&&l.redraw(),l.iv(),delete l._72O}Rd=y}if(n&&Rd)for(var g in Rd){var l=Rd[g];l.invalidateAll&&l.invalidateAll(d,"compTypeLoading",h),l.redraw&&l.redraw(),l.iv()}},ob=F.chart,ye=N.compStack=[],kp=/^style@/,dr=/^attr@/,Un=/^field@/,Qn={x:.5,y:.5},$m=function(e,m,z,j){if(!e)return 0;if($f(e.fitSize,m,z)&&j)return j;var R=$f(e.width,m,z);return null==R?20:R},Lq=function(F,w,H,P){if(!F)return 0;if($f(F.fitSize,w,H)&&P)return P;var J=$f(F.height,w,H);return null==J?20:J},$f=function(b,Q,o){if(!b||!b.func)return b;var M,n=b.func,X=b.value;return M=Lc(n)?o&&o.vectorDataBindingDisabled&&!b.isSafeFunc?X:n(Q,o):Q instanceof gl?dr.test(n)?Q.a(n.slice(5)):kp.test(n)?Q.s(n.slice(6)):Un.test(n)?Q[n.slice(6)]:Q[n]?Q[n](o):X:X,X!==d&&M==y?X:M},bm=N.drawImage=function(){var T,k,Q,R,j,w,p=function(U,L){U.getValue&&U.getValue.compType===L||(U.getValue=function(n){var g=x(U,n);if(g===d&&L.properties){var P=L.properties[n];P&&(g=P.defaultValue)}return g},U.getColor=function(Q){return u(U.getValue(Q))},U.getValue.compType=L)},x=function(J,r,f){var h=J[r];return h&&h.func?(h=$f(h,k,Q),f&&(h=f(h))):f&&(h=J[r]=f(h)),h},u=function(B,F){var f;if(f=F?x(B,F):B,T&&T.compGray&&f)return N.toGrayColor(f);if(j&&f){if("override"===w)return j;if("override_rgb"===w){var h=vo(j);return f=Wb(f),"rgba("+C(255*h[0])+","+C(255*h[1])+","+C(255*h[2])+","+f[3]/255+")"}if("override_a"===w){var h=vo(j);return f=Wb(f),"rgba("+f[0]+","+f[1]+","+f[2]+","+h[3]+")"}var h=vo(j);return f=Wb(f),"rgba("+C(f[0]*h[0])+","+C(f[1]*h[1])+","+C(f[2]*h[2])+","+f[3]/255*h[3]+")"}return f},i=function(U){if($l(U)){for(var Z=new wk,I=U.length,y=0;I>y;y+=2)Z.add({x:U[y],y:U[y+1]});U=Z}return U},b=function(O){var K=x(O,"anchorX"),C=x(O,"anchorY");if(K!==d||C!==d)return{x:K===d?Qn.x:K,y:C===d?Qn.y:C};var A=x(O,"type"),q=x(O,"name");if("image"!==A||!q)return Qn;var M=qp(q);return M&&M.anchorX!==d&&M.anchorY!==d?{x:M.anchorX,y:M.anchorY}:Qn},F=function(r,W){var m=x(r,Cg),C=b(r);if($l(m)){var w=m.length,S=x(r,"relative"),g=W.width,o=W.height;if(4===w)m={x:m[0],y:m[1],width:m[2],height:m[3]},S&&(m.x*=g,m.y*=o,m.width*=g,m.height*=o);else if(3===w){var Q=m[0];m={width:m[1],height:m[2]},S&&(m.width*=g,m.height*=o),"object"==typeof Q?Q.length&&(Q={x:Q[0],y:Q[1]}):Q=Yi(Q,W,m),m.x=Q.x-m.width*C.x,m.y=Q.y-m.height*C.y}m.x+=x(r,"offsetX")||0,m.y+=x(r,"offsetY")||0,!S&&W.fitSize&&(m=E(r,m,W))}return m},E=function(N,g,$){if(g){var G,s,C,p={x:g.x,y:g.y,width:g.width,height:g.height},T=b(N),j=x(N,"layoutH"),c=x(N,"layoutV"),Y=1,F=1,X=0,J=0,i=1,h=1;switch(j){case"left":break;case"right":p.x+=$.width-$.rw;break;case"center":p.x+=.5*($.width-$.rw);break;case"scale":case"leftright":default:G=x(N,Cq)||0,G&&(X=Math.abs(J=Math.sin(G)),i=Math.abs(h=Math.cos(G))),"leftright"!==j?(Y+=i*($.widthScale-1),F+=X*($.widthScale-1)):(Y+=p.width?i*($.width-$.rw)/p.width:0,F+=p.height?X*($.width-$.rw)/p.height:0,s=-Math.min(-T.x*h+T.y*J,-T.x*h-(1-T.y)*J,(1-T.x)*h+T.y*J,(1-T.x)*h-(1-T.y)*J))}switch(c){case"top":break;case"bottom":p.y+=$.height-$.rh;break;case"center":p.y+=.5*($.height-$.rh);break;case"scale":case"topbottom":default:G==y&&(G=x(N,Cq),G&&(X=Math.abs(J=Math.sin(G)),i=Math.abs(h=Math.cos(G)))),"topbottom"!==c?(Y+=X*($.heightScale-1),F+=i*($.heightScale-1)):(Y+=p.width?X*($.height-$.rh)/p.width:0,F+=p.height?i*($.height-$.rh)/p.height:0,C=-Math.min(-T.x*J-T.y*h,-T.x*J+(1-T.y)*h,(1-T.x)*J-T.y*h,(1-T.x)*J+(1-T.y)*h))}return(1!==Y||1!==F)&&("scale"!==j&&j?"leftright"===j&&(p.x+=p.width*(1-Y)*T.x+s*($.width-$.rw)):p.x+=p.x*($.widthScale-1)+T.x*p.width*($.widthScale-Y),"scale"!==c&&c?"topbottom"===c&&(p.y+=p.height*(1-F)*T.y+C*($.height-$.rh)):p.y+=p.y*($.heightScale-1)+T.y*p.height*($.heightScale-F),p.width*=Y,p.height*=F),p.width<0&&(p.width=0),p.height<0&&(p.height=0),p}},I=function(N){return $l(N)?new wk(N):N},S=function(X,C,e,b,o,Y,U){var V=T.interactiveInfo,g=X.transform;if(g)return T.save(),T.setTransform(g.a,g.b,g.c,g.d,g.tx,g.ty),V&&V.compInfos.push({comp:X,rect:C,matrix:g.clone()}),!0;o===d&&(o=1),Y===d&&(Y=1);var S=x(X,"clipPercentage"),K=be(e,C);if(K&&!b&&1===o&&1===Y&&!(1>S))return V&&V.compInfos.push({comp:X,rect:C,matrix:V.matrix.clone()}),!1;U=U||Qn;var c=C.x+C.width*U.x,r=C.y+C.height*U.y,m=e.x+e.width*U.x,Z=e.y+e.height*U.y,p=e.width?o*(C.width/e.width):1,a=e.height?Y*(C.height/e.height):1;if(T.save(),V&&(V.matrix.appendTranslate(c,r).appendRotate(b).appendScale(p,a).appendTranslate(-m,-Z),V.compInfos.push({comp:X,rect:C,matrix:V.matrix.clone()})),Gj(T,c,r),mn(T,b||0),ci(T,p,a),Gj(T,-m,-Z),1>S){0>S&&(S=0);var v=Qd(e,x(X,"clipDirection"),S);T.beginPath(),T.rect(v.x,v.y,v.width,v.height),T.clip()}return!0},A=function(){T.restore()},c=function(f,U,$){var c=x(f,"path"),r=x(f,Cq),d=x(f,"scaleX"),e=x(f,"scaleY"),v=b(f),n=y,s=Dl(null,c);if($||($=f.unionRect,$||($=wm(s),f.path.func||(f.unionRect=$)),n=$),$){n||(n=f.unionRect,n||(n=wm(s),f.path.func||(f.unionRect=n)));var G=S(f,$,n,r,d,e,v),X=x(f,"borderPattern"),Y=Tc(T,X),O=u(f,"background"),t=u(f,"borderColor"),p=x(f,"borderWidth"),q=x(f,"gradient"),H=u(f,"gradientColor"),i=x(f,"border3d"),C=x(f,"border3dColor"),P=x(f,"border3dAccuracy"),B=T.lineJoin,F=T.lineCap;if(T.lineJoin=x(f,"borderJoin")||Qr,T.lineCap=x(f,"borderCap")||zg,O?(hk(T,O,q,H,n),Dl(T,c),T.fill(),Y!==T&&Dl(T,c)):Dl(T,c),p&&t){var E=x(f,"borderWidthAbsolute");E&&(T.save(),T.setTransform(1,0,0,1,0,0)),T.lineWidth=p,T.strokeStyle=t,T.stroke(),E&&T.restore(),i&&Vc(T,t,C,p,R,P)}if($o(T,X),x(f,"dash")){var Z=x(f,"dashWidth")||p;if(Z>0){X=x(f,"dashPattern")||Bn;var Y=Tc(T,X,x(f,"dashOffset")),W=u(f,"dashColor")||u(Ro);Y!==T&&Dl(T,c),T.strokeStyle=W,T.lineWidth=Z,T.stroke(),x(f,"dash3d")&&Vc(T,W,u(f,"dash3dColor"),Z,R,x(f,"dash3dAccuracy")),$o(T,X)}}U===Cg&&gn(T,O,x(f,"depth"),n),T.lineJoin=B,T.lineCap=F,G&&A()}},W=function(l,e,N,g){var B=x(l,ph,i),v=x(l,Cq),W=b(l);if(B&&g.fitSize){var f=new wk,L=wm(B),D=E(l,L,g),P=L.x+W.x*L.width,M=L.y+W.y*L.height,X=D.x+W.x*D.width,C=D.y+W.y*D.height,s=L.width?D.width/L.width:1,U=L.height?D.height/L.height:1;B.each(function(k){f.add({x:X+(k.x-P)*s,y:C+(k.y-M)*U})}),B=f,l.unionRect=null}var V=x(l,"scaleX"),K=x(l,"scaleY"),d=e===Kg,F=y;if(!N&&d&&(N=l.unionRect,N||(N=wm(B),l.points.func||(l.unionRect=N)),F=N),N){d?F||(F=l.unionRect,F||(F=wm(B),l.points.func||(l.unionRect=F))):F=N;var Y,z,h,q,r=S(l,N,F,v,V,K,W),c=x(l,"borderPattern"),Z=Tc(T,c),J=u(l,"background"),H=qp(x(l,"repeatImage"),j,w),o=x(l,"gradientPack"),G=u(l,"borderColor"),O=x(l,"borderWidth"),m=x(l,"segments",I),t=x(l,"gradient"),p=u(l,"gradientColor"),n=x(l,"border3d"),$=x(l,"border3dColor"),a=x(l,"border3dAccuracy"),_=x(l,"closePath"),Aj=x(l,"fillRule")||"nonzero",uj=T.lineJoin,pe=T.lineCap;if(T.lineJoin=x(l,"borderJoin")||Qr,T.lineCap=x(l,"borderCap")||zg,d)if(J||H||o){var xh=x(l,"fillClipPercentage");if(1>xh){0>xh&&(xh=0);var Ir=Qd(F,x(l,"fillClipDirection"),xh);T.save(),T.beginPath(),T.rect(Ir.x,Ir.y,Ir.width,Ir.height),T.clip()}if(Yc(T,B,m,_),o)mf(T,o);else if(H){var rr=T,gi=j,zc=w;Yn(T,H,j,w,k,Q),T=rr,j=gi,w=zc}else{var rr=T;hk(T,J,t,p,F),T=rr}T.fill(Aj),1>xh&&T.restore(),o&&T.restore(),Z!==T&&Yc(Z,B,m,_)}else Yc(Z,B,m,_);else if("roundRect"===e?Y=x(l,"cornerRadius"):"polygon"===e?Y=x(l,"polygonSide"):"arc"===e&&(Y=x(l,"arcFrom"),z=x(l,"arcTo"),h=x(l,"arcClose"),q=x(l,"arcOval")),J||H||o){var xh=x(l,"fillClipPercentage");if(1>xh){0>xh&&(xh=0);var Ir=Qd(F,x(l,"fillClipDirection"),xh);T.save(),T.beginPath(),T.rect(Ir.x,Ir.y,Ir.width,Ir.height),T.clip()}if(qf(T,e,F,Y,z,h,q),o)mf(T,o);else if(H){var rr=T,gi=j,zc=w;Yn(T,H,j,w,k,Q),T=rr,j=gi,w=zc}else hk(T,J,t,p,F);T.fill(Aj),1>xh&&T.restore(),o&&T.restore(),T!==Z&&qf(Z,e,F,Y,z,h,q)}else qf(Z,e,F,Y,z,h,q);if(O&&G){var _d=x(l,"borderWidthAbsolute");_d&&(T.save(),T.setTransform(1,0,0,1,0,0)),T.lineWidth=O,T.strokeStyle=G,T.stroke(),_d&&T.restore(),n&&Vc(T,G,$,O,R,a)}if($o(T,c),x(l,"dash")){var nd=x(l,"dashWidth")||O;if(nd>0){c=x(l,"dashPattern")||Bn;var Z=Tc(T,c,x(l,"dashOffset")),Ye=u(l,"dashColor")||u(Ro);Z!==T&&(d?Yc(Z,B,m,_):qf(Z,e,F,Y,z,h,q)),T.strokeStyle=Ye,T.lineWidth=nd,T.stroke(),x(l,"dash3d")&&Vc(T,Ye,u(l,"dash3dColor"),nd,R,x(l,"dash3dAccuracy")),$o(T,c)}}e===Cg&&gn(T,J,x(l,"depth"),F),T.lineJoin=uj,T.lineCap=pe,r&&A()}},O=function(C,l){var G=j,d=w,z=j||x(C,js),E=w||x(C,"blendMode"),u=qp(x(C,"name"),z,E);if(u){var J=x(C,"stretch");if(u.cacheRule!=y){var U=T;u=Qm(T,u,J,l.width,l.height,k,Q,z),T=U}bp(T,u,J,l.x,l.y,l.width,l.height,k,Q,z,null,E),j=G,w=d}},n=function(e,I){var D=x(e,"text");D!=y&&Ek(T,D,x(e,"font"),u(e,js),I.x,I.y,I.width,I.height,x(e,"align"),x(e,"vAlign"))},g=function(U,G){yp(T,u(U,js),G.x,G.y,G.width,G.height,x(U,"width"))},H=function(H,i){var j=x(H,ce),E=0;if(j&&(j.forEach(function(S){E+=S}),E>0)){for(var K=x(H,"colors")||ob,_=x(H,"startAngle")||0,L=x(H,"hollow"),N=x(H,Rh),o=x(H,Wj),C=x(H,Nq),c=N?new wk:y,Q=i.x,r=i.y,J=i.width,g=i.height,d=Q+J/2,F=r+g/2,P=Y(J,g)/2,Z=0,B=0;B<j.length;B++){var q=j[B],p=t*q/E,s=_+p;if(T.fillStyle=K[Z++],Z===K.length&&(Z=0),T.beginPath(),L){var O=d+G(_)*P/2,I=F+f(_)*P/2,u=d+G(s)*P,l=F+f(s)*P;T.moveTo(O,I),T.arc(d,F,P/2,_,s,!1),T.lineTo(u,l),T.arc(d,F,P,s,_,!0)}else T.moveTo(d,F),T.arc(d,F,P,s,_,!0);c&&(p=(_+s)/2,c.add({text:Lc(N)?N(q,B,E,k):q,x:d+.75*G(p)*P,y:F+.75*f(p)*P})),T.closePath(),T.fill(),_=s}c&&c.each(function(n){Ek(T,n.text,o,C,n.x,n.y,0,0,qd)})}},D=function(F,G){var L=x(F,Ak);if(L&&L.length>0){var p=L.length,c=x(F,Rh),_=x(F,Wj),Y=x(F,Nq),t=c?new wk:y,g=x(F,"minValue")||0,U=x(F,"maxValue");if(U==y&&(U=0,L.forEach(function(w){x(w,ce).forEach(function(G){U=m(U,G)})})),g===U)return;for(var C=G.height/(U-g),J=G.y+U*C,D=x(L[0],ce).length,P=G.width/(3*D+1),r=2*P/p,A=0,f=0;p>f;f++)for(var Z=L[f],n=x(Z,js),s=x(Z,"colors"),w=x(Z,ce),W=0;D>W;W++){s?T.fillStyle=s[W]:n?T.fillStyle=n:(T.fillStyle=ob[A++],A===ob.length&&(A=0));var a=w[W],E=a*C,B=G.x+(1+3*W)*P+f*r;if(Gf(T,B,J-E,r,E),t){var S=Lc(c)?c(a,W,Z,k):a,Q=iq(_,S).height;t.add({x:B,y:J-E-Q,width:r,height:Q,text:S})}}t&&t.each(function(Q){Ek(T,Q.text,_,Y,Q.x,Q.y,Q.width,Q.height,qd)})}},r=function(Z,L){var F=x(Z,Ak);if(F&&F.length>0){var W=F.length,Y=x(F[0],ce).length,w=L.width/(3*Y+1),g=0,h=x(Z,"maxValue"),U=x(Z,Rh),i=x(Z,Wj),J=x(Z,Nq),O=U?new wk:y;if(h==y){h=0;for(var A=0;Y>A;A++){for(var p=0,f=0;W>f;f++)p+=x(F[f],ce)[A];h=m(h,p)}}if(h>0){for(var A=0;Y>A;A++)for(var X=L.y+L.height,f=0;W>f;f++){var s=F[f],I=x(s,js),z=x(s,ce)[A],V=z/h*L.height;I?T.fillStyle=I:(T.fillStyle=ob[g++],g===ob.length&&(g=0)),X-=V;var C={x:L.x+(1+3*A)*w,y:X,width:2*w,height:V};Gf(T,C.x,C.y,C.width,C.height),O&&(C.text=Lc(U)?U(z,A,s,k):z,O.add(C))}O&&O.each(function(p){Ek(T,p.text,i,J,p.x,p.y,p.width,p.height,qd)})}}},z=function(c,n){var w=x(c,Ak);if(w&&w.length>0){for(var N=w.length,v=x(w[0],ce).length,V=n.width/(3*v+1),R=0,P=x(c,Rh),O=x(c,Wj),i=x(c,Nq),r=P?new wk:y,m=0;v>m;m++){for(var Z=0,b=0;N>b;b++)Z+=x(w[b],ce)[m];if(Z>0){var u=n.y+n.height;for(b=0;N>b;b++){var j=w[b],Y=x(j,js),H=x(j,ce)[m],K=H/Z*n.height;Y?T.fillStyle=Y:(T.fillStyle=ob[R++],R===ob.length&&(R=0)),u-=K;var A={x:n.x+(1+3*m)*V,y:u,width:2*V,height:K};Gf(T,A.x,A.y,A.width,A.height),r&&(A.text=Lc(P)?P(H,m,j,k):H,r.add(A))}}}r&&r.each(function(H){Ek(T,H.text,O,i,H.x,H.y,H.width,H.height,qd)})}},o=function(Z,f){var i=x(Z,Ak);if(i&&i.length>0){var _=i.length,J=x(Z,"minValue")||0,u=x(Z,"maxValue");if(u==y&&(u=0,i.forEach(function(P){x(P,ce).forEach(function(d){u=m(u,d)})})),J===u)return;for(var I=f.height/(u-J),E=f.y+u*I,h=x(i[0],ce).length,s=f.width/(3*h+1),N=0,Q=x(Z,"lineWidth")||2,U=x(Z,"line3d"),D=x(Z,"linePoint"),v=x(Z,Rh),q=x(Z,Wj),G=x(Z,Nq),M=0;_>M;M++){var o=i[M],H=x(o,js),n=x(o,ce);H?T.strokeStyle=H:(H=T.strokeStyle=ob[N++],N===ob.length&&(N=0)),T.beginPath();for(var X=0;h>X;X++){var c=f.x+(2+3*X)*s,b=E-n[X]*I;0===X?T.moveTo(c,b):T.lineTo(c,b)}if(T.lineWidth=Q,T.stroke(),U&&Vc(T,H,y,Q,R),D||v){var C,P=Q/2+2;for(X=0;h>X;X++){var p=n[X];if(c=f.x+(2+3*X)*s,b=E-p*I,Lc(D)?D(T,c,b,H,X,o,k):D&&(T.fillStyle=H,T.beginPath(),T.arc(c,b,P,0,t,!0),T.fill()),Lc(v)?C=v(p,X,o,k):v&&(C=p),C){var A=iq(q,C).height,g=T.shadowBlur;if(g){var L=T.shadowOffsetX,l=T.shadowOffsetY,w=T.shadowColor;T.shadowOffsetX=0,T.shadowOffsetY=0,T.shadowBlur=0,T.shadowColor=y}Ek(T,C,q,G,c,b-A-P+2,0,A,qd),g&&(T.shadowOffsetX=L,T.shadowOffsetY=l,T.shadowBlur=g,T.shadowColor=w)}}}}}},v=function(){T=null,k=null,Q=null},X={border:g,image:O,text:n,pieChart:H,columnChart:D,stackedColumnChart:r,percentageColumnChart:z,lineChart:o};return function(t,V,L,h,e,$,m,K,D,J){if(V&&e&&$){var H=T?!1:!0;T=t,k=m,Q=K,R=Q?Q._zoom?Q._zoom:1:1,j=D,w=J;var B=e,C=$;if(pr()){var l,Z,o;0===T[Sr]?pr[0]&&(l=!0):l=!0,T.texureImage2D?pr[1]&&(Z=!0):Z=!0,T.texureImage3D?pr[2]&&(o=!0):o=!0,l&&Z&&o&&(B=L,C=h)}if(V.tagName)return Hc(s)&&!U[s]||T.drawImage(V,B,C,e,$),H&&v(),void 0;if(x(V,"visible")===!1)return H&&v(),void 0;j||(j=$f(V.color,k,Q)),J||(w=$f(V.blendMode,k,Q)),Hc(s)&&!U[s]&&(e=B,$=C);var G=$m(V,k,Q,e),n=Lq(V,k,Q,$),Y={x:0,y:0,width:G,height:n,fitSize:x(V,"fitSize")},q=x(V,"clip"),g=x(V,"opacity");if(Y.fitSize){var r=Y.rw=$f(V.width,k,Q)||20;Y.widthScale=G/r;var P=Y.rh=$f(V.height,k,Q)||20;Y.heightScale=n/P}if(T.save(),T.interactiveInfo){var O=T.interactiveInfo.matrix,a=O.clone();O.appendTranslate(B,C).appendScale(e/G,$/n)}Gj(T,B,C),(G!==e||n!==$)&&T.scale(e/G,$/n),q&&(Lc(q)?q(T,G,n,k,Q,V):(T.beginPath(),T.rect(0,0,G,n),T.clip())),g!=y&&(T.globalAlpha*=g),x(V,"comps").forEach(function(q){if(x(q,nc)!==!1){if(ye.splice(0,0,q),T.interactiveInfo)var J=T.interactiveInfo.matrix.clone();var L=x(q,"opacity"),B=x(q,"shadow"),e=x(q,"type"),w=F(q,Y);if(L!=y){var j=T.globalAlpha;T.globalAlpha*=L}if(B){var $=T.shadowOffsetX,H=T.shadowOffsetY,g=T.shadowBlur,v=T.shadowColor,n=x(q,"shadowOffsetX"),m=x(q,"shadowOffsetY"),G=x(q,"shadowBlur"),t=u(q,"shadowColor");T.shadowOffsetX=(n==y?3:n)*R,T.shadowOffsetY=(m==y?3:m)*R,T.shadowBlur=(G==y?6:G)*R,T.shadowColor=t||u(Fb)}if("save"===e)T.save();else if("endClip"===e||"restore"===e)T.restore();else if("clip"===e)T.save(),Yc(T,x(q,"points",i),x(q,"segments",I),!0),T.clip();else if(sf[e])w=w||{x:0,y:0,width:Y.width,height:Y.height},W(q,e,w,Y);else if(e===Kg)W(q,e,w,Y);else if("SVGPath"===e)c(q,e,w);else{w=w||{x:0,y:0,width:Y.width,height:Y.height};var f=x(q,Cq),r=x(q,"scaleX"),h=x(q,"scaleY"),a=b(q),V=S(q,w,w,f,r,h,a);if(Lc(e))p(q,e),N.drawCompType(e,T,w,q,k,Q);else if(N.getCompType(e)){var D=N.getCompType(e),U=D.func||D;p(q,D),N.drawCompType(U,T,w,q,k,Q)}else X[e]?X[e](q,w):N.getCompType(e)===d&&dl.test(e)&&uh(e);V&&A()}B&&(T.shadowOffsetX=$,T.shadowOffsetY=H,T.shadowBlur=g,T.shadowColor=v),L!=y&&(T.globalAlpha=j),T.interactiveInfo&&(T.interactiveInfo.matrix=J),ye.splice(0,1)}}),T.interactiveInfo&&(T.interactiveInfo.matrix=a),T.restore(),H&&v()}}}();N.getCurrentComp=function(){return ye[0]},N.getParentComp=function(){return ye[1]},N.getInternal=function(){return{isEnter:Of,isEsc:Fd,isSpace:gb,isLeft:Oc,isUp:kr,isRight:pe,isDown:bq,addMethod:Zc,superCall:hg,toPointsArray:Or,translateAndScale:ls,appendArray:Rj,createWorldMatrix:Xf,vec3TransformMat4:Vb,setCanvas:$b,createDiv:Mg,createView:jj,createCanvas:ff,createImage:fk,initContext:Hl,layout:Ce,fillRect:Gf,Mat:Rc,drawBorder:yp,isString:Hc,setBorder:tm,getPropertyValue:yl,setPropertyValue:On,drawVerticalLine:jg,draw3DRect:gn,getPinchDist:_d,isSameRect:be,getPosition:Yi,intersectionLineRect:Pc,getNodeRect:eo,getEdgeAgentPosition:Bd,getImageWidth:$m,getImageHeight:Lq,initItemElement:od,drawPoints:Yc,createG2:Tc,closePopup:cf,isH:er,createAnim:yk,createNormalMatrix:$j,createNormals:ti,toFloatArray:Vm,glMV:Ug,batchShape:Rk,createNodeMatrix:Wr,getFaceInfo:gc,transformAppend:Pb,drawFaceInfo:uj,to3dPointsArray:mm,setGLDebugMode:function(c){vk=c},cube:function(){return{vs:Jd,is:Md,uv:dq}},ui:function(){return{DataUI:Cc,NodeUI:nj,EdgeUI:Oi,GroupUI:Sg,ShapeUI:jo,GridUI:yn,Data3dUI:Wp,Node3dUI:tn,Shape3dUI:Zm}},getInternalVersion:function(){return"U2FsdGVkX1/83odQTXLEz/4jamLGVOgl5sN9gdBAJWw="},getDragger:function(){return Tk},addMSMap:function(W){Zc(Ae,W)},k:K}},function(v){function e(W,t){W!=y&&(t==y&&Bb!=typeof W?this._54O(W,256):this._54O(W,t))}function I(){return new e(y)}function _(r,t,y,u,Y,g){for(;--g>=0;){var L=t*this[r++]+y[u]+Y;Y=C(L/67108864),y[u++]=67108863&L}return Y}function k(e,H,b,o,s,q){for(var u=32767&H,N=H>>15;--q>=0;){var w=32767&this[e],r=this[e++]>>15,X=N*w+r*u;w=u*w+((32767&X)<<15)+b[o]+(1073741823&s),s=(w>>>30)+(X>>>15)+N*r+(s>>>30),b[o++]=1073741823&w}return s}function x(N,h,H,m,q,e){for(var b=16383&h,S=h>>14;--e>=0;){var P=16383&this[N],r=this[N++]>>14,C=S*P+r*b;P=b*P+((16383&C)<<14)+H[m]+q,q=(P>>28)+(C>>14)+S*r,H[m++]=268435455&P}return q}function Z(o){return vl.charAt(o)}function n(R,H){var j=yc[R.charCodeAt(H)];return j==y?-1:j}function Q(o){for(var m=this.t-1;m>=0;--m)o[m]=this[m];o.t=this.t,o.s=this.s}function h(e){this.t=1,this.s=0>e?-1:0,e>0?this[0]=e:-1>e?this[0]=e+this.DV:this.t=0}function O(q){var V=I();return V._58O(q),V}function z(m,i){var r,v=this;if(16==i)r=4;else if(8==i)r=3;else if(256==i)r=8;else if(2==i)r=1;
else if(32==i)r=5;else{if(4!=i)return v.fromRadix(m,i),void 0;r=2}v.t=0,v.s=0;for(var c=m.length,z=!1,h=0;--c>=0;){var N=8==r?255&m[c]:n(m,c);0>N?"-"==m.charAt(c)&&(z=!0):(z=!1,0==h?v[v.t++]=N:h+r>v.DB?(v[v.t-1]|=(N&(1<<v.DB-h)-1)<<h,v[v.t++]=N>>v.DB-h):v[v.t-1]|=N<<h,h+=r,h>=v.DB&&(h-=v.DB))}8==r&&0!=(128&m[0])&&(v.s=-1,h>0&&(v[v.t-1]|=(1<<v.DB-h)-1<<h)),v._57O(),z&&e.ZERO._78O(v,v)}function T(){for(var O=this,T=O.s&O.DM;O.t>0&&O[O.t-1]==T;)--O.t}function u(J){var Q=this;if(Q.s<0)return"-"+Q._85O()[to](J);var Y;if(16==J)Y=4;else if(8==J)Y=3;else if(2==J)Y=1;else if(32==J)Y=5;else{if(4!=J)return Q.toRadix(J);Y=2}var c,v=(1<<Y)-1,X=!1,p="",o=Q.t,k=Q.DB-o*Q.DB%Y;if(o-->0)for(k<Q.DB&&(c=Q[o]>>k)>0&&(X=!0,p=Z(c));o>=0;)Y>k?(c=(Q[o]&(1<<k)-1)<<Y-k,c|=Q[--o]>>(k+=Q.DB-Y)):(c=Q[o]>>(k-=Y)&v,0>=k&&(k+=Q.DB,--o)),c>0&&(X=!0),X&&(p+=Z(c));return X?p:"0"}function p(){var j=I();return e.ZERO._78O(this,j),j}function U(){return this.s<0?this._85O():this}function c(A){var C=this,I=C.s-A.s;if(0!=I)return I;var B=C.t;if(I=B-A.t,0!=I)return C.s<0?-I:I;for(;--B>=0;)if(0!=(I=C[B]-A[B]))return I;return 0}function B(P){var _,y=1;return 0!=(_=P>>>16)&&(P=_,y+=16),0!=(_=P>>8)&&(P=_,y+=8),0!=(_=P>>4)&&(P=_,y+=4),0!=(_=P>>2)&&(P=_,y+=2),0!=(_=P>>1)&&(P=_,y+=1),y}function r(){var F=this;return F.t<=0?0:F.DB*(F.t-1)+B(F[F.t-1]^F.s&F.DM)}function w(g,J){var Z;for(Z=this.t-1;Z>=0;--Z)J[Z+g]=this[Z];for(Z=g-1;Z>=0;--Z)J[Z]=0;J.t=this.t+g,J.s=this.s}function o(b,K){for(var S=b;S<this.t;++S)K[S-b]=this[S];K.t=m(this.t-b,0),K.s=this.s}function V(m,u){var S,e=this,o=m%e.DB,E=e.DB-o,N=(1<<E)-1,$=C(m/e.DB),i=e.s<<o&e.DM;for(S=e.t-1;S>=0;--S)u[S+$+1]=e[S]>>E|i,i=(e[S]&N)<<o;for(S=$-1;S>=0;--S)u[S]=0;u[$]=i,u.t=e.t+$+1,u.s=e.s,u._57O()}function l(z,H){var O=this;H.s=O.s;var T=C(z/O.DB);if(T>=O.t)return H.t=0,void 0;var c=z%O.DB,h=O.DB-c,t=(1<<c)-1;H[0]=O[T]>>c;for(var k=T+1;k<O.t;++k)H[k-T-1]|=(O[k]&t)<<h,H[k-T]=O[k]>>c;c>0&&(H[O.t-T-1]|=(O.s&t)<<h),H.t=O.t-T,H._57O()}function s(h,j){for(var r=this,m=0,T=0,n=Y(h.t,r.t);n>m;)T+=r[m]-h[m],j[m++]=T&r.DM,T>>=r.DB;if(h.t<r.t){for(T-=h.s;m<r.t;)T+=r[m],j[m++]=T&r.DM,T>>=r.DB;T+=r.s}else{for(T+=r.s;m<h.t;)T-=h[m],j[m++]=T&r.DM,T>>=r.DB;T-=h.s}j.s=0>T?-1:0,-1>T?j[m++]=r.DV+T:T>0&&(j[m++]=T),j.t=m,j._57O()}function g(c,p){var q=this.abs(),i=c.abs(),b=q.t;for(p.t=b+i.t;--b>=0;)p[b]=0;for(b=0;b<i.t;++b)p[b+q.t]=q.am(0,i[b],p,b,0,q.t);p.s=0,p._57O(),this.s!=c.s&&e.ZERO._78O(p,p)}function P(G){for(var x=this.abs(),r=G.t=2*x.t;--r>=0;)G[r]=0;for(r=0;r<x.t-1;++r){var k=x.am(r,x[r],G,2*r,0,1);(G[r+x.t]+=x.am(r+1,2*x[r],G,2*r+1,k,x.t-r-1))>=x.DV&&(G[r+x.t]-=x.DV,G[r+x.t+1]=1)}G.t>0&&(G[G.t-1]+=x.am(r,x[r],G,2*r,0,1)),G.s=0,G._57O()}function J(t,K,P){var v=t.abs(),E=this;if(!(v.t<=0)){var k=E.abs();if(k.t<v.t)return K!=y&&K._58O(0),P!=y&&E._77O(P),void 0;P==y&&(P=I());var Q=I(),m=E.s,a=t.s,n=E.DB-B(v[v.t-1]);n>0?(v._44O(n,Q),k._44O(n,P)):(v._77O(Q),k._77O(P));var L=Q.t,i=Q[L-1];if(0!=i){var j=i*(1<<E.F1)+(L>1?Q[L-2]>>E.F2:0),f=E.FV/j,u=(1<<E.F1)/j,O=1<<E.F2,X=P.t,J=X-L,Z=K==y?I():K;for(Q._59O(J,Z),P._52O(Z)>=0&&(P[P.t++]=1,P._78O(Z,P)),e.ONE._59O(L,Z),Z._78O(Q,Q);Q.t<L;)Q[Q.t++]=0;for(;--J>=0;){var p=P[--X]==i?E.DM:C(P[X]*f+(P[X-1]+O)*u);if((P[X]+=Q.am(0,p,P,J,0,L))<p)for(Q._59O(J,Z),P._78O(Z,P);P[X]<--p;)P._78O(Z,P)}K!=y&&(P._45O(L,K),m!=a&&e.ZERO._78O(K,K)),P.t=L,P._57O(),n>0&&P._46O(n,P),0>m&&e.ZERO._78O(P,P)}}}function H(G){var j=I();return this.abs()._49O(G,y,j),this.s<0&&j._52O(e.ZERO)>0&&G._78O(j,j),j}function q(i){this.m=i}function d(k){return k.s<0||k._52O(this.m)>=0?k.mod(this.m):k}function a(k){return k}function A(V){V._49O(this.m,y,V)}function F(l,B,I){l._47O(B,I),this._74O(I)}function M(w,Y){w._48O(Y),this._74O(Y)}function L(){if(this.t<1)return 0;var o=this[0];if(0==(1&o))return 0;var K=3&o;return K=15&K*(2-(15&o)*K),K=255&K*(2-(255&o)*K),K=65535&K*(2-(65535&(65535&o)*K)),K=K*(2-o*K%this.DV)%this.DV,K>0?this.DV-K:-K}function b($){var C=this;C.m=$,C.mp=$._50O(),C.mpl=32767&C.mp,C.mph=C.mp>>15,C.um=(1<<$.DB-15)-1,C.mt2=2*$.t}function N(D){var z=I();return D.abs()._59O(this.m.t,z),z._49O(this.m,y,z),D.s<0&&z._52O(e.ZERO)>0&&this.m._78O(z,z),z}function X(d){var N=I();return d._77O(N),this._74O(N),N}function E(B){for(var z=this;B.t<=z.mt2;)B[B.t++]=0;for(var e=0;e<z.m.t;++e){var T=32767&B[e],n=T*z.mpl+((T*z.mph+(B[e]>>15)*z.mpl&z.um)<<15)&B.DM;for(T=e+z.m.t,B[T]+=z.m.am(0,n,B,e,0,z.m.t);B[T]>=B.DV;)B[T]-=B.DV,B[++T]++}B._57O(),B._45O(z.m.t,B),B._52O(z.m)>=0&&B._78O(z.m,B)}function tl(k,X){k._48O(X),this._74O(X)}function Dk(O,t,u){O._47O(t,u),this._74O(u)}function $j(){return 0==(this.t>0?1&this[0]:this.s)}function Nb(J,A){if(J>4294967295||1>J)return e.ONE;var o=I(),z=I(),Y=A._73O(this),K=B(J)-1;for(Y._77O(o);--K>=0;)if(A._76O(o,z),(J&1<<K)>0)A._75O(z,Y,o);else{var l=o;o=z,z=l}return A.revert(o)}function bd(g,l){var G;return G=256>g||l._51O()?new q(l):new b(l),this.exp(g,G)}function fq(){var W=this;if(W.s<0){if(1==W.t)return W[0]-W.DV;if(0==W.t)return-1}else{if(1==W.t)return W[0];if(0==W.t)return 0}return(W[1]&(1<<32-W.DB)-1)<<W.DB|W[0]}function ao(b,L){return new e(b,L)}function Rq(){var e=this;e.n=y,e.e=0,e.d=y,e.p=y,e.q=y,e.dmp1=y,e.dmq1=y,e._10A=y}function xo(C){return C._53O(this.e,this.n)}function ob(v){var L,z,F,m="",T=0;for(L=0;L<v.length&&v.charAt(L)!=Hl;++L)F=Uf.indexOf(v.charAt(L)),0>F||(0==T?(m+=Z(F>>2),z=3&F,T=1):1==T?(m+=Z(z<<2|F>>4),z=15&F,T=2):2==T?(m+=Z(z),m+=Z(F>>2),z=3&F,T=3):(m+=Z(z<<2|F>>4),m+=Z(15&F),T=0));return 1==T&&(m+=Z(z<<2)),m}function uf($){var z=$.split(""),h=ob($);return z.forEach(function(N){var r=N.length;r>0&&h&&(hc+=S(N))}),h}function Th(j,t){var d=Ho._4O.Util._56O(j,"ss"),D={},o=0;return D.v=d==t,D.t=1,D.s=0>o?-1:0,Wl=D.v,o>0?D[0]=o:-1>o?D[0]=o+D.DV:D.t=0,[d,D]}function $p(Z){var n=38,T=Z.substring(0,n);if(T&&30==T.indexOf("05000420")){var M=["ss",Z.substring(n)];return M}return[]}function wd(d,h){h=h.replace(Pj,""),h=h.replace(/[ \n]+/g,"");var m=ao(h,16);if(m._55O()>this.n._55O())return 0;var H=this._37O(m),s=H[to](16).replace(/^1f+00/,""),e=$p(s);if(0==e.length)return!1;for(var A,X,I,$=.5,u=We,z=[0,.5,.75,.875,.9375],x=[],l=[],J=[],B=t/u,V=e[1],r=Th(d,V)[0],Q=0,q=0;Q<z.length;Q++){var K=0===Q%2?0:.5;for(A=0;u>=A;A++)X=(A+K)*B,I=1-z[Q],x.push(G(X)*$*I,-$+2*z[Q]*$,-f(X)*$*I),l.push((A+K)/u,I)}for(Q=0;Q<z.length-1;Q++){var P=Q*(u+1),C=(Q+1)*(u+1);for(A=0;u>A;A++)J.push(P+A,C+A+1,C+A,P+A,P+A+1,C+A+1)}return J.forEach(function(f){q+=f}),V==r&&q>10}var te,Ie=0xdeadbeefcafe,Yq=15715070==(16777215&Ie),to="toString",tp="",yq="nat",qo=function(){};R=v["D"+11182[to](j(2,5))];var On=e.prototype;ej+=Hq.substr(0,1);var jm=v.navigator?v.navigator.appName:"";Yq&&"Microsoft Internet Explorer"==jm?(On.am=k,te=30):Yq&&"Netscape"!=jm?(On.am=_,te=26):(On.am=x,te=28),On.DB=te,On.DM=(1<<te)-1,On.DV=1<<te;var xh=52;On.FV=j(2,xh),On.F1=xh-te,On.F2=2*te-xh;var kh,Dd,vl="0123456789abcdefghijklmnopqrstuvwxyz",yc=[],pl=function(p){return String.fromCharCode(p)};for(kh="0".charCodeAt(0),Dd=0;9>=Dd;++Dd)yc[kh++]=Dd;for(kh="a".charCodeAt(0),Dd=10;36>Dd;++Dd)yc[kh++]=Dd;for(kh="A".charCodeAt(0),Dd=10;36>Dd;++Dd)yc[kh++]=Dd;var Zi=q.prototype;Zi._73O=d,Zi.revert=a,Zi._74O=A,Zi._75O=F,Zi._76O=M;var co=b.prototype;co._73O=N,co.revert=X,co._74O=E,co._75O=Dk,co._76O=tl,On._77O=Q,On._58O=h,On._54O=z,On._57O=T,On._59O=w,On._45O=o,On._44O=V,On._46O=l,On._78O=s,On._47O=g,On._48O=P,On._49O=J,On._50O=L,On._51O=$j,On.exp=Nb,On.toString=u,On._85O=p,On.abs=U,On._52O=c,On._55O=r,On.mod=H,On._53O=bd,e.ZERO=O(0),e.ONE=O(1),On._86O=fq;var pc=function(T,p){var E=this;E.isPublic=!0,typeof T!==Bb?(E.n=T,E.e=p):T!=y&&p!=y&&T.length>0&&p.length>0&&(E.n=ao(T,16),E.e=S(p,16))};Xr=function(){var w,l,B=uf(wj),W=B.substr(0,4),g=B.substr(4,2),t=B.substr(6,2),m=1,j=!m,L=K,D=[],o=mk.charAt(7);if(R&&(R[to]().indexOf(yq)<0||R[ej][to]().indexOf(yq)<0||!B?w=Vk(jh[o]):(B=new R(W-0,g-m,t-0),l=B.setHours(9),R[ej]()>l?w=Vk(jh[o]):j=!0)),B&&w&&L){for(var b in w)D.push(b);var G,u=0,F=w[D[u++]],d=w[D[u++]],V=w[D[u++]],i=w[D[u++]],M=w[D[u++]],n=w[D[u++]],k=w[D[u++]],S=eh._27O(L);if(S&&k){G=F+d+V+i+M+n;var f=!n||n===ll;if(!f&&n)for(var e,c=0,Q=n.length;Q>c;c++)n[c]===Tn[u]?e===ll?f=!0:e=y:(e==y?e=n[c]:e+=n[c],c===Q-1&&e===ll&&(f=!0));G&&S._31O(G,k)&&f&&(!M||R[ej]()<M)&&(j=!0)}}return j||(qf=Aj),o};var Mg=Rq.prototype;Mg._37O=xo,Mg._38O=pc;var Uf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Hl="=",wb=25,yh=10,wj="IBkCJQ==",js=js||function(x,J){var P={},o=P._7A={},F=o._6A=function(){function T(){}return{_80O:function(u){T.prototype=this;var V=new T;return u&&V._5A(u),V.hasOwnProperty("_82O")||(V._82O=function(){V.$super._82O.apply(this,arguments)}),V._82O.prototype=V,V.$super=this,V},_3A:function(){var I=this._80O();return I._82O.apply(I,arguments),I},_82O:function(){},_5A:function(h){for(var r in h)h.hasOwnProperty(r)&&(this[r]=h[r]);h.hasOwnProperty(to)&&(this.toString=h.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),r=o._39O=F._80O({_82O:function(H,N){H=this._84O=H||[],this._65O=N!=J?N:4*H.length},toString:function(q){return(q||D).stringify(this)},_89O:function(z){var K=this._84O,a=z._84O,w=this._65O,i=z._65O;if(this._57O(),w%4)for(var W=0;i>W;W++){var c=255&a[W>>>2]>>>24-8*(W%4);K[w+W>>>2]|=c<<24-8*((w+W)%4)}else if(a.length>65535)for(var W=0;i>W;W+=4)K[w+W>>>2]=a[W>>>2];else K.push.apply(K,a);return this._65O+=i,this},_57O:function(){var P=this._84O,I=this._65O;P[I>>>2]&=4294967295<<32-8*(I%4),P.length=i(I/4)},_88O:function(){var R=F._88O.call(this);return R._84O=this._84O.slice(0),R},_87O:function(Y){for(var k=[],T=0;Y>T;T+=4)k.push(0|4294967296*$);return new r._82O(k,Y)}}),R=P._2A={},D=R._69O={stringify:function(B){var q,t=B._84O,H=B._65O,X=[];for(q=0;H>q;q++){var P=255&t[q>>>2]>>>24-8*(q%4);X.push((P>>>4).toString(16)),X.push((15&P).toString(16))}return X.join("")},_68O:function(v){for(var N=v.length,P=[],W=0;N>W;W+=2)P[W>>>3]|=S(v.substr(W,2),16)<<24-4*(W%8);return new r._82O(P,N/2)}},e=R._8A={stringify:function(f){var $,n=f._84O,L=f._65O,p=[];for($=0;L>$;$++){var N=255&n[$>>>2]>>>24-8*($%4);p.push(pl(N))}return p.join("")},_68O:function(J){var I,P=J.length,i=[];for(I=0;P>I;I++)i[I>>>2]|=(255&J.charCodeAt(I))<<24-8*(I%4);return new r._82O(i,P)}},s=R._9A={stringify:function(Z){try{return decodeURIComponent(escape(e.stringify(Z)))}catch(B){throw new Error("")}},_68O:function(W){return e._68O(unescape(encodeURIComponent(W)))}},A=o._32O=F._80O({_1A:function(){this._83O=new r._82O,this._23O=0},_33O:function(g){typeof g==Bb&&(g=s._68O(g)),this._83O._89O(g),this._23O+=g._65O},_25O:function(k){var g=this._83O,D=g._84O,l=g._65O,S=this._79O,w=4*S,X=l/w;X=k?i(X):m((0|X)-this._22O,0);var F=X*S,L=Y(4*F,l);if(F){for(var V=0;F>V;V+=S)this._20O(D,V);var M=D.splice(0,F);g._65O-=L}return new r._82O(M,L)},_88O:function(){var t=F._88O.call(this);return t._83O=this._83O._88O(),t},_22O:0});o._66O=A._80O({cfg:F._80O(),_82O:function(z){this.cfg=this.cfg._80O(z),this._1A()},_1A:function(){A._1A.call(this),this._34O()},_81O:function(L){return this._33O(L),this._25O(),this},_72O:function(s){s&&this._33O(s);var n=this._21O();return n},_79O:16,_26O:function(r){return function(J,X){return new r._82O(X)._72O(J)}},_19O:function(Y){return function(q,N){return new z._71O._82O(Y,N)._72O(q)}}});var z=P._67O={};return P}();!function(){var x=js,q=x._7A,M=q._39O,V=q._66O,o=x._67O,Z=[],z=[];!function(){function V(i){for(var T=W(i),L=2;T>=L;L++)if(!(i%L))return!1;return!0}function v(g){return 0|4294967296*(g-(0|g))}for(var I=2,t=0;64>t;)V(I)&&(8>t&&(Z[t]=v(j(I,.5))),z[t]=v(j(I,1/3)),t++),I++}();var B=[],y=o._41O=V._80O({_34O:function(){this._64O=new M._82O(Z.slice(0))},_20O:function(t,s){for(var n=this._64O._84O,N=n[0],d=n[1],f=n[2],F=n[3],D=n[4],K=n[5],U=n[6],p=n[7],u=0;64>u;u++){if(16>u)B[u]=0|t[s+u];else{var T=B[u-15],h=(T<<25|T>>>7)^(T<<14|T>>>18)^T>>>3,$=B[u-2],I=($<<15|$>>>17)^($<<13|$>>>19)^$>>>10;B[u]=h+B[u-7]+I+B[u-16]}var q=D&K^~D&U,o=N&d^N&f^d&f,L=(N<<30|N>>>2)^(N<<19|N>>>13)^(N<<10|N>>>22),Q=(D<<26|D>>>6)^(D<<21|D>>>11)^(D<<7|D>>>25),M=p+Q+q+z[u]+B[u],x=L+o;p=U,U=K,K=D,D=0|F+M,F=f,f=d,d=N,N=0|M+x}n[0]=0|n[0]+N,n[1]=0|n[1]+d,n[2]=0|n[2]+f,n[3]=0|n[3]+F,n[4]=0|n[4]+D,n[5]=0|n[5]+K,n[6]=0|n[6]+U,n[7]=0|n[7]+p},_21O:function(){var d=this._83O,P=d._84O,y=8*this._23O,M=8*d._65O;return P[M>>>5]|=128<<24-M%32,P[(M+64>>>9<<4)+14]=C(y/4294967296),P[(M+64>>>9<<4)+15]=y,d._65O=4*P.length,this._25O(),this._64O},_88O:function(){var J=V._88O.call(this);return J._64O=this._64O._88O(),J}});x._41O=V._26O(y),x._42O=V._19O(y)}();var Pj=new RegExp("");Pj.compile("[^0-9a-f]","gi"),Rq._28O=-1,Rq._29O=-2,Mg._31O=wd,Mg._63O=wd,Rq._43O=-2;var Im=new function(){var W=this;W._5O=function(i,g){if("8"!=i.substring(g+2,g+3))return 1;var n=S(i.substring(g+3,g+4));return 0==n?-1:n>0&&10>n?n+1:-2},W._13O=function(U,F){var X=W._5O(U,F);return 1>X?"":U.substring(F+2,F+2+2*X)},W._12O=function(_,i){var A=W._13O(_,i);if(""==A)return-1;var Y;return Y=S(A.substring(0,1))<8?new e(A,16):new e(A.substring(2),16),Y._86O()},W._6O=function(H,T){var E=W._5O(H,T);return 0>E?E:T+2*(E+1)},W._11O=function(d,Y){var a=W._6O(d,Y),V=W._12O(d,Y);return d.substring(a,a+2*V)},W._10O=function(K,r){var x=W._6O(K,r),b=W._12O(K,r);return x+2*b},W._7O=function(I,k){var z=[],i=W._6O(I,k);z.push(i);for(var U=W._12O(I,k),T=i,E=0;;){var h=W._10O(I,T);if(h==y||h-i>=2*U)break;if(E>=200)break;z.push(h),T=h,E++}return z}};if(Im._90O=pl(yh+24),Im._91O=D+pl(yh*yh+8),Ho==y||!Ho)var Ho={};Ho._4O!=y&&Ho._4O||(Ho._4O={});var ln=Ho._4O;Ho._4O.Util=new function(){var i=this;i._56O=function(D){var Q=new Ho._4O._3O;return Q._30O(D)},i._4A=function(x){var k=new Ho._4O._3O;return k._36O(x)},i._11A=function(r){var l=new ln._3O;return l._30O(r)}},Ho._4O._3O=function(){var n=this;n._8O=function(W,q){if("ss"==W&&"cj"==q){try{n.md=js._67O._41O._3A()}catch(c){qo(tp)}n._24O=function(Y){n.md._81O(Y)},n._35O=function(N){var l=js._2A._69O._68O(N);n.md._81O(l)},n._60O=function(){var m=n.md._72O();return m[to](js._2A._69O)},n._30O=function(X){return n._24O(X),n._60O()},n._36O=function(Y){return n._35O(Y),n._60O()}}},n._24O=function(){qo(tp)},n._35O=function(){qo(tp)},n._60O=function(){qo(tp)},n._30O=function(){qo(tp)},n._36O=function(){qo(tp)},n._8O("ss","cj")},zk=function(t){var b=Bm[sd[7]],x=1,Q=!1;if(hm.a!=Bm[$d])return hm.a;if(hm.forEach(function(r){x*=r}),t>x){if(b){b=b.split(Im._90O);var I=b[3],p=b[7],f=b[11],n=b[15],k=b[19],J=b[23],E=b[27],j=I+p+f+n+k+J,v=J?!1:!0;if(J){var K=J&&J.split(Tl("firefox")[3]);if(K)for(var A=0;A<K.length;A++)if(ym.indexOf(K[A])>=0){v=!0;break}}Q=ah()(j,E)&&v&&(!k||k>t)}Q||(Cc.prototype._42=Bp)}else Q=!0;return hm.a=Q,Q},wb=String.fromCharCode(wb+20);var xk=function(w){return w=w.replace(Pj,tp),w=w.replace(/[ \n]+/g,tp)},Ai="30",lf="06",mo="02",xm="03",Kk=ao,zq=/^1f+00/,eh=function(){var F;return F={_18O:function(m){var c=m,D=c.replace(/\s+/g,""),l=ob(D);return l},_14O:function(e){var p=this._18O(e),L=this._15O(p);return L},_15O:function(A){var h=this._17O(A);if("2a864886f70d010101"==h._61O){var g=this._16O(h.key),B=new Rq;return B._38O(g.n,g.e),B}qo(tp)},_16O:function(X){var _={};X.substr(0,2)!=Ai&&qo(tp);var I=Im._7O(X,0);return 2!=I.length&&qo(tp),X.substr(I[0],2)!=mo&&qo(tp),_.n=Im._11O(X,I[0]),X.substr(I[1],2)!=mo&&qo(tp),_.e=Im._11O(X,I[1]),_},_17O:function(H){var v={};v._40O=y;var h=Im._7O(H,0);2!=h.length&&qo(tp);var o=h[0];H.substr(o,2)!=Ai&&qo(tp);var C=Im._7O(H,o);return 2!=C.length&&qo(tp),H.substr(C[0],2)!=lf&&qo(tp),v._61O=Im._11O(H,C[0]),H.substr(C[1],2)==lf?v._40O=Im._11O(H,C[1]):H.substr(C[1],2)==Ai&&(v._40O={},v._40O.p=Im._70O(H,C[1],[0],mo),v._40O.q=Im._70O(H,C[1],[1],mo),v._40O.g=Im._70O(H,C[1],[2],mo)),H.substr(h[1],2)!=xm&&qo(tp),v.key=Im._11O(H,h[1]).substr(2),v}},F._17O?F:y}(),md=eh._27O=function(y){return eh._14O(y)};ah=function(){return function(A,_){if(A&&_){_=xk(_);var R=Kk(_,j(2,4)),p=this;if(!p||!p.n||R._55O()>p.n._55O())return 0;var y=p._37O(R),Z=y[to](j(2,4)).replace(zq,""),b=$p(Z);if(0==b.length)return!1;var B=b[0],m=b[1],h=function(S){return Ho._4O.Util._56O(S,B)},L=h(A);return m==L}}.bind(md(K))};var Gg,ii;return function(){var D=Ve.length-Cr.length;if(D>0)for(var U=0;D>U;U++)Gg=ln.Util,ii=xk}(),Af=function(P,$){$=ii($);var x=md(Pn),m=Tg.length,n=2*m,F=Kk($,j(m,n)),k=x,Q=!0;if(k){var X=k[Pf[0]];X&&F._55O()<=X._55O()&&(Q=!1)}if(Q)return 0;var r=k._37O(F),i=r[to](j(m,n)).replace(zq,""),l=$p(i);if(0==l.length)return!1;var G=l[0],q=l[1],u=Gg._11A(P,G);return q==u},eh}(U,M),Zc(N,{load:function(){var q={},D=function(D){return D?"c_"+(D.sync?"1":"0")+"_"+(D.post?"1":"0")+"_"+(D.responseType||"H")+"_"+(D.mimeType||"H")+"_"+(D.data?JSON.stringify(D.data):"H"):""};return function(E,M,x){var s,$=q[E],k=D(x);return $&&(s=$[k])?(s.push(M),void 0):(q[E]||($=q[E]={count:0}),s=$[k]=[M],$.count++,N.xhrLoad(E,function(t){delete $[k],$.count--,$.count||delete q[E],s.forEach(function(u){u(t)})},x),void 0)}}(),asyncEach:function(X,J,g){"function"!=typeof g&&(g=Function.prototype);var e=new Array(X.length),M=0,p=!1;X.forEach(function(x,O){J(x,function(v,c){return p?void 0:v?(p=!0,g(null)):(e[O]=c,M++,M===X.length?g(e):void 0)})})},xhrLoad:function(z,a,P){var l=!1;$l(z)||(l=!0,z=[z]),P=P||{},z.length;var A=P.sync,Q=!!P.post,$=null;return N.asyncEach(z,function(z,j){var i=new Gh;z=N.beforeLoadURL(z),z.data?j(null,z.data):(P.url=encodeURI(z),P.method=Q?"POST":"GET",P.responseType?i.setResponseType(P.responseType):i.setOverrideMimeType(P.mimeType||"text/plain"),i.onload=function(){200===this.status||0===this.status?j(null,i.getResponseText()):j(!0)},i.onerror=function(){j(!0)},i.send(P))},function(H){var Y="function"==typeof a;(Y||A)&&($=l&&H?H[0]:H,Y&&a($))}),A?$:void 0}}),Math.sign===d&&(Math.sign=function(C){return 0>C?-1:C>0?1:+C}),T.Math={generateUUID:function(){for(var N=[],q=0;256>q;q++)N[q]=(16>q?"0":"")+q.toString(16).toUpperCase();return function(){var K=0|4294967295*Math.random(),S=0|4294967295*Math.random(),G=0|4294967295*Math.random(),q=0|4294967295*Math.random();return N[255&K]+N[255&K>>8]+N[255&K>>16]+N[255&K>>24]+"-"+N[255&S]+N[255&S>>8]+"-"+N[64|15&S>>16]+N[255&S>>24]+"-"+N[128|63&G]+N[255&G>>8]+"-"+N[255&G>>16]+N[255&G>>24]+N[255&q]+N[255&q>>8]+N[255&q>>16]+N[255&q>>24]}}(),clamp:function(q,i,G){return Math.max(i,Math.min(G,q))},generateIncreasingID:function(){var w=0;return function(){return++w}}()};var kd=T.Matrix=T.Math.Matrix2d=function(E,u,n,A,$){this.setFromTransform(E,u,n,A,$)},Rc=kd;kd.prototype={},kd.prototype.constructor=kd,kd.prototype.set=function(l,P,z,Z,q,o){return this.a=l,this.b=P,this.c=z,this.d=Z,this.tx=q,this.ty=o,this},kd.prototype.setFromTransform=function(w,C,h,j,l){var m=this;if(w===d)return m.a=1,m.b=0,m.c=0,m.d=1,m.tx=0,m.ty=0,void 0;w=w||0;var W=f(w),Q=G(w);return j=j||1,l=l||1,m.a=Q*j,m.b=W*j,m.c=-W*l,m.d=Q*l,m.tx=C||0,m.ty=h||0,m},kd.prototype.apply=function(U,R){R=R||new Ie;var e=U.x,K=U.y;return R.x=this.a*e+this.c*K+this.tx,R.y=this.b*e+this.d*K+this.ty,R},kd.prototype.applyInverse=function(q,i){i=i||new Ie;var e=1/(this.a*this.d+this.c*-this.b),b=q.x,S=q.y;return i.x=this.d*e*b+-this.c*e*S+(this.ty*this.c-this.tx*this.d)*e,i.y=this.a*e*S+-this.b*e*b+(-this.ty*this.a+this.tx*this.b)*e,i},kd.prototype.translate=function(g,l){return this.tx+=g,this.ty+=l,this},kd.prototype.scale=function(I,e){return this.a*=I,this.d*=e,this.c*=I,this.b*=e,this.tx*=I,this.ty*=e,this},kd.prototype.rotate=function(x){var V=Math.cos(x),R=Math.sin(x),E=this.a,H=this.c,k=this.tx;return this.a=E*V-this.b*R,this.b=E*R+this.b*V,this.c=H*V-this.d*R,this.d=H*R+this.d*V,this.tx=k*V-this.ty*R,this.ty=k*R+this.ty*V,this},kd.prototype.appendTranslate=function(H,D){return this.tx+=this.a*H+this.c*D,this.ty+=this.b*H+this.d*D,this},kd.prototype.appendScale=function(D,h){return this.a*=D,this.d*=h,this.c*=h,this.b*=D,this},kd.prototype.appendRotate=function(q){if(!q)return this;var z=Math.cos(q),I=Math.sin(q),r=this.a,b=this.b;return this.a=r*z+this.c*I,this.b=b*z+this.d*I,this.c=-r*I+this.c*z,this.d=-b*I+this.d*z,this},kd.prototype.append=function(U){var R=this.a,i=this.b,o=this.c,J=this.d;return this.a=U.a*R+U.b*o,this.b=U.a*i+U.b*J,this.c=U.c*R+U.d*o,this.d=U.c*i+U.d*J,this.tx=U.tx*R+U.ty*o+this.tx,this.ty=U.tx*i+U.ty*J+this.ty,this},kd.prototype.setTransform=function(K,B,f,F,P,o,Q,z,M){var y,w,c,N,W,e,a,Y,k,L;return W=Math.sin(Q),e=Math.cos(Q),a=Math.cos(M),Y=Math.sin(M),k=-Math.sin(z),L=Math.cos(z),y=e*P,w=W*P,c=-W*o,N=e*o,this.a=a*y+Y*c,this.b=a*w+Y*N,this.c=k*y+L*c,this.d=k*w+L*N,this.tx=K+(f*y+F*c),this.ty=B+(f*w+F*N),this},kd.prototype.prepend=function(X){var D=this.tx;if(1!==X.a||0!==X.b||0!==X.c||1!==X.d){var s=this.a,G=this.c;this.a=s*X.a+this.b*X.c,this.b=s*X.b+this.b*X.d,this.c=G*X.a+this.d*X.c,this.d=G*X.b+this.d*X.d}return this.tx=D*X.a+this.ty*X.c+X.tx,this.ty=D*X.b+this.ty*X.d+X.ty,this},kd.prototype.transform=kd.prototype.prepend,kd.prototype.invert=function(){var t=this.a,Y=this.b,i=this.c,f=this.d,z=this.tx,o=t*f-Y*i;return this.a=f/o,this.b=-Y/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-f*z)/o,this.ty=-(t*this.ty-Y*z)/o,this},kd.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},kd.prototype.clone=function(){var o=new kd;return o.a=this.a,o.b=this.b,o.c=this.c,o.d=this.d,o.tx=this.tx,o.ty=this.ty,o},kd.prototype.copy=function(F){return F.a=this.a,F.b=this.b,F.c=this.c,F.d=this.d,F.tx=this.tx,F.ty=this.ty,F},kd.prototype.tf=function(b,Z){1===arguments.length&&(Z=b.y,b=b.x);var c=this;return{x:c.a*b+c.c*Z+c.tx,y:c.b*b+c.d*Z+c.ty}},kd.prototype.tfi=function(G,D){1===arguments.length&&(D=G.y,G=G.x);var B=this,z=1/(B.a*B.d+B.c*-B.b);return{x:B.d*z*G+-B.c*z*D+(B.ty*B.c-B.tx*B.d)*z,y:B.a*z*D+-B.b*z*G+(-B.ty*B.a+B.tx*B.b)*z}},kd.IDENTITY=new kd,kd.TEMP_MATRIX=new kd;var jf=T.Math.Vector3=function(Q,N,h){"object"==typeof Q?this.copy(Q):this.set(Q,N==d?Q:N,h==d?Q:h)};M.assign(jf.prototype,{set:function(T,A,f){return this.x=T,this.y=A,this.z=f,this},setScalar:function(L){return this.x=L,this.y=L,this.z=L,this},setX:function(z){return this.x=z,this},setY:function(R){return this.y=R,this},setZ:function(W){return this.z=W,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return e.x===d?(this.x=e[0],this.y=e[1],this.z=e[2]):(this.x=e.x,this.y=e.y,this.z=e.z),this},add:function(C){return this.x+=C.x,this.y+=C.y,this.z+=C.z,this},addScalar:function(d){return this.x+=d,this.y+=d,this.z+=d,this},addVectors:function(M,A){return this.x=M.x+A.x,this.y=M.y+A.y,this.z=M.z+A.z,this},addScaledVector:function(D,e){return this.x+=D.x*e,this.y+=D.y*e,this.z+=D.z*e,this},sub:function(j){return this.x-=j.x,this.y-=j.y,this.z-=j.z,this},subScalar:function($){return this.x-=$,this.y-=$,this.z-=$,this},subVectors:function(Y,m){return this.x=Y.x-m.x,this.y=Y.y-m.y,this.z=Y.z-m.z,this},multiply:function(L){return this.x*=L.x,this.y*=L.y,this.z*=L.z,this},multiplyScalar:function(d){return this.x*=d,this.y*=d,this.z*=d,this},distanceTo:function(U){return Math.sqrt(this.distanceToSquared(U))},distanceToSquared:function(c){var K=this.x-c.x,s=this.y-c.y,e=this.z-c.z;return K*K+s*s+e*e},distanceToSquared2:function(c){var q=this.x-c[0],k=this.y-c[1],L=this.z-c[2];return q*q+k*k+L*L},multiplyVectors:function(l,r){return this.x=l.x*r.x,this.y=l.y*r.y,this.z=l.z*r.z,this},transformDirection:function(U){var r=this.x,C=this.y,v=this.z,F=U.el;return this.x=F[0]*r+F[4]*C+F[8]*v,this.y=F[1]*r+F[5]*C+F[9]*v,this.z=F[2]*r+F[6]*C+F[10]*v,this.normalize()},applyQuaternion:function(F){var T=this.x,q=this.y,M=this.z,Q=F._x,A=F._y,v=F._z,t=F._w,d=t*T+A*M-v*q,m=t*q+v*T-Q*M,I=t*M+Q*q-A*T,k=-Q*T-A*q-v*M;return this.x=d*t+k*-Q+m*-v-I*-A,this.y=m*t+k*-A+I*-Q-d*-v,this.z=I*t+k*-v+d*-A-m*-Q,this},applyMatrix4:function(M){var k=this.x,P=this.y,K=this.z,Z=M.el,N=1/(Z[3]*k+Z[7]*P+Z[11]*K+Z[15]);return this.x=(Z[0]*k+Z[4]*P+Z[8]*K+Z[12])*N,this.y=(Z[1]*k+Z[5]*P+Z[9]*K+Z[13])*N,this.z=(Z[2]*k+Z[6]*P+Z[10]*K+Z[14])*N,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function($){return this.x*$.x+this.y*$.y+this.z*$.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var s=this.length();return s?this.multiplyScalar(1/s):this},setLength:function(A){return this.normalize().multiplyScalar(A)},fromArray:function(D,A){return A===d&&(A=0),this.x=D[A],this.y=D[A+1],this.z=D[A+2],this},toArray:function(L,B){return L===d&&(L=[0,0,0]),B===d&&(B=0),L[B]=this.x,L[B+1]=this.y,L[B+2]=this.z,L},cross:function(D){return this.crossVectors(this,D)},angleTo:function(k){var r=this.dot(k)/Math.sqrt(this.lengthSq()*k.lengthSq());return r>1||-1>r?0:Math.acos(r)},lerpVectors:function(W,t,h){return this.subVectors(t,W).multiplyScalar(h).add(W)},crossVectors:function(z,$){var e=z.x,x=z.y,K=z.z,G=$.x,f=$.y,B=$.z;return this.x=x*B-K*f,this.y=K*G-e*B,this.z=e*f-x*G,this},min:function(U){return this.x=Math.min(this.x,U.x),this.y=Math.min(this.y,U.y),this.z=Math.min(this.z,U.z),this},max:function(v){return this.x=Math.max(this.x,v.x),this.y=Math.max(this.y,v.y),this.z=Math.max(this.z,v.z),this}});var Ie=T.Math.Vector2=function(I,K,U){"object"==typeof I&&(I.x!=d?(K=I.y,I=I.x,U=I.e):(U=I[2],K=I[1],I=I[0])),this.set(I||0,K||0,U)};Ie.prototype={},Ie.prototype.constructor=Ie,M.defineProperties(Ie.prototype,{width:{get:function(){return this.x},set:function(Y){this.x=Y}},height:{get:function(){return this.y},set:function(y){this.y=y}}}),Ie.prototype.clone=function(){return new Ie(this.x,this.y,this.e)},Ie.prototype.copy=function(B){return this.set(B.x,B.y,B.e),this},Ie.prototype.equals=function(L){return L.x===this.x&&L.y===this.y},Ie.prototype.set=function(k,x,Z){return this.x=k||0,this.y=x||(0!==x?this.x:0),Z!=d&&(this.e=Z),this},Ie.prototype.setScalar=function(E){return this.x=E,this.y=E,this},Ie.prototype.setX=function(_){return this.x=_||0,this},Ie.prototype.setY=function(C){return this.y=C||0,this},Ie.prototype.add=function(c){return this.x+=c.x,this.y+=c.y,this},Ie.prototype.addVectors=function(n,O){return this.x=n.x+O.x,this.y=n.y+O.y,this},Ie.prototype.addScalar=function(g){return this.x+=g,this.y+=g,this},Ie.prototype.addScaledVector=function(C,x){return this.x+=C.x*x,this.y+=C.y*x,this},Ie.prototype.sub=function(T){return this.x-=T.x,this.y-=T.y,this},Ie.prototype.subScalar=function(v){return this.x-=v,this.y-=v,this},Ie.prototype.subVectors=function(a,u){return this.x=a.x-u.x,this.y=a.y-u.y,this},Ie.prototype.multiply=function(Q){return this.x*=Q.x,this.y*=Q.y,this},Ie.prototype.multiplyScalar=function(r){return this.x*=r,this.y*=r,this},Ie.prototype.divide=function(J){return this.x/=J.x,this.y/=J.y,this},Ie.prototype.divideScalar=function(I){return this.multiplyScalar(1/I)},Ie.prototype.min=function(q){return this.x=Math.min(this.x,q.x),this.y=Math.min(this.y,q.y),this},Ie.prototype.max=function(l){return this.x=Math.max(this.x,l.x),this.y=Math.max(this.y,l.y),this},Ie.prototype.fromArray=function(A,E){return E===d&&(E=0),this.x=A[E],this.y=A[E+1],this},Ie.prototype.clamp=function(K,W){return this.x=Math.max(K.x,Math.min(W.x,this.x)),this.y=Math.max(K.y,Math.min(W.y,this.y)),this},Ie.prototype.clampScalar=function(){var l,J;return function(W,r){return l===d&&(l=new Ie,J=new Ie),l.set(W,W),J.set(r,r),this.clamp(l,J)}}(),Ie.prototype.clampLength=function(s,o){var P=this.length();return this.multiplyScalar(Math.max(s,Math.min(o,P))/P)},Ie.prototype.dot=function(Z){return this.x*Z.x+this.y*Z.y},Ie.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Ie.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Ie.prototype.normalize=function(){return this.divideScalar(this.length())},Ie.prototype.angle=function(){var x=Math.atan2(this.y,this.x);return 0>x&&(x+=2*Math.PI),x},Ie.prototype.distanceTo=function(b){return Math.sqrt(this.distanceToSquared(b))},Ie.prototype.distanceToSquared=function(d){var k=this.x-d.x,m=this.y-d.y;return k*k+m*m},Ie.prototype.isNearEnough=function(B){return this.distanceToSquared(B)<1e-8},Ie.prototype.setLength=function(c){var v=this.length();return v?this.multiplyScalar(c/v):this},Ie.prototype.lerp=function(b,L){return this.x+=(b.x-this.x)*L,this.y+=(b.y-this.y)*L,this},Ie.prototype.lerpVectors=function(U,J,$){return this.subVectors(J,U).multiplyScalar($).add(U)},Ie.prototype.rotateAround=function(c,q){var R=c?c.x:0,u=c?c.y:0,f=Math.cos(q),S=Math.sin(q),j=this.x-R,z=this.y-u;return this.x=j*f-z*S+R,this.y=j*S+z*f+u,this};var Yp=T.Math.Ray=function(Z,z){this.origin=Z!==d?Z.clone():new jf,this.direction=z!==d?z.clone():new jf};M.assign(Yp.prototype,{set:function(q,o){return this.origin.copy(q),this.direction.copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(C){return this.origin.copy(C.origin),this.direction.copy(C.direction),this.maxHitLen=C.maxHitLen,this},at:function(B,n){var Q=n||new jf;return Q.copy(this.direction).multiplyScalar(B).add(this.origin)},setMaxHitLength:function(M){this.maxHitLen=M},lookAt:function(d){return this.direction.copy(d).sub(this.origin).normalize(),this},applyMatrix4:function(c){var R=this.maxHitLen;if(R){var q=this.direction.clone().multiplyScalar(R).add(this.origin);q.applyMatrix4(c)}return this.origin.applyMatrix4(c),this.direction.transformDirection(c),R&&(this.maxHitLen=this.origin.distanceTo(q)),this},intersectBox:function(I,X){var u,c,M,e,U,C,P=1/this.direction.x,w=1/this.direction.y,o=1/this.direction.z,R=this.origin;if(P>=0?(u=(I.min.x-R.x)*P,c=(I.max.x-R.x)*P):(u=(I.max.x-R.x)*P,c=(I.min.x-R.x)*P),w>=0?(M=(I.min.y-R.y)*w,e=(I.max.y-R.y)*w):(M=(I.max.y-R.y)*w,e=(I.min.y-R.y)*w),u>e||M>c)return null;if((M>u||u!==u)&&(u=M),(c>e||c!==c)&&(c=e),o>=0?(U=(I.min.z-R.z)*o,C=(I.max.z-R.z)*o):(U=(I.max.z-R.z)*o,C=(I.min.z-R.z)*o),u>C||U>c)return null;if((U>u||u!==u)&&(u=U),(c>C||c!==c)&&(c=C),0>c)return null;var s=u>=0?u:c,L=this.maxHitLen;return L&&s>L?null:this.at(s,X)},intersectTriangle:function(){var E=new jf,s=new jf,e=new jf,P=new jf;return function(c,U,z,_,R){s.subVectors(U,c),e.subVectors(z,c),P.crossVectors(s,e);var y,T=this.direction.dot(P);if(T>0){if(_)return null;y=1}else{if(!(0>T))return null;y=-1,T=-T}E.subVectors(this.origin,c);var C=y*this.direction.dot(e.crossVectors(E,e));if(0>C)return null;var u=y*this.direction.dot(s.cross(E));if(0>u||C+u>T)return null;var G=-y*E.dot(P);if(0>G)return null;var A=G/T,F=this.maxHitLen;return F&&A>F?null:this.at(A,R)}}()});var se=T.Math.Box3=function(v,l){this.min=v!==d?v:new jf(1/0,1/0,1/0),this.max=l!==d?l:new jf(-1/0,-1/0,-1/0)};M.assign(se.prototype,{set:function(P,_){return this.min.copy(P),this.max.copy(_),this},setFromArray:function(n){for(var O=1/0,x=1/0,k=1/0,y=-1/0,d=-1/0,U=-1/0,q=0,K=n.length;K>q;q+=3){var l=n[q],g=n[q+1],V=n[q+2];O>l&&(O=l),x>g&&(x=g),k>V&&(k=V),l>y&&(y=l),g>d&&(d=g),V>U&&(U=V)}return this.min.set(O,x,k),this.max.set(y,d,U),this},setFromPoints:function(k){this.makeEmpty();for(var w=0,H=k.length;H>w;w++)this.expandByPoint(k[w]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(I){return this.min.copy(I.min),this.max.copy(I.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(m){return this.min.min(m),this.max.max(m),this}});var El=T.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};M.assign(El.prototype,{set:function(R,K,s,O,o,i,y,W,p,m,G,A,H,a,f,x){var Q=this.el;return Q[0]=R,Q[4]=K,Q[8]=s,Q[12]=O,Q[1]=o,Q[5]=i,Q[9]=y,Q[13]=W,Q[2]=p,Q[6]=m,Q[10]=G,Q[14]=A,Q[3]=H,Q[7]=a,Q[11]=f,Q[15]=x,this},clone:function(){return(new El).fromArray(this.el)},fromArray:function(k,T){T===d&&(T=0);for(var K=this.el,q=0;16>q;q++)K[q]=k[q+T];return this},scale:function(x){var t=this.el,S=x.x,n=x.y,X=x.z;return t[0]*=S,t[4]*=n,t[8]*=X,t[1]*=S,t[5]*=n,t[9]*=X,t[2]*=S,t[6]*=n,t[10]*=X,t[3]*=S,t[7]*=n,t[11]*=X,this},makeRotationFromEuler:function(M){var N=this.el,o=M._x,B=M._y,k=M._z,r=M._order,d=Math.cos(o),X=Math.sin(o),G=Math.cos(B),Q=Math.sin(B),U=Math.cos(k),L=Math.sin(k);
if("XYZ"===r){var t=d*U,e=d*L,h=X*U,z=X*L;N[0]=G*U,N[4]=-G*L,N[8]=Q,N[1]=e+h*Q,N[5]=t-z*Q,N[9]=-X*G,N[2]=z-t*Q,N[6]=h+e*Q,N[10]=d*G}else if("YXZ"===r){var g=G*U,w=G*L,f=Q*U,l=Q*L;N[0]=g+l*X,N[4]=f*X-w,N[8]=d*Q,N[1]=d*L,N[5]=d*U,N[9]=-X,N[2]=w*X-f,N[6]=l+g*X,N[10]=d*G}else if("ZXY"===r){var g=G*U,w=G*L,f=Q*U,l=Q*L;N[0]=g-l*X,N[4]=-d*L,N[8]=f+w*X,N[1]=w+f*X,N[5]=d*U,N[9]=l-g*X,N[2]=-d*Q,N[6]=X,N[10]=d*G}else if("ZYX"===r){var t=d*U,e=d*L,h=X*U,z=X*L;N[0]=G*U,N[4]=h*Q-e,N[8]=t*Q+z,N[1]=G*L,N[5]=z*Q+t,N[9]=e*Q-h,N[2]=-Q,N[6]=X*G,N[10]=d*G}else if("YZX"===r){var $=d*G,C=d*Q,P=X*G,R=X*Q;N[0]=G*U,N[4]=R-$*L,N[8]=P*L+C,N[1]=L,N[5]=d*U,N[9]=-X*U,N[2]=-Q*U,N[6]=C*L+P,N[10]=$-R*L}else if("XZY"===r){var $=d*G,C=d*Q,P=X*G,R=X*Q;N[0]=G*U,N[4]=-L,N[8]=Q*U,N[1]=$*L+R,N[5]=d*U,N[9]=C*L-P,N[2]=P*L-C,N[6]=X*U,N[10]=R*L+$}return N[3]=0,N[7]=0,N[11]=0,N[12]=0,N[13]=0,N[14]=0,N[15]=1,this},makeRotationFromQuaternion:function(V){var N=this.el,v=V._x,d=V._y,L=V._z,i=V._w,r=v+v,w=d+d,P=L+L,g=v*r,G=v*w,s=v*P,I=d*w,W=d*P,X=L*P,T=i*r,J=i*w,Z=i*P;return N[0]=1-(I+X),N[4]=G-Z,N[8]=s+J,N[1]=G+Z,N[5]=1-(g+X),N[9]=W-T,N[2]=s-J,N[6]=W+T,N[10]=1-(g+I),N[3]=0,N[7]=0,N[11]=0,N[12]=0,N[13]=0,N[14]=0,N[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(i){var C=this.el,V=i.el,O=V[0],z=V[1],r=V[2],N=V[3],X=V[4],h=V[5],o=V[6],_=V[7],a=V[8],H=V[9],Z=V[10],c=V[11],e=V[12],L=V[13],Q=V[14],I=V[15],g=H*Q*_-L*Z*_+L*o*c-h*Q*c-H*o*I+h*Z*I,l=e*Z*_-a*Q*_-e*o*c+X*Q*c+a*o*I-X*Z*I,q=a*L*_-e*H*_+e*h*c-X*L*c-a*h*I+X*H*I,x=e*H*o-a*L*o-e*h*Z+X*L*Z+a*h*Q-X*H*Q,W=O*g+z*l+r*q+N*x;if(0===W)return this.identity();var B=1/W;return C[0]=g*B,C[1]=(L*Z*N-H*Q*N-L*r*c+z*Q*c+H*r*I-z*Z*I)*B,C[2]=(h*Q*N-L*o*N+L*r*_-z*Q*_-h*r*I+z*o*I)*B,C[3]=(H*o*N-h*Z*N-H*r*_+z*Z*_+h*r*c-z*o*c)*B,C[4]=l*B,C[5]=(a*Q*N-e*Z*N+e*r*c-O*Q*c-a*r*I+O*Z*I)*B,C[6]=(e*o*N-X*Q*N-e*r*_+O*Q*_+X*r*I-O*o*I)*B,C[7]=(X*Z*N-a*o*N+a*r*_-O*Z*_-X*r*c+O*o*c)*B,C[8]=q*B,C[9]=(e*H*N-a*L*N-e*z*c+O*L*c+a*z*I-O*H*I)*B,C[10]=(X*L*N-e*h*N+e*z*_-O*L*_-X*z*I+O*h*I)*B,C[11]=(a*h*N-X*H*N-a*z*_+O*H*_+X*z*c-O*h*c)*B,C[12]=x*B,C[13]=(a*L*r-e*H*r+e*z*Z-O*L*Z-a*z*Q+O*H*Q)*B,C[14]=(e*h*r-X*L*r-e*z*o+O*L*o+X*z*Q-O*h*Q)*B,C[15]=(X*H*r-a*h*r+a*z*o-O*H*o-X*z*Z+O*h*Z)*B,this},makeRotationAxis:function(F,t){var y=Math.cos(t),f=Math.sin(t),A=1-y,W=F.x,z=F.y,N=F.z,a=A*W,u=A*z;return this.set(a*W+y,a*z-f*N,a*N+f*z,0,a*z+f*N,u*z+y,u*N-f*W,0,a*N-f*z,u*N+f*W,A*N*N+y,0,0,0,0,1),this},multiply:function(v){return this.multiplyMatrices(this,v)},premultiply:function(w){return this.multiplyMatrices(w,this)},multiplyMatrices:function(l,$){var j=l.el,S=$.el,k=this.el,q=j[0],p=j[4],e=j[8],h=j[12],o=j[1],U=j[5],P=j[9],b=j[13],K=j[2],N=j[6],s=j[10],M=j[14],I=j[3],R=j[7],J=j[11],_=j[15],O=S[0],t=S[4],g=S[8],r=S[12],F=S[1],Q=S[5],f=S[9],x=S[13],a=S[2],v=S[6],G=S[10],T=S[14],d=S[3],w=S[7],W=S[11],E=S[15];return k[0]=q*O+p*F+e*a+h*d,k[4]=q*t+p*Q+e*v+h*w,k[8]=q*g+p*f+e*G+h*W,k[12]=q*r+p*x+e*T+h*E,k[1]=o*O+U*F+P*a+b*d,k[5]=o*t+U*Q+P*v+b*w,k[9]=o*g+U*f+P*G+b*W,k[13]=o*r+U*x+P*T+b*E,k[2]=K*O+N*F+s*a+M*d,k[6]=K*t+N*Q+s*v+M*w,k[10]=K*g+N*f+s*G+M*W,k[14]=K*r+N*x+s*T+M*E,k[3]=I*O+R*F+J*a+_*d,k[7]=I*t+R*Q+J*v+_*w,k[11]=I*g+R*f+J*G+_*W,k[15]=I*r+R*x+J*T+_*E,this},lookAt:function(){var w=new jf,s=new jf,z=new jf;return function(n,h,r){var A=this.el;return z.subVectors(n,h),0===z.lengthSq()&&(z.z=1),z.normalize(),w.crossVectors(r,z),0===w.lengthSq()&&(1===Math.abs(r.z)?z.x+=1e-4:z.z+=1e-4,z.normalize(),w.crossVectors(r,z)),w.normalize(),s.crossVectors(z,w),A[0]=w.x,A[4]=s.x,A[8]=z.x,A[1]=w.y,A[5]=s.y,A[9]=z.y,A[2]=w.z,A[6]=s.z,A[10]=z.z,this}}()});var um=T.Math.Quaternion=function(c,C,n,A){this.set(c,C,n,A)};M.assign(um.prototype,{set:function(y,g,W,c){var V=this;return V._x=y||0,V._y=g||0,V._z=W||0,V._w=c!==d?c:1,V},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(N){var f=this;return f._x=N._x,f._y=N._y,f._z=N._z,f._w=N._w,f},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var r=this.length();return 0===r?(this._x=0,this._y=0,this._z=0,this._w=1):(r=1/r,this._x=this._x*r,this._y=this._y*r,this._z=this._z*r,this._w=this._w*r),this},fromArray:function($,S){S===d&&(S=0);var N=this;return N._x=$[S],N._y=$[S+1],N._z=$[S+2],N._w=$[S+3],this},slerp:function(N,j){if(0===j)return this;if(1===j)return this.copy(N);var x=this._x,P=this._y,n=this._z,D=this._w,t=D*N._w+x*N._x+P*N._y+n*N._z;if(0>t?(this._w=-N._w,this._x=-N._x,this._y=-N._y,this._z=-N._z,t=-t):this.copy(N),t>=1)return this._w=D,this._x=x,this._y=P,this._z=n,this;var a=Math.sqrt(1-t*t);if(Math.abs(a)<.001)return this._w=.5*(D+this._w),this._x=.5*(x+this._x),this._y=.5*(P+this._y),this._z=.5*(n+this._z),this;var l=Math.atan2(a,t),m=Math.sin((1-j)*l)/a,d=Math.sin(j*l)/a;return this._w=D*m+this._w*d,this._x=x*m+this._x*d,this._y=P*m+this._y*d,this._z=n*m+this._z*d,this},setFromAxisAngle:function(A,H){var K=H/2,S=Math.sin(K);return this._x=A.x*S,this._y=A.y*S,this._z=A.z*S,this._w=Math.cos(K),this},setFromEuler:function(e){var u=e._x,L=e._y,F=e._z,I=e._order,j=Math.cos,$=Math.sin,x=j(u/2),U=j(L/2),C=j(F/2),z=$(u/2),b=$(L/2),_=$(F/2);return"XYZ"===I?(this._x=z*U*C+x*b*_,this._y=x*b*C-z*U*_,this._z=x*U*_+z*b*C,this._w=x*U*C-z*b*_):"YXZ"===I?(this._x=z*U*C+x*b*_,this._y=x*b*C-z*U*_,this._z=x*U*_-z*b*C,this._w=x*U*C+z*b*_):"ZXY"===I?(this._x=z*U*C-x*b*_,this._y=x*b*C+z*U*_,this._z=x*U*_+z*b*C,this._w=x*U*C-z*b*_):"ZYX"===I?(this._x=z*U*C-x*b*_,this._y=x*b*C+z*U*_,this._z=x*U*_-z*b*C,this._w=x*U*C+z*b*_):"YZX"===I?(this._x=z*U*C+x*b*_,this._y=x*b*C+z*U*_,this._z=x*U*_-z*b*C,this._w=x*U*C-z*b*_):"XZY"===I&&(this._x=z*U*C-x*b*_,this._y=x*b*C-z*U*_,this._z=x*U*_+z*b*C,this._w=x*U*C+z*b*_),this},setFromToVectors:function(){var V,x;return function(y,J){return V===d&&(V=new jf),x=y.dot(J)+1,1e-7>x?(x=0,Math.abs(y.x)>Math.abs(y.z)?V.set(-y.y,y.x,0):V.set(0,-y.z,y.y)):V.crossVectors(y,J),this._x=V.x,this._y=V.y,this._z=V.z,this._w=x,this.normalize()}}()});var bk=T.Math.Triangle=function(y,S,o){this.a=y!==d?y:new jf,this.b=S!==d?S:new jf,this.c=o!==d?o:new jf};M.assign(bk,{barycoordFromPoint:function(){var i=new jf,t=new jf,_=new jf;return function(c,k,m,V,$){i.subVectors(V,k),t.subVectors(m,k),_.subVectors(c,k);var K=i.dot(i),j=i.dot(t),n=i.dot(_),R=t.dot(t),Q=t.dot(_),L=K*R-j*j,J=$||new jf;if(0===L)return J.set(-2,-1,-1);var o=1/L,Y=(R*n-j*Q)*o,x=(K*Q-j*n)*o;return J.set(1-Y-x,x,Y)}}()});var Xj=T.Math.Euler=function(C,t,N,U,j){this.set(C,t,N,U,j)};Xj.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Xj.DefaultOrder="XYZ",Xj.ReverseOrder=function(Q){return Q=Q[2]+Q[1]+Q[0],Q.toUpperCase()},M.defineProperties(Xj.prototype,{x:{get:function(){return this._x},set:function(T){this._x=T,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(X){this._y=X,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(B){this._z=B,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(P){this._order=P,this.onChangeCallback()}}}),M.assign(Xj.prototype,{set:function(z,A,T,w,N){return $l(z)&&(N=T,w=A,T=z[2],A=z[1],z=z[0]),w?N&&(w=Xj.ReverseOrder(w)):w="ZYX",this._x=z||0,this._y=A||0,this._z=T||0,this._order=w||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(o){return this._x=o._x,this._y=o._y,this._z=o._z,this._order=o._order,this.onChangeCallback(),this},setFromRotationMatrix:function(R,f,O){var P=T.Math.clamp,z=R.el||R,Y=z[0],b=z[4],E=z[8],n=z[1],r=z[5],K=z[9],D=z[2],J=z[6],a=z[10];return f=f||this._order,"XYZ"===f?(this._y=Math.asin(P(E,-1,1)),Math.abs(E)<.99999?(this._x=Math.atan2(-K,a),this._z=Math.atan2(-b,Y)):(this._x=Math.atan2(J,r),this._z=0)):"YXZ"===f?(this._x=Math.asin(-P(K,-1,1)),Math.abs(K)<.99999?(this._y=Math.atan2(E,a),this._z=Math.atan2(n,r)):(this._y=Math.atan2(-D,Y),this._z=0)):"ZXY"===f?(this._x=Math.asin(P(J,-1,1)),Math.abs(J)<.99999?(this._y=Math.atan2(-D,a),this._z=Math.atan2(-b,r)):(this._y=0,this._z=Math.atan2(n,Y))):"ZYX"===f?(this._y=Math.asin(-P(D,-1,1)),Math.abs(D)<.99999?(this._x=Math.atan2(J,a),this._z=Math.atan2(n,Y)):(this._x=0,this._z=Math.atan2(-b,r))):"YZX"===f?(this._z=Math.asin(P(n,-1,1)),Math.abs(n)<.99999?(this._x=Math.atan2(-K,r),this._y=Math.atan2(-D,Y)):(this._x=0,this._y=Math.atan2(E,a))):"XZY"===f?(this._z=Math.asin(-P(b,-1,1)),Math.abs(b)<.99999?(this._x=Math.atan2(J,r),this._y=Math.atan2(E,Y)):(this._x=Math.atan2(-K,a),this._y=0)):console.warn("unsupported order: "+f),this._order=f,O!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var M=new El;return function(S,B,m){return M.makeRotationFromQuaternion(S),this.setFromRotationMatrix(M,B,m)}}(),setFromVector3:function(r,J){return this.set(r.x,r.y,r.z,J||this._order)},reorder:function(){var Q=new um;return function(P){return Q.setFromEuler(this),this.setFromQuaternion(Q,P)}}(),equals:function(z){return z._x===this._x&&z._y===this._y&&z._z===this._z&&z._order===this._order},fromArray:function(r){return this._x=r[0],this._y=r[1],this._z=r[2],r[3]!==d&&(this._order=r[3]),this.onChangeCallback(),this},toArray:function(E,D){return E===d&&(E=[]),D===d&&(D=0),E[D]=this._x,E[D+1]=this._y,E[D+2]=this._z,E[D+3]=this._order,E},toVector3:function(U){return U?U.set(this._x,this._y,this._z):new jf(this._x,this._y,this._z)},onChange:function(h){return this.onChangeCallback=h,this},onChangeCallback:function(){}});var wk=T.List=function(){this._as=[];var C,X,n=arguments.length;if(1===n){var s=arguments[0];if(ic(s)&&(s=s._as),$l(s))for(X=s.length,C=0;X>C;C++)this._as.push(s[C]);else s!=y&&this._as.push(s)}else if(n>1)for(C=0;n>C;C++)this._as.push(arguments[C])};ld("List",M,{forEach:function(g,Z){this.each(g,Z)},push:function(){for(var S=0;S<arguments.length;S++)this.add(arguments[S])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(c,n){return n===d?this._as.push(c):this._as.splice(n,0,c)},addAll:function(U){ic(U)&&(U=U._as),$l(U)?Rj(this._as,U):this._as.push(U)},get:function(x){return this._as[x]},slice:function(j,K){return new wk(this._as.slice(j,K))},remove:function(l){var M=this._as.indexOf(l);return M>=0&&M<this._as.length&&this.removeAt(M),M},removeAt:function(q){return this._as.splice(q,1)[0]},set:function(j,g){return this._as[j]=g},clear:function(){return this._as.splice(0,this._as.length)},contains:function(D){return this._as.indexOf(D)>=0},indexOf:function(m){return this._as.indexOf(m)},each:function(p,v){for(var w=0,H=this._as.length;H>w;w++){var f=this._as[w];v?p.call(v,f,w,this):p(f,w,this)}},reverseEach:function(Q,x){for(var _=this._as.length-1;_>=0;_--){var R=this._as[_];x?Q.call(x,R):Q(R)}},toArray:function(J,b){if(J){for(var f,F=[],E=0,v=this._as.length;v>E;E++)f=this._as[E],b?J.call(b,f)&&F.push(f):J(f)&&F.push(f);return F}return this._as.concat()},toList:function(L,Q){if(L){for(var r,y=new wk,H=0,j=this._as.length;j>H;H++)r=this._as[H],Q?L.call(Q,r)&&y.add(r):L(r)&&y.add(r);return y}return new wk(this)},reverse:function(){this._as.reverse()},sort:function(z){return this._as.sort(z?z:Nn),this},toString:function(){return this._as.toString()}}),M.defineProperties(wk.prototype,{length:{get:function(){return this._as.length},set:function(X){this._as.length=X}}});var po=new wk;Zc(po,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Pi,each:Pi,reverseEach:Pi,toArray:function(){return[]},toList:function(){return new wk},add:Rp,addAll:Rp,set:Rp,remove:Rp,removeAt:Rp,clear:Rp});var pq=T.Notifier=function(){this._f=0};ld("Notifier",M,{contains:function(C,u){if(this._ls)for(var E,Q=0,G=this._ls.size();G>Q;Q++)if(E=this._ls.get(Q),C===E.l&&u===E.s)return!0;return!1},add:function(i,t,w){var j=this,F={l:i,s:t,a:w};j._ls||(j._ls=new wk),j._f?(j._as||(j._as=new wk),j._as.add(F)):F.a?j._ls.add(F,0):j._ls.add(F)},remove:function(D,s){var A=this;A._ls&&(A._f?(A._rs||(A._rs=new wk),A._rs.add({l:D,s:s})):A._remove(D,s))},_remove:function(q,l){for(var G,d=this._ls,f=0,M=d.size();M>f;f++)if(G=d.get(f),G.l===q&&G.s===l)return d.removeAt(f),void 0},fire:function(T){var M=this,j=M._ls;if(M._b=1e4,j){++M._f;try{for(var o,V=0,L=j.size();L>V;V++)o=j.get(V),o.s?o.l.call(o.s,T):o.l(T)}finally{if(--M._f)return;if(M._rs){for(L=M._rs.size(),V=0;L>V;V++)o=M._rs.get(V),M._remove(o.l,o.s);delete M._rs}if(M._as){for(L=M._as.size(),V=0;L>V;V++)o=M._as.get(V),o.a?j.add(o,0):j.add(o);delete M._as}}}}});var gl=T.Data=function(){this._id=Ef()};ld("Data",M,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:y,_parent:y,_children:po,_childMap:y,_styleMap:y,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return y},_22Q:function(){return y},s:function(O,E){var Z=this;if(2===arguments.length)Z.setStyle(O,E);else{if(!Bh(O))return Z.getStyle(O);for(var v in O)Z.setStyle(v,O[v])}return Z},fp:function(j,$,x,y,O){return this.firePropertyChange(j,$,x,y,O)},firePropertyChange:function(t,e,P,h,$){if(h){if(h(e,P))return!1}else if(e===P)return!1;var L=this,C=$||{};return C.property=t,C.oldValue=e,C.newValue=P,C.data=L,L._dataModel&&L._dataModel.handleDataPropertyChange(C),L.onPropertyChanged(C),!0},onPropertyChanged:function(A){var w=this,d=w._parent,v=A.property;if(zc(d)){var G=w.s(op),f="s:ingroup"===v;(G&&vp[v]||v===f)&&d._81I(),(G||f)&&d.fp("childChange",!0,!1)}bi(d)&&vp[v]&&d.updateFromChildren()},_21I:function(U){var b=this;if(U&&b._dataModel)throw"Remove data from dataModel before adding";b._dataModel=U},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var g=0,o=this._children.toArray(),j=o.length;j>g;g++)o[g].removeFromDataModel()},getId:function(){return this._id},setId:function(i){this._id=i},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function($,f){return this._children.toList($,f)},eachChild:function(J,j){this._children.each(J,j)},addChild:function(t,p){var r=this;t!==r&&(r._children===po&&(r._children=new wk,r._childMap={}),p>=0||(p=r._children.size()),r._childMap[t._id]||r.isDescendantOf(t)||(t._parent&&t._parent.removeChild(t),(0>p||p>r._children.size())&&(p=r._children.size()),r._children.add(t,p),r._childMap[t._id]=t,t.setParent(r),r.onChildAdded(t,p),r.fp(Kc,y,t)))},onChildAdded:function(){},removeChild:function(R){var G=this;if(G._childMap&&G._childMap[R._id]){var w=G._children.remove(R);delete G._childMap[R._id],G.fp(Kc,R,y),R.setParent(y,w),G.onChildRemoved(R,w)}},onChildRemoved:function(){},getChildAt:function(V){return this._children.get(V)},clearChildren:function(){var B=this;if(!B._children.isEmpty())for(var l=0,q=B._children.toArray(),F=q.length;F>l;l++)B.removeChild(q[l])},getParent:function(){return this._parent},setParent:function(Q,A){var e=this;if(!(e._73I||e._parent===Q||e===Q||Q&&Q.isDescendantOf(e))){var v,n=e._parent;e._parent=Q,e._73I=1,n?(A==y&&(A=n.getChildren().indexOf(e)),n.removeChild(e)):e._dataModel&&A==y&&(A=e._dataModel.getRoots().indexOf(e)),Q&&(Q.addChild(e),v=Q.getChildren().indexOf(e)),delete e._73I,e.fp("parent",n,Q,d,{oldIndex:A,newIndex:v}),e.onParentChanged(n,Q)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(R){return R?this.isDescendantOf(R)||R.isDescendantOf(this):!1},isParentOf:function(x){return x&&this._childMap?!!this._childMap[x._id]:!1},isDescendantOf:function(o){if(!o||o.isEmpty())return!1;for(var J=this._parent;J;){if(o===J)return!0;J=J._parent}return!1},getStyle:function(Q,g){g===d&&(g=1);var M=this._styleMap?this._styleMap[Q]:d;return M===d&&g?c[Q]:M},setStyle:function(w,P){var O=this;O._styleMap||(O._styleMap={});var q=O._styleMap[w];P===d?delete O._styleMap[w]:O._styleMap[w]=P,O.fp("s:"+w,q,P)&&O.onStyleChanged(w,q,P)},onStyleChanged:function(){},iv:function(z){this.invalidate(z)},invalidate:function(u){this.fp(u||"*",!1,!0)},toString:function(){var T=this;return T._displayName||T._name||T._tag||T._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(r,k){var i=this,z=i.s(zj);z||i.s(zj,z={}),k?z[r]=k:delete z[r],i.fp(zj,y,z)},removeStyleIcon:function(R){var E=this.s(zj);if(E){var d=E[R];delete E[R],this.fp(zj,y,E)}return d},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var $,I={};for($ in this._styleMap)I[$]=1;return I}});var ub=T.DataModel=function(){var J=this;J._datas=new wk,J._dataMap={},J._roots=new wk,J._rootMap={},J._fsDataMap={},J._78O={},J._36I=new pq,J._35I=new pq,J._serializeNotifier=new pq,J._selectionModel=new qn(J);var c=J._29Q=[],E=J._scheduleCallback=function(){for(var T=Date.now(),g=0;g<c.length;g++){var e=c[g];e.enabled&&T-e.lastTime>e.interval&&(e.beforeAction&&e.beforeAction(),J.each(function(d){e.action(d)}),e.afterAction&&e.afterAction(),e.lastTime=T)}c.length&&(J._30Q=U.requestAnimationFrame(E))}};ld("DataModel",M,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:d,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:d,_init:d,_envmap:d,_postProcessingData:d,sm:function(){return this.getSelectionModel()},mm:function(f,X,P){this.addDataModelChangeListener(f,X,P)},umm:function(D,E){this.removeDataModelChangeListener(D,E)},md:function(G,g,_){this.addDataPropertyChangeListener(G,g,_)},umd:function(y,I){this.removeDataPropertyChangeListener(y,I)},mh:function(k,z,h){this.addHierarchyChangeListener(k,z,h)},umh:function(B,J){this.removeHierarchyChangeListener(B,J)},getAttrObject:function(){return this._attrObject},setAttrObject:function(r){return this._attrObject=r},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getDataById:function(h){return this._dataMap[h]},removeDataById:function(H){this.remove(this.getDataById(H))},toDatas:function(f,V){return this._datas.toList(f,V)},each:function(b,Y){this._datas.each(b,Y)},getDataByTag:function(y){return this._78O[y]},getTagMap:function(){return this._78O},removeDataByTag:function(S){this.remove(this.getDataByTag(S))},add:function(A,x,H){var e=this,u=A._id,p=A._tag,i=e._roots;if(e._dataMap[u])throw"'"+u+"' already exists";p!=y&&(e._78O[p]=A),e._dataMap[u]=A,H>=0?e._datas.add(A,H):e._datas.add(A),A._parent||(e._rootMap[u]=A,x>=0?i.add(A,x):i.add(A)),A.s("fullscreen")!==d&&(e._fsDataMap[u]=A),A._21I(e),e.onAdded(A),e._36I.fire({kind:"add",data:A,rootsIndex:x,datasIndex:H})},onAdded:function(){},remove:function(w,k){if(w){var p=this,D=w._id,q=k&&k.keepStructure,P=k&&k.keepChildren,Y=w.getTag();if(w._dataModel===p){this.beginTransaction(),q?p._removingData||(p._removingData=w):p.prepareRemove(w),P||w.toChildren().each(function(Q){p.remove(Q,k)},p),q?p._removingData===w&&(w._parent&&w._parent.removeChild(w),delete p._removingData):w._parent&&w._parent.removeChild(w);var l=p._datas.remove(w);delete p._dataMap[D],Y!=y&&delete p._78O[Y];var i;p._rootMap[D]&&(delete p._rootMap[D],i=p._roots.remove(w)),p._fsDataMap[D]&&delete p._fsDataMap[D],w._21I(y),p.onRemoved(w),p._36I.fire({kind:ro,data:w,rootsIndex:i,datasIndex:l}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var L=this;if(L._datas.size()){var b=L._historyManager?this.toJSON():d;L._datas.toArray().forEach(function(r){r._21I(y)}),L._datas.clear(),L._dataMap={},L._roots.clear(),L._rootMap={},L._fsDataMap={},L._78O={},L._36I.fire({kind:Ih,json:b})}},contains:function(V){return V&&V._dataModel===this},handleDataPropertyChange:function(Z){var _=this,w=Z.data,x=Z.property;if("parent"===x){var R=w._id,E=_._rootMap,L=_._roots;w._parent?E[R]&&(delete E[R],L.remove(w)):E[R]||(E[R]=w,L.add(w))}else if("tag"===x){var U=Z.oldValue,V=Z.newValue,c=_._78O;U!=y&&delete c[U],V!=y&&(c[V]=w)}else if("s:fullscreen"===x){var R=w._id,C=_._fsDataMap;Z.oldValue!=y&&delete C[R],Z.newValue!=y&&(C[R]=w)}this.onDataPropertyChanged(w,Z),this._35I.fire(Z)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(H,o,D){this._36I.add(H,o,D)},removeDataModelChangeListener:function(T,A){this._36I.remove(T,A)},addSerializeListener:function(J,j,w){this._serializeNotifier.add(J,j,w)},removeSerializeListener:function(M,J){this._serializeNotifier.remove(M,J)},fireSerializeEvent:function(T){this._serializeNotifier.fire(T)},addDataPropertyChangeListener:function(P,z,A){this._35I.add(P,z,A)},removeDataPropertyChangeListener:function(U,i){this._35I.remove(U,i)},_38I:function(b,q,H){this._37I&&this._37I.fire({data:b,oldIndex:q,newIndex:H})},addHierarchyChangeListener:function(m,X,A){this._37I||(this._37I=new pq),this._37I.add(m,X,A)},removeHierarchyChangeListener:function(y,Z){this._37I.remove(y,Z)},getSiblings:function(o){var K=o._parent;return K?K._children:this._roots},eachByHierarchical:function(y,_,p){if(_)return this._eachByHierarchical(y,_,p);for(var l=0,i=this._roots,d=i.size();d>l;l++)if(this._eachByHierarchical(y,i.get(l),p)===!1)return!1;return!0},_eachByHierarchical:function(U,B,W){if(W){if(U.call(W,B)===!1)return!1}else if(U(B)===!1)return!1;for(var u=B.size(),r=0;u>r;r++)if(this._eachByHierarchical(U,B.getChildAt(r),W)===!1)return!1;return!0},reverseEachByHierarchical:function(h,k,w){if(k)return this._reverseEachByHierarchical(h,k,w);for(var d=this._roots,i=d.size(),O=i-1;O>=0;O--)if(this._reverseEachByHierarchical(h,d.get(O),w)===!1)return!1;return!0},_reverseEachByHierarchical:function(s,p,S){for(var i=p.size(),j=i-1;j>=0;j--)if(this._reverseEachByHierarchical(s,p.getChildAt(j),S)===!1)return!1;if(S){if(s.call(S,p)===!1)return!1}else if(s(p)===!1)return!1;return!0},eachByDepthFirst:function(N,k,$){if(k)return this._11I(N,k,$);for(var o=0,B=this._roots,a=B.size();a>o;o++)if(this._11I(N,B.get(o),$)===!1)return!1;return!0},_11I:function(S,o,A){for(var M=o.size(),O=0;M>O;O++)if(this._11I(S,o.getChildAt(O),A)===!1)return!1;if(A){if(S.call(A,o)===!1)return!1}else if(S(o)===!1)return!1;return!0},eachByBreadthFirst:function(m,X,L){var z=new wk;for(X?z.add(X):this._roots.each(z.add,z);z.size()>0;)if(X=z.removeAt(0),X.eachChild(z.add,z),L){if(m.call(L,X)===!1)return!1}else if(m(X)===!1)return!1;return!0},moveTo:function(v,$){var P=this.getSiblings(v),Q=P.indexOf(v);Q===$||0>Q||$>=0&&$<=P.size()&&(P.remove(v),$>P.size()&&$--,P.add(v,$),this._38I(v,Q,$))},moveUp:function(T){this.moveTo(T,this.getSiblings(T).indexOf(T)-1)},moveDown:function(m){this.moveTo(m,this.getSiblings(m).indexOf(m)+1)},moveToTop:function(i){this.moveTo(i,0)},moveToBottom:function(C){this.moveTo(C,this.getSiblings(C).size())},moveSelectionUp:function(E){this.beginTransaction(),E||(E=this.sm());var i=new wk;Wg(E,i,this._roots),i.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(n){this.beginTransaction(),n||(n=this.sm());var z=new wk;ug(n,z,this._roots),z.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(t){this.beginTransaction(),t||(t=this.sm());var G=new wk;Fn(t,G,this._roots),G.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(x){this.beginTransaction(),x||(x=this.sm());var M=new wk;Rr(x,M,this._roots),M.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(t,f,v){var N=this.getDatas();null==v&&(v=N.indexOf(t)),v===f||0>v||f>=0&&f<=N.size()&&(N.remove(t),f>N.size()&&f--,N.add(t,f),this._76I(t,v,f))},bringForward:function(H){this.moveToIndex(H,this.getDatas().indexOf(H)+1)},bringToFront:function(r){this.moveToIndex(r,this.size())},sendBackward:function(N){this.moveToIndex(N,this.getDatas().indexOf(N)-1)},sendToBack:function(K){this.moveToIndex(K,0)},bringSelectionForward:function(F){this.beginTransaction(),F||(F=this.sm());for(var j=new wk,A=this.getDatas(),C=!1,K=0;K<A.size();K++){var G=A.get(A.size()-1-K);F.contains(G)?C&&j.add(G):C=!0}j.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(N){this.beginTransaction(),N||(N=this.sm());for(var b=new wk,k=this.getDatas(),D=0;D<k.size();D++){var E=k.get(D);N.contains(E)&&b.add(E)}b.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(w){this.beginTransaction(),w||(w=this.sm());for(var i=new wk,m=this.getDatas(),X=!1,b=0;b<m.size();b++){var o=m.get(b);w.contains(o)?X&&i.add(o):X=!0}i.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(k){this.beginTransaction(),k||(k=this.sm());for(var b=new wk,l=this.getDatas(),h=0;h<l.size();h++){var y=l.get(l.size()-1-h);k.contains(y)&&b.add(y)}b.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(A){var G=this;G.removeScheduleTask(A),A.enabled==y&&(A.enabled=!0),A.interval==y&&(A.interval=10),A.action==y&&(A.action=Pi),A.lastTime=Date.now(),G._29Q.push(A),G._30Q==y&&(G._30Q=U.requestAnimationFrame(G._scheduleCallback))},removeScheduleTask:function(w){var F=this,C=F._29Q,k=C.indexOf(w);k>=0&&C.splice(k,1),C.length||F._30Q==y||(U.cancelAnimationFrame(F._30Q),delete F._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(k){this._historyManager||new T.HistoryManager(this),null!=k&&this._historyManager.setMaxHistoryCount(k),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(O){this._historyManager&&this._historyManager.undo(O)},redo:function(g){this._historyManager&&this._historyManager.redo(g)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(J){this._historyManager&&this._historyManager.addHistory(J)},onHistoryManagerChanged:function(){}});var qn=T.SelectionModel=function(X){var m=this;m._68O=sj,m._map={},m._73O=new wk,m._74I=new pq,m._21I(X)};ld("SelectionModel",M,{ms_fire:1,ms_dm:1,ms:function(D,B,R){this.addSelectionChangeListener(D,B,R)},ums:function(n,v){this.removeSelectionChangeListener(n,v)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===fe},co:function(h){return this._map[h._id]!=y},ss:function(c){this.setSelection(c)},as:function(q){this.appendSelection(q)},rs:function(e){this.removeSelection(e)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(R){var q=this;if(q._68O!==R&&(R===Pf||R===fe||R===sj)){q.cs();var I=q._68O;q._68O=R,q.fp("selectionMode",I,R)}},_21I:function(Q){var O=this,H=O._dataModel;H!==Q&&(H&&(O.cs(),H.umm(O.handleDataModelChange,O)),O._dataModel=Q,Q.mm(O.handleDataModelChange,O,!0),O.fp(ns,H,Q))},dispose:function(){var q=this;q.cs(),q._dataModel.umm(q.handleDataModelChange,q)},handleDataModelChange:function(G){var n=this;if(G.kind===ro){var l=G.data;n.co(l)&&(n._73O.remove(l),delete n._map[l._id],n._75I(ro,new wk(l)))}else G.kind===Ih&&n.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(V){var n=this;if(n._filterFunc!==V){n.cs();var Y=n._filterFunc;n._filterFunc=V,n.fp("filterFunc",Y,n._filterFunc)}},_75I:function(W,u,t,Q){t&&(this._73O.each(function(K){Q[K._id]?t.remove(K):t.add(K)}),u=t.toList()),this._74I.fire({kind:W,datas:new wk(u)})},addSelectionChangeListener:function(b,Y,C){this._74I.add(b,Y,C)},removeSelectionChangeListener:function($,I){this._74I.remove($,I)},_97O:function(w,B){for(var N,b=this,q=0,n=new wk(w);q<n.size();q++)N=n.get(q),(b._filterFunc&&!b._filterFunc(N)||B&&b.co(N)||!B&&!b.co(N)||!b._dataModel.contains(N))&&(n.removeAt(q),q--);return n},appendSelection:function(Q){var I=this;if(I._68O!==Pf){var X,m,p=I._73O,v=I._97O(Q,!0);v.isEmpty()||(I.sg()&&(X=new wk(p),m=I._map,p.clear(),I._map={},v=new wk(v.get(v.size()-1))),v.each(function(W){p.add(W),I._map[W._id]=W}),I._75I("append",v,X,m))}},removeSelection:function(s){var C=this,E=C._97O(s),O=0,i=E.size();if(0!==i){for(;i>O;O++){var R=E.get(O);C._73O.remove(R),delete C._map[R._id]}C._75I(ro,E)}},toSelection:function(N,v){return this._73O.toList(N,v)},getSelection:function(){return this._73O},each:function(Z,i){this._73O.each(Z,i)},setSelection:function(h){var i=this,g=i._73O;if(i._68O!==Pf&&!(g.isEmpty()&&!h||1===g.size()&&i.ld()===h)){var f=new wk(g),b=i._map;g.clear(),i._map={};var A=i._97O(h,!0);i.sg()&&A.size()>1&&(A=new wk(A.get(A.size()-1))),A.each(function(L){g.add(L),i._map[L._id]=L}),i._75I("set",y,f,b)}},clearSelection:function(){var g=this,D=g._73O;if(D.size()>0){var d=D.toList();D.clear(),g._map={},g._75I(Ih,d)}},selectAll:function(){var A=this;if(A._68O!==Pf){var $,u,C=A._dataModel.toDatas();if(A._filterFunc)for($=0;$<C.size();$++)u=C.get($),A._filterFunc(u)||(C.removeAt($),$--);var F=A._73O,Q=new wk(F),U=A._map;F.clear(),A._map={},A.sg()&&C.size()>1&&(C=new wk(C.get(C.size()-1)));var p=C.size();for($=0;p>$;$++)u=C.get($),F.add(u),A._map[u._id]=u;A._75I("all",y,Q,U)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(Y){return this._map[Y._id]!=y},getLastData:function(){var c=this._73O;return c.size()>0?c.get(c.size()-1):y},getFirstData:function(){var z=this._73O;return z.size()>0?z.get(0):y},isSelectable:function(p){var j=this;return p&&j._68O!==Pf?j._filterFunc?j._filterFunc(p):!0:!1},getTopSelection:function(){var o=this,i=new wk;return o._73O.each(function(E){for(var N=E.getParent();N;){if(o.contains(N)){E=y;break}N=N.parent}E&&i.add(E)}),i}});var eo=function(){return cj(0),function(V,t){var a;if(nk(t)){var H=V.getDataUI(t);H&&H._88I&&(a=H._88I.rect)}return a?a:t.getRect()}}();Zc(N,{edgeGroupAgentFunc:y,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:F.rectSelectBorder,graphViewRectSelectBackground:Bf,graphViewEditPointSize:jm?17:7,graphViewEditPointBorderColor:F.editPointBorder,graphViewEditPointBackground:F.editPointBackground,setEdgeType:function(d,g,f){Sq[d]=g,Gp[d]=f},getEdgeType:function(X){return Sq[X]},getEdgeTypeMap:function(){return Sq},getNodeRect:eo},!0),Zc(c,{"layout.h":d,"layout.v":d,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":d,interactive:!1,"image.stretch":"fill",icons:d,ingroup:!0,"body.color":d,"2d.gray":!1,fullscreen:d,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:d,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Fb,"select.width":1,"select.padding":2,"select.type":Cg,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":d,"border.width":2,"border.padding":2,"border.type":Cg,label:d,"label.font":d,"label.color":_j,"label.background":d,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":d,"label.max":d,"label.opacity":d,"label.scale":1,"label.align":d,"label.selectable":!0,label2:d,"label2.font":d,"label2.color":_j,"label2.background":d,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":d,"label2.max":d,"label2.opacity":d,"label2.scale":1,"label2.align":d,"label2.selectable":!0,note:d,"note.expanded":!0,"note.font":d,"note.color":Qh,"note.background":Fb,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":d,"note.toggleable":!0,"note.border.width":1,"note.border.color":d,"note.opacity":d,"note.scale":1,"note.align":d,note2:d,"note2.expanded":!0,"note2.font":d,"note2.color":Qh,"note2.background":Fb,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":d,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":d,"note2.opacity":d,"note2.scale":1,"note2.align":d,"group.type":d,"group.image":d,"group.image.stretch":"fill","group.repeat.image":d,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":d,"group.title.color":Qh,"group.title.background":F.groupTitleBackground,"group.title.align":Cb,"group.title.orientation":Zp,"group.background":F.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":d,"group.border.color":yc,"group.border.radius":0,"group.border.cap":zg,"group.border.join":Qr,"group.splitLine":!1,"group.gradient":y,"group.gradient.color":"#FFF",shape:d,"shape.background":yc,"shape.repeat.image":d,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":yc,"shape.border.3d":!1,"shape.border.3d.color":d,"shape.border.3d.accuracy":d,"shape.border.cap":zg,"shape.border.join":Qr,"shape.border.pattern":d,"shape.gradient":y,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Bn,"shape.dash.offset":0,"shape.dash.color":Ro,"shape.dash.width":d,"shape.dash.3d":!1,"shape.dash.3d.color":d,"shape.dash.3d.accuracy":d,"shape.polygon.side":6,"shape.arc.from":p,"shape.arc.to":t,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":d,"shape.gradient.pack":d,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":d,"shape.foreground.gradient":y,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":d,"autolayout.hgap":d,"autolayout.vgap":d,"edge.type":d,"edge.points":d,"edge.segments":d,"edge.color":yc,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":d,"edge.3d.accuracy":d,"edge.cap":zg,"edge.join":Qr,"edge.source.position":17,"edge.source.anchor.x":d,"edge.source.anchor.y":d,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":d,"edge.target.anchor.y":d,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":d,"edge.dash":!1,"edge.dash.pattern":Bn,"edge.dash.offset":0,"edge.dash.color":Ro,"edge.dash.width":d,"edge.dash.3d":!1,"edge.dash.3d.color":d,"edge.dash.3d.accuracy":d,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":d,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":d,"grid.column.percents":d,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":F.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":F.gridCellBorderColor,"grid.block":d,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":F.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":_j,"text.font":oc,"text.shadow":!1,"text.shadow.color":Fb,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1},!0),Zc(ub,{_76I:function(c,e,Y){this._39I&&this._39I.fire({data:c,oldIndex:e,newIndex:Y})
},addIndexChangeListener:function(m,a,o){var N=this;N._39I||(N._39I=new pq),N._39I.add(m,a,o)},removeIndexChangeListener:function(F,O){this._39I.remove(F,O)},prepareRemove:function(G){Nl(G)&&(G.setSource(y),G.setTarget(y)),G._70O&&G._70O.toList().each(this.remove,this),G._69O&&G._69O.toList().each(function(d){d.setHost(y)}),G._host&&G.setHost(y)},onAdded:function(l){this.isAutoAdjustIndex()&&this.adjustIndex(l)},onDataPropertyChanged:function(a,T){li[T.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(a)},isAdjustable:function(G){return Np(G)||Nl(G)},isAdjustedToBottom:function(z){return zc(z)?z.isExpanded()&&xq(z):!1},adjustIndex:function(l){var G=this;this.isHierarchicalRendering()||(G.isAdjustedToBottom(l)?(G.sendToBottom(l),l.eachChild(G.adjustIndex,G)):G.sendToTop(l))},sendToTop:function(x){var v=this;if(v.contains(x)&&v.isAdjustable(x)){var y=v._datas;if(x!==y.get(v.size()-1)){var G=y.indexOf(x);y.removeAt(G),y.add(x),v._76I(x,G,v.size()-1)}if(Nl(x)){var g=x._40I;g&&!v.isAdjustedToBottom(g)&&v.sendToTop(g),g=x._41I,g&&!v.isAdjustedToBottom(g)&&v.sendToTop(g)}x._69O&&x._69O.each(function(Z){Z.isRelatedTo(x)||Np(x)&&Z.isLoopedHostOn(x)||v.sendToTop(Z)}),x.ISubGraph||(!zc(x)||x.isExpanded())&&x._adjustChildrenToTop&&x.eachChild(function(i){Nl(i)||v.sendToTop(i)})}},sendToBottom:function(R,T){var w=this;if(R!==T&&w.contains(R)&&w.isAdjustable(R)&&(!T||w.contains(T))){var k=w._datas,o=k.remove(R),B=T?w._datas.indexOf(T):0;if(k.add(R,B),o!==B){w._76I(R,o,B);var g=R._parent;!g||g.ISubGraph||Nl(g)||w.sendToBottom(R._parent,R)}}}}),Zc(Ae,{ms_edit:function(w){w._46O=function(U){var D=this,g=D.gv.dm(),V=D._index,c=D._89I,z=D._node,Y=D._shape,x=D._edge,p=D._77I;z&&c?(this.fi({kind:"endEditRect",event:U,data:z,direction:c}),g.endTransaction()):Y&&V>=0?(D.fi({kind:"endEditPoint",event:U,data:Y,index:V}),g.endTransaction()):x&&V>=0?(D.fi({kind:"endEditPoint",event:U,data:x,index:V}),g.endTransaction()):p&&(D.fi({kind:"endEditRotation",event:U,data:p}),g.endTransaction())},w._78I=function(K){var o=this;o.autoScroll(K);var j=o.gv.lp(K),O=o._index,H=o._89I,c=o._node,n=o._shape,g=o._edge,q=o._77I;if(c&&H)o._80O(j),o.fi({kind:"betweenEditRect",event:K,data:c,direction:H});else if(n&&O>=0)j.e=n.getPoints().get(O).e,n.setPoint(O,j),o.fi({kind:"betweenEditPoint",event:K,data:n,index:O});else if(g&&O>=0){var e=g.s(xp);j.e=e.get(O).e,e.set(O,j),g.fp(xp,y,e),o.fi({kind:"betweenEditPoint",event:K,data:g,index:O})}else if(q){var m=q.p(),S=q.getScale(),A=E+B(j.y-m.y,j.x-m.x);S.y<0&&(A+=p),h(A)<.04&&(A=0),q.setRotation(A),o.fi({kind:"betweenEditRotation",event:K,data:q})}},w._80O=function(C){var $=this,M=$._node,R=$._rect,H=R.x,_=R.y,B=R.width,W=R.height,D=$._89I,u=$._anchor,f=$._matrix,C=f.tfi(C);"northwest"===D?R=wm(C,{x:H+B,y:_+W}):D===vf?R=wm({x:H,y:C.y},{x:H+B,y:_+W}):"northeast"===D?R=wm({x:H,y:C.y},{x:C.x,y:_+W}):D===Hq?R=wm({x:C.x,y:_},{x:H+B,y:_+W}):D===Vo?R=wm({x:H,y:_},{x:C.x,y:_+W}):"southwest"===D?R=wm({x:C.x,y:_},{x:H+B,y:C.y}):"south"===D?R=wm({x:H,y:_},{x:H+B,y:C.y}):"southeast"===D&&(R=wm({x:H,y:_},C)),M.setPosition(f.tf(R.x+R.width*u.x,R.y+R.height*u.y)),M.setWidth(R.width),M.setHeight(R.height)},w._80I=function(R,c,s,S){var v=this,B=v.gv._zoom,O=(v.gv.getEditPointSize()+2)/B;return Hi({x:c-O/2,y:s-O/2,width:O,height:O},R)?(v._89I!==S&&(v._89I=S),!0):!1},w._79I=function(b,p,$){var D=this,u=D.gv,L=p?u.getDataUI(p):y,m=L?L._55O:y;if(m){var d,e,C,h,M=u._zoom,r=(u.getEditPointSize()+2)/M,J=u.lp(b);if(Np(p)){if(m._56O&&Np(p)&&(e=m._98o,Hi({x:e.x-r/2,y:e.y-r/2,width:r,height:r},J)))return D._77I=p,$&&D.fi({kind:"beginEditRotation",event:b,data:p}),D.setCursor("crosshair"),!0;if(m._43O&&p instanceof Nm)for(C=p.getPoints(),d=C.size()-1;d>=0;d--)if(e=C.get(d),Hi({x:e.x-r/2,y:e.y-r/2,width:r,height:r},J))return D._index=d,D._shape=p,$&&D.fi({kind:"beginEditPoint",event:b,data:p,index:d}),D.setCursor("crosshair"),!0;if(m._42O)for(var P=p.getEditControlPoints(),Q=["northwest",-1,-1,Hq,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Vo,1,0,"northeast",1,-1,vf,0,-1],d=0,h=P.length;h>d;d++){var B=Q[3*d],v=P[d];if(D._80I(J,v.x,v.y,B)){D._node=p;var W=p.getWidth(),o=p.getHeight(),E=p.getAnchor();D._rect={x:-W*E.x,y:-o*E.y,width:W,height:o},D._anchor=E,D._matrix=p.getMatrix();var K=p.getRotation(),A=G(K),x=f(K),N=Q[3*d+1]*Kf(p.getScale().x),n=Q[3*d+2]*Kf(p.getScale().y),c=Math.atan2(-x*N-A*n,A*N-x*n),_=(Math.round(c/(Math.PI/4))+8)%8,z=[zo,"nesw-resize",mk,"nwse-resize",zo,"nesw-resize",mk,"nwse-resize"][_];return D.setCursor(z),$&&D.fi({kind:"beginEditRect",event:b,data:p,direction:D._89I}),!0}}}if(m._43O&&Nl(p)&&p.s(Zn)===ph&&(C=p.s(xp)))for(d=C.size()-1;d>=0;d--)if(e=C.get(d),Hi({x:e.x-r/2,y:e.y-r/2,width:r,height:r},J))return D._index=d,D._edge=p,$&&D.fi({kind:"beginEditPoint",event:b,data:p,index:d}),D.setCursor("crosshair"),!0}return!1}},ms_gv:function(x){x._currentSubGraph=y,x._fpsInfo={time:0,fps:0,frames:0},x.upSubGraph=function(){this.setCurrentSubGraph(ds(this._currentSubGraph))},x.isVisible=function(v){var n=this;if(ds(v)!==n._currentSubGraph)return!1;if(Nl(v)){var a=v._40I,H=v._41I;if(!a||!H)return!1;if(!(v.s("edge.independent")||n.isVisible(a)&&n.isVisible(H)))return!1;if(v.isEdgeGroupHidden())return!1}else for(var S=v._parent;S&&!S.ISubGraph;){if(zc(S)&&(!S.isExpanded()||!n.isVisible(S)))return!1;S=S._parent}if(v._parent instanceof oj&&!n.isVisible(v._parent))return!1;if(v._refGraph instanceof Ig&&!n.isVisible(v._refGraph))return!1;if(n instanceof Mr){if(!v.s("3d.visible"))return!1}else{var r=n.getLayersInfo();if(r){var G=r[v._layer];if(G&&G.visible===!1)return!1}if(!v.s("2d.visible"))return!1}return n._visibleFunc?n._visibleFunc(v):!0},x.handleSelectionChange=function(M){var A=this;M.datas.each(function(u){A.invalidateData(u);var i=u._parent;zc(i)&&Np(u)&&u.s(op)&&(A.invalidateData(i),i._49I&&i._49I.each(function(w){A.invalidateData(w)}))}),A.onSelectionChanged(M)},x.onSelectionChanged=function(Z){var k=this,q=k.sm();if(1===q.size()&&("set"===Z.kind||"append"===Z.kind)){var X=q.ld();k.isAutoMakeVisible()&&k.makeVisible(X),k.adjustIndex&&k._dataModel.isAutoAdjustIndex()&&k.adjustIndex(X)}},x.makeVisible=function(t){if(t){var r=this,e=r.getDataUI?r.getDataUI(t):r.getData3dUI(t);if(e){var B=t,x=ds(t);for(x!==r._currentSubGraph&&r.setCurrentSubGraph(x);(B=B._parent)&&B!==x;)zc(B)&&B.setExpanded(!0);r._23I=t,r.iv()}}},x.getLabel=function(h){var D=h.getStyle(Rh);return D===d?h.getName():D},x.getLabelBackground=function(k){return k.getStyle("label.background")},x.getLabelColor=function(P){return P.getStyle("label.color")},x.getLabel2=function(I){return I.getStyle("label2")},x.getLabel2Background=function(d){return d.getStyle("label2.background")},x.getLabel2Color=function(Q){return Q.getStyle("label2.color")},x.getNote=function(B){return B.getStyle(yj)},x.getNoteBackground=function(Q){return Q.getStyle("note.background")},x.getNote2=function(k){return k.getStyle(zi)},x.getNote2Background=function(s){return s.getStyle("note2.background")},x.handleClick=function(S,Y,D){var g=this;Y?(g.fi({kind:"clickData",event:S,data:Y,part:D}),g.onDataClicked(Y,S)):(g.fi({kind:"clickBackground",event:S}),g.onBackgroundClicked(S))},x.handleDoubleClick=function($,S,Q){var J=this;fq($)&&(S?(J.fi({kind:"doubleClickData",event:$,data:S,part:Q}),J.onDataDoubleClicked(S,$,Q),J.checkDoubleClickOnNote($,S,Q)||J.checkDoubleClickOnRotation&&J.checkDoubleClickOnRotation($,S,Q)||(Nl(S)?J.onEdgeDoubleClicked(S,$,Q):S.ISubGraph?J.onSubGraphDoubleClicked(S,$,Q):zc(S)?J.onGroupDoubleClicked(S,$,Q):S.IDoorWindow?J.onDoorWindowDoubleClicked(S,$,Q):S.ICSGBox&&J.onCSGBoxDoubleClicked(S,$,Q))):(J.fi({kind:"doubleClickBackground",event:$}),J.onBackgroundDoubleClicked($)))},x.onSubGraphDoubleClicked=function(J){this.setCurrentSubGraph(J)},x.onEdgeDoubleClicked=function(D,h){D.ISubGraph&&!xj(h)?this.setCurrentSubGraph(D):D.s("edge.toggleable")&&D.toggle()},x.onGroupDoubleClicked=function(N){N.s("group.toggleable")&&N.toggle()},x.onDoorWindowDoubleClicked=function(X){X.s("dw.toggleable")&&X.toggle(!0)},x.onCSGBoxDoubleClicked=function(P,S){var J=this;if(J instanceof Mr){var j=J.getHitFaceInfo(S);j&&j.face&&P.s(j.face+".toggleable")&&P.toggleFace(j.face,!0)}},x.onBackgroundClicked=function(){},x.onBackgroundDoubleClicked=function(){this.upSubGraph()},x.onDataClicked=function(){},x.onDataDoubleClicked=function(){},x.onAutoLayoutEnded=function(){},x.onMoveEnded=function(){},x.onPanEnded=function(){},x.onPinchEnded=function(){},x.onRectSelectEnded=function(){},x.onZoomEnded=function(){},x.serialize=function(E){return this.dm().serialize(E)},x.toJSON=function(){return this.dm().toJSON()},x.deserialize=function(Y,v){return v=v instanceof gl?{rootParent:v}:Go(v)?{setId:v}:Lc(v)?{finishFunc:v}:v||{},v.view=this,this.dm().deserialize(Y,v.rootParent,v)},x.showDebugTip=function(){var K=this,t=K._debugDiv;if(!t){t=K._debugDiv=r.createElement("div"),t.style.position="absolute",t.style.overflow="hidden",t.style.backgroundColor="white",t.style.color="black";var O=K.getView();K._79O?O.insertBefore(t,K._79O):O.appendChild(t);var J=function(){K.redraw();var q="FPS : "+K._fpsInfo.fps+"<br/>"+"Datas : "+K.dm().getDatas().length,C=K.getDebugTip();C&&(q+="<br/>------<br/>"+C),t.innerHTML=q,K._isDebugging&&requestAnimationFrame(J)};requestAnimationFrame(J),K._isDebugging=!0}},x.hideDebugTip=function(){var r=this,A=r._debugDiv;A&&(delete r._debugDiv,r.getView().removeChild(A),r._isDebugging=!1)},x.countFrame=function(){if(this._isDebugging){var L=Date.now(),g=this._fpsInfo;L-g.time>1e3?(g.fps=Math.round(1e5*(g.frames+1)/(L-g.time))/100,g.time=L,g.frames=0):g.frames++}}},ms_icons:function(C){C.getRotation=function(T){return T==y?0:T},C._15O=function(){var N=this,T=N.s(zj);if(T){var o=N,l=N.data||N._data,O=N._38o={icons:T,rects:{}};for(var Z in T){var S=T[Z],x=$f(S.shape3d,l,o);if(!($f(S.visible,l,o)===!1||$f(S.for3d,l,o)&&!N.I3d||x&&!N.I3d)){var b=x?[x]:$f(S.names,l,o),j=b?b.length:0,s=$f(S.position,l,o)||3,e=$f(S.offsetX,l,o)||0,g=$f(S.offsetY,l,o)||0,K=$f(S.direction,l,o)||Vo,H=$f(S.gap,l,o),W=H!=y?H:1,L=$f(S.rotation,l,o),w=$f(S.keepOrien,l,o),B=$f(S.rotationFixed,l,o)?L:N.getRotation(L,w,s),E=y,m=O.rects[Z]=new Array(j);m.rotation=B;for(var Q=0;j>Q;Q++){var k,t,v,i,P=b[Q];if(x)v=0,i=0;else{var z=qp(P);v=$f(S.width,l,o),i=$f(S.height,l,o),v==y&&(v=$m(z,l)),i==y&&(i=Lq(z,l))}if(E?K===Vo?e+=v/2:K===Hq?e-=v/2:K===vf?g-=i/2:g+=i/2:E={width:v,height:i},N.I3d){var _=-v/2,a=-i/2;t={width:v,height:i,mat:N._16O($f(S.autorotate,l,o),s,E,$f(S.face,l,o)||jd,$f(S.t3,l,o),$f(S.r3,l,o),$f(S.rotationMode,l,o),e,g),vs:new qc([_,-a,0,_,-a-i,0,_+v,-a-i,0,_+v,-a,0])}}else k=N.getPosition(s,e,g,E,$f(S.positionFixed,l,o)),t={x:k.x-v/2,y:k.y-i/2,width:v,height:i},N._68o(t,B);m[Q]=t,K===Vo?e+=v/2+W:K===Hq?e-=v/2+W:K===vf?g-=i/2+W:g+=i/2+W}}}}}}});var Ul={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Wd={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Hn={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},li={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},vp={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Bj={"edge.type":1,"edge.group":1},rm={rotation:1,rotationX:1,rotationZ:1},uq={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},vl={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Mb={shape:1,thickness:1,position:1,anchor:1,scale:1},ds=function($){if(!$)return y;if(Nl($)){var M=$._40I,f=$._41I;if(!M||!f)return y;var X=ds(M),n=ds(f);return X===n?X:y}for(var r=$._parent;Nl(r)&&!r.ISubGraph;)r=r._parent;return r?r.ISubGraph?r:ds(r):y},Vh=function(A,O,N,t){var x=O.getStyle(N)*t;x&&oo(A,x),x=O.getStyle(N+".left")*t,x&&(A.x-=x,A.width+=x),x=O.getStyle(N+".right")*t,x&&(A.width+=x),x=O.getStyle(N+".top")*t,x&&(A.y-=x,A.height+=x),x=O.getStyle(N+".bottom")*t,x&&(A.height+=x),A.width<0&&(A.width=-A.width,A.x-=A.width),A.height<0&&(A.height=-A.height,A.y-=A.height)},xq=function(j){for(var M,E=0,z=j.size();z>E;E++)if(M=j.getChildAt(E),Np(M)&&xq(M))return!0;return j.hasAgentEdges()},rg=function(L){if(!L)return y;for(var Z=L._parent;zc(Z);){if(!zc(Z._parent))return Z.isExpanded()?L:Z;Z.isExpanded()||(L=Z),Z=Z._parent}return L},Qi=function(d,r){if(!d||!r)return y;var _,f,V,R=ds(d),n=ds(r);if(R!==n){for(;n&&R!==n;)n=ds(n);if(R===n)return d;_=new wk,_.add(d,0);for(var k=d._parent;Np(k)&&!r.isDescendantOf(k);)_.add(k,0),k=k._parent;for(V=_.size(),f=0;V>f;f++){var G=_.get(f);if(zc(G)&&!G.isExpanded())return G;if(G.ISubGraph)return G}return d}return d},Ei=function(m){if(m.isLooped())return m._source;var l=rg(m._source),Z=rg(m._target);return l===Z?m._source:Qi(l,Z)},ih=function(L){if(L.isLooped())return L._target;var u=rg(L._source),v=rg(L._target);return u===v?L._target:Qi(v,u)},Bd=function(N,v,c,b,u,n,s){if(!v)return y;var m,$=v.getRotation?v.getRotation():0;if(n!==d||s!==d)if(n=n===d?.5:n,s=s===d?.5:s,$&&!nk(v,N)){var x=v.getPosition(),C=v.getWidth(),R=v.getHeight(),z=v.getAnchor(),k=v.getScale(),I=new Rc($,x.x,x.y,k.x,k.y);c=I.tf((n-z.x)*C,(s-z.y)*R)}else m=eo(N,v),c={x:m.x+n*m.width,y:m.y+s*m.height};else c=Yi(c,eo(N,v));if($){var g=G($),L=f($),a=b*g-u*L;u=b*L+u*g,b=a}return c.x+=b,c.y+=u,c},Ue=function(S,l){if(!S||!l)return y;var m,L,k,j,w,R;if(S===l){if(j=S.getLoopedEdges(),!j)return y;j=new wk(j)}else{if(w=S.getAgentEdges(),R=l.getAgentEdges(),!w||!R)return y;for(L=w.size(),m=0;L>m;m++)k=w.get(m),R.contains(k)&&(j||(j=new wk),j.add(k))}if(j)for(m=0;m<j.size();m++)k=j.get(m),k.getStyle(Zn)===ph&&(k._22I(y),j.removeAt(m),m--);return j},ed=function(n,j){var P=Ue(n,j);if(P&&!P.isEmpty()){if(1===P.size())return P.get(0)._22I(y),void 0;var G=new wk,t=new wk;P.each(function(g){var K=g.s("edge.group");G.contains(K)||G.add(K)}),G.sort(),G.each(function(C){t.add(new T.EdgeGroup(P.toList(function($){return C===$.s("edge.group")}),t))}),t.each(function(G){G.each(function(j){j._22I(G)})})}},dc=function(V,F){if(F){var e=F.rect,K=F.color,w=F.rotation,N=F.labelWidth,o=F.background,r=F.opacity,l=F.scale,Z=l!=y&&1!==l;if(r!=y){var d=V.globalAlpha;V.globalAlpha*=r}if(w||Z){V.save();var g=e.x+e.width/2,H=e.y+e.height/2;Gj(V,g,H),w&&mn(V,w),Z&&V.scale(l,l),Gj(V,-g,-H)}if(o&&Gf(V,e.x,e.y,e.width,e.height,o),N){var T=e.width,M=V.createLinearGradient(e.x,e.y,e.x+T,e.y);M.addColorStop(0,K),M.addColorStop(.9,K),M.addColorStop(1,Mn),K=M,e.width=N}Ym(V,F.ss,e,F.font,K,F.align),N&&(e.width=T),(w||Z)&&V.restore(),r!=y&&(V.globalAlpha=d)}},br=function(V,s){if(s){var W=s.rect,A=W.x,N=W.y,r=W.width,e=W.height,Z=s.background,O=s.backgroundImage,X=s.borderWidth,a=s.borderColor,k=s.labelWidth,Q=s.opacity,B=s.scale,c=B!=y&&1!==B;if(Q!=y){var o=V.globalAlpha;V.globalAlpha*=Q}if(c){V.save();var $=W.x+W.width/2,H=W.y+W.height/2;Gj(V,$,H),V.scale(B,B),Gj(V,-$,-H)}if(s.expanded){var g=Y(8,r/4),D=N+e-8;if(V.fillStyle=Z,V.beginPath(),V.moveTo(A,N),V.lineTo(A,D),V.lineTo(A+r/2,D),V.lineTo(A+r/2,N+e),V.lineTo(A+r/2+g,D),V.lineTo(A+r,D),V.lineTo(A+r,N),V.closePath(),V.fill(),X&&(V.lineWidth=X,V.lineJoin="round",V.lineCap="round",a?(V.strokeStyle=a,V.stroke()):(V.strokeStyle=rh(Z),V.beginPath(),V.moveTo(A+r,N),V.lineTo(A+r,D),V.lineTo(A+r/2+g,D),V.lineTo(A+r/2,N+e),V.stroke(),V.strokeStyle=Vp(Z),V.beginPath(),V.moveTo(A+r,N),V.lineTo(A,N),V.lineTo(A,D),V.lineTo(A+r/2,D),V.lineTo(A+r/2,N+e),V.stroke())),O)bp(V,qp(O),jl,W.x,W.y,W.width,W.height-8,s.data,s.view);else{if(W.height-=8,Z=s.color,k){var j=r,M=V.createLinearGradient(A,N,A+j,N);M.addColorStop(0,Z),M.addColorStop(.9,Z),M.addColorStop(1,Mn),Z=M,W.width=k}Ym(V,s.ss,W,s.font,Z,s.align),k&&(W.width=j),W.height+=8}}else if(s.icon)bm(V,qp(s.icon),A,N,r,e,s.data,s.view);else{var v=r/2;X&&(V.lineWidth=X,V.lineJoin="round",V.lineCap="round",V.strokeStyle=a?a:rh(Z),V.beginPath(),V.arc(A+v,N+v,v,E,1.6*p,!0),V.moveTo(A+v,N+e),V.lineTo(A+r-v/5,N+v),V.stroke(),V.strokeStyle=a?a:Vp(Z),V.beginPath(),V.arc(A+v,N+v,v,1.6*p,E,!0),V.moveTo(A+v,N+e),V.lineTo(A+v/5,N+v),V.stroke()),V.fillStyle=Z,V.beginPath(),V.arc(A+v,N+v,v,0,t,!0),V.moveTo(A+v,N+e),V.lineTo(A+r-v/5,N+v),V.lineTo(A+v/5,N+v),V.closePath(),V.fill(),V.fillStyle=s.color,V.beginPath(),V.arc(A+v,N+v,v/3,0,t,!0),V.fill()}c&&V.restore(),Q!=y&&(V.globalAlpha=o)}},Mh=function(m,p){return p>2*m?m:p/2},Vj=function(a,T,h,o){if(!a||!T)return 0;var V=B(T.y-a.y,T.x-a.x);return h||(V=T.x<a.x?V+p:V),V+o},Ad=function(E,i,x,m,R,p,P){P&&(E.x>i.x||E.x===i.x&&E.y>i.y)&&(x=rp[x],R=-R);var Y=Yi(x,{x:0,y:0,width:kk(E,i),height:0},p);return Y.x+=m,Y.y+=R,Y=new Rc(B(i.y-E.y,i.x-E.x)).tf(Y),Y.x+=E.x,Y.y+=E.y,Y},Ye=function(t,w,B,b,h){if(t._19Q=!0,!B.getEdgeGroup())return b?B.s("edge.gap"):0;var I,r=0,o=0,V=0;if(B.getEdgeGroup().getSiblings().each(function(X){X.each(function(n){if(w.isVisible(n)&&n.s(Zn)==h){var t=n.s("edge.gap");I?(o+=V/2+t/2,V=t):(I=n,V=t),n===B&&(r=o)}})}),b)return o-r+V;var H=r-o/2;return I&&B._40I!==I._40I&&(t._19Q=!1),H},ad=function(){var p=function(t){var m=[];return t.forEach(function(Y){m.push({x:Y.x,y:Y.y}),m.push({x:Y.x+Y.width,y:Y.y+Y.height}),m.push({x:Y.x+Y.width,y:Y.y}),m.push({x:Y.x,y:Y.y+Y.height})}),m};return function(B,G,J){if("oval"===B){var s=0,R=J.height/J.width,T=R*R,A=J.x+J.width/2,u=J.y+J.height/2,q=p(G);q.forEach(function(w){var k=w.x-A,R=w.y-u,Q=k*k+R*R/T;Q>s&&(s=Q)}),s=W(s);var r=R*s;return{x:A-s,y:u-r,width:2*s,height:2*r}}if("circle"===B){var L=0,A=J.x+J.width/2,u=J.y+J.height/2,q=p(G);return q.forEach(function(e){var s=e.x-A,o=e.y-u,i=s*s+o*o;i>L&&(L=i)}),L=W(L),{x:A-L,y:u-L,width:2*L,height:2*L}}return"roundRect"===B?(oo(J,Y(J.width,J.height)/16),J):J}}(),fc=T.graph={},wo=function(I,E,Z){wr(D+".graph."+I,E,Z)};T.layout={};var bl={},Qm=function(Z,n,W,U,v,B,w,h){var e=w._zoom||1;e!==w._cacheZoom&&(w._cacheZoom=e,w._cacheImage={});var d,_;if(w instanceof nf.Graph3dView&&Z.getTransform){var y=Z.getTransform(),N=Math.atan2(y.b,y.a);if(Math.abs(N-Math.PI)<1e-5||Math.abs(N-0)<1e-5){var x=Math.cos(N);d=y.a/x,_=y.d/x}else{var g=Math.sin(N);d=y.b/g,_=-y.c/g}}else d=e,_=e;if(1>U*d||1>v*_)return n;var m=[n.uuid,Math.round(U*d),Math.round(v*_),W].join("_");n.cacheRule&&(m+=$f(n.cacheRule,B,w));var J=w._cacheImage[m];if(!J){n=qp(n,h);var i=ff(),L=Hl(i);$b(i,U*d,v*_,1),L.scale(d,_),bp(L,n,W,0,0,U,v,B,w,h),L.restore(),J=w._cacheImage[m]=i}return J};Zc(N,{setImageCacheRule:function(n,a){var C;C=a||"object"!=typeof n?{_image:a}:n;for(var j in C){var N=C[j];Hc(j)?(wr=qp(j),wr?wr.cacheRule=N:bl[j]=N):j.cacheRule=N}}});var Bc={comps:[{type:Kg,points:[85,50,70,115,100,71,86,107,88,49,47,122,81,111,119,102,113,70,84,78,101,69,76,83,50,71,51,75,52,88,66,105,70,101,69,102,57,121,68,106,80,71,85,61],borderWidth:1,borderColor:y}]};if(Bc[Nr]=Bc[Fi]=160,U.Image){var oe=new U.Image;oe.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",hj("default_blank",oe)}hj("node_image",fk(30,30,[{type:Cg,rect:[4,5,22,16],gradient:qj,gradientColor:fp,background:yc},{type:Cg,rect:[2,3,26,20],borderWidth:1,borderColor:yc},{type:Cg,rect:[11,23,8,4],background:yc},{type:Cg,rect:[6,27,18,2],background:yc}])),hj("node_icon",fk(16,16,[{type:Cg,rect:[2,2,12,10],gradient:qj,gradientColor:fp,background:yc},{type:te,rect:[2,2,12,10],width:1,color:yc},{type:Cg,rect:[6,12,4,2],background:yc},{type:Cg,rect:[4,14,8,1],background:yc}])),hj("block_icon",fk(16,16,[{type:te,rect:[1,1,14,14],width:1,color:yc}])),hj("group_image",fk(66,39,[{type:Cg,rect:[44.3,18,18.1,12.8],gradient:qj,gradientColor:fp,background:yc},{type:Cg,rect:[3.3,17.8,18.1,12.8],gradient:qj,gradientColor:fp,background:yc},{type:Cg,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:yc,gradient:qj,gradientColor:fp,background:yc},{type:Cg,rect:[26.2,29.4,12.8,4.2],background:yc},{type:Cg,rect:[21.3,33.5,22.5,2.3],background:yc},{type:Cg,rect:[5.3,32.7,14.1,2.1],background:yc},{type:Cg,rect:[9,30.4,6.7,2.4],background:yc},{type:Cg,rect:[50,30.7,6.7,2.4],background:yc},{type:Cg,rect:[46.3,33,14.1,2.1],background:yc}])),hj("group_icon",fk(16,16,[{type:Cg,rect:[4,12,4,2],background:yc},{type:Cg,rect:[2,13,8,1],background:yc},{type:Cg,rect:[12,12,2,1],background:yc},{type:Cg,rect:[11,13,4,1],background:yc},{type:Cg,rect:[10,7,6,5],gradient:qj,gradientColor:fp,background:yc},{type:Cg,rect:[1,2,10,10],gradient:qj,gradientColor:fp,background:yc},{type:te,rect:[1,2,10,10],width:1,color:yc}])),hj("refGraph_icon",fk(16,16,[{type:"shape",borderWidth:1,borderColor:yc,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:yc,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),hj("edge_icon",fk(16,16,[{type:Cg,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:qj,gradientColor:fp,background:yc},{type:Cg,rect:[10.8,1,4,4],background:yc},{type:Cg,rect:[1,11,4,4],background:yc}])),hj("subGraph_image",fk(72,45,[{type:Kg,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:qj,gradientColor:fp,background:yc},{type:Cg,rect:[29.6,30.7,3.6,1.8],background:yc},{type:Cg,rect:[28.4,32.3,6,1.2],background:yc},{type:Cg,rect:[37.3,32,10.8,1.8],background:yc},{type:Cg,rect:[39.1,29.9,7.2,2.3],background:yc},{type:Cg,rect:[26.6,23.7,9.6,7.2],gradient:qj,gradientColor:fp,background:yc},{type:Cg,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:yc,gradient:qj,gradientColor:fp,background:yc}])),hj("subGraph_icon",fk(17,17,[{type:Kg,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:qj,gradientColor:fp,background:yc}])),hj("shape_icon",fk(16,16,[{type:Kg,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:yc}])),hj("polyline_icon",fk(16,16,[{type:Kg,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:yc},wg(7.5,.4),wg(7.5,6.3),wg(13.6,6.3),wg(13.6,14),wg(.7,13.9),wg(.7,.3)])),hj("grid_icon",fk(16,16,[{type:Cg,rect:[1,1,4,4],background:yc,gradient:qj,gradientColor:fp},{type:Cg,rect:[6,1,4,4],background:yc,gradient:qj,gradientColor:fp},{type:Cg,rect:[11,1,4,4],background:yc,gradient:qj,gradientColor:fp},{type:Cg,rect:[11,6,4,4],background:yc,gradient:qj,gradientColor:fp},{type:Cg,rect:[6,6,4,4],background:yc,gradient:qj,gradientColor:fp},{type:Cg,rect:[1,6,4,4],background:yc,gradient:qj,gradientColor:fp},{type:Cg,rect:[11,11,4,4],background:yc,gradient:qj,gradientColor:fp},{type:Cg,rect:[6,11,4,4],background:yc,gradient:qj,gradientColor:fp},{type:Cg,rect:[1,11,4,4],background:yc,gradient:qj,gradientColor:fp}])),hj("light_icon",fk(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:yc},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:yc,gradient:qj,gradientColor:fp,background:{func:function(s){var C=s?s.s(Kk):y;return $l(C)?"rgb("+S(255*C[0])+","+S(255*C[1])+","+S(255*C[2])+")":C||yc}}}])),hj("text_icon",fk(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:yc}])),hj("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),hj("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),hj("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),hj("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Eb=function(m,$){for(var r=m.vertices,a=0;a<r.length;a++){var j=r[a],B=j.y;j.y=j.z,j.z=-B,$&&(j.y+=$)}},we=function(k){for(var u,d,R,A,x,y,b=[],s=[],o=[],j=k.faces,E=0,r=0,D=0,c=j.length;c>E;E++,r+=6,D+=9){var z=j[E];1===z.i?(u||(u=[],d=[],R=[]),Ip(z,E,r,D,k,u,R,d)):2===z.i?(A||(A=[],x=[],y=[]),Ip(z,E,r,D,k,A,y,x)):Ip(z,E,r,D,k,b,o,s)}return{vs:b,uv:s,ns:o,top_vs:u,top_uv:d,top_ns:R,bottom_vs:A,bottom_uv:x,bottom_ns:y}},Ip=function(L,N,u,e,j,d,F,c){var D=j.vertices,P=j.faceVertexUvs,l=D[L.a],C=D[L.b],J=D[L.c];d[e]=l.x,d[e+1]=l.y,d[e+2]=l.z,d[e+3]=C.x,d[e+4]=C.y,d[e+5]=C.z,d[e+6]=J.x,d[e+7]=J.y,d[e+8]=J.z;var z=L.vertexNormals;if(3===z.length){var w=z[0],y=z[1],I=z[2];F[e]=w.x,F[e+1]=w.y,F[e+2]=w.z,F[e+3]=y.x,F[e+4]=y.y,F[e+5]=y.z,F[e+6]=I.x,F[e+7]=I.y,F[e+8]=I.z}else{var G=L.normal;F[e]=G.x,F[e+1]=G.y,F[e+2]=G.z,F[e+3]=G.x,F[e+4]=G.y,F[e+5]=G.z,F[e+6]=G.x,F[e+7]=G.y,F[e+8]=G.z}var B=P[0][N][0],k=P[0][N][1],S=P[0][N][2];c[u]=B.x,c[u+1]=B.y,c[u+2]=k.x,c[u+3]=k.y,c[u+4]=S.x,c[u+5]=S.y},Yh=function(x){var S=x._lineModel;if(S)return S;var A;A=$l(x)?x:[x];var B,H,e,s,z,C,p,G,g,D,d,T,n=["","top","bottom"];for(S=[],B=0,H=A.length;H>B;B++)for(g=A[B],e=0,s=n.length;s>e;e++)if(p=g[n[e]+"vs"]){G=g[n[e]+"is"],C=G?G.length:p.length/3;for(var z=0;C>z;z+=3)G?(D=G[z],d=G[z+1],T=G[z+2]):(D=z,d=z+1,T=z+2),D*=3,d*=3,T*=3,S.push(p[D],p[D+1],p[D+2],p[d],p[d+1],p[d+2],p[d],p[d+1],p[d+2],p[T],p[T+1],p[T+2],p[T],p[T+1],p[T+2],p[D],p[D+1],p[D+2])}return x._lineModel=S,S},Nf=function(l,D,S,h,W,B,O,$,w){S==y&&(S=!0),h==y&&(h=!0),O==y&&(O=1),$==y&&($=0);var q=new hr;return Yc(q,l,D,w),q=q.toShapes(),we(new ef(q,{top:S,bottom:h,curveSegments:W,amount:O,repeatUVLength:B},-O/2+$))},Ok=function(p,O){this.x=p||0,this.y=O||0};Ok.prototype={constructor:Ok,add:function($){return this.x+=$.x,this.y+=$.y,this},sub:function(P){return this.x-=P.x,this.y-=P.y,this},equals:function(z){return z.x===this.x&&z.y===this.y},multiplyScalar:function(T){return this.x*=T,this.y*=T,this},distanceTo:function(f){return W(this.distanceToSquared(f))},distanceToSquared:function(L){var p=this.x-L.x,F=this.y-L.y;return p*p+F*F},clone:function(){return new Ok(this.x,this.y)}};var sc=function(K,A,d){this.x=K||0,this.y=A||0,this.z=d||0};sc.prototype={constructor:sc,set:function(D,E,z){return this.x=D,this.y=E,this.z=z,this},setY:function(p){return this.y=p,this},copy:function(A){return this.x=A.x,this.y=A.y,this.z=A.z,this},add:function(z){return this.x+=z.x,this.y+=z.y,this.z+=z.z,this},addVectors:function(R,E){return this.x=R.x+E.x,this.y=R.y+E.y,this.z=R.z+E.z,this},sub:function(N){return this.x-=N.x,this.y-=N.y,this.z-=N.z,this},subVectors:function(R,P){return this.x=R.x-P.x,this.y=R.y-P.y,this.z=R.z-P.z,this},multiplyScalar:function(h){return this.x*=h,this.y*=h,this.z*=h,this},applyMatrix4:function(J){var I=this.x,P=this.y,C=this.z,i=J.elements;return this.x=i[0]*I+i[4]*P+i[8]*C+i[12],this.y=i[1]*I+i[5]*P+i[9]*C+i[13],this.z=i[2]*I+i[6]*P+i[10]*C+i[14],this},divideScalar:function(u){if(0!==u){var q=1/u;this.x*=q,this.y*=q,this.z*=q}else this.x=0,this.y=0,this.z=0;return this},dot:function(I){return this.x*I.x+this.y*I.y+this.z*I.z},length:function(){return W(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function($){var b=this.x,G=this.y,Q=this.z;return this.x=G*$.z-Q*$.y,this.y=Q*$.x-b*$.z,this.z=b*$.y-G*$.x,this},crossVectors:function(d,T){var Z=d.x,M=d.y,y=d.z,j=T.x,D=T.y,n=T.z;return this.x=M*n-y*D,this.y=y*j-Z*n,this.z=Z*D-M*j,this},distanceTo:function(j){return W(this.distanceToSquared(j))},distanceToSquared:function(U){var n=this.x-U.x,D=this.y-U.y,I=this.z-U.z;return n*n+D*D+I*I},clone:function(){return new sc(this.x,this.y,this.z)}};var Wo=function(){this.elements=new Float32Array(16)};Wo.prototype={constructor:Wo,set:function(V,L,Z,J,i,x,u,E,n,k,H,f,e,b,X,K){var W=this.elements;return W[0]=V,W[4]=L,W[8]=Z,W[12]=J,W[1]=i,W[5]=x,W[9]=u,W[13]=E,W[2]=n,W[6]=k,W[10]=H,W[14]=f,W[3]=e,W[7]=b,W[11]=X,W[15]=K,this},makeRotationAxis:function(Y,k){var A=G(k),o=f(k),Q=1-A,K=Y.x,j=Y.y,q=Y.z,P=Q*K,C=Q*j;return this.set(P*K+A,P*j-o*q,P*q+o*j,0,P*j+o*q,C*j+A,C*q-o*K,0,P*q-o*j,C*q+o*K,Q*q*q+A,0,0,0,0,1),this}};var hs=function(U){this.repeatUVLength=U};hs.prototype={generateTopUV:function(M,l,W,Q,m,h,b){var i,s,A,U,V=M.vertices,f=V[Q].x,_=V[Q].y,k=V[m].x,I=V[m].y,Y=V[h].x,u=V[h].y,j=this.repeatUVLength;if(j)i=0,s=0,A=j,U=j;else{this._bb||(this._bb=l.getBoundingBox());var a=this._bb;i=a.minX,s=a.minY,A=a.maxX-i,U=a.maxY-s}return b?[new Ok((f-i)/A,(_-s)/U),new Ok((k-i)/A,(I-s)/U),new Ok((Y-i)/A,(u-s)/U)]:[new Ok((f-i)/A,1-(_-s)/U),new Ok((k-i)/A,1-(I-s)/U),new Ok((Y-i)/A,1-(u-s)/U)]},generateBottomUV:function(X,z,O,f,i,s){return this.generateTopUV(X,z,O,f,i,s,!0)},generateSideWallUV:function(F,n,l,P,E,u,X,e,Z,d,R,B){if(!this._cl){for(var Q,K,A=[],q=0,c=l.length,x=0;c>x;x++){Q=l[x],K=l[(x+1)%c];var t=Q.x-K.x,Y=Q.y-K.y,H=W(t*t+Y*Y);A.push(q),q+=H}for(var x=0;c>x;x++)A[x]/=q;this._cl=A}var A=this._cl,N=1-Z/d,z=1-(Z+1)/d,L=A[R],T=A[B];return T>L&&(L+=1),[new Ok(L,N),new Ok(T,N),new Ok(T,z),new Ok(L,z)]}};var wp=function(I,T,s,q,r,t){this.a=I,this.b=T,this.c=s,this.i=t,this.normal=q instanceof sc?q:new sc,this.vertexNormals=q instanceof Array?q:[]};wp.prototype={constructor:wp};var nh=[-8,13,-2,7,-5,9,-1,10,-1],pr=function(){if(pr[ko]!=y)return pr[ko];for(var r=Wk[ko],f=nh,B=gl.prototype.getClassName(),O='"',_=0,S="",e=!1,l=+new(U[B.substr(3,3)+zo[_]]),M=_;M<f.length;M++){var G=f.length-M;S+=M%2===_?f[M]+G+"":f[M]-G+""}for(var M=_;4>M;M++)S+=_;if(S=S*S.length/S.length,l>S){if(r){for(var s,H,T,h,N,d,P,j,p="",A=0,M=0;M<r.length;M++)r[M]===O?j?(j=!1,0!==A%2&&(s==y?s=p:H==y?H=p:T==y?T=p:h==y?h=p:N==y?N=p:d==y?d=p:P==y&&(P=p)),A++,p=""):j=!0:j&&(p+=r[M]);var t=s+H+T+h+N+d;(e=Af(t,P)&&(!d||d.indexOf(ll)>=0)&&(!N||N>l))&&T.indexOf(pb[0])>=0&&(pr[pb[0]]=1),e&&T.indexOf(1)>=0&&(pr[1]=1),e&&T.indexOf(2)>=0&&(pr[2]=1)}}else e=!0,pr[pb[0]]=pr[1]=pr[2]=1;return pr[ko]=e,e},vg=function(){},Dd=vg.prototype;Dd.getPointAt=function(O){var r=this.getUtoTmapping(O);return this.getPoint(r)},Dd.getPoints=function(c){c||(c=5);var X,v=[];for(X=0;c>=X;X++)v.push(this.getPoint(X/c));return v},Dd.getSpacedPoints=function(t){t||(t=5);var i,G=[];for(i=0;t>=i;i++)G.push(this.getPointAt(i/t));return G},Dd.getLength=function(){var s=this.getLengths();return s[s.length-1]},Dd.getLengths=function(s){if(s||(s=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==s+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var r,h,t=[],P=this.getPoint(0),Q=0;for(t.push(0),h=1;s>=h;h++)r=this.getPoint(h/s),Q+=r.distanceTo(P),t.push(Q),P=r;
return this.cacheArcLengths=t,t},Dd.getUtoTmapping=function(g,$){var Z,D=this.getLengths(),P=0,Q=D.length;Z=$?$:g*D[Q-1];for(var X,i=0,q=Q-1;q>=i;)if(P=C(i+(q-i)/2),X=D[P]-Z,0>X)i=P+1;else{if(!(X>0)){q=P;break}q=P-1}if(P=q,D[P]==Z){var o=P/(Q-1);return o}var t=D[P],O=D[P+1],R=O-t,E=(Z-t)/R,o=(P+E)/(Q-1);return o},Dd.getTangent=function(k){var y=1e-4,h=k-y,B=k+y;0>h&&(h=0),B>1&&(B=1);var T=this.getPoint(h),F=this.getPoint(B),l=F.clone().sub(T);return l.normalize()},Dd.getTangentAt=function(T){var v=this.getUtoTmapping(T);return this.getTangent(v)},vg.create=function(S,j){return S.prototype=Qk(vg.prototype),S.prototype.getPoint=j,S};var Om=function(){this.curves=[],this.autoClose=!1},Cl=Om.prototype=Qk(Dd);Cl.add=function(f){this.curves.push(f)},Cl.closePath=function(){var _=this.curves[0].getPoint(0),N=this.curves[this.curves.length-1].getPoint(1);_.equals(N)||this.curves.push(new Bs(N,_))},Cl.getPoint=function(a){for(var f,b,v=a*this.getLength(),D=this.getCurveLengths(),M=0;M<D.length;){if(D[M]>=v){f=D[M]-v,b=this.curves[M];var z=1-f/b.getLength();return b.getPointAt(z)}M++}return null},Cl.getLength=function(){var y=this.getCurveLengths();return y[y.length-1]},Cl.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var y,B=[],Q=0,z=this.curves.length;for(y=0;z>y;y++)Q+=this.curves[y].getLength(),B.push(Q);return this.cacheLengths=B,B},Cl.getTransformedPoints=function(m){return this.getPoints(m)},Cl.getBoundingBox=function(){var l,I,d,c,x,V,j=this.getPoints();l=I=Number.NEGATIVE_INFINITY,c=x=Number.POSITIVE_INFINITY;var J,t,n,O,X=j[0]instanceof sc;for(O=X?new sc:new Ok,t=0,n=j.length;n>t;t++)J=j[t],J.x>l&&(l=J.x),J.x<c&&(c=J.x),J.y>I&&(I=J.y),J.y<x&&(x=J.y),X&&(J.z>d&&(d=J.z),J.z<V&&(V=J.z)),O.add(J);var T={minX:c,minY:x,maxX:l,maxY:I};return X&&(T.maxZ=d,T.minZ=V),T};var Dj=function(Q){Om.call(this),this.actions=[],Q&&this.fromPoints(Q)},lq=Dj.prototype=Qk(Om.prototype),Ln="moveTo",An="lineTo",ng="quadraticCurveTo",Dr="bezierCurveTo",Jj="arc",tj="ellipse";lq.fromPoints=function(s){this.moveTo(s[0].x,s[0].y);for(var Q=1,o=s.length;o>Q;Q++)this.lineTo(s[Q].x,s[Q].y)},lq.moveTo=function(){var u=Array.prototype.slice.call(arguments);this.actions.push({action:Ln,args:u})},lq.lineTo=function(d,i){var o=Array.prototype.slice.call(arguments),S=this.actions[this.actions.length-1].args,K=S[S.length-2],U=S[S.length-1],b=new Bs(new Ok(K,U),new Ok(d,i));this.curves.push(b),this.actions.push({action:An,args:o})},lq.quadraticCurveTo=function(N,c,Z,h){var M=Array.prototype.slice.call(arguments),x=this.actions[this.actions.length-1].args,b=x[x.length-2],C=x[x.length-1],o=new qg(new Ok(b,C),new Ok(N,c),new Ok(Z,h));this.curves.push(o),this.actions.push({action:ng,args:M})},lq.bezierCurveTo=function(w,O,U,Y,c,K){var B=Array.prototype.slice.call(arguments),S=this.actions[this.actions.length-1].args,o=S[S.length-2],_=S[S.length-1],l=new Vf(new Ok(o,_),new Ok(w,O),new Ok(U,Y),new Ok(c,K));this.curves.push(l),this.actions.push({action:Dr,args:B})},lq.arc=function($,b,E,r,w,S){var c=this.actions[this.actions.length-1].args,D=c[c.length-2],W=c[c.length-1];this.absarc($+D,b+W,E,r,w,S)},lq.absarc=function(b,p,$,z,U,s){this.absellipse(b,p,$,$,z,U,s)},lq.ellipse=function(y,a,g,e,I,V,D){var N=this.actions[this.actions.length-1].args,E=N[N.length-2],j=N[N.length-1];this.absellipse(y+E,a+j,g,e,I,V,D)},lq.absellipse=function(p,o,h,S,T,D,I){var X=Array.prototype.slice.call(arguments),J=new Kj(p,o,h,S,T,D,I);this.curves.push(J);var r=J.getPoint(1);X.push(r.x),X.push(r.y),this.actions.push({action:tj,args:X})},lq.getSpacedPoints=function(r){r||(r=40);for(var x=[],h=0;r>h;h++)x.push(this.getPoint(h/r));return x},lq.getPoints=function(n,X){n=n||12;var p,J,B,a,u,P,I,z,S,O,$,d,M,U,c,_,Z,C,W=[];for(p=0,J=this.actions.length;J>p;p++)switch(B=this.actions[p],a=B.action,u=B.args,a){case Ln:W.push(new Ok(u[0],u[1]));break;case An:W.push(new Ok(u[0],u[1]));break;case ng:for(P=u[2],I=u[3],O=u[0],$=u[1],W.length>0?(U=W[W.length-1],d=U.x,M=U.y):(U=this.actions[p-1].args,d=U[U.length-2],M=U[U.length-1]),c=1;n>=c;c++)_=c/n,Z=ri.b2(_,d,O,P),C=ri.b2(_,M,$,I),W.push(new Ok(Z,C));break;case Dr:for(P=u[4],I=u[5],O=u[0],$=u[1],z=u[2],S=u[3],W.length>0?(U=W[W.length-1],d=U.x,M=U.y):(U=this.actions[p-1].args,d=U[U.length-2],M=U[U.length-1]),c=1;n>=c;c++)_=c/n,Z=ri.b3(_,d,O,z,P),C=ri.b3(_,M,$,S,I),W.push(new Ok(Z,C));break;case Jj:var k,R=u[0],N=u[1],y=u[2],H=u[3],v=u[4],g=!!u[5],L=v-H,Q=2*n;for(c=1;Q>=c;c++)_=c/Q,g||(_=1-_),k=H+_*L,Z=R+y*G(k),C=N+y*f(k),W.push(new Ok(Z,C));break;case tj:var k,R=u[0],N=u[1],q=u[2],i=u[3],H=u[4],v=u[5],g=!!u[6],L=v-H,Q=2*n;for(c=1;Q>=c;c++)_=c/Q,g||(_=1-_),k=H+_*L,Z=R+q*G(k),C=N+i*f(k),W.push(new Ok(Z,C))}var o=W[W.length-1],V=1e-10;return h(o.x-W[0].x)<V&&h(o.y-W[0].y)<V&&W.splice(W.length-1,1),X&&W.push(W[0]),W},lq.toShapes=function(u,j){function J(y){var F,G,B,w,K,h=[],g=new Dj;for(F=0,G=y.length;G>F;F++)B=y[F],K=B.args,w=B.action,w==Ln&&0!=g.actions.length&&(h.push(g),g=new Dj),g[w].apply(g,K);return 0!=g.actions.length&&h.push(g),h}function Q(Y){for(var v=[],V=0,k=Y.length;k>V;V++){var r=Y[V],W=new hr;W.actions=r.actions,W.curves=r.curves,v.push(W)}return v}function o(u,X){for(var H=1e-10,i=X.length,A=!1,L=i-1,s=0;i>s;L=s++){var D=X[L],G=X[s],q=G.x-D.x,I=G.y-D.y;if(h(I)>H){if(0>I&&(D=X[s],q=-q,G=X[L],I=-I),u.y<D.y||u.y>G.y)continue;if(u.y==D.y){if(u.x==D.x)return!0}else{var P=I*(u.x-D.x)-q*(u.y-D.y);if(0==P)return!0;if(0>P)continue;A=!A}}else{if(u.y!=D.y)continue;if(G.x<=u.x&&u.x<=D.x||D.x<=u.x&&u.x<=G.x)return!0}}return A}var i=J(this.actions);if(0==i.length)return[];if(j===!0)return Q(i);var V,B,C,X=[];if(1==i.length)return B=i[0],C=new hr,C.actions=B.actions,C.curves=B.curves,X.push(C),X;var m=!ri.isClockWise(i[0].getPoints());m=u?!m:m;var l,y=[],r=[],c=[],$=0;r[$]=d,c[$]=[];var N,b;for(N=0,b=i.length;b>N;N++)B=i[N],l=B.getPoints(),V=ri.isClockWise(l),V=u?!V:V,V?(!m&&r[$]&&$++,r[$]={s:new hr,p:l},r[$].s.actions=B.actions,r[$].s.curves=B.curves,m&&$++,c[$]=[]):c[$].push({h:B,p:l[0]});if(!r[0])return Q(i);if(r.length>1){for(var R=!1,g=[],v=0,e=r.length;e>v;v++)y[v]=[];for(var v=0,e=r.length;e>v;v++){r[v];for(var W=c[v],O=0;O<W.length;O++){for(var z=W[O],S=!0,F=0;F<r.length;F++)o(z.p,r[F].p)&&(v!=F&&g.push({froms:v,tos:F,hole:O}),S?(S=!1,y[F].push(z)):R=!0);S&&y[v].push(z)}}g.length>0&&(R||(c=y))}var Y,K,T;for(N=0,b=r.length;b>N;N++)for(C=r[N].s,X.push(C),Y=c[N],K=0,T=Y.length;T>K;K++)C.holes.push(Y[K].h);return X};var hr=function(){Dj.apply(this,arguments),this.holes=[]},ln=hr.prototype=Qk(lq);ln.getPointsHoles=function(d){var p,r=this.holes.length,Y=[];for(p=0;r>p;p++)Y[p]=this.holes[p].getTransformedPoints(d);return Y},ln.extractAllPoints=function(q){return{shape:this.getTransformedPoints(q),holes:this.getPointsHoles(q)}},ln.extractPoints=function(m){return this.extractAllPoints(m)};var ri={triangulateShape:function(D,P){function U(w,u,G){return w.x!=u.x?w.x<u.x?w.x<=G.x&&G.x<=u.x:u.x<=G.x&&G.x<=w.x:w.y<u.y?w.y<=G.y&&G.y<=u.y:u.y<=G.y&&G.y<=w.y}function f(y,B,d,w,Q){var X=1e-10,l=B.x-y.x,P=B.y-y.y,_=w.x-d.x,S=w.y-d.y,g=y.x-d.x,z=y.y-d.y,j=P*_-l*S,J=P*g-l*z;if(h(j)>X){var T;if(j>0){if(0>J||J>j)return[];if(T=S*g-_*z,0>T||T>j)return[]}else{if(J>0||j>J)return[];if(T=S*g-_*z,T>0||j>T)return[]}if(0==T)return!Q||0!=J&&J!=j?[y]:[];if(T==j)return!Q||0!=J&&J!=j?[B]:[];if(0==J)return[d];if(J==j)return[w];var v=T/j;return[{x:y.x+v*l,y:y.y+v*P}]}if(0!=J||S*g!=_*z)return[];var R=0==l&&0==P,q=0==_&&0==S;if(R&&q)return y.x!=d.x||y.y!=d.y?[]:[y];if(R)return U(d,w,y)?[y]:[];if(q)return U(y,B,d)?[d]:[];var r,M,k,f,C,p,n,c;return 0!=l?(y.x<B.x?(r=y,k=y.x,M=B,f=B.x):(r=B,k=B.x,M=y,f=y.x),d.x<w.x?(C=d,n=d.x,p=w,c=w.x):(C=w,n=w.x,p=d,c=d.x)):(y.y<B.y?(r=y,k=y.y,M=B,f=B.y):(r=B,k=B.y,M=y,f=y.y),d.y<w.y?(C=d,n=d.y,p=w,c=w.y):(C=w,n=w.y,p=d,c=d.y)),n>=k?n>f?[]:f==n?Q?[]:[C]:c>=f?[C,M]:[C,p]:k>c?[]:k==c?Q?[]:[r]:c>=f?[r,M]:[r,p]}function s(o,W,m,X){var v=1e-10,_=W.x-o.x,n=W.y-o.y,Y=m.x-o.x,b=m.y-o.y,w=X.x-o.x,A=X.y-o.y,I=_*b-n*Y,K=_*A-n*w;if(h(I)>v){var E=w*b-A*Y;return I>0?K>=0&&E>=0:K>=0||E>=0}return K>0}function k(I,T){function V($,a){var p=P.length-1,y=$-1;0>y&&(y=p);var T=$+1;T>p&&(T=0);var z=s(P[$],P[y],P[T],c[a]);if(!z)return!1;var C=c.length-1,R=a-1;0>R&&(R=C);var _=a+1;return _>C&&(_=0),z=s(c[a],c[R],c[_],P[$]),z?!0:!1}function G(w,c){var M,t,R;for(M=0;M<P.length;M++)if(t=M+1,t%=P.length,R=f(w,c,P[M],P[t],!0),R.length>0)return!0;return!1}function $(l,n){var F,Q,c,m,k;for(F=0;F<X.length;F++)for(Q=T[X[F]],c=0;c<Q.length;c++)if(m=c+1,m%=Q.length,k=f(l,n,Q[c],Q[m],!0),k.length>0)return!0;return!1}for(var c,k,Q,w,J,x,r,A,z,t,u,P=I.concat(),X=[],l=[],h=0,a=T.length;a>h;h++)X.push(h);for(var K=0,i=2*X.length;X.length>0&&(i--,!(0>i));)for(Q=K;Q<P.length;Q++){w=P[Q],k=-1;for(var h=0;h<X.length;h++)if(x=X[h],r=w.x+":"+w.y+":"+x,l[r]===d){c=T[x];for(var O=0;O<c.length;O++)if(J=c[O],V(Q,O)&&!G(w,J)&&!$(w,J)){k=O,X.splice(h,1),A=P.slice(0,Q+1),z=P.slice(Q),t=c.slice(k),u=c.slice(0,k+1),P=A.concat(t).concat(u).concat(z),K=Q;break}if(k>=0)break;l[r]=!0}if(k>=0)break}return P}for(var j,S,t,q,A,T,$={},Q=D.concat(),V=0,y=P.length;y>V;V++)Array.prototype.push.apply(Q,P[V]);for(j=0,S=Q.length;S>j;j++)A=Q[j].x+":"+Q[j].y,$[A]!==d,$[A]=j;var O=k(D,P),e=cq.Triangulate(O,!1);for(j=0,S=e.length;S>j;j++)for(q=e[j],t=0;3>t;t++)A=q[t].x+":"+q[t].y,T=$[A],T!==d&&(q[t]=T);return e.concat()},isClockWise:function(H){return cq.Triangulate.area(H)<0},b2p0:function(U,c){var a=1-U;return a*a*c},b2p1:function(C,m){return 2*(1-C)*C*m},b2p2:function(P,s){return P*P*s},b2:function(P,u,G,y){return this.b2p0(P,u)+this.b2p1(P,G)+this.b2p2(P,y)},b3p0:function(p,x){var P=1-p;return P*P*P*x},b3p1:function(K,e){var L=1-K;return 3*L*L*K*e},b3p2:function(x,J){var X=1-x;return 3*X*x*x*J},b3p3:function(k,T){return k*k*k*T},b3:function(l,g,A,c,i){return this.b3p0(l,g)+this.b3p1(l,A)+this.b3p2(l,c)+this.b3p3(l,i)}},cq={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var g=M.keys(this.faces);return g.length?g[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(Q){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(D){var f=D.familyName.toLowerCase(),p=this;return p.faces[f]=p.faces[f]||{},p.faces[f][D.cssFontWeight]=p.faces[f][D.cssFontWeight]||{},p.faces[f][D.cssFontWeight][D.cssFontStyle]=D,D},drawText:function(q){var v,f=this.getFace(),c=this.size/f.resolution,n=0,x=String(q).split(""),u=x.length,Y=[];for(v=0;u>v;v++){var d=new Dj,r=this.extractGlyphPoints(x[v],f,c,n,d);r&&(n+=r.offset*this.spacing,Y.push(r.path))}var p=n/2;return{paths:Y,offset:p}},extractGlyphPoints:function(H,c,x,W,J){var _,Q,G,S,y,v,M,C,i,k,Y,X,l,u,U,q,Z,I,D,h=[],R=c.glyphs[H]||c.glyphs["?"];if(R){if(R.o)for(S=R._cachedOutline||(R._cachedOutline=R.o.split(" ")),v=S.length,M=x,C=x,_=0;v>_;)switch(y=S[_++]){case"m":i=S[_++]*M+W,k=S[_++]*C,J.moveTo(i,k);break;case"l":i=S[_++]*M+W,k=S[_++]*C,J.lineTo(i,k);break;case"q":if(Y=S[_++]*M+W,X=S[_++]*C,U=S[_++]*M+W,q=S[_++]*C,J.quadraticCurveTo(U,q,Y,X),D=h[h.length-1])for(l=D.x,u=D.y,Q=1,G=this.divisions;G>=Q;Q++){var V=Q/G;ri.b2(V,l,U,Y),ri.b2(V,u,q,X)}break;case"b":if(Y=S[_++]*M+W,X=S[_++]*C,U=S[_++]*M+W,q=S[_++]*C,Z=S[_++]*M+W,I=S[_++]*C,J.bezierCurveTo(U,q,Z,I,Y,X),D=h[h.length-1])for(l=D.x,u=D.y,Q=1,G=this.divisions;G>=Q;Q++){var V=Q/G;ri.b3(V,l,U,Z,Y),ri.b3(V,u,q,I,X)}}return{offset:R.ha*x,path:J}}}};cq.generateShapes=function(F,N){N=N||{};var U=N.font;if(U===d&&(U=cq.getDefaultFont(),!U))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var i=N.size!==d?N.size:1,R=N.curveSegments!==d?N.curveSegments:4,n=N.spacing!==d?N.spacing:1,u=N.weight!==d?N.weight:"normal",w=N.style!==d?N.style:"normal";cq.size=i,cq.divisions=R,cq.face=U,cq.weight=u,cq.style=w,cq.spacing=n;for(var O=cq.drawText(F),A=O.paths,$=[],H=0,S=A.length;S>H;H++)Array.prototype.push.apply($,A[H].toShapes());return $},function(S){var W=1e-10,d=function(T,o){var I=T.length;if(3>I)return null;var S,t,q,R=[],s=[],v=[];if(e(T)>0)for(t=0;I>t;t++)s[t]=t;else for(t=0;I>t;t++)s[t]=I-1-t;var F=I,p=2*F;for(t=F-1;F>2;){if(p--<=0)return o?v:R;if(S=t,S>=F&&(S=0),t=S+1,t>=F&&(t=0),q=t+1,q>=F&&(q=0),f(T,S,t,q,F,s)){var z,d,Y,_,J;for(z=s[S],d=s[t],Y=s[q],R.push([T[z],T[d],T[Y]]),v.push([s[S],s[t],s[q]]),_=t,J=t+1;F>J;_++,J++)s[_]=s[J];F--,p=2*F}}return o?v:R},e=function(Y){for(var U=Y.length,l=0,P=U-1,y=0;U>y;P=y++)l+=Y[P].x*Y[y].y-Y[y].x*Y[P].y;return.5*l},f=function(l,m,N,S,D,V){var E,C,t,X,U,P,T,f,o;if(C=l[V[m]].x,t=l[V[m]].y,X=l[V[N]].x,U=l[V[N]].y,P=l[V[S]].x,T=l[V[S]].y,W>(X-C)*(T-t)-(U-t)*(P-C))return!1;var A,H,h,I,e,n,w,u,Q,x,v,O,j,p,z;for(A=P-X,H=T-U,h=C-P,I=t-T,e=X-C,n=U-t,E=0;D>E;E++)if(f=l[V[E]].x,o=l[V[E]].y,!(f===C&&o===t||f===X&&o===U||f===P&&o===T)&&(w=f-C,u=o-t,Q=f-X,x=o-U,v=f-P,O=o-T,z=A*x-H*Q,j=e*u-n*w,p=h*O-I*v,z>=-W&&p>=-W&&j>=-W))return!1;return!0};return S.Triangulate=d,S.Triangulate.area=e,S}(cq),U._typeface_js={faces:cq.faces,loadFace:cq.loadFace};var qb=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},$q=qb.prototype={constructor:qb,computeFaceNormals:function(){for(var x=new sc,G=new sc,J=0,L=this.faces.length;L>J;J++){var a=this.faces[J],y=this.vertices[a.a],Y=this.vertices[a.b],c=this.vertices[a.c];x.subVectors(c,Y),G.subVectors(y,Y),x.cross(G),x.normalize(),a.normal.copy(x)}},computeVertexNormals:function(m){var w,D,s,V,$,P;for(P=new Array(this.vertices.length),w=0,D=this.vertices.length;D>w;w++)P[w]=new sc;if(m){var y,e,I,M=new sc,z=new sc;for(s=0,V=this.faces.length;V>s;s++)$=this.faces[s],y=this.vertices[$.a],e=this.vertices[$.b],I=this.vertices[$.c],M.subVectors(I,e),z.subVectors(y,e),M.cross(z),P[$.a].add(M),P[$.b].add(M),P[$.c].add(M)}else for(s=0,V=this.faces.length;V>s;s++)$=this.faces[s],P[$.a].add($.normal),P[$.b].add($.normal),P[$.c].add($.normal);for(w=0,D=this.vertices.length;D>w;w++)P[w].normalize();for(s=0,V=this.faces.length;V>s;s++)$=this.faces[s],$.vertexNormals[0]=P[$.a].clone(),$.vertexNormals[1]=P[$.b].clone(),$.vertexNormals[2]=P[$.c].clone()},mergeVertices:function(){var V,E,L,f,Q,_,S,b,I={},h=[],u=[],$=4,H=j(10,$);for(L=0,f=this.vertices.length;f>L;L++)V=this.vertices[L],E=e(V.x*H)+"_"+e(V.y*H)+"_"+e(V.z*H),I[E]===d?(I[E]=L,h.push(this.vertices[L]),u[L]=h.length-1):u[L]=u[I[E]];var A=[];for(L=0,f=this.faces.length;f>L;L++){Q=this.faces[L],Q.a=u[Q.a],Q.b=u[Q.b],Q.c=u[Q.c],_=[Q.a,Q.b,Q.c];for(var t=0;3>t;t++)if(_[t]==_[(t+1)%3]){A.push(L);break}}for(L=A.length-1;L>=0;L--){var D=A[L];for(this.faces.splice(D,1),S=0,b=this.faceVertexUvs.length;b>S;S++)this.faceVertexUvs[S].splice(D,1)}var J=this.vertices.length-h.length;return this.vertices=h,J}},Kj=function($,m,O,z,M,I,R){this.aX=$,this.aY=m,this.xRadius=O,this.yRadius=z,this.aStartAngle=M,this.aEndAngle=I,this.aClockwise=R};Kj.prototype=Qk(Dd),Kj.prototype.getPoint=function(Q){var R,M=this.aEndAngle-this.aStartAngle;0>M&&(M+=t),M>t&&(M-=t),R=this.aClockwise===!0?this.aEndAngle+(1-Q)*(t-M):this.aStartAngle+Q*M;var S=this.aX+this.xRadius*G(R),X=this.aY+this.yRadius*f(R);return new Ok(S,X)};var Bs=function(O,k){this.v1=O,this.v2=k},Rg=Bs.prototype=Qk(Dd);Rg.getPoint=function(s){var P=this.v2.clone().sub(this.v1);return P.multiplyScalar(s).add(this.v1),P},Rg.getPointAt=function(A){return this.getPoint(A)},Rg.getTangent=function(){var Z=this.v2.clone().sub(this.v1);return Z.normalize()};var qg=function(a,C,J){this.v0=a,this.v1=C,this.v2=J};qg.prototype=Qk(Dd),qg.prototype.getPoint=function(R){var L,T;return L=ri.b2(R,this.v0.x,this.v1.x,this.v2.x),T=ri.b2(R,this.v0.y,this.v1.y,this.v2.y),new Ok(L,T)};var Vf=function(j,c,t,P){this.v0=j,this.v1=c,this.v2=t,this.v3=P};Vf.prototype=Qk(Dd),Vf.prototype.getPoint=function(_){var c,O;return c=ri.b3(_,this.v0.x,this.v1.x,this.v2.x,this.v3.x),O=ri.b3(_,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Ok(c,O)},vg.create(function(g,C){this.v1=g,this.v2=C},function(V){var C=new sc;return C.subVectors(this.v2,this.v1),C.multiplyScalar(V),C.add(this.v1),C});var pg=vg.create(function(i,G,U){this.v0=i,this.v1=G,this.v2=U},function(G){var i,O,k;return i=ri.b2(G,this.v0.x,this.v1.x,this.v2.x),O=ri.b2(G,this.v0.y,this.v1.y,this.v2.y),k=ri.b2(G,this.v0.z,this.v1.z,this.v2.z),new sc(i,O,k)}),ep=vg.create(function(m,e,F,Q){this.v0=m,this.v1=e,this.v2=F,this.v3=Q},function(u){var U,c,S;return U=ri.b3(u,this.v0.x,this.v1.x,this.v2.x,this.v3.x),c=ri.b3(u,this.v0.y,this.v1.y,this.v2.y,this.v3.y),S=ri.b3(u,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new sc(U,c,S)}),zq=function(g,K,j,C,z,D,E,u){qb.call(this),C=C!==d?C:.5,z=z!==d?z:.5,u=u!==d?u:1,g=g||8,D=D||0,E=E||t;var S,b,_=1,J=u/2,L=[],y=[],Y=this.vertices,A=this.faces,w=this.faceVertexUvs;for(b=0;_>=b;b++){var $=[],O=[],U=b/_,R=U*(z-C)+C;for(S=0;g>=S;S++){var T=S/g,r=new sc,M=-(T*E+D);r.z=R*f(M),r.y=-U*u+J,r.x=R*G(M),Y.push(r),$.push(Y.length-1),O.push(new Ok(T,U))}L.push($),y.push(O)}var q,I,i=(z-C)/u;for(S=0;g>S;S++)for(0!==C?(q=Y[L[0][S]].clone(),I=Y[L[0][S+1]].clone()):(q=Y[L[1][S]].clone(),I=Y[L[1][S+1]].clone()),q.setY(W(q.x*q.x+q.z*q.z)*i).normalize(),I.setY(W(I.x*I.x+I.z*I.z)*i).normalize(),b=0;_>b;b++){var V=L[b][S],F=L[b+1][S],n=L[b+1][S+1],v=L[b][S+1],c=q.clone(),k=q.clone(),a=I.clone(),B=I.clone(),x=y[b][S].clone(),X=y[b+1][S].clone(),l=y[b+1][S+1].clone(),p=y[b][S+1].clone();A.push(new wp(V,F,v,[c,k,B])),w[0].push([x,X,p]),A.push(new wp(F,n,v,[k.clone(),a,B.clone()])),w[0].push([X.clone(),l,p.clone()])}if(K&&C>0)for(this.vertices.push(new sc(0,J,0)),S=0;g>S;S++){var V=L[0][S],F=L[0][S+1],n=this.vertices.length-1,c=new sc(0,1,0),k=new sc(0,1,0),a=new sc(0,1,0),x=y[0][S].clone(),X=y[0][S+1].clone(),l=new Ok(X.x,0);A.push(new wp(V,F,n,[c,k,a],null,1));var h=S/g*t,N=G(h),m=f(h),Q=(S+1)/g*t,e=G(Q),H=f(Q);w[0].push([new Ok(.5+.5*N,.5+.5*m),new Ok(.5+.5*e,.5+.5*H),new Ok(.5,.5)])}if(j&&z>0)for(this.vertices.push(new sc(0,-J,0)),S=0;g>S;S++){var V=L[b][S+1],F=L[b][S],n=Y.length-1,c=new sc(0,-1,0),k=new sc(0,-1,0),a=new sc(0,-1,0),x=y[b][S+1].clone(),X=y[b][S].clone();A.push(new wp(V,F,n,[c,k,a],null,2));var h=S/g*t,N=G(h),m=f(h),Q=(S+1)/g*t,e=G(Q),H=f(Q);w[0].push([new Ok(.5+.5*e,.5-.5*H),new Ok(.5+.5*N,.5-.5*m),new Ok(.5,.5)])}};zq.prototype=Qk($q);var zp=function(k,Q,l,V,o,i,r){qb.call(this),r=r||.5,k=k||16,Q=Q||16,l=(l!==d?l:0)-p,V=V!==d?V:t,o=o!==d?o:0,i=i!==d?i:p;var e,R,z=[],H=[],x=this.vertices,N=this.faces,X=this.faceVertexUvs;for(R=0;Q>=R;R++){var g=[],I=[];for(e=0;k>=e;e++){var m=e/k,_=R/Q,S=new sc;S.x=-r*G(l+m*V)*f(o+_*i),S.y=r*G(o+_*i),S.z=r*f(l+m*V)*f(o+_*i),x.push(S),g.push(x.length-1),I.push(new Ok(m,_))}z.push(g),H.push(I)}for(R=0;Q>R;R++)for(e=0;k>e;e++){var P=z[R][e+1],s=z[R][e],F=z[R+1][e],u=z[R+1][e+1],W=x[P].clone().normalize(),D=x[s].clone().normalize(),Y=x[F].clone().normalize(),j=x[u].clone().normalize(),T=H[R][e+1].clone(),U=H[R][e].clone(),C=H[R+1][e].clone(),J=H[R+1][e+1].clone();h(x[P].y)===r?(T.x=(T.x+U.x)/2,N.push(new wp(P,F,u,[W,Y,j])),X[0].push([T,C,J])):h(x[F].y)===r?(C.x=(C.x+J.x)/2,N.push(new wp(P,s,F,[W,D,Y])),X[0].push([T,U,C])):(N.push(new wp(P,s,u,[W,D,j])),X[0].push([T,U,J]),N.push(new wp(s,F,u,[D.clone(),Y,j.clone()])),X[0].push([U.clone(),C,J.clone()]))}};zp.prototype=Qk($q);var nb=function(u,c,r,v,L,V){qb.call(this),u=u||.33,c=c||.17,v=v||8,r=r||6,L=L||0,V=V||t;for(var y=new sc,Y=[],x=[],E=0;v>=E;E++)for(var M=E/v*t+p,A=0;r>=A;A++){var X=A/r*V+L;y.x=u*G(X),y.z=-u*f(X);var m=new sc,$=u+c*G(M);m.x=$*G(X),m.z=-$*f(X),m.y=c*f(M),this.vertices.push(m),Y.push(new Ok(A/r,1-E/v)),x.push(m.clone().sub(y).normalize())}for(var E=1;v>=E;E++)for(var A=1;r>=A;A++){var j=(r+1)*E+A-1,Q=(r+1)*(E-1)+A-1,H=(r+1)*(E-1)+A,O=(r+1)*E+A,K=new wp(j,Q,O,[x[j].clone(),x[Q].clone(),x[O].clone()]);this.faces.push(K),this.faceVertexUvs[0].push([Y[j].clone(),Y[Q].clone(),Y[O].clone()]),K=new wp(Q,H,O,[x[Q].clone(),x[H].clone(),x[O].clone()]),this.faces.push(K),this.faceVertexUvs[0].push([Y[Q].clone(),Y[H].clone(),Y[O].clone()])}this.computeFaceNormals()};nb.prototype=Qk($q);var ef=function(A,e,p){return A?(qb.call(this),A=A instanceof Array?A:[A],this.addShapeList(A,e),e.convertYZ!==!1&&Eb(this,p),this.computeFaceNormals(),void 0):(A=[],void 0)},Ng=ef.prototype=Qk(qb.prototype);Ng.addShapeList=function(y,M){for(var h=y.length,H=0;h>H;H++){var e=y[H];this.addShape(e,M)}},Ng.addShape=function(Q,M){function Z(){if(M.bottom)for(var R=0;p>R;R++)A=u[R],s(A[2],A[1],A[0],!0);if(M.top)for(R=0;p>R;R++)A=u[R],s(A[0]+U*B,A[1]+U*B,A[2]+U*B,!1)}function T(){var B=0;for(j(i,B),B+=i.length,v=0,g=c.length;g>v;v++)k=c[v],j(k,B),B+=k.length}function j(Q,N){for(var G,p,X=Q.length;--X>=0;){G=X,p=X-1,0>p&&(p=Q.length-1);var g=0,h=B;for(g=0;h>g;g++){var I=U*g,R=U*(g+1),T=N+G+I,Y=N+p+I,w=N+p+R,e=N+G+R;z(T,Y,w,e,Q,g,h,G,p)}}}function E(S,y,f){K.vertices.push(new sc(S,y,f))}function s(i,$,D,u){i+=y,$+=y,D+=y,K.faces.push(new wp(i,$,D,null,null,u?2:1));var l=u?n.generateBottomUV(K,Q,M,i,$,D):n.generateTopUV(K,Q,M,i,$,D);K.faceVertexUvs[0].push(l)}function z(h,C,g,b,u,l,N,O,T){h+=y,C+=y,g+=y,b+=y,K.faces.push(new wp(h,C,b)),K.faces.push(new wp(C,g,b));var z=n.generateSideWallUV(K,Q,u,M,h,C,g,b,l,N,O,T);K.faceVertexUvs[0].push([z[0],z[1],z[3]]),K.faceVertexUvs[0].push([z[1],z[2],z[3]])}var W,x,r,C,f,q=M.amount,O=M.curveSegments||xm,B=M.steps||1,H=M.extrudePath,R=!1,n=new hs(M.repeatUVLength);H&&(W=H.getSpacedPoints(B),R=!0,x=M.frames!==d?M.frames:new or.FrenetFrames(H,B,!1),r=new sc,C=new sc,f=new sc);var k,v,g,K=this,y=this.vertices.length,V=Q.extractPoints(O),P=V.shape,c=V.holes,$=!ri.isClockWise(P);if($){for(P=P.reverse(),v=0,g=c.length;g>v;v++)k=c[v],ri.isClockWise(k)&&(c[v]=k.reverse());$=!1}var u=ri.triangulateShape(P,c),i=P;for(v=0,g=c.length;g>v;v++)k=c[v],P=P.concat(k);for(var l,A,U=P.length,p=u.length,N=0;U>N;N++)l=P[N],R?(C.copy(x.normals[0]).multiplyScalar(l.x),r.copy(x.binormals[0]).multiplyScalar(l.y),f.copy(W[0]).add(C).add(r),E(f.x,f.y,f.z)):E(l.x,l.y,0);var h;for(h=1;B>=h;h++)for(N=0;U>N;N++)l=P[N],R?(C.copy(x.normals[h]).multiplyScalar(l.x),r.copy(x.binormals[h]).multiplyScalar(l.y),f.copy(W[h]).add(C).add(r),E(f.x,f.y,f.z)):E(l.x,l.y,q/B*h);Z(),T()};var or=function(e,p,w,s,R){function D(i,e,H){return P.vertices.push(new sc(i,e,H))-1}qb.call(this),p=p||64,w=w||1,s=s||8,R=R||!1;var F,$,_,M,N,d,c,q,U,V,Y,g,K,b,m,z,W,o,X,H,S=[],P=this,E=p+1,i=new sc,y=new or.FrenetFrames(e,p,R),J=y.tangents,L=y.normals,C=y.binormals;for(this.tangents=J,this.normals=L,this.binormals=C,U=0;E>U;U++)for(S[U]=[],M=U/(E-1),q=e.getPointAt(M),F=J[U],$=L[U],_=C[U],V=0;s>V;V++)N=V/s*t,d=-w*G(N),c=w*f(N),i.copy(q),i.x+=d*$.x+c*_.x,i.y+=d*$.y+c*_.y,i.z+=d*$.z+c*_.z,S[U][V]=D(i.x,i.y,i.z);for(U=0;p>U;U++)for(V=0;s>V;V++)Y=R?(U+1)%p:U+1,g=(V+1)%s,K=S[U][V],b=S[Y][V],m=S[Y][g],z=S[U][g],W=new Ok(U/p,V/s),o=new Ok((U+1)/p,V/s),X=new Ok((U+1)/p,(V+1)/s),H=new Ok(U/p,(V+1)/s),this.faces.push(new wp(K,b,z)),this.faceVertexUvs[0].push([W,o,H]),this.faces.push(new wp(b,m,z)),this.faceVertexUvs[0].push([o.clone(),X,H.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};or.prototype=Qk($q),or.FrenetFrames=function(X,i,U){function K(){g[0]=new sc,G[0]=new sc,R=Number.MAX_VALUE,A=h(E[0].x),I=h(E[0].y),l=h(E[0].z),R>=A&&(R=A,D.set(1,0,0)),R>=I&&(R=I,D.set(0,1,0)),R>=l&&D.set(0,0,1),Z.crossVectors(E[0],D).normalize(),g[0].crossVectors(E[0],Z),G[0].crossVectors(E[0],g[0])}var M,R,A,I,l,b,f,D=new sc,E=[],g=[],G=[],Z=new sc,r=new Wo,v=i+1,P=1e-4;for(this.tangents=E,this.normals=g,this.binormals=G,b=0;v>b;b++)f=b/(v-1),E[b]=X.getTangentAt(f),E[b].normalize();for(K(),b=1;v>b;b++)g[b]=g[b-1].clone(),G[b]=G[b-1].clone(),Z.crossVectors(E[b-1],E[b]),Z.length()>P&&(Z.normalize(),M=x(Ze(E[b-1].dot(E[b]),-1,1)),g[b].applyMatrix4(r.makeRotationAxis(Z,M))),G[b].crossVectors(E[b],g[b]);if(U)for(M=x(Ze(g[0].dot(g[v-1]),-1,1)),M/=v-1,E[0].dot(Z.crossVectors(g[0],g[v-1]))>0&&(M=-M),b=1;v>b;b++)g[b].applyMatrix4(r.makeRotationAxis(E[b],M*b)),G[b].crossVectors(E[b],g[b])};var Zk=function(C,R,J,c){qb.call(this),R=R||18,J=J||0,c=c==y?t:c;for(var O=1/(C.length-1),r=1/R,D=0,Y=R;Y>=D;D++)for(var N=J+D*r*c,j=G(N),I=f(N),h=0,M=C.length;M>h;h++){var g=C[h],k=new sc;k.x=j*g.x-I*g.y,k.y=I*g.x+j*g.y,k.z=g.z,this.vertices.push(k)}for(var E=C.length,D=0,Y=R;Y>D;D++)for(var h=0,M=C.length-1;M>h;h++){var T=h+E*D,Q=T,U=T+E,j=T+1+E,$=T+1,W=D*r,S=h*O,q=W+r,K=S+O;this.faces.push(new wp(Q,$,U)),this.faceVertexUvs[0].push([new Ok(W,S),new Ok(W,K),new Ok(q,S)]),this.faces.push(new wp(U,$,j)),this.faceVertexUvs[0].push([new Ok(q,S),new Ok(W,K),new Ok(q,K)])}this.mergeVertices(),Eb(this),this.computeFaceNormals(),this.computeVertexNormals()};Zk.prototype=Qk($q);var dm=function(m,P){P=P||{};var q=cq.generateShapes(m,P);P.amount=P.amount!==d?P.amount:.5,P.convertYZ=!1,P.fill!==!1&&(P.bottom=!0,P.top=!0),ef.call(this,q,P)};dm.prototype=Qk(Ng);var fh=T.Node=function(){hg(fh,this)},Fe={X:Gd,Y:rr,Z:xo},sl={X:0,Y:1,Z:2},bd={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},ok="xzy",ur=function(y,c,M){if(c){var o=c[0],b=c[1],S=c[2];"xzy"===M?(rr(y,b),xo(y,S),Gd(y,o)):"xyz"===M?(xo(y,S),rr(y,b),Gd(y,o)):"yxz"===M?(xo(y,S),Gd(y,o),rr(y,b)):"yzx"===M?(Gd(y,o),xo(y,S),rr(y,b)):"zxy"===M?(rr(y,b),Gd(y,o),xo(y,S)):"zyx"===M?(Gd(y,o),rr(y,b),xo(y,S)):(rr(y,b),xo(y,S),Gd(y,o))}};ld("Node",gl,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:ok,_64O:0,_rotationX:0,_53O:0,_host:y,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return nj},_22Q:function(){return tn},getX:function(){return this.p().x},setX:function(a){this.p(a,this.p().y)},getY:function(){return this.p().y},setY:function(u){this.p(this.p().x,u)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(u){this.setAnchor(u,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(X){this.setAnchor(this.getAnchor().x,X)},getScaleX:function(){return this.getScale().x},setScaleX:function(F){this.setScale(F,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(k){this.setScale(this.getScale().x,k)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(_,R){Vb(_,Xf(y,y,this.r3(),this.getRotationMode())),this.translate3d(_[0]*R,_[1]*R,_[2]*R)},translateFront:function(Q){this.translate3dBy([0,0,1],Q)},translateBack:function(X){this.translate3dBy([0,0,-1],X)},translateLeft:function(N){this.translate3dBy([-1,0,0],N)},translateRight:function(i){this.translate3dBy([1,0,0],i)},translateTop:function(d){this.translate3dBy([0,1,0],d)},translateBottom:function(Q){this.translate3dBy([0,-1,0],Q)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(U,C,f){1===arguments.length&&(C=U[1],f=U[2],U=U[0]),this.p(U,f),this.setElevation(C)},translate3d:function(g,h,S){1===arguments.length&&(h=g[1],S=g[2],g=g[0]),this.translate(g,S),this.setElevation(this._54O+h)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(d,C,q){1===arguments.length&&(C=d[1],q=d[2],d=d[0]),this.setSize(d,q),this.setTall(C)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(b,h,w){1===arguments.length&&(h=b[1],w=b[2],b=b[0]),this.setRotationX(b),this.setRotation(-h),this.setRotationZ(w)},setRotationY:function(B){this.setRotation(-B)},getRotationY:function(){return-this._64O},lookAtDirection:function(v,x){x=x||jd;var C=this,Z=kk(v);x===jd?(C.r3([-L(v[1]/Z),-B(v[2],v[0])+E,0]),C.setRotationMode("xzy")):x===Fq?(C.r3(0,-B(v[2],v[0]),L(v[1]/Z)),C.setRotationMode("zyx")):x===Cb?(C.r3(0,-B(v[2],v[0])+p,-L(v[1]/Z)),C.setRotationMode("zyx")):x===Zp?(C.r3([-L(v[1]/Z)+E,-B(v[2],v[0])+E,0]),C.setRotationMode("xzy")):x===Yg&&(C.r3([-L(v[1]/Z)-E,-B(v[2],v[0])+E,0]),C.setRotationMode("xzy")),x===Oo&&(C.r3([-L(v[1]/Z)+p,-B(v[2],v[0])+E,p]),C.setRotationMode("zxy"))},lookAt:function(Q,k){return this.lookAtDirection(yi(Q,this.p3()),k)},lookAtX:function(){var w=new jf,x=new jf,L=new jf,p=new El,R=new El,P=new T.Math.Euler;return function(c,O,Z){O===Cb||O===Fq?p.makeRotationAxis(new T.Math.Vector3(0,1,0),Math.PI/2):O===Zp||O===Yg?p.makeRotationAxis(new T.Math.Vector3(1,0,0),Math.PI/2):p.identity(),O===Yg||O===Fq||O===Oo?(w.fromArray(this.p3()),x.fromArray(c)):(w.fromArray(c),x.fromArray(this.p3())),R.lookAt(w,x,Z?L.fromArray(Z):L.set(0,1,0)),P.setFromRotationMatrix(R.multiply(p),Xj.ReverseOrder(this.getRotationMode())),this.r3([P.x,P.y,P.z])}}(),getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(l){var s=this;if(s!==l&&s._host!==l){var L=s._host;L&&L._removeAttach(s),s._host=l,s._host&&s._host._addAttach(s),s.fp("host",L,l),s.onHostChanged(L,l)}},getAttaches:function(){return this._69O},_addAttach:function(s){var O=this;O._69O||(O._69O=new wk),O._69O.add(s),O.fp("attaches",y,s)},_removeAttach:function(l){var e=this;e._69O.remove(l),e._69O.isEmpty()&&delete e._69O,e.fp("attaches",l,y)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(X){var U=this;U._44I||(U._44I=new wk),U._42I||(U._42I=new wk),U._44I.add(X),U._42I.add(X),U._20I()},_4I:function(Q){var e=this;e._44I||(e._44I=new wk),e._43I||(e._43I=new wk),e._44I.add(Q),e._43I.add(Q),e._20I()},_16I:function(e){var Q=this;Q._44I.remove(e),Q._42I.remove(e),Q._44I.isEmpty()&&delete Q._44I,Q._42I.isEmpty()&&delete Q._42I,Q._20I()},_18I:function(d){var c=this;c._44I.remove(d),c._43I.remove(d),c._44I.isEmpty()&&delete c._44I,c._43I.isEmpty()&&delete c._43I,c._20I()},_20I:function(){var z=this;if(delete z._45I,!z._44I||z._44I.isEmpty())return delete z._70O,void 0;var c;z._44I.each(function(K){K.isLooped()&&(c||(c={}),c[K._id]||(z._45I||(z._45I=new wk),z._45I.add(K),c[K._id]=K))}),c?(z._70O=new wk,z._44I.each(function(J){c[J._id]?"A"===c[J._id]||(c[J._id]="A",z._70O.add(J)):z._70O.add(J)})):z._70O=z._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(a){var X=this;X._46I||(X._46I=new wk),X._48I||(X._48I=new wk),X._46I.add(a),X._48I.add(a),X._19I()},_3I:function(H){var i=this;i._47I||(i._47I=new wk),i._48I||(i._48I=new wk),i._47I.add(H),i._48I.add(H),i._19I()},_15I:function(r){var i=this;i._46I.remove(r),i._48I.remove(r),i._46I.isEmpty()&&delete i._46I,i._48I.isEmpty()&&delete i._48I,i._19I()},_17I:function(J){var l=this;l._47I.remove(J),l._48I.remove(J),l._47I.isEmpty()&&delete l._47I,l._48I.isEmpty()&&delete l._48I,l._19I()},_19I:function(){var B=this;delete B._49I;var j=B._48I;if(j&&!j.isEmpty()){var k={};j.each(function(y){k[y._id]?B._49I||(B._49I=new wk):k[y._id]=y}),B._49I?j.each(function(u){k[u._id]&&(B._49I.add(u),delete k[u._id])}):B._49I=j}},getImage:function(){if(this._pendingCheckImageJSON){var e=N.getImage(this._image);e&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Ig&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(p){var t=this,F=t._image,d=t.getWidth(),O=t.getHeight();t._image=p,t.fp("image",F,p)&&(null!=p&&(Bh(p)||Hc(p)&&/\.json$/i.test(p))&&(this._pendingCheckImageJSON=!0),t.fp(Nr,d,t.getWidth()),t.fp(Fi,O,t.getHeight()))},getElevation:function(){return this._54O},setElevation:function(f){var X=this;if(!X._50O){X._50O=1;var R=X._54O;X._54O=f,X.fp(Vg,R,f),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(c){var q=this;
if(!q._49O){q._49O=1;var j=q._64O;q._64O=c,q.fp(Cq,j,c),delete q._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(u){var G=this;if(!G._51O){G._51O=1;var R=G._rotationX;G._rotationX=u,G.fp("rotationX",R,u),delete G._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(o){var c=this;if(!c._52O){c._52O=1;var J=c._53O;c._53O=o,c.fp("rotationZ",J,o),delete c._52O}},getPosition:function(){return this._position},setPosition:function(t,s){var K=this;if(!K._50I){K._50I=1;var o;if(o=2===arguments.length?{x:t,y:s}:t,o.x!==K._position.x||o.y!==K._position.y){var v=K._position;K._position=o,K.fp(hp,v,o)}delete K._50I}},translate:function(N,c){var n=this._position;this.p(n.x+N,n.y+c)},getWidth:function(){var U=this;if(U._width>=0)return U._width;var V=U.getStyle("shape3d");if(V){var O=mh(V);if(O&&O.rawS3)return O.rawS3[0];if("billboard"===V||"plane"===V){var B=qp(U.getStyle("shape3d.image"));return B?$m(B,U):20}}var B=qp(U._image);return B?$m(B,U):20},setWidth:function(G){var W=this,V=W._width;W._width=G,W.fp(Nr,V,G)},getHeight:function(){var R=this;if(R._height>=0)return R._height;var f=R.getStyle("shape3d");if(f){var q=mh(f);if(q&&q.rawS3)return q.rawS3[2];if("plane"===f){var m=qp(R.getStyle("shape3d.image"));return m?Lq(m,R):20}if("billboard"===f)return 2}var m=qp(R._image);return m?Lq(m,R):20},setHeight:function(T){var S=this,K=S._height;S._height=T,S.fp(Fi,K,T)},getTall:function(){var y=this;if(y._tall>=0)return y._tall;var S=y.getStyle("shape3d");if(S){var X=mh(S);if(X&&X.rawS3)return X.rawS3[1];if("billboard"===S){var k=qp(y.getStyle("shape3d.image"));return k?Lq(k,y):20}if("plane"===S)return 2}return 20},setTall:function(x){var f=this,C=f._tall;f._tall=x,f.fp("tall",C,x)},setSize:function(n,b){var M=this;2===arguments.length?(M.setWidth(n),M.setHeight(b)):(M.setWidth(n.width),M.setHeight(n.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(n,h,T,e,V){var U=this,a=U.getAnchor(),M=U.getScale();arguments.length<=2&&(V=h,h=n.y,T=n.width,e=n.height,n=n.x);var x=V&&M.x<0?1-a.x:a.x,i=V&&M.y<0?1-a.y:a.y;U.p(n+T*x,h+e*i),V&&(T/=Math.abs(M.x),e/=Math.abs(M.y)),U.setWidth(T),U.setHeight(e)},getMatrix:function(){var i=this,Y=i._64O,G=i._position,V=i.getScale();return new Rc(Y,G.x,G.y,V.x,V.y)},getAnchorRect:function(){var q=this,i=q.getWidth(),V=q.getHeight(),X=q.getAnchor();return{x:-i*X.x,y:-V*X.y,width:i,height:V}},toLocal:function(m){return this.getMatrix().tfi(m)},toGlobal:function(A){return this.getMatrix().tf(A)},getAttachPosition:function(){var n=new Rc;return function(X,G,d,k){d=d||0,k=k||0;var j=this,m=j.getAnchor(),l=j._64O,Y=j._position,f=j.getScale();return n.setFromTransform(l,Y.x,Y.y).tf({x:d+f.x*j.getWidth()*(X-m.x),y:k+f.y*j.getHeight()*(G-m.y)})}}(),isInRect:function(m){m=this.toLocal(m);var f=this.getWidth(),S=this.getHeight();return m.x+=f*this.getAnchorX(),m.y+=S*this.getAnchorY(),!(m.x<0||m.y<0||m.x>f||m.y>S)},getRect:function(){var $=this,o=$.getWidth(),b=$.getHeight(),V=$.getAnchor(),t={x:-o*V.x,y:-b*V.y,width:o,height:b},B=$.getMatrix();return t=wm([B.tf(t.x,t.y),B.tf(t.x+t.width,t.y),B.tf(t.x+t.width,t.y+t.height),B.tf(t.x,t.y+t.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var M=this,R=M.getAnchor(),s=M._anchorElevation;return{x:R.x,y:s,z:R.y}},setAnchorElevation:function(N){var I=this,F=I._anchorElevation;return F!==N?(I._anchorElevation=N,I.fp("anchorElevation",F,N),!0):!1},setAnchor3d:function(i,H,l,x){var A,I=this;"number"==typeof i?A={x:i,y:H,z:l}:(A=i.length?{x:i[0],y:i[1],z:i[2]}:i,x=H);var C=I.getDataModel();C&&C.beginTransaction();var W=I.getAnchor3d(),L=I.setAnchor(A.x,A.z);if(I.setAnchorElevation(A.y)&&(L=!0),L&&x&&!Yd){I.getAnchor3d();var R=Wr(I),P=Vb([A.x-W.x,A.y-W.y,A.z-W.z],R);I.p3(P)}return C&&C.endTransaction(),L},getAnchor:function(){var W=this;if(W.hasOwnProperty("_anchor"))return W._anchor;var Z=qp(W._image);return Z&&Z.anchorX!==d?{x:Z.anchorX,y:Z.anchorY}:W._anchor},setAnchor:function(R,m,i){var O,T=this;"number"==typeof R?O={x:R,y:m}:(O=R.length?{x:R[0],y:R[1]}:R,i=m);var U=T.getAnchor();if(U.x!==O.x||U.y!==O.y){var P=T.getDataModel();if(P&&P.beginTransaction(),T._anchor=O,T.fp("anchor",U,O),i&&!Yd){var V=T.getPosition(),I=T.getSize(),N=T.getRotation(),c=T.getScale(),B=-I.width*(U.x-O.x)*c.x,v=-I.height*(U.y-O.y)*c.y,b=f(N),A=G(N);T.setPosition(V.x+A*B-b*v,V.y+b*B+A*v)}return P&&P.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(i,E){var f,L=this;f=2===arguments.length?{x:i,y:E}:i;var V=L.getScale();(V.x!==f.x||V.y!==f.y)&&(L._scale=f,L.fp("scale",V,f))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var j=this,C=j._scaleTall,S=j.getScale();return[S.x,C,S.y]},getFinalScale3d:function(){var o=this,Y=o.s3(),V=o._dynamicScale3d,U=o.getScale3d();return Y&&(U[0]*=Y[0],U[1]*=Y[1],U[2]*=Y[2]),V&&(U[0]*=V[0],U[1]*=V[1],U[2]*=V[2]),U},getFinalRotation3d:function(){var v=this;return v._dynamicRotation||v.r3()},setScaleTall:function(z){var h=this,$=h._scaleTall;$!==z&&(h._scaleTall=z,h.fp("scaleTall",$,z))},setScale3d:function(t,d,P){var G,r=this;G="number"==typeof t?{x:t,y:d,z:P}:t.length?{x:t[0],y:t[1],z:t[2]}:t,r.setScaleTall(G.y),r.setScale(G.x,G.z)},getCorners:function(L,_){L==y&&(L=0),_==y&&(_=L);var r=this,V=r.getAnchor(),e=r.getWidth(),K=r.getHeight(),X=-e*V.x-L,u=-K*V.y-_,d=e+2*L,k=K+2*_,J=r.getMatrix();return[J.tf(X,u),J.tf(X,u+k),J.tf(X+d,u+k),J.tf(X+d,u)]},getEditControlPoints:function(D,r,k){r==y&&(r=0),k==y&&(k=r);var o=this,E=o.getAnchor(),a=o.getWidth(),G=o.getHeight(),j=-a*E.x-r,s=-G*E.y-k,g=a+2*r,Z=G+2*k;if(D)return[{x:j,y:s},{x:j,y:0},{x:j,y:s+Z},{x:0,y:s+Z},{x:j+g,y:s+Z},{x:j+g,y:0},{x:j+g,y:s},{x:0,y:s}];var v=o.getMatrix();return[v.tf(j,s),v.tf(j,0),v.tf(j,s+Z),v.tf(0,s+Z),v.tf(j+g,s+Z),v.tf(j+g,0),v.tf(j+g,s),v.tf(0,s)]},rotateAt:function(j,c,z){var N=this,M=N._position,v=N._64O,$=new Rc(v,M.x,M.y).tf(j,c),Y=W(j*j+c*c),O=B(M.y-$.y,M.x-$.x)+z;N.setRotation(v+z),N.p($.x+Y*G(O),$.y+Y*f(O))},onParentChanged:function(){fh.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(N){N._7I()})},onPropertyChanged:function(){var Z={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(C){Z[C]=!0}),function(X){var G=this;fh.superClass.onPropertyChanged.call(G,X),Z[X.property]&&!G._layoutUpdating&&G.updateLayoutParameters(null,X.property),G._69O&&G._69O.each(function(d){d.handleHostPropertyChange(X)}),G._49I&&G._49I.each(function(a){a.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(l){this.updateAttach(l)},onStyleChanged:function(Q){fh.superClass.onStyleChanged.apply(this,arguments),vl[Q]&&this.updateAttach()},updateAttach:function(F){var Z=this;Z._51I||Yd||(Z._51I=1,Z._71O(F),delete Z._51I)},_71O:function(W){var J,k,g,G,n,X,h=this,F=h._host,I=W?W.property:y,q=W?W.oldValue:y,w=W?W.newValue:y;if(F instanceof T.Grid){if(I===Vg)h.setElevation(h._54O+w-q);else if(!W||uq[I]){if(J=h.s("attach.row.index"),k=h.s("attach.column.index"),g=F.getCellRect(J,k),!g)return;G=h.s("attach.row.span"),n=h.s("attach.column.span"),(1!==G||1!==n)&&(g=ks(g,F.getCellRect(J+G-1,k+n-1))),Vh(g,h,"attach.padding",1),h.setRect(g)}}else if(F instanceof Nm&&(X=h.s("attach.index"))>=0&&(!W||Mb[I])){var e=h.s("attach.thickness");e!=y&&h.setHeight(F.getThickness()*e);var p=h.s("attach.offset"),L=F.getPoints(),Z=L.size();if(Z>X){var d=L.get(X),C=Z===X+1?L.get(0):L.get(X+1),i=[C.x-d.x,C.y-d.y],m=kk(i);if(m){h.s("attach.offset.relative")&&(p*=m),h.s("attach.offset.opposite")&&(p=m-p);var t={x:d.x+i[0]/m*p,y:d.y+i[1]/m*p},Q=h.s("attach.gap");Q&&(h.s("attach.gap.relative")&&(Q*=F.getThickness()),t=Zo(y,t,C,Q)),h.p(t),h.setRotation(B(i[1],i[0]))}}}else W&&(I===hp?h.translate(w.x-q.x,w.y-q.y):I===Vg?h.setElevation(h._54O+w-q):rm[I]?h._11Q(F,I,w-q):("anchor"===I||"width"===I||"height"===I||"scale"===I)&&h.layout(F))},_11Q:function(){var z=new T.Math.Euler,L=T.Math.Euler.ReverseOrder,Z=new T.Math.Vector2,c=new T.Math.Vector2;return function(M,T,D){var e=this,f=M.p3(),U=M.r3(),B=e.p3(),o=e.r3();if(T===Cq&&(T="rotationY",D=-D),(T===Cq||"rotationY"===T)&&0===o[0]&&0===o[2]&&0===U[0]&&0===U[2]&&0===B[1]&&0===f[1])return e.setRotation(-o[1]-D),Z.set(B[0],B[2]).rotateAround(c.set(f[0],f[2]),-D),e.p(Z.x,Z.y),void 0;var O=bd[M.getRotationMode()],h=O[0],v=O[1],r=O[2],t=Fe[h],n=Fe[v],b=Fe[r],q=mj();T===Cq+h?(b(q,U[sl[r]]),n(q,U[sl[v]]),t(q,D),n(q,-U[sl[v]]),b(q,-U[sl[r]])):T===Cq+v?(b(q,U[sl[r]]),n(q,D),b(q,-U[sl[r]])):T===Cq+r&&b(q,D);var $=yi(B,f);Vb($,q),e.p3(f[0]+$[0],f[1]+$[1],f[2]+$[2]);var k=e.getRotationMode();ur(q,e.r3(),k),z.setFromRotationMatrix(q,L(k)),e.r3([z.x,z.y,z.z])}}(),isHostOn:function(f){var U=this;if(U._host&&f&&f._69O)for(var z={},C=U._host;C&&C!==U&&!z[C._id];){if(C===f)return!0;z[C._id]=C,C=C._host}return!1},isLoopedHostOn:function(H){return this.isHostOn(H)&&H.isHostOn(this)},getScaledSize:function(){var d=this.getSize(),g=this.getScale();return d.width*=Math.abs(g.x),d.height*=Math.abs(g.y),d},layout:function(P){if(P=P||this.getHost()){var x=this,s=x.s("layout.h")||"center",i=x.s("layout.v")||"center";if("center"!==s||"center"!==i){var c=new T.Math.Vector2,G=P.getPosition(),g=P.getAnchor(),_=P.getScaledSize();x.getPosition();var n,E,w,b,j,F=1,W=1;switch(x._layoutUpdating=!0,s){case"left":c.setX(x._layoutHValue-g.x*_.width);break;case"right":c.setX((1-g.x)*_.width-x._layoutHValue);break;case"leftright":n=_.width-x._layoutHValue[2],w=x.getRotation()-P.getRotation(),b=Math.abs(Math.sin(w)),j=Math.abs(Math.cos(w)),F+=j*n/x._layoutHValue[3],W+=b*n/x._layoutHValue[4],c.setX(x._layoutHValue[1]+(x._layoutHValue[5]-g.x)*_.width);break;case"center":c.setX((.5-g.x)*_.width-x._layoutHValue);break;case"scale":w=x.getRotation()-P.getRotation(),b=Math.abs(Math.sin(w)),j=Math.abs(Math.cos(w)),c.setX((.5-g.x)*_.width-x._layoutHValue[1]*_.width/x._layoutHValue[0]),E=_.width/x._layoutHValue[2]-1,F+=j*E,W+=b*E}switch(i){case"top":c.setY(x._layoutVValue-g.y*_.height);break;case"bottom":c.setY((1-g.y)*_.height-x._layoutVValue);break;case"topbottom":w||(w=x.getRotation()-P.getRotation(),b=Math.abs(Math.sin(w)),j=Math.abs(Math.cos(w))),n=_.height-x._layoutVValue[2],F+=b*n/x._layoutVValue[3],W+=j*n/x._layoutVValue[4],c.setY(x._layoutVValue[1]+(x._layoutVValue[5]-g.y)*_.height);break;case"center":c.setY((.5-g.y)*_.height-x._layoutVValue);break;case"scale":w||(w=x.getRotation()-P.getRotation(),b=Math.abs(Math.sin(w)),j=Math.abs(Math.cos(w))),c.setY((.5-g.y)*_.height-x._layoutVValue[1]*_.height/x._layoutVValue[0]),E=_.height/x._layoutVValue[2]-1,F+=b*E,W+=j*E}(1!==F||1!==W)&&("leftright"===s||"scale"===s?x.setSize(x._layoutHValue[3]*F,x._layoutHValue[4]*W):x.setSize(x._layoutVValue[3]*F,x._layoutVValue[4]*W)),c.rotateAround(null,P.getRotation()),this.setPosition(c.x+G.x,c.y+G.y),x._layoutUpdating=d}}},updateLayoutParameters:function(P,k){if(P=P||this.getHost()){var K=this,l=K.s("layout.h"),S=K.s("layout.v");if(l||S){var E,m,o,W,i,r,R=new T.Math.Vector2,n=P.getPosition(),e=P.getAnchor(),s=P.getScaledSize(),x=K.getPosition(),y=K.getSize();switch(R.set(x.x-n.x,x.y-n.y),R.rotateAround(null,-P.getRotation()),l){case"left":K._layoutHValue=R.x+e.x*s.width;break;case"right":K._layoutHValue=-R.x+(1-e.x)*s.width;break;case"center":K._layoutHValue=-R.x+(.5-e.x)*s.width;break;case"leftright":case"scale":"scale"===l?E=-R.x+(.5-e.x)*s.width:(m=K.getAnchor(),o=K.getRotation()-P.getRotation(),W=Math.cos(o),i=Math.sin(o),r=-Math.min(-m.x*W+m.y*i,-m.x*W-(1-m.y)*i,(1-m.x)*W+m.y*i,(1-m.x)*W-(1-m.y)*i),E=R.x-(r-e.x)*s.width),"position"===k&&"object"==typeof K._layoutHValue?(K._layoutHValue[0]=s.width,K._layoutHValue[1]=E):K._layoutHValue=[s.width,E,s.width,y.width,y.height,r]}switch(S){case"top":K._layoutVValue=R.y+e.y*s.height;break;case"bottom":K._layoutVValue=-R.y+(1-e.y)*s.height;break;case"center":K._layoutVValue=-R.y+(.5-e.y)*s.height;break;case"topbottom":case"scale":"scale"===S?E=-R.y+(.5-e.y)*s.height:(o||(m=K.getAnchor(),o=K.getRotation()-P.getRotation(),W=Math.cos(o),i=Math.sin(o)),r=-Math.min(-m.x*i-m.y*W,-m.x*i+(1-m.y)*W,(1-m.x)*i-m.y*W,(1-m.x)*i+(1-m.y)*W),E=R.y-(r-e.y)*s.height),"position"===k&&"object"==typeof K._layoutVValue?(K._layoutVValue[0]=s.height,K._layoutVValue[1]=E):K._layoutVValue=[s.height,E,s.height,y.width,y.height,r]}}}},getSerializableProperties:function(){var s=fh.superClass.getSerializableProperties.call(this);return Zc(s,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),s}});var Ld=T.Edge=function(l,u){var T=this;hg(Ld,T),T.setSource(l),T.setTarget(u)};ld("Edge",gl,{_icon:"edge_icon",getUIClass:function(){return Oi},_22Q:function(){return bs},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(X){var G=this;if(G._source!==X){var B=G._source;G._source=X,B&&B._16I(G),X&&X._2I(G),G._7I(),G.fp("source",B,X)}},setTarget:function(g){var z=this;if(z._target!==g){var b=z._target;z._target=g,b&&b._18I(z),g&&g._4I(z),z._7I(),z.fp("target",b,g)}},isLooped:function(){var m=this;return m._source===m._target&&!!m._source&&!!m._target},onPropertyChanged:function(){},_7I:function(){var T,y=this,Y=Ei(y);y._40I!==Y&&(T=this._40I,T&&T._15I(y),y._40I=Y,Y&&Y._1I(y),y.fp("sourceAgent",T,Y),ed(T,y._41I),ed(Y,y._41I));var p=ih(y);y._41I!==p&&(T=y._41I,T&&T._17I(y),y._41I=p,p&&p._3I(y),y.fp("targetAgent",T,p),ed(T,y._40I),ed(p,y._40I))},_22I:function(h){this._52I=h,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var P=this;return P._52I&&P._52I.get(0)!==P&&!P.getStyle(ee)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var k=this,v=k._52I;return v&&!k.getStyle(ee)&&v.size()>1&&k===v.get(0)},toggle:function(){var m=this._52I,E=!this.s(ee);m&&m.size()>1&&(m.each(function(O){O.s(ee,E)}),m.getSiblings().each(function(z){z!==m&&z.each(function(f){f.fp("edgeGroup",y,z)})}))},setStyle:function(L,o){(L===xp||"edge.segments"===L)&&(o=jr(o)),Ld.superClass.setStyle.call(this,L,o)},onStyleChanged:function(U){Ld.superClass.onStyleChanged.apply(this,arguments),Bj[U]&&ed(this._41I,this._40I)},getSerializableProperties:function(){var T=Ld.superClass.getSerializableProperties.call(this);return Zc(T,{source:1,target:1}),T}});var Dm=T.Group=function(){hg(Dm,this)};ld("Group",fh,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Sg},onChildAdded:function(){Dm.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Dm.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var n=this;if(!n._54I&&!Yd){var O=n.getChildrenRect();O&&(n._53I=1,n.p(Yi(n.s("group.position"),O,n.getSize())),delete n._53I)}},getChildrenRect:function(){var D,E=this;return E.eachChild(function(R){Np(R)&&(D=ks(D,E.getChildRect(R)))}),D},getChildRect:function(F){var p;return Np(F)&&F.s(op)&&(zc(F)&&F.isExpanded()&&F.eachChild(function(f){p=ks(p,F.getChildRect(f))}),!p&&F.getRect&&(p=F.getRect())),p},setPosition:function($,J){var G=this;if(!G._54I){var S;S=2===arguments.length?{x:$,y:J}:$,Yd||G._53I||(G._54I=1,ze(G._children,S.x-G._position.x,S.y-G._position.y),delete G._54I),Dm.superClass.setPosition.call(this,S)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(z){var Q=this;if(Q._57O!==z){var y=Q._57O;Q._57O=z,Q.fp("expanded",y,Q._57O),Q._fireInvalidateDeep(),Q._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(l){zc(l)?l._fireInvalidateDeep():l.iv()})},_8I:function(){Dm.superClass._8I.call(this),this.eachChild(function(b){Np(b)&&b._8I()})},onStyleChanged:function(z){Dm.superClass.onStyleChanged.apply(this,arguments),"group.position"===z&&this._81I()},getSerializableProperties:function(){var F=Dm.superClass.getSerializableProperties.call(this);return F.expanded=1,F}});var oj=T.Block=function(){hg(oj,this)};ld("Block",fh,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return os},onChildAdded:function(){oj.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){oj.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var n=this;if(!Yd&&!n._updatingToChildren&&n._syncSize&&!n._freezeSyncFromChildren){var j,B,k,i,o,t=[],V=n.getRotation();if(n.eachChild(function($){Np($)&&t.push.apply(t,$.getCorners())}),t.length){n._updatingFromChildren=1;var X=G(-V),p=f(-V),W=1/0,l=-1/0,x=1/0,L=-1/0;for(i=0,o=t.length;o>i;i++)k=t[i],j=k.x,B=k.y,k.x=X*j-p*B,k.y=p*j+X*B,W=Y(W,k.x),l=m(l,k.x),x=Y(x,k.y),L=m(L,k.y);var M=n.getScale();n.setSize(h((l-W)/M.x),h((L-x)/M.y));var z;M.x<0&&(z=W,W=l,l=z),M.y<0&&(z=x,x=L,L=z),X=G(V),p=f(V);var I=n.getAnchor();j=W+(l-W)*I.x,B=x+(L-x)*I.y,n.setPosition(X*j-p*B,p*j+X*B),delete n._updatingFromChildren}}},setPosition:function(B,Q){var V=this;if(!V._updatingToChildren){var l;l=2===arguments.length?{x:B,y:Q}:B,Yd||V._updatingFromChildren||(V._updatingToChildren=1,ze(V._children,l.x-V._position.x,l.y-V._position.y),delete V._updatingToChildren),oj.superClass.setPosition.call(this,l)}},setWidth:function(R){return this.setSize(R,this.getHeight())},setHeight:function(j){return this.setSize(this.getWidth(),j)},setSize:function(O,t){1>O&&(O=1),1>t&&(t=1);var Z=this;if(!Z._updatingToChildren){2!==arguments.length&&(t=O.height,O=O.width);var H=Z.getWidth(),F=Z.getHeight();if(O!==H&&oj.superClass.setWidth.call(Z,O),t!==F&&oj.superClass.setHeight.call(Z,t),!Yd&&!Z._updatingFromChildren){Z._updatingToChildren=1;var W=O/H,y=t/F;Z._adjustChildScaleOrSize(W,y,"size"),delete Z._updatingToChildren,Z.updateFromChildren()}}},_adjustChildScaleOrSize:function(W,I,E){var Y=this;if(Y._syncSize){var n=Y.getPosition(),j=Y.getRotation();Y.getScale(),Y.eachChild(function(h){if(Np(h)){var d=h.getPosition(),_=h.getRotation(),l=h.getWidth(),L=h.getHeight(),x=h.getScale(),R=x.x*l,a=x.y*L,Z=new Rc(_,d.x,d.y,R,a);Z.translate(-n.x,-n.y),Z.rotate(-j),_=B(Z.b*Math.sign(R),Z.a*Math.sign(R)),Z.scale(W,I);var S,c,g,s=G(_);if(Math.abs(s)<.001?(S=f(_),c=Z.b/S,g=-Z.c/S):(c=Z.a/s,g=Z.d/s),"scale"===E)h.setScale(c/l,g/L);else if("size"===E){var w=c/x.x,m=g/x.y;h.setScale(Kf(c)*Math.abs(x.x),Kf(g)*Math.abs(x.y)),h.setSize(Math.max(.1,Math.abs(w)),Math.max(.1,Math.abs(m)))}Z.rotate(j),Z.translate(n.x,n.y),h.setPosition(Z.tx,Z.ty)}})}},_calcChangeFactor:function(V,c,k,l){var X,w,T,p;return X=h(V),w=h(k),T=X>w?X/w:w/X,X=h(c),w=h(l),p=X>w?X/w:w/X,m(T,p)},setAnchor:function(){var a=this;if(!a._updatingToChildren){var J=a.getAnchor();if(oj.superClass.setAnchor.apply(a,arguments),!Yd&&!a._updatingFromChildren&&a._syncSize){a._updatingToChildren=1;var d=a.getAnchor();a.getPosition();var I=a.getSize(),S=a.getScale(),K=a.getRotation(),z=-I.width*S.x*(J.x-d.x),T=-I.height*S.y*(J.y-d.y),Y=f(K),y=G(K),u=y*z-Y*T,U=Y*z+y*T;a.eachChild(function(E){if(Np(E)){var t=E.getPosition();E.setPosition(t.x-u,t.y-U)}}),delete a._updatingToChildren}}},setRotation:function(p){var T=this;if(!T._updatingToChildren){var f=T.getRotation();if(oj.superClass.setRotation.apply(T,arguments),!Yd&&!T._updatingFromChildren){T._updatingToChildren=1;var Z=T.getPosition(),U=p-f;T.eachChild(function(N){if(Np(N)){var C=N.getMatrix();C.translate(-Z.x,-Z.y),C.rotate(U),C.translate(Z.x,Z.y);var V=Math.sign(N.getScale().x);N.setRotation(B(C.b*V,C.a*V)),N.setPosition(C.tx,C.ty)}}),delete T._updatingToChildren}}},setScale:function(y,d){var C=this;if(!C._updatingToChildren){null==d&&(d=y.y,y=y.x);var b=C.getScale();if(h(y)<.01&&(y=.01*(Kf(y)||Kf(b.x))),h(d)<.01&&(d=.01*(Kf(d)||Kf(b.y))),oj.superClass.setScale.call(C,y,d),!Yd&&!C._updatingFromChildren){C._updatingToChildren=1;var W=y/b.x,Y=d/b.y;C._adjustChildScaleOrSize(W,Y,"size"),delete C._updatingToChildren,C.updateFromChildren()}}},getSerializableProperties:function(){var I=oj.superClass.getSerializableProperties.call(this);return I.clickThroughEnabled=1,I.syncSize=1,I}});var dn=T.Grid=function(){hg(T.Grid,this)};ld("Grid",fh,{IRotatable:!1,_icon:"grid_icon",_image:y,getUIClass:function(){return yn},setRotation:function(){},getCellRect:function(m,p){var S=this,g=S.s("grid.row.count"),N=S.s("grid.column.count");if(0>=g||0>=N||0>m||m>=g||0>p||p>=N)return y;var h,U,z,B=S.getRect(),b=S.s("grid.row.percents"),K=S.s("grid.column.percents");if(Vh(B,S,"grid.border",-1),b&&b._as&&(b=b._as),K&&K._as&&(K=K._as),b&&b.length===g){for(z=0,h=0;m>h;h++)z+=B.height*b[h];B.y+=z,B.height=B.height*b[m]}else B.height=B.height/g,B.y+=B.height*m;if(K&&K.length===N){for(U=0,h=0;p>h;h++)U+=B.width*K[h];B.x+=U,B.width=B.width*K[p]}else B.width=B.width/N,B.x+=B.width*p;return oo(B,-S.s("grid.gap")),B}});var Po=T.Text=function(){hg(Po,this),this.setSize(100,50),this.s("text","TEXT")};ld("Text",fh,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Mi},setWidth:function(F){F||(F=.001),Po.superClass.setWidth.call(this,F)},setHeight:function(u){u||(u=.001),Po.superClass.setHeight.call(this,u)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),hj("__text__",{width:{value:100,isSafeFunc:!0,func:function(z){return z._width}},height:{value:50,isSafeFunc:!0,func:function(Q){return Q._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var Nm=T.Shape=function(){hg(Nm,this),this._59O=new wk};Nm.__de__=Bc,ld("Shape",fh,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return jo},_22Q:function(){return Zm},getLength:function(S){return Lg(Or(this._59O,this._58O,S,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var $=this._58O;return $?new wk($._as.slice(0)):$},setSegments:function(z){var p=this._58O;z=z?$l(z)?new wk(z.slice(0)):new wk(z._as.slice(0)):null,(p&&z&&p._as.join(",")!==z._as.join(",")||p!==z)&&(this._58O=z,this.fp("segments",p,z))},getPoints:function(){return this._59O},toPoints:function(){var M=this._59O;return new wk(M._as.slice(0))},setPoints:function(G,x){var f=this,w=f._59O;G=G?$l(G)?new wk(G.slice(0)):new wk(G._as.slice(0)):new wk;var l,$,d,o,u,C;x&&(l=f.getPosition(),C=new Rc(f.getRotation(),0,0,f.getScale().x,f.getScale().y)),(w&&G&&w._as.join(",")!==G._as.join(",")||w!==G)&&(f._59O=G,f.fs(),f.fp("points",w,G)),x&&($=f.getPosition(),d=$.x-l.x,o=$.y-l.y,u=C.tf(d,o),f.setPosition($.x-d+u.x,$.y-o+u.y))},addPoint:function(p,k,F){var f=this.toPoints();f.add(p,k),this.setPoints(f,F)},setPoint:function(o,W,t){var f=this.toPoints();f.set(o,W),this.setPoints(f,t)},removePointAt:function(V){var v=this.toPoints();v.removeAt(V),this.setPoints(v)},setWidth:function(J){var z=this;if(1>J&&(J=1),!z._55I&&!Yd&&z.getWidth()){z._55I=1;var y=z._position.x,B=J/z.getWidth(),E=z.toPoints(),i=new wk;E.each(function(z){i.add({x:(z.x-y)*B+y,y:z.y,e:z.e})}),z.setPoints(i),jh(z,[B,0,0,1,y*(1-B),0]),z.fs(),delete z._55I}Nm.superClass.setWidth.call(z,J)},setHeight:function(v){var r=this;if(1>v&&(v=1),!r._55I&&!Yd&&r.getHeight()){r._55I=1;var c=r._position.y,L=v/r.getHeight(),l=r.toPoints(),d=new wk;l.each(function(v){d.add({x:v.x,y:(v.y-c)*L+c,e:v.e})}),r.setPoints(d),jh(r,[1,0,0,L,0,c*(1-L)]),r.fs(),delete r._55I}Nm.superClass.setHeight.call(r,v)},setAnchorElevation:function(T){var $=this;$._55I=!0;var J=$._updatingAnchor3d,R=!Yd&&!J;if(R){var m,u=T,p=$.getAnchorElevation(),k=$.getTall();m=k*(p-u),$.shiftPointsElevation(m)}var G=Nm.superClass.setAnchorElevation.apply($,arguments);return J||delete $._55I,G},getShapeElevation:function(){var R=this,G=R._54O;return G-(R.getTall()||0)*(R._anchorElevation-.5)},setAnchor3d:function(s,U,q,M){var p,Z=this;"number"==typeof s?p={x:s,y:U,z:q}:(p=s.length?{x:s[0],y:s[1],z:s[2]}:s,M=U),Z._55I=!0,Z._updatingAnchor3d=!0;var c=Z.getDataModel();if(c&&c.beginTransaction(),!Yd){var g=Z.getAnchor3d(),L=Z.getSize(),r=Z.getTall(),O=L.width*(g.x-p.x),K=L.height*(g.z-p.z),f=r*(g.y-p.y);M||Z.shiftPoints(O,K,f);var D=Z.p3()}var _=Nm.superClass.setAnchor3d.apply(Z,arguments);if(!Yd&&M){var a=Z.p3();Z.shiftPoints(a[0]-D[0]+O,a[2]-D[2]+K,a[1]-D[1]+f)}return c&&c.endTransaction(),delete Z._updatingAnchor3d,delete Z._55I,_},setAnchor:function(x,n,A){var N=this;N._55I=!0;var m=N._updatingAnchor3d,X=!Yd&&!m;if(X){var L,U,Y;"number"==typeof x?Y={x:x,y:n}:(Y=x.length?{x:x[0],y:x[1]}:x,A=n);var Q=N.getAnchor(),g=N.getSize();L=g.width*(Q.x-Y.x),U=g.height*(Q.y-Y.y),A||N.shiftPoints(L,U);var k=N.getPosition()}var P=Nm.superClass.setAnchor.apply(N,arguments);if(X){var K=N.getPosition();A&&N.shiftPoints(K.x-k.x+L,K.y-k.y+U)}return m||delete N._55I,P},shiftPoints:function(e,m,F){var B=this,s=B.getElevation()||0,E=B.toPoints(),z=new wk;E.each(function(i){var j=i.e;F&&(j=(j==y?s:j)+F),z.add({x:i.x+e,y:i.y+m,e:j})}),B.setPoints(z),B.fs()},shiftPointsElevation:function(Q){return this.shiftPoints(0,0,Q)},setPosition:function(m,C){var P,f=this;if(!f._28Q){if(f._28Q=1,!f._55I&&!Yd){P=2===arguments.length?{x:m,y:C}:m;var Q=P.x-f._position.x,t=P.y-f._position.y;if(0===Q&&0===t)return delete f._28Q,void 0;f._55I=1,f.shiftPoints(Q,t),jh(f,[1,0,0,1,Q,t]),delete f._55I}Nm.superClass.setPosition.apply(f,arguments),delete f._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var Z=this;if(2!==Z._59O.size())return!1;var P=Z._58O;return P?2===P.size()&&1===P.get(0)&&2===P.get(1)?!0:!1:!0},fireShapeChange:function(){var _=this;if(!_._55I&&!Yd){var d=wm(_._59O);d&&(_._55I=1,_.setRect(d),delete _._55I)}_.fp(Kg,!1,!0)},getSerializableProperties:function(){var A=Nm.superClass.getSerializableProperties.call(this);return A.segments=1,A.points=1,A.thickness=1,A.closePath=1,A}});var jn=T.Polyline=function(){hg(jn,this),this.s({"shape.background":null,"shape.border.width":2})};ld("Polyline",Nm,{_icon:"polyline_icon",_22Q:function(){return cr},getUIClass:function(){return Kp},setClosePath:function(){},setTall:function(X){var R=this;if(!R._55I&&!R._24Q&&!Yd&&R.getTall()){R._24Q=1;var W=R._54O,C=X/R.getTall();R._59O.each(function(A){A.e=A.e==y?W:(A.e-W)*C+W}),R.fs(),delete R._24Q}jn.superClass.setTall.call(R,X)},setElevation:function(k){var m=this;if(!m._55I&&!m._24Q&&!Yd){m._24Q=1;var U=k-m._54O;m._59O.each(function(F){F.e==y?F.e=k:F.e+=U}),m.fs(),delete m._24Q}jn.superClass.setElevation.apply(m,arguments)},fireShapeChange:function(){var n=this,B=n._59O;if(!n._55I&&!n._24Q&&!Yd){var i=B.size();if(i){var C=1,f=B.get(0),l=n._54O;f.e==y&&(f.e=l);for(var F=f.e,b=0;i>C;C++){f=B.get(C),f.e==y&&(f.e=l);var r=Y(F,f.e),s=m(F+b,f.e);F=r,b=s-r}n._24Q=1,n.setTall(b),n.setElevation(F+b*n._anchorElevation),delete n._24Q}}jn.superClass.fireShapeChange.apply(n,arguments)}});var Hp=T.SubGraph=function(){hg(Hp,this)};ld("SubGraph",fh,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Hp.superClass._8I.call(this),this.eachChild(function($){Np($)&&$._8I()})}}),N.loadingRefGraph=0;var Ig=T.RefGraph=function(){hg(Ig,this)};ld("RefGraph",oj,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(u){var f=this._ref;this._ref=u,this.fp("ref",f,u),this.updateRef()},_21I:function(){Ig.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var C=this;if(N.loadingRefGraph++,C.clearChildrenFromDataModel(),N.loadingRefGraph--,C._ref&&C._dataModel){C._xhrLoadHandler&&(C._xhrLoadHandler.cancel=!0);var k=Yd,D=C._xhrLoadHandler=function(R){if(R&&C._dataModel){N.loadingRefGraph++;var T=C._pendingUpdateInfo={needToRestore:k};k&&(T.position=C.p(),T.width=C.getWidth(),T.height=C.getHeight(),T.rotation=C.getRotation(),T.anchor=C.getAnchor(),T.scale=C.getScale()),C.p(0,0),C.setAnchor(.5,.5),C.setRotation(0),C.setScale(1,1);var H=N.parse(R),l=C._dataModel.deserialize(H,C,{justDatas:!0});l.each(function(t){t._refGraph=C}),C.checkPendingUpdateInfo(),N.loadingRefGraph--,N.handleRefGraphLoaded(C,l,H)}};D.xhrLoadCalled=!1,N.load(C._ref,function(R){D.cancel||(D.xhrLoadCalled?D(R):_o(function(){D(R)}))}),D.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var d=this,W=d._pendingUpdateInfo;if(!W)return d.onPendingUpdated&&(N.loadingRefGraph++,d.onPendingUpdated(),N.loadingRefGraph--),void 0;var $=!0;this.eachChild(function(f){(f._pendingCheckImageJSON||f._pendingUpdateInfo)&&($=!1)}),$&&(N.loadingRefGraph++,d._pendingUpdateInfo=null,d.updateFromChildren(),W.needToRestore&&(d.setSize(W.width,W.height),d.setAnchor(W.anchor),d.setRotation(W.rotation),d.setScale(W.scale),d.p(W.position)),this.getParent()instanceof Ig&&this.getParent().checkPendingUpdateInfo(),d.onPendingUpdated&&d.onPendingUpdated(),N.loadingRefGraph--)},getSerializableProperties:function(){var B=Ig.superClass.getSerializableProperties.call(this);return B.ref=1,B}}),T.EdgeGroup=function(O,b){this._70O=O,this._siblings=b;for(var W,z,g=0,T=O.size(),$=c[ee];T>g;g++)if(W=O.get(g).getStyle(ee,!1),W!=y){$=W;break}$==y&&($=!0);var H=N.edgeGroupAgentFunc;for(H&&(z=H(O),z&&z!==O.get(0)&&(O.remove(z),O.add(z,0))),g=0;T>g;g++)O.get(g).s(ee,$)},ld("EdgeGroup",M,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(S){return this._70O.get(S)},indexOf:function(l){return this._70O.indexOf(l)},each:function(x,X){this._70O.each(x,X)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(e,N){this._siblings.each(function(i){i._70O.each(e,N)})}});var wq=function(g,n,V){var v=Ub[g]={type:g,action:n};if(V)for(var c in V)v[c]=V[c]};Zc(N,{setConnectAction:wq,getConnectAction:function(z,t){if(!t){if(!z)return null;t=z.getCurrentConnectActionType()}return Ub[t]},doConnectAction:function(i,M,Q,I){I=I||i.getCurrentConnectActionType();var G=Ub[I];if(!G)return!1;var n=G.action;return n?(M instanceof cg.Group?i.sm().getSelection().each(function(q){n.call(null,i,q,Q)}):n.call(null,i,M,Q),!0):!1},doDeleteConnectionAction:function(Z,l,q){q=q||Z.getCurrentConnectActionType();var a=Ub[q];if(!a||!a.delete)return!1;var E=a.delete.action;return E?(l instanceof cg.Group?Z.sm().getSelection().each(function(R){E.call(null,Z,R)}):E.call(null,Z,l),!0):!1}});var ck=T.JSONSerializer=function(W,u){this.dm=this._dataModel=W,this._hierarchical=N.forceHierarchicalSerialization?!0:u==y?W.isHierarchicalRendering():u};ld("JSONSerializer",M,{ms_ac:["hierarchical"],serialize:function(Q){return N.stringify(this.toJSON(),Q)},toJSON:function(){var e=this,f=e.dm,Z=f.getRoots(),D=e.json={v:N.getVersion(),p:{},a:{},d:[]},E=f.getSerializableAttrs();f.getInit()&&(D.init=f.getInit()),f.getName()&&(D.p.name=f.getName()),f.getBackground()&&(D.p.background=f.getBackground()),f.getLayers()&&(D.p.layers=f.getLayers()),f.getEnvmap()&&(D.p.envmap=f.getEnvmap()),D.p.autoAdjustIndex=f.isAutoAdjustIndex(),D.p.hierarchicalRendering=f.isHierarchicalRendering();for(var X in E){var x=f.a(X);x!==d&&e[sd](X,x,D.a)}return Ar(D.a)&&delete D.a,e._hierarchical?Z.each(e.serializeData,this):f.each(function(L){e.serializeData(L)}),f.fireSerializeEvent({type:"serialize",json:D}),f.getPostProcessingData()&&(D.p.postProcessingData=f.getPostProcessingData()),D},isSerializable:function(){return!0},getProperties:function(g){return g.getSerializableProperties()},getStyles:function(k){return k.getSerializableStyles()},getAttrs:function(p){return p.getSerializableAttrs()},serializeData:function(e){var X=this;if(X.isSerializable(e)&&!e._refGraph){var u,v,f,c,y=Ic(e.getClassName())||e.getClass(),S=new y,A={c:e.getClassName(),i:e.getId(),p:{},s:{},a:{}};
X.json.d.push(A),u=X.getProperties(e);for(v in u)if(/^_/.test(v)){if(f=e[v],("_width"===v||"_height"===v)&&f===d){var U;((e.s("layout.h")||e.s("layout.v"))&&e.getHost()||e instanceof T.Node&&(U=e.getParent())&&U instanceof T.Block||e.s("fullscreen"))&&(f=e[v]="_width"===v?e.getWidth():e.getHeight())}f!==S[v]&&X[sd](v.substr(1),f,A.p)}else c=$r(v),e[c]&&(f=e[c](),f!==S[c]()&&X[sd](v,f,A.p));u=X.getStyles(e);for(v in u)f=e.s(v),f!==S.s(v)&&X[sd](v,f,A.s);u=X.getAttrs(e);for(v in u)f=e.a(v),f!==S.a(v)&&X[sd](v,f,A.a);Ar(A.p)&&delete A.p,Ar(A.s)&&delete A.s,Ar(A.a)&&delete A.a}X._hierarchical&&e.getChildren().each(X.serializeData,X)},serializeValue:function(V,n,z){ic(n)?n={__a:n._as}:n instanceof gl&&(n={__i:n.getId()}),z[V]=n},deserialize:function(O,S,w){var I=this;return Hc(O)&&/.json$/.test(O)?(N.xhrLoad(O,function(t){I.deserializeImpl(t,S,w)}),void 0):I.deserializeImpl(O,S,w)},deserializeImpl:function(x,w,m){var L=this,B=L.dm;m=Go(m)?{setId:m}:Lc(m)?{finishFunc:m}:m||{},x=L.json=Hc(x)?N.parse(x):x,x.a&&x.a.onPreDeserialize&&!m.disableOnPreDeserialize&&x.a.onPreDeserialize(x,B,m.view),B.beginTransaction(),Yd++,L._82I={};var p=new wk,V=new wk,q=0,P=x.d.length;if(m.justDatas||(Lc(x.init)&&x.init(B),B.setInit(x.init)),!m.justDatas){for(var G in x.a)B.a(G,L[Ko](x.a[G]));for(var C in x.p)B[Tl(C)](x.p[C])}for(;P>q;q++){var $=x.d[q],H=Ic($.c),K=new H,Q=$.i;m.setId&&Q!=y&&(K._id=Q),L._82I[Q]=K,p.add(K),V.add($)}for(q=0;P>q;q++)L.deserializeData(p.get(q),V.get(q));return p.each(function(E){w&&!E.getParent()&&E.setParent(w),B.add(E)}),B.fireSerializeEvent({type:"deserialize",json:x}),Yd--,B.endTransaction(),x.a&&x.a.onPostDeserialize&&!m.disableOnPostDeserialize&&x.a.onPostDeserialize(x,B,m.view,p),m.finishFunc&&m.finishFunc(x,B,m.view,p),p},deserializeData:function(j,N){for(var X in N.p)j[Tl(X)](this[Ko](N.p[X]));for(X in N.s)j.s(X,this[Ko](N.s[X]));for(X in N.a)j.a(X,this[Ko](N.a[X]))},deserializeValue:function(p){if(Bh(p)){var V=p.__i;if(V!=y)return this._82I[V];if(V=p.__a,$l(V))return new wk(V)}return p}}),Zc(ub,{serialize:function(G,M){return new ck(this,M).serialize(G)},toJSON:function(y){return new ck(this,y).toJSON()},deserialize:function(k,L,h){return new ck(this).deserialize(k,L,h)}});var jq=T.OverlappingBox=function(x){this.gv=x,this.boxes={}};ld("OverlappingBox",M,{clear:function(){var W,D,c=this.boxes;for(W in c)D=c[W],D.length=0},isOverlapping:function(r,i){var S,Q,O=this,v=O.boxes,H=v[r];H?(S=H.rects,Q=H.length):H=v[r]={rects:S=[],length:Q=0};var W,f,i;for(W=0;Q>W;W++)if(f=S[W],f.x<i.x+i.w&&f.x+f.w>i.x&&f.y<i.y+i.h&&f.h+f.y>i.y)return!0;return S.length<=Q?(S.push(i),H.length++):S[H.length++]=i,!1}}),Zc(N,{fetch:function(F,b){var s="GET",i=!1,h=null,B="";b&&(s=b.method||"GET",i=b.sync,B=b.url,h=b.data||null),F.open(s,B,!i),b.responseType?F.responseType=b.responseType:b.overrideMimeType&&F.overrideMimeType&&F.overrideMimeType(b.overrideMimeType),F.send(h)},convertImageSrc:function(J,K){K&&"function"==typeof K||(K=function(){}),K(J)}});var Gh=T.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};ld("Request",M,{_responseType:null,_overrideMimeType:"text/plain",send:function($){var H=this._xhr,f=this.onload,R=this.onerror;this.getResponseType()?$.responseType=this.getResponseType():this.getOverrideMimeType()&&($.overrideMimeType=this.getOverrideMimeType()),H.onload=f,H.onerror=R,N.fetch(H,$)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(f){this._responseType=f},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(z){this._overrideMimeType=z},getResponseText:function(){var c=this._xhr;return c.response||c.responseText}}),fc.GraphView=function(O){var z=this;z._24I={},z._34I=new wk,z._25I={},z._56I={},z._view=jj(1,z),z._canvas=ff(z._view),z.dm(O?O:new ub),this._coreInteractor=new al(this),z.setEditable(!1),z.setScrollBarVisible(N.graphViewScrollBarVisible)},wo("GraphView",M,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Zq,nm,bf,vi,"resettable","editInteractor",ne,"pannable","rectSelectable","autoScrollZone",Tn,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:N.graphViewResettable,_pannable:N.graphViewPannable,_rectSelectable:N.graphViewRectSelectable,_autoScrollZone:N.graphViewAutoScrollZone,_rectSelectBackground:N.graphViewRectSelectBackground,_rectSelectBorderColor:N.graphViewRectSelectBorderColor,_editPointSize:N.graphViewEditPointSize,_editPointBorderColor:N.graphViewEditPointBorderColor,_editPointBackground:N.graphViewEditPointBackground,_scrollBarColor:Li,_scrollBarSize:mq,_autoHideScrollBar:Br,_autoMakeVisible:Vn,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(G){this._dataModel.setLayers(G)},setEditable:function(b){var A=this,H=A.__interactorMap__;if(!H){var t=fc.XEditInteractor;H=A.__interactorMap__={scrollBar:new Cj(A),select:new dj(A),edit:t?new t(A):new Lo(A),move:new ai(A),"default":new Jq(A),touch:new Xi(A,{editable:!1})}}b?(A._uieditable=!0,A.setInteractors([H.scrollBar,H.select,H.edit,H.move,H.default,H.touch])):(A._uieditable=!1,A.setInteractors([H.scrollBar,H.select,H.move,H.default,H.touch]))},getCanvas:function(){return this._canvas},_33I:function(u){var U=u.getUIClass();return U?new U(this,u):y},getDataUI:function(F){var J=this,T=J._25I[F._id];return T===d&&(T=J._33I(F),J._25I[F._id]=T),T},getNodeRect:function(y){return N.getNodeRect(this,y)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(d){var k=this.getDataUI(d);return k?(k._79o(),k._78o):null},getEdgeSourcePosition:function(S){var e=this,D=e.getDataUI(S),N=D.s,M=D._data._40I;return Bd(e,M,N("edge.source.position"),N("edge.source.offset.x"),N("edge.source.offset.y"),N("edge.source.anchor.x"),N("edge.source.anchor.y"))},getEdgeTargetPosition:function(m){var q=this,E=q.getDataUI(m),c=E.s,I=E._data._41I;return Bd(q,I,c("edge.target.position"),c("edge.target.offset.x"),c("edge.target.offset.y"),c("edge.target.anchor.x"),c("edge.target.anchor.y"))},invalidateAll:function(L){var Y=this;if(L){for(var T in Y._25I){var Z=Y._25I[T];Z&&Z.dispose()}Y._25I={},Y._56I={},Y._24I={},Y._34I.clear(),Y.redraw()}else Y.dm().each(function(m){Y.invalidateData(m)})},invalidateSelection:function(){var g=this;g.sm().each(function(r){g.invalidateData(r)})},invalidateData:function(Y){var Z=this;Z._24I[Y._id]=Y,Z._21Q(Y),Z.iv()},_21Q:function(n){var P=this,p=P._24I;if(Nl(n)&&Gp[n.s(Zn)]){var v=n.getSourceAgent();v&&v.getAgentEdges().each(function(k){p[k._id]=k}),v=n.getTargetAgent(),v&&v.getAgentEdges().each(function(d){p[d._id]=d}),P.iv()}},redraw:function(p){var _=this;_._32I||(p?_._34I.add(p):(_._32I=1,_._34I.clear()),_.iv())},each:function(s,n){var d,C,g,f=0,z=this.getLayers(),X=this._dataModel,L=X._datas._as,S=L.length;if(z){for(var B=z.length;B>f;f++)if(g=z[f],Bh(g)&&(g=g.name),X.isHierarchicalRendering()){var N=function(e){return e._layer===g?n?s.call(n,e):s(e):void 0};if(this._dataModel.eachByHierarchical(N)===!1)return}else for(var l=0;S>l;l++)if(d=L[l],d._layer===g&&(C=n?s.call(n,d):s(d),C===!1))return}else if(X.isHierarchicalRendering())this._dataModel.eachByHierarchical(s,null,n);else for(;S>f;f++)if(d=L[f],C=n?s.call(n,d):s(d),C===!1)return},reverseEach:function(z,Z){var c,C,k,X,d=this._dataModel,F=d._layers,N=d._datas._as,Y=N.length;if(F){for(c=F.length-1;c>=0;c--)if(X=F[c],Bh(X)&&(X=X.name),d.isHierarchicalRendering()){var L=function(v){return v._layer===X?Z?z.call(Z,v):z(v):void 0};if(d.reverseEachByHierarchical(L)===!1)return}else for(var K=Y-1;K>=0;K--)if(C=N[K],C._layer===X&&(k=Z?z.call(Z,C):z(C),k===!1))return}else if(d.isHierarchicalRendering())d.reverseEachByHierarchical(z,null,Z);else for(c=Y-1;c>=0;c--)if(C=N[c],k=Z?z.call(Z,C):z(C),k===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var c=this,o=c._84I;if(!o){var Z=this.dm().a("width"),p=this.dm().a("height");Z>0&&p>0?c._84I={x:0,y:0,width:Z,height:p}:(c.each(function(D){c.isVisible(D)&&(o=ks(o,c.getDataUIBounds(D)))}),c._84I=o?o:Eo)}return c._84I},getScrollRect:function(){return ks(this.getContentRect(),this._29I)},makeCenter:function(o,R,U){var C=this;if(!C.getWidth()||!C.getHeight())return U||_o(C.centerData,C,[o,R,!0],500),void 0;C.makeVisible(o),C.validate();var c=C.getDataUIBounds(o);if(c){var I=C.getWidth(),v=C.getHeight(),V=c.x+c.width/2,X=c.y+c.height/2,E=-V*C._zoom+I/2,J=-X*C._zoom+v/2;C.setTranslate(E,J,R)}},fitData:function(B,f,Z,q,F){var s=this;if(!s.getWidth()||!s.getHeight())return F||_o(s.fitData,s,[B,f,Z,q,!0],500),void 0;var v=function(){s.makeVisible(B),s.validate();var v=s.getDataUIBounds(B);v&&(v=zf(v),oo(v,Z==y?20:Z),s.fitRect(v,f,q))};f?N.callWhenLoaded(v):v()},fitContent:function(a,v,g,L){var J=this;if(!J.getWidth()||!J.getHeight())return L||_o(J.fitContent,J,[a,v,g,!0],500),void 0;var O=function(){J.validate();var x=zf(J.getContentRect());oo(x,v==y?20:v),J.fitRect(x,a,g)};a?N.callWhenLoaded(O):O()},fitRect:function(G,M,o){var K=this,t=K.getWidth(),D=K.getHeight(),k=G.x+G.width/2,P=G.y+G.height/2,g=Y(t/G.width,D/G.height),l=K._zoom,s=-k*l+t/2,L=-P*l+D/2;0===g||isNaN(g)||(o&&(g=Y(1,g)),M?(K._65I&&(delete K._65I.finishFunc,K._65I.stop(!0)),K._14o&&K._14o.stop(!0),K.setTranslate(s,L,{finishFunc:function(){K.setZoom(g,M)}})):(K.setTranslate(s,L),K.setZoom(g)))},toCanvas:function(N,L){L=L||this._zoom,this.validateImpl();var b=this,h=b.getContentRect();h.width||(h.width=10),h.height||(h.height=10);var k=ff(),A=h.x*L,F=h.y*L,I=h.width*L,a=h.height*L;$b(k,I,a,1);var B=Hl(k);return N=N||this._dataModel.getBackground(),N&&Gf(B,0,0,I,a,N),Gj(B,-A,-F),B.scale(L,L),b._42(B),B.restore(),k},toDataURL:function(u,s,H){return this.toCanvas(u,H).toDataURL(s||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(V,R){var H=this,P=this.__htmlOrderList,f=[];if(H._93db(V,R),H.each(function(p){var L=H.getDataUI(p);if(L){var K=H._56I[p._id],r=L._htmlView;if(K){var A=L._79o();if(r=L._htmlView,T.HtmlNode&&p instanceof T.HtmlNode)L._42(V);else{var Z=H.getViewRect(),J=r&&r.layoutHTML;!R||Iq(R,A)?(J&&(r.layoutHTML(),L.__outerLayout&&delete L.__outerLayout),L._42(V)):Iq(Z,A)||!J||L.__outerLayout||(r.layoutHTML(),L.__outerLayout=!0)}}r&&(f.push(r),r.getView&&(r=r.getView()),r.style.display=K?"block":Pf)}}),P&&f.length>0){var E=!1;if(P.length!==f.length)E=!0;else for(var c=0;c<f.length;c++)if(f[c]!==P[c]){E=!0;break}E&&(f.forEach(function(z){H.appendHTML(z,!0)}),this.__htmlOrderList=f)}else this.__htmlOrderList=f;H._92db(V,R)},validateImpl:function(){this.tryUpdateRootData();var G,k,X,J,f,F=this,V=F.tx(),q=F.ty(),n=F._zoom,B=F._canvas,e=this.getWidth(),h=this.getHeight(),S=F._29I,I={x:-V/n,y:-q/n,width:e/n,height:h/n},L={},U=F._34I,y=F._24I,T=F._32I,O=F._23I;F._24I={},(e!==B.clientWidth||h!==B.clientHeight)&&($b(B,e,h),T=1),T||be(I,S)||(T=1),F._29I=I,F.each(function($){k=$._id;var w=L[k]=F.isVisible($);w!==F._56I[k]&&(y[k]=$,X=F.getDataUI(y[k]),X&&X._84o(w),F._84o($,w))},F);for(k in y)X=F.getDataUI(y[k]),X&&(!T&&F._56I[k]&&(f=X._79o(),f&&U.add(f)),X.invalidate()),F._83I=1;if(F._56I=L,!T)for(k in y)L[k]&&(X=F.getDataUI(y[k]),X&&(f=X._79o(),f&&U.add(f)));if(T?J=I:(U.each(function(f){Iq(I,f)&&(J=ks(J,f))}),J&&(oo(J,m(1,1/n)),J.x=C(J.x*n)/n,J.y=C(J.y*n)/n,J.width=i(J.width*n)/n,J.height=i(J.height*n)/n,J=nd(I,J))),F._74O=J,J){G=Hl(B);var Y=J.x,u=J.y,_=J.width,r=J.height;Y=Math.floor((Y*n+V)*Kl),u=Math.floor((u*n+q)*Kl),_=Math.ceil(_*n*Kl)+1,r=Math.ceil(r*n*Kl)+1,G.beginPath(),G.rect(Y,u,_,r),G.clip(),G.clearRect(Y,u,_,r),ls(G,V,q,n),F._42(G,J),G.restore(),delete F._74O}if(U.clear(),delete F._32I,O&&e>0&&h>0){var X=F.getDataUI(O);if(X){var f=X._79o(),A=F._29I,E=A.x,R=A.y,Z=A.width,v=A.height,n=F._zoom;f&&!Iq(f,A)&&(f.x+f.width<E&&F.tx(-f.x*n),f.x>E+Z&&F.tx(-(f.x+f.width-Z)*n),f.y+f.height<R&&F.ty(-f.y*n),f.y>R+v&&F.ty(-(f.y+f.height-v)*n))}delete F._23I}F._83I&&(delete F._83I,delete F._84I),F._98O(),F.countFrame(),Ar(F._24I)||_o(F.iv,F)},tryUpdateRootData:function(){var q,a=this.getFullscreenDatas();for(var v in a)q=a[v],this.scaleRootData(q)},scaleRootData:function(R){var m=R.s("fullscreen");if("uniform"===m||"fill"===m){R.setRotation(0);var E,A=R.s("fullscreen.gap")||0,P=this.getWidth()-2*A,X=this.getHeight()-2*A,i=R.getAnchor(),g=R.getScaledSize(),b=g.width,Y=g.height,T=R.s("fullscreen.lock");if(T)return"uniform"===m?P/X>b/Y?(E=X/Y,b=Y*P/X):(E=P/b,Y=b*X/P):"v"===T?(E=X/Y,b=P/E,R.setWidth(b)):(E=P/b,Y=X/E,R.setHeight(Y)),this.setZoom(E),this.tx(A-(R.getX()-i.x*b)*E),this.ty(A-(R.getY()-i.y*Y)*E),void 0;var N=this.tx(),l=this.ty();E=this._zoom;var r={x:(-N+A)/E,y:(-l+A)/E,width:P/E,height:X/E};if("uniform"===m){var e=b/Y,O=Math.min(r.width,r.height*e),S=O/e;r.x+=.5*(r.width-O),r.y+=.5*(r.height-S),r.width=O,r.height=S}R.setSize(r.width/R.getScaleX(),r.height/R.getScaleY()),R.setPosition(r.x+i.x*r.width,r.y+i.y*r.height)}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(O){var u=this;O!==u.isScrollBarVisible()&&(O?(Ah(u._view,u._79O=Mg()),Ah(u._79O,u._27I=Mg()),Ah(u._79O,u._28I=Mg())):(Hm(u._79O),delete u._79O,delete u._27I,delete u._28I),u.fp("scrollBarVisible",!O,O))},getDebugTip:function(){return""},showScrollBar:function(){var v=this;v._79O&&(v._85I||(X(function(){v._86I()},lb),v.iv()),v._85I=new Date)},_86I:function(){var w=this;if(w._85I){var h=new Date,B=h.getTime();B-w._85I.getTime()>=lb?(delete w._85I,w.iv()):X(function(){w._86I()},lb)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var _=this,Z=this._27I,d=this._28I;if(_._79O){if(_._autoHideScrollBar&&!_._85I)return Z.style.visibility=ie,d.style.visibility=ie,void 0;var m=_.getScrollBarColor(),J=_._zoom,q=_.getScrollBarSize(),D=_.getViewRect(),I=_.getScrollRect(),T=D.height*J,N=I.height*J,$=D.width*J-q-2,k=T*((D.y-I.y)*J/N),z=T*(T/N),g=Z.style;N-.5>T?(Ib>z&&(k=k+z/2-Ib/2,0>k&&(k=0),k+Ib>T&&(k=T-Ib),z=Ib),Ce(Z,$,k,q,z),g.visibility=nc,g.background=m,g.borderRadius=q/2+Tg):g.visibility=ie;var U=D.width*J,C=I.width*J,k=D.height*J-q-2,$=U*((D.x-I.x)*J/C),t=U*(U/C),g=d.style;C-.5>U?(Ib>t&&($=$+t/2-Ib/2,0>$&&($=0),$+Ib>U&&($=U-Ib),t=Ib),Ce(d,$,k,t,q),g.visibility=nc,g.background=m,g.borderRadius=q/2+Tg):g.visibility=ie}},setDataModel:function(F){var R=this,i=R._dataModel,P=R._selectionModel;i!==F&&(i&&(i.ump(R.handleDataModelPropertyChange,R),i.umm(R.handleDataModelChange,R),i.umd(R.handleDataPropertyChange,R),i.removeIndexChangeListener(R._75O,R),i.removeHierarchyChangeListener(R.handleHierarchyChange,R),P||i.sm().ums(R.handleSelectionChange,R)),R._dataModel=F,F.mp(R.handleDataModelPropertyChange,R),F.mm(R.handleDataModelChange,R),F.md(R.handleDataPropertyChange,R),F.addIndexChangeListener(R._75O,R),F.addHierarchyChangeListener(R.handleHierarchyChange,R),P?P._21I(F):F.sm().ms(R.handleSelectionChange,R),R.invalidateAll(!0),R.fp(ns,i,F),R._canvas.style.background=F.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===d){var i=this.getLayers();i?(this._layersInfo={},i.forEach(function(y){var g=Bh(y)?y.name:y;this._layersInfo[g]=y},this)):this._layersInfo=null}return this._layersInfo},calculateAttachPoint:function(){var b=new Ie,z=new Ie,l=new Ie;return function(W,X){var I=this.getAttachPoints(W);if(!I||!I.length)return null;l.set(X.x,X.y);for(var B,$,q,j,r=1/0,e=0,v=I.length;v>e;e++)q=I[e],z.x=q.x,z.y=q.y,b.x=q.offsetX||0,b.y=q.offsetY||0,j=Bd(this,W,0,b.x,b.y,z.x,z.y),$=l.distanceToSquared(j),r>$&&(B=e,r=$);r=Math.sqrt(r);var w=this.getAttachStyle(W);if("close"===w){var k=W.s("attach.close.threshold")/this._zoom;if(r>k)return null}return{index:B,distance:r,info:I[B]}}}(),getAttachPoints:function(v){var C=v.s("attach.points");if(C)return C;var l=qp(v._image);return l?$f(l.attachPoints,v,this)||null:void 0},getAttachStyle:function(w){var t=w.s("attach.style");if(t)return t;var N=qp(w._image);return N?$f(N.attachStyle,w,this)||"close":void 0},updateLayers:function(){this._layersInfo=d,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(k){if("background"===k.property){var d=this._canvas.style.background,r=k.newValue||"";this._canvas.style.background=r,this.fp("canvasBackground",d,r)}else"a:width"===k.property||"a:height"===k.property?(this._83I=1,this.redraw()):"layers"===k.property?this.updateLayers():"hierarchicalRendering"===k.property&&this.redraw()},handleDataPropertyChange:function(l){this.dm().isHierarchicalRendering()&&"parent"===l.property&&l.data.hasChildren()&&this.redraw(),this.invalidateData(l.data)},onPropertyChanged:function(A){var $=this,G=A.property;if($.redraw(),"zoom"===G){var H=$.sm().getSelection();H.size()&&H.each(function(A){A.invalidate()})}Hn[G]?$.showScrollBar():G===ne&&$.onCurrentSubGraphChanged(A)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(E){var t=this,p=E.kind,D=E.data;if(t._83I=1,"add"===p)t.invalidateData(D),Nl(D)&&D.getEdgeGroup()&&D.getEdgeGroup().eachSiblingEdge(t.invalidateData,t);else if(p===ro){t._21Q(D);var u=D._id,V=t._25I[u];if(V){if(t._56I[u]){var r=V._79o();r&&t.redraw(r)}V.dispose(),delete t._25I[u],delete t._24I[u],delete t._56I[u]}D===t._currentSubGraph&&t.setCurrentSubGraph(y)}else p===Ih&&(t.invalidateAll(!0),t.setCurrentSubGraph(y))},_75O:function(a){this.invalidateData(a.data)},handleHierarchyChange:function(n){this.dm().isHierarchicalRendering()&&n.data.hasChildren()&&this.redraw(),this.invalidateData(n.data)},adjustIndex:function(z){var C=this;if(C.isVisible(z)){C.dm().beginTransaction();for(var K=z;K._parent&&C.isVisible(K._parent);)K=K._parent;K&&K!==z&&C._dataModel.adjustIndex(K),C._dataModel.adjustIndex(z),C.dm().endTransaction()}},getImage:function(x){return x.getImage?x.getImage():d},getSelectWidth:function(F){var T=qp(this.getImage(F));return T&&$f(T.disableSelectedBorder,F,this)?0:F.s("select.width")},getSelectColor:function(X){return X.s("select.color")},isSelectable:function($,r){if(this.isSelected($))return!0;if(!r&&$.getParent()instanceof oj&&this.isSelectable($.getParent(),!0)&&$.getParent().isSyncSize())return!1;var Y=this.getLayersInfo();if(Y){var y=Y[$._layer];if(y&&y.selectable===!1)return!1}return $.s("2d.selectable")&&this.sm().isSelectable($)},isMovable:function(x){var u=this;if(Nl(x)&&x.getStyle(Zn)!==ph)return!1;var j=this.getLayersInfo();if(j){var g=j[x._layer];if(g&&g.movable===!1)return!1}return x.s("2d.movable")?u._movableFunc?u._movableFunc(x):!0:!1},isEditable:function(J){var W=this;if(T._uiSerializing)return W._uieditable;if(!W._editInteractor||!W.isSelected(J))return!1;if(zc(J)){var j=W.getDataUI(J);if(!j||j._88I)return!1}if(Nl(J)&&J.getStyle(Zn)!==ph)return!1;var A=this.getLayersInfo();if(A){var V=A[J._layer];if(V&&V.editable===!1)return!1}return J.s("2d.editable")?W._editableFunc?W._editableFunc(J):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(H){return Np(H)&&0!==H.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(H):!0},isRectEditable:function(E){return this._rectEditableFunc?this._rectEditableFunc(E):!0},isAnchorEditable:function(q){return this._anchorEditableFunc?this._anchorEditableFunc(q):!0},isRotationEditable:function(w){return w.setRotation&&w.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(w):!0:!1},getRotationPoint:function(L){var b=L.getAnchor(),d=L.getScale(),Q=this._zoom,g=Oj(L.getRotation(),0,-L.getHeight()*d.y*b.y-(d.y<0?-1:1)*(jm?32:16)/Q),Z=L.p();return g.x+=Z.x,g.y+=Z.y,g},getLogicalPoint:function(Q){var p=this;return Zf(Q,p._canvas,p.tx(),p.ty(),p._zoom,p._zoom)},getScreenPoint:function(l,h){var q,y=this;return"object"==typeof l?l.x!==d?(q=l.x,h=l.y):(q=l[0],h=l[1]):q=l,Bk(q,h,y._canvas,y.tx(),y.ty(),y._zoom,y._zoom)},getSelectedDataAt:function(E){var m=this;return this.getDataAt(E,function(w){return m.isSelected(w)})},getDataInfoAt:function(h,U,n){var I,$=this.lp(h),R=this.getDataAt($,U,n);if(R){var x=this.getDataUI(R);I={data:R,ui:x,point:$};var i=x._38o;if(i){var d=i.icons;for(var Z in d){var O=d[Z],E=i.rects[Z];if(E)for(var b=$f(O.names,R,this),r=b?b.length:0,q=E.rotation,T=r-1;T>=0;T--){var B=b[T],J=E[T];if(Hi(J,$,q))return I.part="icons",I.name=Z,I.icon=B,I.rect=J,I.index=T,I.rotation=q,I}}}if(this.isNoteVisible(R)){if(x.note2Info&&Hi(x.note2Info.clickRect,$,y,x.note2Info.scale))return I.part="note2",I;if(x.noteInfo&&Hi(x.noteInfo.clickRect,$,y,x.noteInfo.scale))return I.part="note",I}if(this.isLabelVisible(R)){if(x.label2Info&&Hi(x.label2Info.rect,$,x.label2Info.rotation,x.label2Info.scale))return I.part="label2",I;if(x.labelInfo&&Hi(x.labelInfo.rect,$,x.labelInfo.rotation,x.labelInfo.scale))return I.part="label",I}if(R.isInRect&&R.isInRect($))return I.part="body",I}return I},getDataAt:function(H,w,g){H.target&&(H=this.lp(H));var t,v=this._zoom;return this.reverseEach(function(I){return(w?w(I):this.isSelectable(I))&&this.rectIntersects(I,ii(H.x,H.y,g,v))?(t=I,!1):void 0},this),t},getIconInfoAt:function(M,d){var r=this;if(M.target&&(M=r.lp(M)),d||(d=r.getDataAt(M)),d){var E=r.getDataUI(d);if(E&&E._38o){var t,$=E._38o,c=new wk;for(t in $.icons)c.add(t);for(var f=c.size()-1;f>=0;f--){t=c.get(f);for(var K=$.rects[t],C=K.rotation,F=K.length-1;F>=0;F--){var l=K[F],V=l.width,_=l.height,N={x:M.x-l.x-V/2,y:M.y-l.y-_/2};C!=y&&(N=Oj(-C,N.x,N.y));var l={x:-V/2,y:-_/2,width:V,height:_};if(Hi(l,N))return{key:t,index:F,name:$.icons[t].names[F],rect:K[F],point:M,rotation:C,relativeRect:l,relativePoint:N,data:d}}}}}return y},getDatasInRect:function(J,O,R){R===d&&(R=1);var s=this,h=new wk;return s.reverseEach(function(f){R&&!s.isSelectable(f)||(O?s.rectIntersects(f,J):s.rectContains(f,J))&&h.add(f)}),h},moveSelection:function(v,R){var c=this;c.dm().beginTransaction(),ze(c.sm().toSelection(c.isMovable,c),v,R),c.dm().endTransaction()},moveDatas:function(e,$,p){var Y=this;Y.dm().beginTransaction(),e instanceof wk||(e=new wk(e)),ze(e,$,p),Y.dm().endTransaction()},getDataUIBounds:function(f){var Q=this.getDataUI(f);return Q?Q._79o():y},drawData:function(k,p,H){var N=this.getDataUI(p);if(N){var z=N._79o();(!H||Iq(H,z))&&(N._42(k),p instanceof T.Block&&p.eachChild(function(S){this.drawData(k,S,H)},this))}},getBoundsForGroup:function(l){return l.s(op)?this.getDataUIBounds(l):y},isPixelPerfect:function(h){return h.s("pixelPerfect")},rectIntersects:function(I,z){this.validate();var H=y;if(this._56I[I._id]){var g=this._25I[I._id];if(g){var D=g._79o();if(Um(z,D))H=!0;else if((z=nd(z,D))&&(g.rectIntersects&&(H=g.rectIntersects(z)),H==y)){if(!this.isPixelPerfect(I))return!0;var j=z.x,M=z.y,Q=z.width,a=z.height,f=this._zoom,S=N.hitMaxArea,b=Q*a*f*f;if(b>S){var J=Math.sqrt(S/b);f*=J}Q*=f,a*=f,2>Q&&(Q=2),2>a&&(a=2),j*=f,M*=f;var r=kj(Q,a);Gj(r,-j,-M),r.scale(f,f),this._drawForChecking=!0,this.drawData(r,I,z),this._drawForChecking=!1;try{for(var w=0,X=r.getImageData(0,0,Q,a).data;w<X.length;w+=4)if(0!==X[w+3]){H=!0;break}r.restore()}catch(Z){ao=y,H=!1}}}}return H?!0:!1},rectContains:function(V,Z){if(this._56I[V._id]){var Q=this._25I[V._id];if(Q)return Um(Z,Q._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(J){if(!N.isInput(J.target)){var g=this,D=g._focusData,E=D&&g._25I[D._id],S=0,M=g._dataModel._datas;if(!(D&&D._enabled&&D._editable&&E&&E.onKeyDown&&E.onKeyDown(J)===!0))if(9===J.keyCode&&(D&&(S=M.indexOf(D),im(J)?-1===--S&&(S=0):++S===M.size()&&(S=0)),g._focusData=D=M.get(S),g.sm().setSelection(D)),Yf(J)?g.selectAll():gb(J)&&g.isResettable()&&g.reset(),g.sm().isEmpty()){if(g._editing)return;var a=g.tx(),p=g.ty(),L=!1,Y=im()?100:10;Oc(J)&&(a-=Y,L=!0),kr(J)&&(p-=Y,L=!0),pe(J)&&(a+=Y,L=!0),bq(J)&&(p+=Y,L=!0),L&&g.setTranslate(a,p)}else{ol(J)&&g.handleDelete(J);var i=im()?10:1;Oc(J)&&(g.moveSelection(-i,0),g.fi({kind:"moveLeft"})),kr(J)&&(g.moveSelection(0,-i),g.fi({kind:"moveUp"})),pe(J)&&(g.moveSelection(i,0),g.fi({kind:"moveRight"})),bq(J)&&(g.moveSelection(0,i),g.fi({kind:"moveDown"}))}}},handleScroll:function(X,O){if(Mf(X),!this.getEditInteractor()){var F=this.getDataAt(X);if(F){var l=qp(this.getImage(F));if(l&&$f(l.scrollable,F,this))return}}var V=this.lp(X);O>0?this.scrollZoomIn(V):0>O&&this.scrollZoomOut(V)},handlePinch:function(j,L,Q){this._68I||(L>Q?this.pinchZoomIn(j):this.pinchZoomOut(j))},checkDoubleClickOnNote:function(O,P){var F=this,w=F.lp(O),y=F.getDataUI(P),C=y.note2Info;return C&&P.s("note2.toggleable")&&Hi(C.clickRect,w)?(P.s(xn,!P.s(xn)),F.fi({kind:"toggleNote2",event:O,data:P}),!0):(C=y.noteInfo,C&&P.s("note.toggleable")&&Hi(C.clickRect,w)?(P.s(_n,!P.s(_n)),F.fi({kind:"toggleNote",event:O,data:P}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(M,E){var f=this,U=f.getAutoScrollZone(),$=U/f.getZoom(),q=U/4,L=f._29I,W=f.lp(M),i={x:f.tx(),y:f.ty()};return W&&U>0&&L&&(W.x-L.x<$?f.translate(q,0):L.x+L.width-W.x<$&&f.translate(-q,0),W.y-L.y<$?f.translate(0,q):L.y+L.height-W.y<$&&f.translate(0,-q)),i.x=f.tx()-i.x,i.y=f.ty()-i.y,E&&(E.x+=i.x,E.y+=i.y),i},getMoveMode:function(b,g){var p=g.s("2d.move.mode");return p?p:cn["88"]?"x":cn["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(P,g,Q){var A=this;return"currentSubGraph"===g?{__i:P.getId()}:Q.serializeProperty(P,g,A)},deserializeProperty:function(l,I,x){var s=this;if("currentSubGraph"===I){var j=s.dm(),Y=j.__idMap;return Y[l.__i]}return x.deserializeProperty(l,I,s)},setDefaultCursor:function(r,I){this._defaultCursor=r,I!==!1&&this.setCursor(r)},setCursor:function(t){"default"===t&&(t=this._defaultCursor||t);var m=this.getView().style;m.cursor=t,m.cursor="-webkit-"+t,m.cursor="-moz-"+t},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(H){return H===y||N.getConnectAction(null,H)?(this._currentActionType=H,this.redraw(),!0):!1},isConnectActionVisible:function(t){var E=N.getConnectAction(this);if(!E)return!1;var o=E.visible;return Lc(o)&&(o=o(this,t)),o},isInteractive:function(P){var e=qp(this.getImage(P));return e&&$f(e.interactive,P,this)?!0:P.s("interactive")},appendHTML:function(c,l){var z=this.getView();if(!(l||c&&c.parentNode!==z))return!1;var n=c.getView&&c.getView();if(!l&&n&&n.parentNode===z)return!1;if(c.isSelfViewEvent)return c.addToDOM(z),!0;c.getView&&(c=c.getView());var W=this.getEditInteractor();return W&&W._canvas?z.insertBefore(c,W._canvas):this.isScrollBarVisible()?z.insertBefore(c,this.getView().lastChild):Ah(z,c),!0},_layoutHTMLImpl:function(e,k,P){if(arguments.length>1){var Q,E=this,z=E._zoom;if(k.getView&&(Q=k,k=k.getView()),k.style.position="absolute",P){var G=e.getRect();Ce(Q||k,E.tx()+G.x*z,E.ty()+G.y*z,G.width*z,G.height*z)}else{var h=new kd,G=e.getAnchorRect(),R=e.getPosition(),v=e.getScale(),N=k.style;Ce(Q||k,G),h.appendTranslate(E.tx(),E.ty()),h.appendScale(z,z),h.append(new kd(e.getRotation(),R.x,R.y,v.x,v.y)),wd(N,"transform","matrix("+h.a.toFixed(5)+", "+h.b.toFixed(5)+", "+h.c.toFixed(5)+",\n    "+h.d.toFixed(5)+", "+h.tx.toFixed(5)+", "+h.ty.toFixed(5)+")"),wd(N,"transformOrigin",(-G.x).toFixed(5)+"px "+(-G.y).toFixed(5)+"px"),k.maxtrixAppend=h.invert().translate(-G.x,-G.y)}}else this._layoutHTML&&this._layoutHTML()}}),M.defineProperties(fc.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(a){this._layoutHTML=a}}});var Cc=function(T,d){var q=this;q.gv=T,q.s=function(j){return d.getStyle(j)},q._data=d,q._87I=new wk};wr(Cc,M,{_6I:y,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var X=this,$=X.gv.isSelected(X._data);return!$||X.isShadowed()?0:X.gv.getSelectWidth(X._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(t){var T=this._data,M=this.gv.getBodyColor(T);return M?M:t?T.getStyle(t):y},_2Q:function(E){return this.s(E)},_1Q:function(J,e,I,j){var r=this.s,G=r("2d.gray"),B=r(e+".dash.color");if(G&&(B=N.toGrayColor(B)),J.strokeStyle=B,J.lineWidth=I,J.stroke(),r(e+".dash.3d")){var C=r(e+".dash.3d.color");Vc(J,B,G?N.toGrayColor(C):C,I,this.gv._zoom,r(e+".dash.3d.accuracy"))}$o(J,j)},invalidate:function(){this._6I=y},_79o:function(){var x=this;if(!x._6I){var d=x._data,F=x.gv;x.labelInfo=x.label2Info=x.noteInfo=x.note2Info=x._38o=y,x._87I.clear(),x.interactiveInfo=F.isInteractive(d)?{}:y,x._3O(),x._55O=F.isEditable(d)?{_42O:F.isRectEditable(d),_43O:F.isPointEditable(d),_56O:F.isRotationEditable(d)}:y,x._6I=x._81o()}return x._6I},_3O:function(){},getPosition:function(){return Eo},_68o:function(n,W){n&&this._87I.add(Qc(n,W))},_81o:function(){var h=this,x=h.s;h._24O(Rh,"getLabel"),h._24O(Xp,"getLabel2"),h._26O(yj,"getNote"),h._26O(zi,"getNote2"),h._15O(),h._55O&&h._48O();var v;if(h._87I.each(function(C){v=ks(v,C)}),v&&h.isShadowed()){var B=zf(v);B.x+=x("shadow.offset.x"),B.y+=x("shadow.offset.y"),oo(B,x("shadow.blur")),v=ks(v,B)}return h._87I.clear(),v},_42:function(I){var k=this,w=k._data,S=k.gv,M=k.s,K=M("opacity"),q=this.isShadowed();if(q){var D=I.shadowOffsetX,N=I.shadowOffsetY,o=I.shadowBlur,d=I.shadowColor,B=S.getZoom();I.shadowOffsetX=M("shadow.offset.x")*B,I.shadowOffsetY=M("shadow.offset.y")*B,I.shadowBlur=M("shadow.blur")*B,I.shadowColor=k.getSelectColor()}if(K!=y){var p=I.globalAlpha;I.globalAlpha=K}k._80o(I),S.isLabelVisible(w)&&((!S._drawForChecking||M("label.selectable"))&&dc(I,k.labelInfo),(!S._drawForChecking||M("label2.selectable"))&&dc(I,k.label2Info)),S.isNoteVisible(w)&&(br(I,k.noteInfo),br(I,k.note2Info)),k._99O(I),K!=y&&(I.globalAlpha=p),q&&(I.shadowOffsetX=D,I.shadowOffsetY=N,I.shadowBlur=o,I.shadowColor=d)},_80o:function(){},_47O:function(){},_24O:function(d,E){var D=this,l=D._data,Z=D.gv,h=D.s,k=Z[E](l);if(k!=y){var L=h(d+".scale"),f=h(d+".max"),c=h(d+".position"),n=D[d+"Info"]={label:k,scale:L,color:Z[E+"Color"](l),font:h(d+".font"),opacity:h(d+".opacity"),align:h(d+".align"),rotation:D.getRotation(h(d+".rotation"),!1,c),background:Z[E+"Background"](l)},m=dg(n,k);f>0&&f<m.width&&(n.labelWidth=m.width,m.width=f),1!==L&&(m.width*=L,m.height*=L);var B=D.getPosition(c,h(d+".offset.x"),h(d+".offset.y"),m,h(d+".position.fixed"));if(m.x=B.x-m.width/2,m.y=B.y-m.height/2,D._68o(n.rect=m,n.rotation),1!==L){var q=m.width/L,I=m.height/L;n.rect={x:B.x-q/2,y:B.y-I/2,width:q,height:I}}}},_26O:function(q,V){var T=this,H=T.gv,D=T._data,P=T.s,E=H[V](D);if(E!=y){var p,e,k=P(q+".scale"),r=T[q+"Info"]={note:E,scale:k,data:D,view:H,expanded:P(q+".expanded"),font:P(q+".font"),color:P(q+".color"),opacity:P(q+".opacity"),align:P(q+".align"),icon:P(q+".icon"),backgroundImage:P(q+".backgroundImage"),borderWidth:P(q+".border.width"),borderColor:P(q+".border.color"),background:H[V+"Background"](D)},N=T.getPosition(P(q+".position"),P(q+".offset.x"),P(q+".offset.y")),b=N.x,F=N.y;if(r.expanded){var u,m=P(q+".max"),c=P(q+".backgroundImage");c?(c=qp(c),u={width:$m(c,D),height:Lq(c,D)}):u=dg(r,E),u.width+=6,u.height+=2,m>0&&m<u.width&&(r.labelWidth=u.width,u.width=m),p=u.width,e=u.height+8,r.clickRect={x:b-p*k/2,y:F-e*k,width:p*k,height:e*k*u.height/e}
}else{var h=P(q+".icon");h?(h=qp(h),p=$m(h,D),e=Lq(h,D)):(p=12,e=18),r.clickRect={x:b-p*k/2,y:F-e*k,width:p*k,height:e*k}}r.rect={x:b-p/2,y:F-e*k/2-e/2,width:p,height:e};var W=i(r.borderWidth/2)*k;T._68o({x:b-p*k/2-W,y:F-e*k-W,width:p*k+2*W,height:e*k+2*W})}},_48O:function(){},_99O:function(q){var e=this,d=e._38o;if(d){var n=e.gv,t=e._data,M=d.icons,Y=e.interactiveInfo;Y&&(Y._38o={});for(var b in M){var a=M[b],u=d.rects[b];if(u){Y&&(Y._38o[b]=[]);var v=$f(a.opacity,t,n),N=$f(a.names,t,n),D=N?N.length:0,f=u.rotation;if(v!=y){var J=q.globalAlpha;q.globalAlpha*=v}for(var A=0;D>A;A++){var $=N[A],x=qp($),w=u[A];if(f){var _=w.x+w.width/2,Q=w.y+w.height/2;q.save(),Gj(q,_,Q),mn(q,f),Gj(q,-_,-Q)}Y&&Y._38o[b].push(q.interactiveInfo={compInfos:[],matrix:f?new kd(f,_,Q).appendTranslate(-_,-Q):new kd}),bp(q,x,$f(a.stretch,t,n),w.x,w.y,w.width,w.height,e._data,e.gv),q.interactiveInfo=y,f&&q.restore()}v!=y&&(q.globalAlpha=J)}}}}});var nj=function(v,d){hg(nj,this,[v,d])};wr(nj,Cc,{_checkEmptyRect:!0,_40O:function(R,A){var S=this,g=S.s,r=R.rect;(R.borderColor=S.gv.getBorderColor(S._data))&&(R.borderType=g("border.type"),R.borderWidth=g("border.width"),R.borderPadding=g("border.padding"),A=m(A,R.borderPadding+R.borderWidth/2));var J=S._data.getScale(),x=m(1,m(h(J.x),h(J.y)));if(R.selectWidth=S.getSelectWidth()){var o=S.gv._zoom;R.selectType=g("select.type"),R._97o=S.getSelectColor(),R.selectPadding=g("select.padding"),A=m(A,(R.selectPadding+R.selectWidth/2/o)/x)}A>0&&(A*=x,r=zf(r),oo(r,A)),S._68o(r)},_39O:function(J,d){var P,l=this,$=d.rect;if(d.borderWidth>0&&(P=d.borderPadding,J.strokeStyle=d.borderColor,J.lineWidth=d.borderWidth,qf(J,d.borderType,{x:$.x-P,y:$.y-P,width:$.width+2*P,height:$.height+2*P}),J.stroke()),d.selectWidth>0){var i=l.gv._zoom;if(P=d.selectPadding,J.strokeStyle=d._97o,J.lineWidth=d.selectWidth/i,d.rotation!=y){J.save(),J.translate(d.position.x,d.position.y),J.rotate(d.rotation);var a=l._data,F=a.getWidth(),Y=a.getHeight(),G=d.scale,v=d.anchor;$={x:G.x*-F*v.x,y:G.y*-Y*v.y,width:G.x*F,height:G.y*Y}}qf(J,d.selectType,{x:$.x-P,y:$.y-P,width:$.width+2*P,height:$.height+2*P}),d.rotation!=y&&J.restore(),J.stroke()}},dispose:function(){var Q=this,o=Q._htmlView;nj.superClass._3O.call(Q),o&&(o.onHTMLRemoved&&o.onHTMLRemoved(),Hm(o))},_3O:function(){var C=this,e=C.s,N=C._data,b=C.gv,B=N.getStyle(Kg),R=C.getBodyColor(),X=C._83o=B?{shape:B,_53o:C.getBodyColor("shape.background"),_27Q:qp(e("shape.repeat.image"),R),shapeGradientPack:e("shape.gradient.pack"),_54o:e("shape.border.width"),_55o:e("shape.border.color"),_56o:e("shape.border.3d"),_57o:e("shape.border.3d.color"),_58o:e("shape.border.3d.accuracy"),shapeGradient:e("shape.gradient"),_59o:e("shape.gradient.color"),_60o:e("shape.border.pattern"),_61o:e("shape.border.cap"),_62o:e("shape.border.join"),shapeForeground:e("shape.foreground"),bodyColor:R,gray:e("2d.gray")}:{img:qp(b.getImage(N),R),bodyColor:R,gray:e("2d.gray"),stretch:e("image.stretch")};if(k&&!I);else{var T,u=X.img;u&&u.renderHTML?(C._htmlInfo&&C._htmlInfo.img!==u&&(C._htmlInfo=y),C._htmlInfo||(C._htmlInfo={img:u,cache:{}}),T=u.renderHTML(N,b,C._htmlInfo.cache)):C._htmlInfo=y,C._htmlView&&C._htmlView!==T&&(C._htmlView.onHTMLRemoved&&C._htmlView.onHTMLRemoved(),Hm(C._htmlView.getView?C._htmlView.getView():C._htmlView)),(C._htmlView=T)&&b.appendHTML(T)&&T.onHTMLAdded&&T.onHTMLAdded(),X.rect=N.getRect(),X.position=N.p(),X.scale=N.getScale(),X.anchor=N.getAnchor(),X.rotation=N.getRotation(),B===Cg&&(X._63o=e("shape.depth"));var U=0;if(B)U=Wk(y,X._54o/2,X._62o),C.s("shape.dash")&&(U=m(U,(C.s("shape.dash.width")||X._54o)/2));else if(u&&u.boundExtend)if(U=$f(u.boundExtend,N,b),u.boundExtendAbsolute){var v=N.getScale();U/=b._zoom*m(1,m(h(v.x),h(v.y)))}else if(!$f(u.fitSize,N,b)){var O=$f(u.width,N,b),l=$f(u.height,N,b);U*=m(N.getWidth()/O,N.getHeight()/l)}C._40O(X,U);var V=e("clip.percentage");if(1>V&&(0>V&&(V=0),X.clipRect=Qd(N.getAnchorRect(),e("clip.direction"),V)),B){var d=e("shape.fill.clip.percentage");1>d&&(0>d&&(d=0),X.shapeClipRect=Qd(N.getAnchorRect(),e("shape.fill.clip.direction"),d));var F=e("shape.foreground.clip.percentage");1>F&&(0>F&&(F=0),X.shapeForegroundClipRect=Qd(N.getAnchorRect(),e("shape.foreground.clip.direction"),F))}}},getPosition:function(U,n,w,l){var i=Yi(U,this._83o.rect,l);return i.x+=n,i.y+=w,i},_80o:function(D){var $=this,x=$.s,l=$.gv,Q=$._data,r=$._83o,w=r.rect,T=r.position,P=r.rotation,d=r.anchor,s=r.scale,z=r.shape,t=r.clipRect;if(!$._checkEmptyRect||w.width>0&&w.height>0){var M=Q.getSize();if(M.x=-M.width*d.x,M.y=-M.height*d.y,D.save(),Gj(D,T.x,T.y),mn(D,P),ci(D,s.x,s.y),t&&(D.beginPath(),D.rect(t.x,t.y,t.width,t.height),D.clip()),l._drawForChecking&&r.img&&$f(r.img.pixelPerfect,Q,l)===!1)Gf(D,M.x,M.y,M.width,M.height,"#888888");else if($.freeDraw)$.freeDraw(D,M,r);else if(z){var f,h,p,Y,H=r._60o,o=Tc(D,H),J=r._27Q,E=r._54o,L=r.shapeGradientPack,K=r.gray,k=D.lineJoin,c=D.lineCap,j=function(D){return K?N.toGrayColor(D):D};"roundRect"===z?f=x("shape.corner.radius"):"polygon"===z?f=x("shape.polygon.side"):"arc"===z&&(f=x("shape.arc.from"),h=x("shape.arc.to"),p=x("shape.arc.close"),Y=x("shape.arc.oval")),D.lineJoin=r._62o,D.lineCap=r._61o;var v=j(r._53o);if(v||J||L){var F=r.shapeClipRect;F&&(D.save(),D.beginPath(),D.rect(F.x,F.y,F.width,F.height),D.clip()),qf(D,z,M,f,h,p,Y),L?mf(D,L):J?Yn(D,J,j(r.bodyColor),null,Q,l):hk(D,v,r.shapeGradient,j(r._59o),M),D.fill(),F&&D.restore(),L&&D.restore(),D!==o&&qf(o,z,M,f,h,p,Y)}else qf(o,z,M,f,h,p,Y);var g=r.shapeForeground;if(g){D.save();var b=r.shapeForegroundClipRect;b&&(D.beginPath(),D.rect(b.x,b.y,b.width,b.height),D.clip()),qf(D,z,M,f,h,p,Y),hk(D,g,x("shape.foreground.gradient"),j(x("shape.foreground.gradient.color")),M),D.fill(),D.restore()}if(E>0){var U=x("shape.border.width.absolute");U&&(D.save(),D.setTransform(1,0,0,1,0,0)),D.lineWidth=E;var W=j(r._55o);D.strokeStyle=W,D.stroke(),U&&D.restore(),r._56o&&Vc(D,W,j(r._57o),E,l._zoom,r._58o)}if($o(D,H),x("shape.dash")){var q=x("shape.dash.width")||E;if(q>0){H=x("shape.dash.pattern");var o=Tc(D,H,$._2Q("shape.dash.offset"));o!==D&&qf(o,z,M,f,h,p,Y),$._1Q(D,"shape",q,H)}}gn(D,v,r._63o,M),D.lineJoin=k,D.lineCap=c}else{var G=$.interactiveInfo;G&&(D.interactiveInfo=G.bodyInfo={compInfos:[],matrix:new kd(P,T.x,T.y,s.x,s.y)}),r.gray&&(D.compGray=!0);var u=r.img;u&&u.cacheRule!=y&&(u=Qm(D,u,r.stretch,M.width,M.height,Q,l,r.bodyColor)),bp(D,u,r.stretch,M.x,M.y,M.width,M.height,Q,l,r.bodyColor),D.compGray=!1,D.interactiveInfo=y}D.restore()}$._39O(D,r)},_48O:function(){},_47O:function(){}});var Oi=function(B,o){hg(Oi,this,[B,o])},Pp=function(S,I,v,h){var X=kk(S,I);return v=h?Y(v,X):Mh(v,X),X?v/=X:v=0,{x:S.x+(I.x-S.x)*v,y:S.y+(I.y-S.y)*v}};wr(Oi,Cc,{_3O:function(){var k,f=this,h=f._data,_=f.gv,b=f.s,J=b(Zn),Z=h.isLooped(),o=b("edge.width"),i=b("edge.center"),X=b("edge.offset"),H=_.getBorderColor(h),W=H?b("border.width"):0,O=f.getSelectWidth(),A=h._40I,n=h._41I,r=f._78o=A&&n?{looped:Z,type:J,width:o,center:i,color:f.getBodyColor("edge.color"),borderColor:H,borderWidth:W,_97o:O?f.getSelectColor():y,selectWidth:O,pattern:b("edge.pattern"),cap:b("edge.cap"),join:b("edge.join"),is3d:b("edge.3d"),_67o:b("edge.3d.color"),_66o:b("edge.3d.accuracy"),gray:b("2d.gray")}:y;if(r){var P=N.getEdgeType(J);if(P){var L=P(h,Ye(f,_,h,Z,J),_,f._19Q);L.points&&L.points.size()>1?(r.edgeTypeInfo=L,k=wm(r.edgeTypeInfo.points)):L[pk]&&L.rect&&(r.edgeTypeInfo=L,k=L.rect)}else{var D=b("edge.source.anchor.x"),R=b("edge.source.anchor.y"),I=b("edge.target.anchor.x"),s=b("edge.target.anchor.y"),g=Bd(_,A,b("edge.source.position"),b("edge.source.offset.x"),b("edge.source.offset.y"),D,R),c=Bd(_,n,b("edge.target.position"),b("edge.target.offset.x"),b("edge.target.offset.y"),I,s);if(J===ph){var V=r.points=b(xp)||po,a=V.size();r.segments=b("edge.segments");var j=D!==d||R!==d,S=I!==d||s!==d;if(!i)if(X)j||(g=Pp(g,a?V.get(0):c,X,a)),S||(c=Pp(c,a?V.get(a-1):g,X,a));else{var Y;j||(Y=Pc(g,a?V.get(0):c,eo(_,A)),Y&&(g={x:Y[0],y:Y[1]})),S||(Y=Pc(a?V.get(a-1):g,c,eo(_,n)),Y&&(c={x:Y[0],y:Y[1]}))}k=ks(wm(r.points),wm(g,c))}else{var F=Ye(f,_,h,Z,J);if(f._19Q||(F=-F),Z)g=zf(g),g.x=_.getNodeRect(A).x,r.radius=F,k={x:g.x-F,y:g.y-F,width:2*F,height:2*F};else{var u=kk(g,c),K=Mh(X,u),E={x:K,y:F},U={x:u-K,y:F},Q=B(c.y-g.y,c.x-g.x),t=r.mat=new Rc(Q);if(r.orienAngle=Q,r.angle=c.x<g.x?Q+p:Q,r.rect={x:E.x,y:E.y,width:U.x-E.x,height:0},r.origin=g,E=t.tf(E),E.x+=g.x,E.y+=g.y,U=t.tf(U),U.x+=g.x,U.y+=g.y,i){var C={x:u,y:0};C=t.tf(C),C.x+=g.x,C.y+=g.y,k=wm([g,E,U,C]),r.c1=g,r.c2=C}else k=wm(E,U);g=E,c=U}}r.sourcePoint=g,r.targetPoint=c,h._lastSourcePoint=g,h._lastTargetPoint=c}var w=0;b("edge.dash")&&(w=b("edge.dash.width")||o);var M="square"===r.cap?.71:.5;Wk(k,m(w*M,o*M+W+O),r.join),f._68o(k)}},getRotation:function(V,G,N){V=V||0;var v=this._78o;if(v){var e,h=v.angle,m=v.points,B=v.edgeTypeInfo;if(h!=y)return G?v.orienAngle+V:h+V;if(B&&B[pk])return B.getRotation?B.getRotation(this,V,G,N):0;if(B&&B.points){var a=B.points;return e=a.size(),Wd[N]?e&&0===e%2?Vj(a.get(e/2-1),a.get(e/2),G,V):V:Ul[N]?Vj(a.get(0),a.get(1),G,V):Vj(a.get(e-2),a.get(e-1),G,V)}if(m)return e=m.size(),Wd[N]?e&&0===e%2?Vj(m.get(e/2-1),m.get(e/2),G,V):V:Ul[N]?Vj(v.sourcePoint,e?m.get(0):v.targetPoint,G,V):Vj(e?m.get(e-1):v.sourcePoint,v.targetPoint,G,V)}return V},getPosition:function(v,P,m,U,$){var Y=this._78o;if(Y){var X,x=Y.type,O=Y.points,T=Y.edgeTypeInfo,F=Y.sourcePoint,d=Y.targetPoint;if(!x)return Y.looped?{x:F.x-Y.radius+P,y:F.y+m}:($&&F&&d&&(F.x>d.x||F.x===d.x&&F.y>d.y)&&(v=rp[v],m=-m),X=Yi(v,Y.rect,U),X.x+=P,X.y+=m,X=Y.mat.tf(X),X.x+=Y.origin.x,X.y+=Y.origin.y,X);if(T&&T[pk])return T.getPosition?T.getPosition(this,v,P,m,U,$):{x:(F.x+d.x)/2,y:(F.y+d.y)/2};if(O){var X,E=O.size();if(Wd[v]){if(E){var w=E%2;if(0===w)return Ad(O.get(E/2-1),O.get(E/2),v,P,m,U,$);X=O.get((E-w)/2)}else X={x:(F.x+d.x)/2,y:(F.y+d.y)/2};return X=Yi(v,{x:X.x,y:X.y,width:0,height:0},U),X.x+=P,X.y+=m,X}return Ul[v]?Ad(F,E?O.get(0):d,v,P,m,U,$):Ad(E?O.get(E-1):F,d,v,P,m,U,$)}if(T){var Q=T.points,E=Q.size();if(Wd[v]){var w=E%2;return 0===w?Ad(Q.get(E/2-1),Q.get(E/2),v,P,m,U,$):(X=Q.get((E-w)/2),X=Yi(v,{x:X.x,y:X.y,width:0,height:0},U),X.x+=P,X.y+=m,X)}return Ul[v]?Ad(Q.get(0),Q.get(1),v,P,m,U,$):Ad(Q.get(E-2),Q.get(E-1),v,P,m,U,$)}}return Eo},_42:function(J){this._78o&&Oi.superClass._42.call(this,J)},drawPath:function(H,A){H.beginPath();var K=A.type,P=A.points,O=A.segments,J=A.edgeTypeInfo;if(!K||P){var c=A.sourcePoint,l=c.x,S=c.y,h=A.targetPoint,e=h.x,W=h.y;if(K)if(O){var q=new wk({x:l,y:S});q.addAll(P),q.add({x:e,y:W}),Yc(H,q,O)}else H.moveTo(l,S),P.each(function(n){H.lineTo(n.x,n.y)}),H.lineTo(e,W);else A.looped?H.arc(l,S,A.radius,0,t,!0):A.center?(H.moveTo(A.c1.x,A.c1.y),H.lineTo(l,S),H.lineTo(e,W),H.lineTo(A.c2.x,A.c2.y)):(H.moveTo(l,S),H.lineTo(e,W))}else J&&(J.points?Yc(H,J.points,J.segments):J[pk]&&J[pk](H,J))},_80o:function(w){var u=this,I=u.s,L=u._78o,C=L.width,W=L.selectWidth,v=L.borderWidth,Z=w.lineJoin,D=w.lineCap,T=L.gray,H=L.pattern;w.lineJoin=L.join,w.lineCap=L.cap,u.drawPath(Tc(w,H),L);var s=I("edge.width.absolute");s&&(w.save(),w.setTransform(1,0,0,1,0,0)),W&&(w.strokeStyle=L._97o,w.lineWidth=C+2*(v+W),w.stroke()),v&&(w.strokeStyle=T?N.toGrayColor(L.borderColor):L.borderColor,w.lineWidth=C+2*v,w.stroke());var g=T?N.toGrayColor(L.color):L.color,x=T?N.toGrayColor(L._67o):L._67o;if(w.strokeStyle=g,w.lineWidth=C,w.stroke(),L.is3d&&Vc(w,g,x,C,u.gv._zoom,L._66o),s&&w.restore(),$o(w,H),I("edge.dash")){H=I("edge.dash.pattern");var h=Tc(w,H,u._2Q("edge.dash.offset"));h!==w&&u.drawPath(h,L),u._1Q(w,"edge",I("edge.dash.width")||C,H)}w.lineJoin=Z,w.lineCap=D},_48O:function(){},_47O:function(){},_71o:function(z,M){var Y=this,J=Y._data;if(Y._19Q=!0,!J.getEdgeGroup())return z?J.s("edge.gap"):0;var V,k=0,D=0,v=0;if(J.getEdgeGroup().getSiblings().each(function(U){U.each(function($){if(Y.gv.isVisible($)&&$.s(Zn)==M){var Q=$.s("edge.gap");V?(D+=v/2+Q/2,v=Q):(V=$,v=Q),$===J&&(k=D)}})}),z)return D-k+v;var X=k-D/2;return V&&J._40I!==V._40I&&(Y._19Q=!1),X}});var Sg=function(S,N){hg(Sg,this,[S,N])};wr(Sg,nj,{_3O:function(){var $,X,D=this,b=D.s,a=D._data,M=D.gv;if(D._88I=y,a.isExpanded()&&a.eachChild(function(f){if(Np(f)){var y=M.getBoundsForGroup(f);y&&(X||(X=[]),X.push(y),$=ks($,y))}}),$){var z=M.getLabel(a),g=b("group.type");$=ad(g,X,$),Vh($,a,"group.padding",1);var f=D._88I={type:g,rect:$,_64o:$};if(!g&&z!=y){var s,w=D.labelInfo={label:z,color:b("group.title.color"),font:b("group.title.font"),align:b("group.title.align")},F=dg(w,z),n=F.width,c=F.height,i=b("group.title.align"),Q=b("group.title.orientation");if((Q===Zp||Q===Yg)&&n>$.width?$.width=n:(Q===Cb||Q===Fq)&&n>$.height&&($.height=n),w.rect={y:$.y-c,width:F.width,height:c},s=i===Cb?$.x:i===Fq?$.x+$.width-n:$.x+$.width/2-n/2,w.rect.x=s,Q===Yg)f.titleRect={x:$.x,y:$.y+$.height,width:$.width,height:c},f.rect={x:$.x,y:$.y,width:$.width,height:$.height+c},w.rect={x:s,y:$.y+$.height,width:n,height:c};else if(Q===Cb){var _=f.titleRect={x:$.x-c,y:$.y,width:c,height:$.height};f.rect={x:$.x-c,y:$.y,width:$.width+c,height:$.height},w.rect={x:_.x+c/2-$.height/2,y:_.y+$.height/2-c/2,width:$.height,height:c},w.rotation=-Math.PI/2}else if(Q===Fq){var _=f.titleRect={x:$.x+$.width,y:$.y,width:c,height:$.height};f.rect={x:$.x,y:$.y,width:$.width+c,height:$.height},w.rect={x:_.x+c/2-$.height/2,y:_.y+$.height/2-c/2,width:$.height,height:c},w.rotation=Math.PI/2}else f.titleRect={x:$.x,y:$.y-c,width:$.width,height:c+1},f.rect={x:$.x,y:$.y-c,width:$.width,height:$.height+c}}D._40O(f,b("group.border.width")/2)}else Sg.superClass._3O.call(D)},getPosition:function(i,Q,R,d){var W=this._88I;if(W){var F=Yi(i,W.rect,d);return F.x+=Q,F.y+=R,F}return Sg.superClass.getPosition.apply(this,arguments)},_24O:function(s,X){var n=this._88I;(!n||n.type||"label2"===s)&&Sg.superClass._24O.call(this,s,X)},_80o:function(O){var s=this,n=s._88I;if(n){var o=s._data,h=s.s,t=s.gv,f=n.type,k=n.rect,Y=n._64o,E=n.titleRect,W=s.getBodyColor(),B=qp(h("group.image"),W),R=h("group.image.stretch"),p=s.getBodyColor("group.background"),K=qp(h("group.repeat.image"),W),u=h("group.gradient.pack"),l=h("group.gradient"),V=h("group.gradient.color"),T=h("group.border.width"),U=h("group.border.color"),c=h("group.border.pattern"),$=h("group.title.orientation"),S=h("group.depth");if(f){var C=O.lineJoin,M=O.lineCap;if(O.lineJoin=h("group.border.join"),O.lineCap=h("group.border.cap"),B){if(O.save(),qf(O,f,k),O.clip(),bp(O,B,R,k.x,k.y,k.width,k.height,o,t,W),O.restore(),T>0){var y=Tc(O,c);qf(y,f,k),O.lineWidth=T,O.strokeStyle=U,O.stroke(),$o(O,c)}}else{var y=Tc(O,c);p||K||u?(qf(O,f,k),u?mf(O,u):K?Yn(O,K,W,null,o,t):hk(O,p,l,V,k),O.fill(),u&&O.restore(),O!==y&&qf(y,f,k)):qf(y,f,k),T>0&&(O.lineWidth=T,O.strokeStyle=h("group.border.color"),O.stroke()),$o(O,c),f===Cg&&gn(O,p,S,k)}O.lineJoin=C,O.lineCap=M}else{var X=h("group.title.background"),J=h("group.border.radius");if(B)bp(O,B,R,Y.x,Y.y,Y.width,Y.height,o,t,s.getBodyColor());else if(p||K)if(K?Yn(O,K,W,null,o,t):hk(O,p,l,V,Y),0===T)qf(O,Cg,Y),O.fill(),gn(O,p,S,Y);else{switch(O.beginPath(),$){case Yg:ag(O,Y.x,Y.y,Y.width,Y.height,J,J,0,0);break;case Cb:ag(O,Y.x,Y.y,Y.width,Y.height,0,J,0,J);break;case Fq:ag(O,Y.x,Y.y,Y.width,Y.height,J,0,J,0);break;case Zp:ag(O,Y.x,Y.y,Y.width,Y.height,0,0,J,J)}O.fill()}if(E&&X)if(0===T)Gf(O,E.x,E.y,E.width,E.height,X),gn(O,X,S,E);else{switch(O.beginPath(),O.fillStyle=X,$){case Yg:ag(O,E.x,E.y,E.width,E.height,0,0,J,J);break;case Cb:ag(O,E.x,E.y,E.width,E.height,J,0,J,0);break;case Fq:ag(O,E.x,E.y,E.width,E.height,0,J,0,J);break;case Zp:ag(O,E.x,E.y,E.width,E.height,J,J,0,0)}O.fill()}if(T>0){var y=Tc(O,c);if(qf(y,"roundRect",k,J),O.lineWidth=T,O.strokeStyle=U,E&&h("group.splitLine")){var v=E.x,I=E.y,r=E.width,N=E.height;$===Yg?(O.moveTo(v,I),O.lineTo(v+r,I)):$===Cb?(O.moveTo(v+r,I),O.lineTo(v+r,I+N)):$===Fq?(O.moveTo(v,I),O.lineTo(v,I+N)):(O.moveTo(v,I+N),O.lineTo(v+r,I+N))}O.stroke(),$o(O,c)}}s._39O(O,n)}else Sg.superClass._80o.call(s,O)}});var os=function(M,U){hg(os,this,[M,U])};wr(os,nj,{_80o:function(C){this._39O(C,this._83o)}});var jo=function(J,b){hg(jo,this,[J,b])};wr(jo,nj,{_3O:function(){var x=this,$=x._data,G=x.s,t=x.gv,s=$.getPoints(),B=t.getBorderColor($),Z=B?G("border.width"):0,E=x.getSelectWidth(),A=G("shape.border.width"),q=$.getRect(),n=t.getBodyColor($),H=x._99o=s.isEmpty()?y:{rect:q,rotation:$.getRotation(),fillRule:G("shape.fill.rule"),scale:$.getScale(),position:$.p(),points:s,segments:$.getSegments(),bodyColor:n,borderColor:B,borderWidth:Z,_94o:G("shape.border.3d"),_95o:G("shape.border.3d.color"),_96o:G("shape.border.3d.accuracy"),_97o:E?x.getSelectColor():y,selectWidth:E,_53o:G("shape.background"),_27Q:qp(G("shape.repeat.image"),n),shapeGradientPack:G("shape.gradient.pack"),_54o:A,_55o:G("shape.border.color"),shapeGradient:G("shape.gradient"),_59o:G("shape.gradient.color"),_60o:G("shape.border.pattern"),_61o:G("shape.border.cap"),_62o:G("shape.border.join"),shapeForeground:G("shape.foreground"),gray:G("2d.gray")};if(H){var g=$.getScale(),k=m(1,m(h(g.x),h(g.y)));G("shape.dash")&&G("shape.dash.width")>A&&(A=G("shape.dash.width"));var u=A*("square"===H._61o?.71:.5)+Z+E/x.gv._zoom/k;u&&(u*=k,q=zf(q),Wk(q,u,H._62o)),x._68o(q);var V=G("clip.percentage");1>V&&(0>V&&(V=0),H.clipRect=Qd($.getAnchorRect(),G("clip.direction"),V));var v=G("shape.fill.clip.percentage");1>v&&(0>v&&(v=0),H.shapeClipRect=Qd($.getAnchorRect(),G("shape.fill.clip.direction"),v));var f=G("shape.foreground.clip.percentage");1>f&&(0>f&&(f=0),H.shapeForegroundClipRect=Qd($.getAnchorRect(),G("shape.foreground.clip.direction"),f))}},getPosition:function(p,w,v,E){var J=this._99o;if(J){var U=Yi(p,J.rect,E);return U.x+=w,U.y+=v,U}return Eo},_42:function(v){this._99o&&jo.superClass._42.call(this,v)},_80o:function(J){var p,G=this,P=G.s,H=G._99o,e=H.position,M=H.scale,V=H.rotation,j=H.borderWidth,S=H.selectWidth/G.gv._zoom,D=H._27Q,Z=H.shapeGradientPack,t=H._54o,L=H.clipRect,b=H.shapeClipRect,l=H.points,O=H.segments,W=G._data.isClosePath(),k=H.fillRule,i=H.gray,x=function(J){return i?N.toGrayColor(J):J},m=x(H._53o),y=m||D||Z;J.save(),Gj(J,e.x,e.y),mn(J,V),ci(J,M.x,M.y),L&&(J.beginPath(),J.rect(L.x,L.y,L.width,L.height),J.clip()),y&&b&&(J.save(),J.beginPath(),J.rect(b.x,b.y,b.width,b.height),J.clip()),Gj(J,-e.x,-e.y);var U=H._60o,n=Tc(J,U),Y=J.lineJoin,v=J.lineCap;J.lineJoin=H._62o,J.lineCap=H._61o;var Q=x(H.bodyColor);y?(Yc(J,l,O,W),Z?mf(J,Z):D?Yn(J,D,Q,null,G._data,G.gv):(p=Q?Q:m,hk(J,p,H.shapeGradient,x(H._59o),H.rect)),J.fill(k),b&&(J.restore(),Gj(J,-e.x,-e.y)),Z&&J.restore(),n!==J&&Yc(n,l,O,W)):Yc(n,l,O,W);var K=H.shapeForeground;if(K){J.save();var g=H.shapeForegroundClipRect;g&&(Gj(J,e.x,e.y),J.beginPath(),J.rect(g.x,g.y,g.width,g.height),J.clip(),Gj(J,-e.x,-e.y)),Yc(J,l,O,W),hk(J,K,P("shape.foreground.gradient"),x(P("shape.foreground.gradient.color")),H.rect),J.fill(k),J.restore()}var d=P("shape.border.width.absolute");if(d&&(J.save(),J.setTransform(1,0,0,1,0,0)),S&&(J.strokeStyle=H._97o,J.lineWidth=t+2*(j+S),J.stroke()),j&&(J.strokeStyle=x(H.borderColor),J.lineWidth=t+2*j,J.stroke()),t&&(p=x(H._55o),!m&&Q&&(p=Q),J.strokeStyle=p,J.lineWidth=t,J.stroke(),H._94o&&Vc(J,p,x(H._95o),t,G.gv._zoom,H._96o)),d&&J.restore(),$o(J,U),P("shape.dash")){var r=P("shape.dash.width")||t;if(r>0){U=P("shape.dash.pattern");var n=Tc(J,U,G._2Q("shape.dash.offset"));n!==J&&Yc(n,l,O,W),G._1Q(J,"shape",r,U)}}J.lineJoin=Y,J.lineCap=v,J.restore()},_48O:function(){},_47O:function(){}});var Kp=function(m,t){hg(Kp,this,[m,t])};wr(Kp,jo,{getRotation:function(m,A,o){m=m||0;var d=this._data.getPoints(),s=d.size();return s>1?Wd[o]?s&&0===s%2?Vj(d.get(s/2-1),d.get(s/2),A,m):m:Ul[o]?Vj(d.get(0),d.get(1),A,m):Vj(d.get(s-2),d.get(s-1),A,m):m},getPosition:function(Z,H,t,u,v){var T=this._data.getPoints(),K=T.size();if(K>1){if(Wd[Z]){var C=K%2;if(0===C)return Ad(T.get(K/2-1),T.get(K/2),Z,H,t,u,v);var o=T.get((K-C)/2),g={x:o.x,y:o.y,width:0,height:0};return o=Yi(Z,g,u),o.x+=H,o.y+=t,o}return Ul[Z]?Ad(T.get(0),T.get(1),Z,H,t,u,v):Ad(T.get(K-2),T.get(K-1),Z,H,t,u,v)}return Eo}});var yn=function(J,v){hg(yn,this,[J,v])};wr(yn,nj,{_3O:function(){var R=this;yn.superClass._3O.call(R);var O=R.s,t=R._83o;R._82o=t.img||t.shape?y:{background:R.getBodyColor("grid.background"),depth:O("grid.depth"),rect:t.rect,_88o:O("grid.cell.depth"),cellBorderColor:O("grid.cell.border.color"),_89o:O("grid.row.count"),_90o:O("grid.column.count"),block:O("grid.block"),_91o:O("grid.block.color"),_92o:O("grid.block.padding"),_93o:O("grid.block.width")}},_80o:function(D){var r=this,l=r._82o;if(!l)return yn.superClass._80o.call(r,D),void 0;var S,d,G=r._data,x=l.background,n=l.rect,g=l.block,L=l._91o,N=l._92o,A=l._93o,B=l._88o,V=l.cellBorderColor,s=l._89o,Z=l._90o;if(x)if(Gf(D,n.x,n.y,n.width,n.height,x),gn(D,x,l.depth,n),B)for(S=0;s>S;S++)for(d=0;Z>d;d++)n=G.getCellRect(S,d),n&&gn(D,x,B,n);else if(V){for(D.beginPath(),S=0;s>S;S++)for(d=0;Z>d;d++)n=G.getCellRect(S,d),n&&D.rect(n.x,n.y,n.width,n.height);D.strokeStyle=V,D.lineWidth=1,D.stroke()}if("h"===g)for(S=0;s>S;S++)n=ks(G.getCellRect(S,0),G.getCellRect(S,Z-1)),oo(n,N),yp(D,L,n.x,n.y,n.width,n.height,A);else if("v"===g)for(d=0;Z>d;d++)n=ks(G.getCellRect(0,d),G.getCellRect(s-1,d)),oo(n,N),yp(D,L,n.x,n.y,n.width,n.height,A);r._39O(D,r._83o)}});var Mi=function(K,k){hg(Mi,this,[K,k])};wr(Mi,nj,{_checkEmptyRect:!1,_81o:function(){var o=this._data,q=Mi.superClass._81o.call(this),p=o.s("text");if(p!=y){var t,_,I=o.s("text.font"),z=o.s("text.align"),j=o.s("text.vAlign"),Y=iq(I,p),O=Y.width,d=Y.height,J=o.getAnchor(),X=o.getWidth(),Z=o.getHeight();"left"===z?t=-X*J.x:"center"===z?t=-X*J.x+(X-O)/2:"right"===z&&(t=X*(1-J.x)-Y.width),"top"===j?_=-Z*J.y:"middle"===j?_=-Z*J.y+(Z-d)/2:"bottom"===j&&(_=Z*(1-J.y)-Y.height);var P,S=o.getMatrix();if(P=wm([S.tf(t,_),S.tf(t+O,_),S.tf(t+O,_+d),S.tf(t,_+d)]),q=ks(q,P),q&&o.s("text.shadow")){var U=zf(q);U.x+=o.s("text.shadow.offset.x"),U.y+=o.s("text.shadow.offset.y"),oo(U,o.s("text.shadow.blur")),q=ks(q,U)}}return q}});var jk=fc.Interactor=function(N){this.gv=this._graphView=N};wo("Interactor",M,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(m){this.gv.fi(m)},setCursor:function(G){jm||this.gv.setCursor(G)},startDragging:function(e){var n=this;n._lastClientPoint=Ne(e),n._lastLogicalPoint=n.gv.lp(e),Ej(n,e)},clearDragging:function(){var T=this;T._lastClientPoint=T._lastLogicalPoint=T._logicalPoint=y},autoScroll:function(v){return this.gv.autoScroll(v,this._lastClientPoint)}});var Up=y,Zr=function(G){Up.handleWindowTouchMove(G)},oq=function(C){Up.handleWindowTouchEnd(C),U.removeEventListener(Cd,Zr,Z),U.removeEventListener(wj,oq,Z),Up=y},lo=function(w){Up.handleWindowMouseMove(w)},mo=function(L){Up.handleWindowMouseUp(L),U.removeEventListener(rq,lo,Z),U.removeEventListener(aj,mo,Z),Up=y},go=function(P,i){P!==Up&&(Up?jm?Up.handleWindowTouchEnd(i):Up.handleWindowMouseUp(i):jm?(U.addEventListener(Cd,Zr,Z),U.addEventListener(wj,oq,Z)):(U.addEventListener(rq,lo,Z),U.addEventListener(aj,mo,Z)),Up=P)},al=function(b){var w=this;w.gv=b,w._is2d=b instanceof fc.GraphView,w._is2d&&(w.filter=function(Z){return b.isSelectable(Z)&&b.isInteractive(Z)}),b.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",Xe].forEach(function(B){w.addListener(B)}),w.initImageResource()};wr(al,jk,{enableVR:function(k){var x=this;if(!!x._vrEnable!==k)if(x._vrEnable=k,k)x.gv.vr.mp(x.onVRControllerChange,x);else if(x.gv.vr.ump(x.onVRControllerChange,x),x._vrRayPolyline){var l=x.gv.dm();l.remove(x._vrRayPolyline),l.remove(x._vrRayHitPoint),x._vrRayPolyline=d,x._vrRayHitPoint=d}},onVRControllerChange:function(l){var v=this,U=l.property,x=l.newValue,m=v.gv.vr.getController(x.id),R=m.getRay();R&&("gamepad.button.trigger"===U?"down"===x._62O?v.handle_mousedown(R):v.handleWindowMouseUp(R):"gamepad.pose"===U&&(v.handle_mousemove(R),v.handleWindowMouseMove(R)))},drawVRRay:function(E,X,I){var n,u=this,J=u.gv,o=u._vrRayPolyline,S=!1;if(o)n=u._vrRayHitPoint;else{var p=J.dm();u._vrRayPolyline=o=new T.Polyline,u._vrRayHitPoint=n=new T.Node,n.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),n.setAnchor3d(.5,.5,.499);var R=.2/J.vr.measureOflength;n.s3(R,R,R),o.s("intersect",!1),n.s("intersect",!1),p.add(o),p.add(n),S=!0}if(X){var U=I.world,A=I.worldNormal,b=U.x,e=U.y,w=U.z;o.s("shape.border.color","red"),o.setPoints([{x:E.origin.x,y:E.origin.z,e:E.origin.y},{x:b,y:w,e:e}]),n.s("3d.visible",!0),n.p3(b,e,w),n.lookAtDirection([A.x,A.y,A.z],"front")}else{o.s("shape.border.color","blue");var O=new T.Math.Vector3;O.copy(E.direction).setLength(1e3/u.gv.vr.measureOflength).add(E.origin),o.setPoints([{x:E.origin.x,y:E.origin.z,e:E.origin.y},{x:O.x,y:O.z,e:O.y}]),n.s("3d.visible",!1)}J.fi({kind:"vrRayIntersect",ray:E,data:X,intersect:I,polyline:o,hitNode:n,begin:S})},addListener:function(i){var E=this;E.gv.getView().addEventListener(i,function(t){N.preventDefault(t),E.disabled||E["handle_"+i](t)},Z)},handleWindowTouchMove:function(F){this.handleWindowMouseMove(F)},handleWindowMouseMove:function(b){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",b):(this.handleDownInfo("onBeginDrag",b),this.isDragging=!0))},handleWindowTouchEnd:function(W){this.handleWindowMouseUp(W)},handleWindowMouseUp:function(c){if(this.isDragging&&(this.handleDownInfo("onEndDrag",c),this.isDragging=!1),this.downInfo){var A=this.handle("onUp",c);A&&A.data===this.downInfo.data?this.handleMissingUp(c):this.handleDownInfo("onUp",c),this.downInfo=y}},handle_mouseleave:function(d){var a=this,R=a.gv,k=a.currentInfo?a.currentInfo.data:y;if(k){k.s("onLeave")&&k.s("onLeave")(d,k,R),a.fire("data","onLeave",d,k);var X=a.currentInfo?a.currentInfo.hits:y;if(X)for(var z in X)a.handleLeave(d,z);a.currentInfo=y}},handle_mousewheel:function(i){i.scrollDelta=i.wheelDelta/40,this.handle("onScroll",i)},handle_DOMMouseScroll:function(O){O.scrollDelta=2===O.axis?-O.detail:0,this.handle("onScroll",O)},handle_touchstart:function(g){this.handle_mousedown(g)},handle_touchmove:function(V){this.handle("onMove",V)},handle_mousedown:function(h){this.isDragging&&(this.handleDownInfo("onEndDrag",h),this.isDragging=!1),this.downInfo=this.handle("onDown",h),this.downInfo&&go(this,h)},handle_mousemove:function(c){var S=this,D=S.gv;S._hoverTimer&&(b(S._hoverTimer),delete S._hoverTimer);var r,G,s,C=S.handle("onMove",c),A=this.currentInfo?this.currentInfo.data:y,V=this.currentInfo?this.currentInfo.hits:y;if(C&&(G=C.data,s=C.hits,S._hoverTimer=X(function(){b(S._hoverTimer),delete S._hoverTimer,S.handle("onHover",c,C)},D.getHoverDelay()||N.hoverDelay)),G!==A){if(A&&(A.s("onLeave")&&A.s("onLeave")(c,A,D),this.fire("data","onLeave",c,A)),G&&(G.s("onEnter")&&G.s("onEnter")(c,G,D),this.fire("data","onEnter",c,G)),V)for(r in V)this.handleLeave(c,r);if(s)for(r in s){var g=s[r];g.target.onEnter&&g.target.onEnter(c,G,D,g.point,g.width,g.height),this.fire(g.type,"onEnter",g.event,g.data,g.image,g.comp,g.point,g)}}else{if(V)for(r in V)s&&s[r]||this.handleLeave(c,r);if(s)for(r in s)if(!V||!V[r]){var g=s[r];g.target.onEnter&&g.target.onEnter(c,G,D,g.point,g.width,g.height),this.fire(g.type,"onEnter",g.event,g.data,g.image,g.comp,g.point,g)}}this.currentInfo=C},handle:function(L,N,s){var h,A=this,D=A.gv;if(A._is2d){if(s=s||D.getDataInfoAt(N,this.filter),!s)return;if(h=s.ui.interactiveInfo){var C,Y=s.data;if(Y.s(L)&&Y.s(L)(N,Y,D),this.fire("data",L,N,Y),"body"===s.part&&h.bodyInfo)C="body",s.hits=this.handleImage(C,D.getImage(Y),L,N,Y,s.point,h.bodyInfo);else if("icons"===s.part&&h._38o){var c=h._38o[s.name];c&&c[s.index]&&(C="icons|"+s.name+"|"+s.index,s.hits=this.handleImage(C,s.icon,L,N,Y,s.point,c[s.index]))}}return s}var Y,F;if(!s)if(N&&N instanceof T.Math.Ray){var R=D.vr.intersectWorld(N);if(Y=R.data,F=R.intersect,A.drawVRRay(N,Y,F),!Y)return;var G=D.getData3dUI(Y);if(h=G.interactiveInfo,!h)return;s={data:Y,part:F.part,ui:G}}else{if(s=D.getDataInfoAt(N),!s)return;s&&(s={data:s.data,part:s.part})}if(!F){Y=s.data;var G=D.getData3dUI(Y);if(s.ui=G,h=G.interactiveInfo,!h)return s;if(F=D.intersectObject(N,Y),!F)return}Y.s(L)&&Y.s(L)(N,Y,D),this.fire("data",L,N,Y);var P,z=F.part;return"body"!==z&&(P=Y.s(z+".image")||Y.s("shape3d."+z+".image")),P||(P=Y.s("all.image")||Y.s("shape3d.image")),h="object"==typeof P?h[P.uuid]:h[P],h&&h.bodyInfo?(s.part="body",s.interactiveInfo=h,s.point=F.uv.multiply({x:h.bodyInfo.rect.width,y:h.bodyInfo.rect.height}),s.image=P,s.hits=this.handleImage("body",P,L,N,Y,s.point,h.bodyInfo),s):s},_handleLeaveOrMissing:function(s,d,G){var E="leave"===s?this.currentInfo:this.downInfo;if(E){var J=E.interactiveInfo||E.ui.interactiveInfo;if(J){var Y,a,q=E.data;if(this._is2d){if(a=this.gv.lp(d),"body"===E.part&&J.bodyInfo)Y="body","leave"===s?this.handleLeaveImage(G,Y,this.gv.getImage(q),d,q,a,J.bodyInfo):this.handleMissingUpImage(Y,this.gv.getImage(q),d,q,a,J.bodyInfo);else if("icons"===E.part&&J._38o){var m=J._38o[E.name];m&&m[E.index]&&(Y="icons|"+E.name+"|"+E.index,"leave"===s?this.handleLeaveImage(G,Y,E.icon,d,q,a,m[E.index]):this.handleMissingUpImage(Y,E.icon,d,q,a,m[E.index]))}}else{if(!J.bodyInfo)return;var h=this.gv.intersectObject(d,q);a=h?h.uv.multiply({x:J.bodyInfo.rect.width,y:J.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===s?this.handleLeaveImage(G,"body",E.image,d,q,a,J.bodyInfo):this.handleMissingUpImage("body",E.image,d,q,a,J.bodyInfo)}}}},handleDownInfo:function(O,t){if(this.downInfo){var z=this.downInfo,X=this.gv,c=z.interactiveInfo||z.ui.interactiveInfo;if(c){var o,v=z.data;if(v.s(O)&&v.s(O)(t,v,X),this.fire("data",O,t,v),this._is2d){var p=X.lp(t);if("body"===z.part&&c.bodyInfo)o="body",this.handleDownInfoImage(o,X.getImage(v),O,t,v,p,c.bodyInfo);else if("icons"===z.part&&c._38o){var x=c._38o[z.name];x&&x[z.index]&&(o="icons|"+z.name+"|"+z.index,this.handleDownInfoImage(o,z.icon,O,t,v,p,x[z.index]))}}else{if(!c.bodyInfo)return;var y=X.intersectObject(t,v);if(!y)return;p=y.uv.multiply({x:c.bodyInfo.rect.width,y:c.bodyInfo.rect.height}),this.handleDownInfoImage("body",z.image,O,t,v,p,c.bodyInfo)}}}},fire:function(O,R,K,V,e,y,G,F){this.gv.fi({kind:R,type:O,event:K,data:V,image:e,comp:y,view:this.gv,point:G,width:F?F.width:d,height:F?F.height:d})},handleImage:function(A,R,p,K,t,o,W){var v={};if(R&&(R=qp(R))){var I=this.gv,H=W.rect,e=this.convertPoint(o,W);e.inRect&&(R[p]&&R[p](K,t,I,e,H.width,H.height),this.fire("image",p,K,t,R,d,e,H),v[A+"|image"]={target:R,type:"image",image:R,data:t,event:K,point:e,width:H.width,height:H.height});for(var O=W.compInfos,T=R,u=O.length-1;u>=0;u--){var l=O[u],h=l.comp;e=this.convertPoint(o,l,T,h,I,t),e.inRect&&(H=l.rect,h[p]&&h[p](K,t,I,e,H.width,H.height),this.fire("comp",p,K,t,R,h,e,H),(R=H.image)&&(R[p]&&R[p](K,t,I,e,H.width,H.height),this.fire("image",p,K,t,R,d,e,H)),v[A+"|"+u]={target:h,type:"comp",comp:h,image:R,data:t,event:K,point:e,width:H.width,height:H.height},R&&(v[A+"|"+u+"|image"]={target:R,type:"image",image:R,data:t,event:K,point:e,width:H.width,height:H.height}))}}return v},handleLeave:function(i,j){return this._handleLeaveOrMissing("leave",i,j)},handleMissingUp:function(J){return this._handleLeaveOrMissing("missing",J)},handleLeaveImage:function(E,v,$,H,I,i,O){if($&&($=qp($))){var y=this.gv,u=O.rect,h=this.convertPoint(i,O);E===v+"|image"&&($.onLeave&&$.onLeave(H,I,y,h,u.width,u.height),this.fire("image","onLeave",H,I,$,d,h,u));for(var j=O.compInfos,W=$,t=j.length-1;t>=0;t--){var Q=j[t],A=Q.comp;h=this.convertPoint(i,Q,W,A,y,I),u=Q.rect,E===v+"|"+t&&(A.onLeave&&A.onLeave(H,I,y,h,u.width,u.height),this.fire("comp","onLeave",H,I,$,A,h,u)),($=u.image)&&E===v+"|"+t+"|image"&&($.onLeave&&$.onLeave(H,I,y,h,u.width,u.height),this.fire("image","onLeave",H,I,$,d,h,u))}}},handleMissingUpImage:function(l,z,I,U,Q,P){var Y="onUp",c=this.downInfo.hits;if(c&&z&&(z=qp(z))){var j=this.gv,q=P.rect,p=this.convertPoint(Q,P);!p.inRect&&c[l+"|image"]&&(z[Y]&&z[Y](I,U,j,p,q.width,q.height),this.fire("image",Y,I,U,z,d,p,q));for(var m=P.compInfos,R=z,F=m.length-1;F>=0;F--){var M=m[F],u=M.comp;
p=this.convertPoint(Q,M,R,u,j,U),p.inRect||(q=M.rect,c[l+"|"+F]&&(u[Y]&&u[Y](I,U,j,p,q.width,q.height),this.fire("comp",Y,I,U,z,u,p,q)),(z=q.image)&&c[l+"|"+F+"|image"]&&(z[Y]&&z[Y](I,U,j,p,q.width,q.height),this.fire("image",Y,I,U,z,d,p,q)))}}},handleDownInfoImage:function(J,g,N,m,M,O,r){var Q=this.downInfo.hits;if(Q&&g&&(g=qp(g))){var a=this.gv,S=r.rect,u=this.convertPoint(O,r);Q[J+"|image"]&&(g[N]&&g[N](m,M,a,u,S.width,S.height),this.fire("image",N,m,M,g,d,u,S));for(var k=r.compInfos,H=g,Y=k.length-1;Y>=0;Y--){var D=k[Y],F=D.comp;u=this.convertPoint(O,D,H,F,a,M),S=D.rect,Q[J+"|"+Y]&&(F[N]&&F[N](m,M,a,u,S.width,S.height),this.fire("comp",N,m,M,g,F,u,S)),(g=S.image)&&Q[J+"|"+Y+"|image"]&&(g[N]&&g[N](m,M,a,u,S.width,S.height),this.fire("image",N,m,M,g,d,u,S))}}},initImageResource:function(){N.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(g,E,O,D,C,m){var q=E.rect,Q=E.matrix.applyInverse(g).sub(q),e=Q.x>=0&&Q.y>=0&&Q.x<=q.width&&Q.y<=q.height;if(!e)return Q;if(D&&$f(D.pixelPerfect,m,C)){var q,n=1;this._is2d?(n=C.getZoom(),q=ii(g.x,g.y,d,n)):q=ii(g.x,g.y);var Z=!1,l=q.x,p=q.y,M=q.width,u=q.height,W=N.hitMaxArea,b=M*u*n*n;if(b>W){var w=Math.sqrt(W/b);n*=w}M*=n,u*=n,2>M&&(M=2),2>u&&(u=2),l*=n,p*=n;var U=kj(M,u),s=new kd(0,-l,-p,n,n);s.append(E.matrix),C._drawForChecking=!0,D.transform=s;var R=O.comps;O.comps=[D],bm(U,O,0,0,M,u,m,self),O.comps=R,delete D.transform,C._drawForChecking=!1;try{for(var Y=0,h=U.getImageData(0,0,M,u).data;Y<h.length;Y+=4)if(0!==h[Y+3]){Z=!0;break}U.restore()}catch(A){ao=y,Z=!1}Q.inRect=Z}else Q.inRect=!0;return Q}});var Jq=fc.DefaultInteractor=function(S){hg(Jq,this,[S])};wo("DefaultInteractor",jk,{handle_mousedown:function(I){Mf(I);var G=this,q=G.gv,k=q.getDataAt(I);!q.setFocus(I)||q._editing||q._scrolling||(_h(I)?q.handleDoubleClick(I,k):q.handleClick(I,k),!gb()&&k&&(q.isMovable(k)||q.isInteractive(k))||!q.isPannable()||!fq(I)||xj(I)||(G._tx=q.tx(),G._ty=q.ty(),G.startDragging(I)))},handleWindowMouseUp:function(p){var P=this,d=P.gv;d._panning&&(delete d._panning,d.onPanEnded(),P.fi({kind:"endPan",event:p})),delete P._tx,delete P._ty,P.clearDragging()},handle_mousemove:function(Q){var A=this,H=A.gv;A._hoverTimer&&(b(A._hoverTimer),delete A._hoverTimer),A._hoverTimer=X(function(){A.fi({kind:"hover",event:Q}),b(A._hoverTimer),delete A._hoverTimer},H.getHoverDelay()||N.hoverDelay)},handle_touchmove:function(u){this.handle_mousemove(u)},handleWindowMouseMove:function(Q){var Y=this,u=Y.gv,j=Y._lastClientPoint;Y.fi({kind:u._panning?"betweenPan":"beginPan",event:Q}),u._panning=1,u.setTranslate(Y._tx+Q.clientX-j.x,Y._ty+Q.clientY-j.y)},handle_mousewheel:function(u){this.gv.handleScroll(u,u.wheelDelta)},handle_DOMMouseScroll:function(B){2===B.axis&&this.gv.handleScroll(B,-B.detail)},handle_keydown:function(P){this.gv.handleKeyDown(P)}});var dj=fc.SelectInteractor=function(z){hg(dj,this,[z])};wo("SelectInteractor",jk,{_42:function(){var H=this,O=H.gv,z=O.getZoom(),S=H.mark,q=H.div;q||(q=H.div=Mg(),Ah(H.getView(),q));var C={};C.x=S.x*z+O.tx(),C.y=S.y*z+O.ty(),C.width=S.width*z,C.height=S.height*z,Ce(q,C),this.intersects()?(q.style.border="",q.style.background=O.getRectSelectBackground()):(q.style.background="",q.style.border="1px solid "+O.getRectSelectBorderColor())},handle_mousedown:function(V){var f=this,k=f.gv;if(f._57I=y,f.pendingClickThrough=y,!(k._editing||k._scrolling||gb())){var B=k.getDataAt(V),S=k.sm();B?xj(V)?S.co(B)?S.rs(B):S.as(B):S.co(B)?B instanceof oj&&B.isClickThroughEnabled()&&fq(V)&&(f.pendingClickThrough=Ne(V)):S.ss(B):xj(V)||!k.isPannable()?fq(V)&&(xj(V)||S.cs(),k.isRectSelectable()&&(f.startDragging(V),k._77O=1)):fq(V)&&(f._57I=Ne(V))}},handle_mouseup:function(i){var D=this,U=D.gv,P=D._57I;if(P&&(kk(P,Ne(i))<=1&&U.sm().cs(),D._57I=y),D.pendingClickThrough){if(kk(D.pendingClickThrough,Ne(i))<=1){var Q=U.getDataAt(i);if(Q instanceof oj&&Q.isClickThroughEnabled()){var j=U.getDataAt(i,function(s){var w=s.getParent()===Q&&U.isSelectable(s,!0);return w});j&&(i.clickThrough=!0,U.sm().ss(j))}}D.pendingClickThrough=y}},handleWindowMouseUp:function(J){this.clear(J)},handleWindowMouseMove:function(q){var M=this,j=M.gv;M._logicalPoint=j.lp(q),M.mark?(M.fi({kind:"betweenRectSelect",event:q}),j.isPannable()&&M.autoScroll(q),M.redraw()):M.fi({kind:"beginRectSelect",event:q}),M.mark=wm(M._lastLogicalPoint,M._logicalPoint),M.redraw()},intersects:function(){var Y=this,y=Y._lastLogicalPoint,S=Y._logicalPoint;return y.x>S.x||y.y>S.y},clear:function(M){var $=this,l=$.gv,E=$.mark;if($._57I=y,$.pendingClickThrough=y,$._lastLogicalPoint){if(E){if(0!==E.width&&0!==E.height){var R=l.getDatasInRect(E,$.intersects());if(!R.isEmpty()){var O=l.sm(),j=O.toSelection();R.each(function(B){O.co(B)?j.remove(B):j.add(B)}),O.ss(j)}}Hm($.div),delete $.div,delete $.mark,$.redraw(),$.fi({kind:"endRectSelect",event:M}),l.onRectSelectEnded()}$.clearDragging(),delete l._77O}},redraw:function(){var R=this;R._draw||(R._draw=1,X(function(){R.mark&&R._42(),delete R._draw},16))}});var ai=fc.MoveInteractor=function(v){hg(ai,this,[v])};wo("MoveInteractor",jk,{handle_mousedown:function(o){var q=this,R=q.gv;if(fq(o)&&!R._editing&&!R._scrolling&&!gb()){var p=R.getSelectedDataAt(o);!p||R.isInteractive(p)&&!R.isMovable(p)?R._focusData=y:(q._data=p,R.handleMouseDown&&R.handleMouseDown(o,p),q.startDragging(o),R.isMovable(p)&&(R._moving=1))}},handleWindowMouseUp:function(u){var O=this,A=O.gv;A.handleMouseUp&&A.handleMouseUp(u,O._data),O.clear(u)},handleWindowMouseMove:function(u){var S=this,p=S._data,P=S.gv;if((!P._93O||!P._93O(u,p))&&P._moving){S._logicalPoint||S.fi({kind:"prepareMove",event:u});var r=S._logicalPoint?"betweenMove":"beginMove",j={kind:r,event:u},e=S._logicalPoint=P.lp(u);"beginMove"!==r||S._alreadyBeginTransaction||(S._alreadyBeginTransaction=!0,P.getDataModel().beginTransaction());var d=S._calcShift(r,u),F=d.x,w=d.y,T=S.gv.getMoveMode(u,p);T&&("x"===T?w=0:"y"===T?F=0:"xy"!==T&&(F=w=0)),P.moveSelection(F,w),S._lastLogicalPoint=e,S.autoScroll(u),S.fi(j)}},_calcShift:function(){var w=this,o=w._logicalPoint,k=w._lastLogicalPoint,B=o.x-k.x,Z=o.y-k.y;return{x:B,y:Z}},clear:function(H){var Z=this,C=Z.gv;Z._lastLogicalPoint&&(Z._lastLogicalPoint=Z._data=C._moving=y,Z._logicalPoint&&(Z.fi({kind:"endMove",event:H}),C.onMoveEnded()),Z.clearDragging()),Z._alreadyBeginTransaction&&(Z._alreadyBeginTransaction=!1,C.getDataModel().endTransaction())}});var Cj=fc.ScrollBarInteractor=function(J){hg(Cj,this,[J])};wo("ScrollBarInteractor",jk,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(X){var $=this.gv.getViewRect();return this._41o()&&($.x+$.width-this.gv.lp(X).x)*this.gv.getZoom()<zm},isH:function(n){var F=this.gv.getViewRect();return this._40o()&&(F.y+F.height-this.gv.lp(n).y)*this.gv.getZoom()<zm},handle_mousemove:function(O){this.handle_touchmove(O)},handle_touchmove:function(A){if(!Tk&&fq(A)&&this.gv.isScrollBarVisible()){var O=this,J=O.isV(A),W=O.isH(A);(J||W)&&O.gv.showScrollBar(),O.gv._scrolling=J||W}},handleWindowMouseUp:function(J){this.handleWindowTouchEnd(J)},handleWindowTouchEnd:function(Q){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=y,this.fi({kind:"endScroll",event:Q})},handle_mousedown:function(G){this.handle_touchstart(G)},handle_touchstart:function(u){var C=this;if(C.gv.setFocus(u),Mf(u),C.handle_touchmove(u),!(kl(u)>1)&&C.gv._scrolling&&C.gv.isScrollBarVisible()){C._cp=Ne(u),C._tx=C.gv.tx(),C._ty=C.gv.ty();var K=C.isV(u);C._state=K?"vScroll":"hScroll",Ej(C,u),C.fi({kind:"beginScroll",event:u})}},handleWindowMouseMove:function(U){this.handleWindowTouchMove(U)},handleWindowTouchMove:function(f){var N=Ne(f),S=this.gv.getViewRect(),z=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-N.y)*z.height/S.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-N.x)*z.width/S.width),this.fi({kind:"betweenScroll",event:f})}});var Xi=fc.TouchInteractor=function(D,l){l=l||{},l.selectable===d&&(l.selectable=!0),l.movable===d&&(l.movable=!0),l.pannable===d&&(l.pannable=!0),l.pinchable===d&&(l.pinchable=!0),l.editable===d&&(l.editable=!0),this.params=l,hg(Xi,this,[D])};wo("TouchInteractor",jk,{ms_edit:1,setUp:function(){var L=this;Xi.superClass.setUp.call(L),jm&&L.params.editable&&L.gv.setEditInteractor(L)},tearDown:function(){var r=this;Xi.superClass.tearDown.call(r),jm&&r.params.editable&&r.gv.setEditInteractor(y)},clear:function(d){var S=this,Z=S.gv;Z._moving&&(S.fi({kind:"endMove",event:d}),delete Z._moving,Z.onMoveEnded(),Z.dm().endTransaction()),Z._panning&&(S.fi({kind:"endPan",event:d}),delete Z._panning,Z.onPanEnded()),Z._pinching&&(S.fi({kind:"endPinch",event:d}),delete Z._pinching,Z.onPinchEnded()),Z._editing&&(S._46O(d),S._77I=S._node=S._edge=S._shape=S._rect=S._89I=S._index=Z._editing=y),S._moving=S._panning=S._pinching=S._editing=S._57I=S._data=S._beginHistory=y,S.clearDragging()},handle_touchstart:function(p){var I=this;if(!I.gv._editing){Mf(p),I._57I=y;var k=I.params,K=I.gv,X=K.sm(),G=K.getDataAt(p),h=kl(p);if(1===h){if(_h(p))return K.handleDoubleClick(p,G),void 0;K.handleClick(p,G),G&&(K.handleMouseDown&&K.handleMouseDown(p,G),I._data=G),k.selectable||(G=y),G?(X.co(G)||X.ss(G),k.editable&&K.isEditable(G)&&I._79I(p,G,!0)?(I._editing=1,I.startDragging(p)):k.movable&&K.isMovable(G)&&(I._moving=1,I.startDragging(p))):(I._57I=Ne(p),k.pannable&&K.isPannable()&&(I._panning=1,I.startDragging(p),I._translate={x:K.tx(),y:K.ty()}))}else if(k.pinchable&&2===h){I._pinching=1,I.startDragging(p);var j=K.getView(),R=K.getZoom(),W=j.getBoundingClientRect(),L=p.touches[0],z=p.touches[1],S={x:(L.clientX+z.clientX)/2-W.left,y:(L.clientY+z.clientY)/2-W.top};S.x-=K.tx(),S.y-=K.ty(),S.x/=R,S.y/=R,I._p=S,I._d=_d(p)}}},handle_touchend:function(x){var I=this,H=I.gv,F=I._57I,V=I._data;F&&(kk(F,Ne(x))<=1&&H.sm().cs(),I._57I=y),V&&H.handleMouseUp&&H.handleMouseUp(x,V)},handleWindowTouchEnd:function(u){this.clear(u)},handleWindowTouchMove:function(x){var R=this,A=R.gv,f=kl(x);if(1===f){if(R._editing&&(R._beginHistory||(R._beginHistory=1,A.dm().beginTransaction()),A._editing=1,R._78I(x)),R._moving)R._beginHistory||(R._beginHistory=1,A.dm().beginTransaction()),R.handleMove(x);else if(R._panning){var Z=Ne(x);A.setTranslate(R._translate.x+Z.x-R._lastClientPoint.x,R._translate.y+Z.y-R._lastClientPoint.y),R.fi({kind:A._panning?"betweenPan":"beginPan",event:x}),A._panning=1}}else if(2===f&&R._pinching){var j=_d(x);A.handlePinch(R._p,j,R._d),R._d=j,R.fi({kind:A._pinching?"betweenPinch":"beginPinch",event:x}),A._pinching=1}},handleMove:function(X){var l=this,G=l.gv,B=G.lp(X);G._93O&&G._93O(X,l._data)||(G.moveSelection(B.x-l._lastLogicalPoint.x,B.y-l._lastLogicalPoint.y),l._lastLogicalPoint=B,l.autoScroll(X),l.fi({kind:G._moving?"betweenMove":"beginMove",event:X}),G._moving=1)}});var T=U.ht,cg=T.graph._editor={Math:T.Math,Guide:{}};cg.getStyle=function(r){var h,j=cg.StyleMap;return j&&(h=j[r],h!==d)?h:cg.DefaultStyleMap[r]},cg.setStyle=function(M,J){var Q=cg.StyleMap;Q||(Q=cg.StyleMap={}),Q[M]=J},cg.inEdit=function(v){return v._inXEdit===!0},cg.startEdit=function(W){W._inXEdit=!0,cg.Inject.doInject(W)},cg._46O=function(E){E._inXEdit=!1,cg.Inject.undoInject(E)},cg.toScreenPosition=function(y,X){var S=y.tx(),D=y.ty(),l=y._zoom;return new cg.Math.Vector2(X.x*l+S,X.y*l+D)},cg.checkHit=function(E,e,S){return E.distanceTo(e)<S?!0:!1},cg.toWorldPosition=function(L,K){var o=L.tx(),j=L.ty(),W=L._zoom;return{x:(K.x-o)/W,y:(K.y-j)/W}},cg.setAntialias=function(t,Q){for(var m,I=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],x=0,M=I.length;M>x&&(m=I[x],!(m in t));x++);t[m],t[m]=Q},cg.getTargetCornersOnScreen=function(p,Z){if(!Z)return null;var _,P=[];if(nk(Z,p)){var K=eo(p,Z);_=[{x:K.x,y:K.y},{x:K.x+K.width,y:K.y},{x:K.x+K.width,y:K.y+K.height},{x:K.x,y:K.y+K.height}]}else{if(!Z.getCorners)return null;_=Z.getCorners()}return _.forEach(function(v){var Y=cg.toScreenPosition(p,v);P.push(Y.x,Y.y)}),P},cg.log=function(){};var Kh=cg.Inject={_modules:[]};Kh.registAsModule=function(D,g){var P={},q={};for(var h in D){var a=g.prototype[h];P[h]=a}D.getBackup=function(r){return P[r]},D.getBackups=function(){return P},q.doInject=function(){for(var _ in D)"getBackup"!==_&&(g.prototype[_]=D[_])},q.undoInject=function(){for(var Q in D)"getBackup"!==Q&&(g.prototype[Q]=P[Q])},Kh._modules.push(q)},Kh.doInject=function(x){for(var d,T=Kh._modules,X=0,l=T.length;l>X;X++)d=T[X],d.doInject(x)},Kh.undoInject=function(D){for(var z,x=Kh._modules,L=0,v=x.length;v>L;L++)z=x[L],z.undoInject(D)};var jk=T.graph.EditInteractor=function(U){var b=this,l=r.createElement("canvas");l.className="editCanvas",l.style.position="absolute",b._styleMap={},b._canvas=l,b._context=l.getContext("2d"),jk.superClass.constructor.call(b,U),cg.setAntialias(b._context,!1),b._subModules=[new cg.Anchor(b),new cg.RotateX(b),new cg.Rect(b),new cg.Curve(b),new cg.MoveHelper(b)],b._gridGuide=new cg.Guide.Grid(b),b._rectGuide=new cg.Guide.Rect(b)},Lo=jk;T.Default.def(jk,T.graph.Interactor,{ms_edit:1,ms_fire:1}),M.defineProperties(jk.prototype,{editDetail:{get:function(){var E=!!this._editDetail;return E},set:function(i){var K=this,S=K._editDetail;S!==i&&(K._editDetail=i,K.gv._editing=i,K.fp("editDetail",S,i),K.fp("pointsEditingMode",S,i),K.fi({kind:i?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(N){(!this._editDetail||N)&&(this.gv._editing=N,N||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(N){this._editing=N,this.gvEditing=N}},pointsEditingMode:{get:function(){return this.editDetail},set:function(f){var L=this;L.editDetail!==f&&(f?L._tryEnterEditDetailMode():L._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var n=this._gridEnabled;if(!n)return!1;var C=this.gv;return C?!0:!0},set:function(k){k!==this._gridEnabled&&(this._gridEnabled=k,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(z){z!==this._agEnabled&&(this._agEnabled=z,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),jk.prototype.getSubModule=function(g){var r,E,e,V=this._subModules;for(E=0,e=V.length;e>E;E++)if(r=V[E],r.catalog===g)return r},jk.prototype.invokeSubModule=function(z,K){var M=this,G=M._subModules;if(G)for(var w,Q,R,J=Array.prototype.slice.call(arguments,2),b=0,m=G.length;m>b;b++)if(w=G[b],Q=w[z],Q&&(R=Q.apply(w,J),R!=d&&K))return w},jk.prototype.invokeSubModuleInverse=function(b,Z){var o=this,X=o._subModules;if(X)for(var R,D,j,W=Array.prototype.slice.call(arguments,2),f=X.length-1;f>=0;f--)if(R=X[f],D=R[b],D&&(j=D.apply(R,W),j!=d&&Z))return R},jk.prototype.setUp=function(){cg.log("setUp");var L=this,Z=L.gv,Q=Z.getView(),B=L._canvas;jk.superClass.setUp.call(L),Z.setEditInteractor(L),Z._79O?Q.insertBefore(B,Z._79O):Q.appendChild(B),cg.startEdit(Z),L.invokeSubModule("setUp"),Z.dm().mm(L._onDataModelChanged,L),Z.dm().md(L._onDataPropertyChanged,L)},jk.prototype.tearDown=function(){cg.log("tearDown");var x=this,j=x.gv,k=j.getView();x._resetCustomCursorStyle(),jk.superClass.tearDown.call(x),j.dm().umm(x._onDataModelChanged,x),j.dm().umd(x._onDataPropertyChanged,x),j.setEditInteractor(null),k.removeChild(x._canvas),x._drawTimer&&(b(x._drawTimer),x._drawTimer=null),cg._46O(j),x.invokeSubModule("tearDown")},jk.prototype._onDataModelChanged=function(P){var X=this;("clear"===P.kind||"remove"===P.kind&&X.editDetail&&P.data===X.getSubModule("Curve").target)&&(X.editDetail=!1,X._42())},jk.prototype._onDataPropertyChanged=function(F){var B=this;if(B.editDetail){var g=B.getSubModule("Curve"),y=F.data;y===g.target&&(y._writing||g._handleDataChanged(F))}},jk.prototype.clear=function(){cg.log("clear")},jk.prototype.redraw=function(){this._42()},jk.prototype._42=function(){var S=this;S._drawTimer||(S._drawTimer=X(function(){S._drawTimer=null,S.drawImpl()},0))},jk.prototype.drawImpl=function(){var r;for(r in{_42:!0})break;return function(){var j=this,k=j._canvas,R=j.gv,o=R.getWidth(),L=R.getHeight(),S=j._context,m=T.Default.getInternal();(k.width!==o||k.height!==L)&&m.setCanvas(k,o,L),S.clearRect(0,0,k.width,k.height);var s=j._getValidSelection();S.save();var K=T.Default.devicePixelRatio;S.scale(K,K),j._gridGuide._42(),j.invokeSubModuleInverse(r,!1,S,R,s),j._rectGuide._42(),S.restore()}}(),jk.prototype._getValidSelection=function(){var M=this,r=M.gv,f=r.sm().getSelection(),z=[];return f.each(function(y){r.isVisible(y)&&r.isEditable(y)&&z.push(y)}),z},jk.prototype.handle_touchmove=function(V){return this.handle_mousemove(V)},jk.prototype.handle_mousemove=function(H){if(!T.Default.isDragging()){var G=this;(G.editDetail||!gb())&&(G.gvEditing=!1,G._checkEdit(H)&&(G.gvEditing=!0))}},jk.prototype.handle_touchstart=function(b){return this.handle_mousedown(b)},jk.prototype.handle_mousedown=function(A){Mf(A);var E=this;if(E.editDetail||!gb()){if(_h(A)&&!A.clickThrough){if(E.editDetail){if(E._tryQuitEditDetailMode(A))return}else if(E._tryEnterEditDetailMode())return;E.gv.dm().beginTransaction();var O=E.invokeSubModule("handleDoubleClick",!0,A);if(E.gv.dm().endTransaction(),O)return}var Y=E._checkEdit(A);Y&&(E._downPosition=E._getLogicalPoint(A),E.gv.dm().beginTransaction(),Y.startEdit(E,A),E.editing=!0)}},jk.prototype._checkEdit=function(U){var $=this,g=$.gv,y=$._getLogicalPoint(U),u=$.invokeSubModule("check",!0,g,U,y)||null;return $._editMod=u,u},jk.prototype.handleWindowTouchMove=function(I){return this.handleWindowMouseMove(I)},jk.prototype.handleWindowMouseMove=function(r){var y=this,a=y._downPosition;if(a){var v=y._getLogicalPoint(r);if(v.distanceTo(a)<y.getStyle("moveSensitivity"))return;delete y._downPosition}var k=y._editMod;k&&k.handleEdit(y.gv,r)},jk.prototype._getLogicalPoint=function(V){var P=this,S=T.Default.getLogicalPoint(V,P._canvas);return new cg.Math.Vector2(S)},jk.prototype.handleWindowTouchEnd=function(t){return this.handleWindowMouseUp(t)},jk.prototype.handleWindowMouseUp=function(){var R;for(R in{_46O:!0})break;return function(d){var N=this;N.editing=!1,N.setCursor("default"),N.invokeSubModule(R,!1,d),N._42(),N.gv.dm().endTransaction()}}(),jk.prototype.handle_mousewheel=function(c){var y=this;Mf(c),y.invokeSubModule("preHandleScroll",!0)||y.gv.handleScroll(c,c.wheelDelta)},jk.prototype.handleDelete=function(){var c=this;if(!c.editDetail){c.gv.dm().beginTransaction();var v=c.invokeSubModule("handleNormalStateDelete",!0);return c.gv.dm().endTransaction(),v||c.gv.removeSelection(),void 0}c.gv.dm().beginTransaction(),c.invokeSubModule("handleDelete",!0),c.gv.dm().endTransaction(),c._42()},jk.prototype.handle_keydown=function(N){var a=this;if((N.metaKey||N.ctrlKey)&&a._42(),gb(N)&&!a.editing)return a.gvEditing=!1,a.setCursor("default"),a._42(),void 0;var g=Of(N);return a.editDetail?((g||Fd(N))&&(a.editDetail=!1,a._42()),a.gv.dm().beginTransaction(),a.invokeSubModule("handle_keydown",!0,N),a.gv.dm().endTransaction(),void 0):(a.gv.dm().beginTransaction(),a.invokeSubModule("handleNormalStateKeyDown",!0,N),a.gv.dm().endTransaction(),g&&a._tryEnterEditDetailMode(),void 0)},jk.prototype.handle_keyup=function(z){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,z),this.gv.dm().endTransaction()},jk.prototype._tryEnterEditDetailMode=function(){var t=this;return!t.editDetail&&t.invokeSubModule("canEnterEditDetailMode",!0)&&1===t._getValidSelection().length?(t.editDetail=!0,t._42(),!0):void 0},jk.prototype._tryQuitEditDetailMode=function(g){var w=this;return w.editDetail?!g||w.invokeSubModule("canQuitEditDetailMode",!0,g)?(w.editDetail=!1,w._42(),!0):!1:!1},jk.prototype.setStyle=function(H,b,j){var f=this;j?cg.setStyle(H,b):f._styleMap[H]=b,f.fp("styleChanged",null,{key:H,value:b,base:j}),f._42()},jk.prototype.getStyle=function(E){var M=this,Q=M._styleMap[E];return Q!==d?Q:cg.getStyle(E)},jk.prototype.setCursor=function(S){this._resetCustomCursorStyle(),T.graph.EditInteractor.superClass.setCursor.call(this,S)},jk.prototype._resetCustomCursorStyle=function(){var A=this;if(A._customStyle){var P=this.gv.getView();P.classList&&P.classList.remove&&P.classList.remove(A._customStyle),A._customStyle=null}},jk.prototype._setRotateCursor=function(B){var r=this,K=r._cursorFactory;K||(K=r._cursorFactory=new cg.CursorFactory(r));var p=K.getRotateCursor(B),j=r.gv.getView();r._resetCustomCursorStyle(),r._customStyle=p,j.classList&&j.classList.add&&j.classList.add(p)};var Rl=cg.Group=function(W){var Y=this;Y._entities=W,Y._64O=0,Y._position={x:0,y:0},Y._scale={x:1,y:1},Y._anchor={x:.5,y:.5},Y._anchor2={x:.5,y:.5}};Rl.prototype={},Rl.prototype.constructor=Rl;var _e=null;Rl.findOrCreateGroup=function(l){if(_e&&_e.checkIsMe(l))return _e;var _=new cg.Group(l);return _.getKeyOb()?(_e=_,_):void 0},Rl.prototype.checkIsMe=function(J){var t=this._entities;if(t.length!==J.length)return!1;var E,A={},F=J.length;for(E=0;F>E;E++)A[J[E]._id]=!0;for(E=0;F>E;E++)if(!A[t[E]._id])return!1;return!0},Rl.prototype.getRotation=function(){return this._64O},Rl.prototype.getPosition=function(){return this._position},Rl.prototype.getAnchor=function(){return this._anchor},Rl.prototype.getWidth=function(){return this._width},Rl.prototype.getScale=function(){return this._scale},Rl.prototype.getSize=function(){return{width:this._width,height:this._height}},Rl.prototype.getHeight=function(){return this._height},Rl.prototype.getKeyOb=function(){for(var c=this._entities,E=c.length-1;E>=0;E--){var y=c[E];if(this.isNode(y))return y}},Rl.prototype.getAnchor2=function(){var D=this,L=D.rotateCenter;if(L)return L;var c=D.getKeyOb();if(!c)return D._anchor;var J=D._anchor2,t=c.getMatrix();return t.tf({x:c.getWidth()*(J.x-c.getAnchor().x),y:c.getHeight()*(J.y-c.getAnchor().y)})},Rl.prototype.setAnchor2=function(B,T){var I=this,F=I.getKeyOb();if(F){var t,s=F.getMatrix();t="number"==typeof B?{x:B,y:T}:B;var _=s.tfi(t);I._anchor2={x:F.getAnchor().x+_.x/F.getWidth(),y:F.getAnchor().y+_.y/F.getHeight()}}},Rl.prototype.setRotation=function(){},Rl.prototype.beginRotate=function(O){this.rotateCenter=O.pos,this.rotateMode=O.groupRotateMode},Rl.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Rl.prototype.addRotation=function(_,h){return"batch"===h?this._addRotationInBatchMode(_):"block"===h?this._addRotationInBlockMode(_):void 0},Rl.prototype._addRotationInBlockMode=function(K){var F=this,h=F.rotateCenter||F.getPosition();F._entities.forEach(function(N){if(F.isNode(N)){var g=N.getMatrix();g.translate(-h.x,-h.y),g.rotate(K),g.translate(h.x,h.y);var P=Math.sign(N.getScale().x);N.setRotation(B(g.b*P,g.a*P)),N.setPosition(g.tx,g.ty)}})},Rl.prototype._addRotationInBatchMode=function(m){var d=this,C=d._anchor2;d._entities.forEach(function(w){if(d.isNode(w)){var v=w.getAnchor(),A=w.getMatrix(),Q=A.tf({x:w.getWidth()*(C.x-v.x),y:w.getHeight()*(C.y-v.y)}),K=new cg.Math.Matrix2d;K.set(A.a,A.b,A.c,A.d,A.tx,A.ty),K.translate(-Q.x,-Q.y),K.rotate(m),K.translate(Q.x,Q.y);var L=Math.sign(w.getScale().x);w.setRotation(B(K.b*L,K.a*L)),w.setPosition(K.tx,K.ty)}})},Rl.prototype.setPosition=function(g){var Y,M,K,H,j=this,S=j._position,G=g.x-S.x,v=g.y-S.y,p=j._entities;for(M=0,K=p.length;K>M;M++)Y=p[M],Np(Y)&&(H=Y.getPosition(),Y.setPosition(H.x+G,H.y+v));j._position=g},Rl.prototype.setScale=function(I,i){var $=this,g=I/$._scale.x,r=i/$._scale.y;$._adjustChildScaleOrSize(g,r,"size"),$._scale={x:I,y:i}},Rl.prototype.getRect=function(){var Z=this,c=Z._position,n=Z._width,i=Z._height;return{x:c.x-n/2,y:c.y-i/2,width:n,height:i}},Rl.prototype.setSize=function(J,V){var Y=this,J=Math.max(1,J),V=Math.max(1,V),x=J/Y._width,I=V/Y._height;Y._adjustChildScaleOrSize(x,I,"size"),Y._width=J,Y._height=V},Rl.prototype._adjustChildScaleOrSize=function(m,j,W){var t,S,b,C,d,D,Z,e,n,G,x,f,k,w,q=this,z=q._position,l=q._entities,g=new cg.Math.Matrix2d;for(S=0,b=l.length;b>S;S++)if(t=l[S],q.isNode(t)){if(C=t.getPosition(),d=t.getRotation(),D=t.getWidth(),Z=t.getHeight(),e=t.getScale(),x=e.x*D,f=e.y*Z,g.identity().scale(x,f).rotate(d).translate(C.x,C.y).translate(-z.x,-z.y).rotate(-q._64O),d=B(g.b*Math.sign(x),g.a*Math.sign(x)),g.scale(m,j),n=Math.cos(d),G=Math.sin(d),Math.abs(n)<.001?(k=g.b/G,w=-g.c/G):(k=g.a/n,w=g.d/n),"scale"===W)t.setScale(k/D,w/Z);else if("size"===W){var R=k/e.x,P=w/e.y;t.setScale(Kf(k)*Math.abs(e.x),Kf(w)*Math.abs(e.y)),t.setSize(Math.max(.1,Math.abs(R)),Math.max(.1,Math.abs(P)))}g.rotate(q._64O).translate(z.x,z.y),t.setPosition(g.tx,g.ty)}},Rl.prototype.getMatrix=function(){var $=this,b=$._position,f=T.Default.getInternal(),A=$._scale;return new f.Mat($._64O,b.x,b.y,A.x,A.y)},Rl.prototype.toGlobal=function(d){return this.getMatrix().tf(d)},Rl.prototype.getCorners=function(){var F=this,h=F._width,w=F._height,X=F._anchor,x=-h*X.x,Y=-w*X.y,o=F.getMatrix();return[o.tf(x,Y),o.tf(x,Y+w),o.tf(x+h,Y+w),o.tf(x+h,Y)]},Rl.prototype.calcInfo=function(){var F,l,m,f,g,e,c=this,D=[],T=c._entities,M=c._64O;for(f=0,g=T.length;g>f;f++)e=T[f],c.isNode(e)&&e.getCorners&&D.push.apply(D,e.getCorners());if(D.length){var G=Math.cos(-M),N=Math.sin(-M),A=1/0,s=-1/0,B=1/0,i=-1/0;for(f=0,g=D.length;g>f;f++)m=D[f],F=m.x,l=m.y,m.x=G*F-N*l,m.y=N*F+G*l,A=Math.min(A,m.x),s=Math.max(s,m.x),B=Math.min(B,m.y),i=Math.max(i,m.y);c._width=(s-A)/c._scale.x,c._height=(i-B)/c._scale.y,G=Math.cos(M),N=Math.sin(M);var Q=c._anchor;F=A+(s-A)*Q.x,l=B+(i-B)*Q.y,c._position={x:G*F-N*l,y:N*F+G*l}}},Rl.prototype.isNode=function(y){return Np(y)?nk(y)?!1:!0:!1},Rl.prototype._42=function(T,x,Y){var f,w,A,$,u,V,J,o,j=this,H=j._entities,S=j.rotateMode;for("batch"===S&&(o=j.getKeyOb()),f=0,w=H.length;w>f;f++)A=H[f],j.isNode(A)&&(V=A.getRect(),$=cg.toScreenPosition(Y,{x:V.x,y:V.y}),u=cg.toScreenPosition(Y,{x:V.x+V.width,y:V.y+V.height}),J={min:$,max:u},A===o&&(J.isKeyOb=!0),cg.Icons.DrawIcon(T,x,cg.Icons.GroupSubEntityRect,J))};var Sc=cg.CurveActiving=function(M,v){this._curve=M,this._interactor=M._interactor;for(var A in v)this[A]=v[A]};Sc.prototype={},Sc.prototype.constructor=Sc,M.defineProperties(Sc.prototype,{point:{get:function(){return this._point},set:function(X){var K=this;K._point=X,K.editingCtrl||K._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(R){var g=this;g._pairs=R,g.editingCtrl&&g._firePointChange()}}}),Sc.prototype._firePointChange=function(){var g=this,Q=g.getCurrentEditingPoint();if(!Q)return H.fi({kind:"selectPoint"}),void 0;var H=g._interactor,o=this._curve.target;if(o){var p=cg.getDataMatrix(o).invert(),T=Q.e;Q=p.apply(cg.toWorldPosition(H.gv,Q)),Q.e=T;var E=g._lastFirePoint;E&&Math.abs(Q.x-E.x)<1e-5&&Math.abs(Q.y-E.y)<1e-5&&(Q.e==d&&E.e==d||Math.abs(Q.e-E.e)<1e-5)||(g._lastFirePoint=Q,H.fi({kind:"selectPoint",x:Q.x,y:Q.y,e:Q.e}))}},Sc.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Sc.prototype.getCurrentEditingPoint=function(){var E=this,F=E.editingCtrl;if(F){var g=E.pairs;if(g){var d=g[F.pairId],c=d[F.type];if(c)return c}}return E._point};var zr=cg.CursorFactory=function(h){var y=this;y._interactor=h,y._rotateCursorStyles={}};zr.prototype={},zr.prototype.constructor=zr,zr.prototype.getRotateCursor=function(T){var H=this;0>T&&(T+=2*Math.PI);var X=H._interactor,Z=X.getStyle("rotateCursorSize"),U=X.getStyle("rotateCursorRound"),x=Math.round(180*(T/Math.PI)/U);x*U>=360&&(x=0);var h=H._rotateCursorStyles,V="htCustomRotateStyle_"+Z+"_"+U+"_"+x;return h[V]||(H._produceRotateCursor(V,Z,U,x),h[V]=!0),V},zr.prototype._produceRotateCursor=function(I,W,j,$){var S=this;S._interactor;var b=S._canvas;b||(b=S._canvas=r.createElement("canvas")),b.width=b.height=W*devicePixelRatio,b.style.width=b.style.height=W+" px";var J=b.getContext("2d");cg.setAntialias(J,!1),J.scale(devicePixelRatio,devicePixelRatio);var M,n,q,m,p,L=Math.round(W/2),K=""+L+" "+L+",auto !important;";M=Math.PI/180*$*j,J.clearRect(0,0,W,W),J.save(),J.scale(W/32,W/32),J.translate(16,16),J.rotate(M+Math.PI/2),J.beginPath(),J.moveTo(-8,0),J.lineTo(-8,3),J.lineTo(-5,3),J.moveTo(8,0),J.lineTo(8,3),J.lineTo(5,3),J.moveTo(-8,3),J.quadraticCurveTo(0,-6,8,3),J.restore(),J.strokeStyle="white",J.lineWidth=4,J.stroke(),J.strokeStyle="black",J.lineWidth=2,J.stroke(),n=JSON.stringify(b.toDataURL()),m="cursor:url("+n+")"+K,1!==devicePixelRatio&&(q='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+W+'px" height="'+W+'px"><image xlink:href='+n+' width="'+W+'" height="'+W+'"/></svg>',m+="cursor:url(data:image/svg+xml;base64,"+btoa(q)+")"+K,m+="cursor:-webkit-image-set(url("+n+")"+devicePixelRatio+"x,url("+n+")1x)"+K),p=r.createElement("style"),p.textContent="body."+I+" *, ."+I+"{"+m+"}",r.head.appendChild(p)};var dn=cg.Guide.Grid=function(b){var z=this;z._interactor=b,z._alignmentGuideId=0,z._xAlignmentGuide=[],z._yAlignmentGuide=[]};dn.prototype={},dn.prototype.constructor=dn,M.defineProperties(dn.prototype,{gridBlockSize:{get:function(){var x=this;return x._gridBlockSize||x._interactor.getStyle("gridBlockSize")},set:function(z){this._gridBlockSize=z,this._interactor._42()}},gridThickLinesEvery:{get:function(){var _=this;return _._gridThickLinesEvery||_._interactor.getStyle("gridThickLinesEvery")},set:function(h){this._gridThickLinesEvery=h,this._interactor._42()}},gridEnabled:{get:function(){var T=this,f=T._interactor;return f.gridEnabled&&T.isValidGrid()}}}),dn.prototype._42=function(){var H=this,C=H._interactor;H.gridEnabled&&H.drawGrid(),C.alignmentGuideEnabled&&H.drawAlignmentGuide()},dn.prototype.makeMatrix=function(){var Y=this,a=Y._interactor.getStyle("gridAngle"),X=Y._interactor.getStyle("gridRotation"),o=new cg.Math.Matrix2d,E=Math.sin(a),q=Math.cos(a);return o.set(1,0,q,E,0,0),o.rotate(X),o},dn.prototype.isValidGrid=function(){var g=this,r=Math.PI,l=g._interactor,m=l.gv;if(m._zoom<l.getStyle("gridZoomThreshold"))return!1;var I=l.getStyle("gridAngle"),y=Math.abs(180*(I%r/r)),B=1-1e-8;return B>y||y>180-B?!1:!0},dn.prototype.drawAlignmentGuide=function(){var Q=this,s=Q._interactor,h=s.gv,r=s._canvas,D=s._context,w=r.width,e=r.height,M=h.tx(),f=h.ty(),R=h._zoom;D.beginPath(),D.strokeStyle=s.getStyle("gridAlignmentGuideColor"),D.lineWidth=1,Q._xAlignmentGuide.forEach(function(q){var X=q.p*R+M;D.moveTo(X,0),D.lineTo(X,e)}),Q._yAlignmentGuide.forEach(function(p){var z=p.p*R+f;D.moveTo(0,z),D.lineTo(w,z)}),D.stroke()},dn.prototype.drawGrid=function(){function Y(z,$,m,X){var G=cg.toScreenPosition(A,r.apply({x:z,y:$})),v=cg.toScreenPosition(A,r.apply({x:m,y:X}));R.moveTo(G.x,G.y),R.lineTo(v.x,v.y)}var f=this,j=f._interactor,q=f.gridBlockSize,G=f.gridThickLinesEvery,k=j.getStyle("gridThickColor"),W=j.getStyle("gridLightColor"),A=j.gv,J=j._canvas,R=j._context,t=J.width,c=J.height,r=f.makeMatrix(),y=r.applyInverse(cg.toWorldPosition(A,{x:0,y:0})),P=r.applyInverse(cg.toWorldPosition(A,{x:t,y:0})),B=r.applyInverse(cg.toWorldPosition(A,{x:0,y:c})),s=r.applyInverse(cg.toWorldPosition(A,{x:t,y:c})),w=Math.min(y.x,P.x,B.x,s.x),x=Math.max(y.x,P.x,B.x,s.x),$=Math.min(y.y,P.y,B.y,s.y),d=Math.max(y.y,P.y,B.y,s.y);t=x-w,c=d-$;var H=Math.ceil(w/q),l=Math.floor(x/q),_=Math.ceil($/q),D=Math.floor(d/q);A.tx(),A.ty(),A._zoom;var g,O,b;for(R.save(),R.lineWidth=1,R.beginPath(),R.strokeStyle=k,b=Math.ceil(H/G)*G;l>=b;b+=G)g=b*q,Y(g,$,g,d);for(b=Math.ceil(_/G)*G;D>=b;b+=G)O=b*q,Y(w,O,x,O);for(R.stroke(),R.beginPath(),R.strokeStyle=W,b=H;l>=b;b++)0!==b%G&&(g=b*q,Y(g,$,g,d));for(b=_;D>=b;b++)0!==b%G&&(O=b*q,Y(w,O,x,O));R.stroke(),R.restore()},dn.prototype.getAlignmentGuides=function(){var P=this;return{x:P._xAlignmentGuide,y:P._yAlignmentGuide}},dn.prototype.addAlignmentGuide=function(g,T,i){var c=this,d="x"===g?c._xAlignmentGuide:c._yAlignmentGuide,i=i?i:++c._alignmentGuideId,D={p:T,id:i};if(d.length){var m=c._findClosestAlignmentGuide(D.p,d);
m.dis<0?d.splice(m.index+1,0,D):d.splice(m.index,0,D)}else d.push(D);return c._interactor._42(),i},dn.prototype.findClosest=function(l,E,C){var r=this,T=r._interactor,M=T.gv;C&&(l=cg.toWorldPosition(M,l));var G,z,V,P=1/0,a=1/0,W=l.x,y=l.y;if(r.gridEnabled){var L=r.gridBlockSize,t=r.makeMatrix(),N=t.applyInverse(l);N=t.apply({x:Math.round(N.x/L)*L,y:Math.round(N.y/L)*L}),P=N.x-W,a=N.y-y,V=!0}if(T.alignmentGuideEnabled&&(G=r._findClosestAlignmentGuide(W,r._xAlignmentGuide).dis,z=r._findClosestAlignmentGuide(y,r._yAlignmentGuide).dis,Math.abs(G)<Math.abs(P)&&(P=G,V=!0),Math.abs(z)<Math.abs(a)&&(a=z,V=!0)),V){V=!1;var s=M._zoom,x=T.getStyle("smartGuideSensitivity")/s,g={};if(Math.abs(P)<x&&"y"!==E&&(g.x=C?P*s:P,V=!0),Math.abs(a)<x&&"x"!==E&&(g.y=C?a*s:a,V=!0),V)return g}},dn.prototype._findClosestAlignmentGuide=function(m,q){if(!q.length)return{dis:1/0};for(var A,b=0,J=q.length-1;J-b>1;)A=Math.floor((b+J)/2),q[A].p<m?b=A:J=A;var l=q[b].p-m,d=q[J].p-m;return Math.abs(l)<=Math.abs(d)?{line:q[b],dis:l,index:b}:{line:q[J],dis:d,index:J}},dn.prototype.removeAllAlignmentGuide=function(O){var v=this;"y"!==O&&(v._xAlignmentGuide=[]),"x"!==O&&(v._yAlignmentGuide=[]),v._interactor._42()},dn.prototype.removeAlignmentGuide=function(g){for(var b,u,q,J=this,L=J._xAlignmentGuide,S=0;2>S;S++)for(L=0===S?J._xAlignmentGuide:J._yAlignmentGuide,b=0,u=L.length;u>b;b++)if(q=L[b],q.id===g)return L.splice(b,1),J._interactor._42(),{axis:0===S?"x":"y",position:q.p};return!1},dn.prototype.adjustAlignmentGuide=function(b,$){var O=this,F=O.removeAlignmentGuide(b);return F?(O.addAlignmentGuide(F.axis,$,b),!0):!1};var Wi=cg.Guide.Rect=function(K){var J=this;J._interactor=K};Wi.prototype={},Wi.prototype.constructor=Wi,Wi.prototype.gatherRects=function(){var z,Q,T,v,I=this,X=I._interactor.gv,F=[],E=[],y={x:F,y:E},s={},l=X.getDataModel(),r=l.a("width"),k=l.a("height");r&&k&&(z=0,Q=0,T=r,v=k,F.push({node:l,type:0,p:z},{node:l,type:1,p:z+T/2},{node:l,type:2,p:z+T}),E.push({node:l,type:0,p:Q},{node:l,type:1,p:Q+v/2},{node:l,type:2,p:Q+v}),s[l._id||0]={x:z,y:Q,width:T,height:v}),l.each(function(j){if(Np(j)&&!X.isSelected(j)&&X.isVisible(j)){var $=!1;if(X.sm().getSelection().each(function(e){$||(j.isHostOn(e)?$=!0:j.isDescendantOf(e)&&($=!0))}),!$){var x=j.getRect();z=x.x,Q=x.y,T=x.width,v=x.height,F.push({node:j,type:0,p:z},{node:j,type:1,p:z+T/2},{node:j,type:2,p:z+T}),E.push({node:j,type:0,p:Q},{node:j,type:1,p:Q+v/2},{node:j,type:2,p:Q+v}),s[j._id]=x}}}),F.sort(function(o,h){return o.p-h.p}),E.sort(function(v,b){return v.p-b.p}),I._grid=y,I._87I=s},Wi.prototype.gatherLines=function(B,c,y){var W,r,_,u,S,A,L,H,F,Q,w,I,m=this,U=[m.findClosest({x:B.x,y:B.y},c),m.findClosest({x:B.x+B.w/2,y:B.y+B.h/2},c),m.findClosest({x:B.x+B.w,y:B.y+B.h},c)],a={},E=m._87I;y=y||255;var T,q;for(m._guideLine=[],W=0;2>W;W++)for(a={},0===W?(u="y",H=B.x,F=H+B.w):(u="x",H=B.y,F=H+B.h),r=0;3>r;r++)S=U[r],S&&isFinite(S[u])&&(T=1<<3*W+r,y&T&&(A=S[u+"Line"],L=A.node,q=L._id||0,a[q]||(a[q]=!0,I=E[q],"y"===u?(Q=I.x,w=I.x+I.width):(Q=I.y,w=I.y+I.height),_=A.p,m._guideLine.push({type:u,a:H,b:F,c:Q,d:w,p:_,center:1===A.type}))))},Wi.prototype._binarySearchClosest=function(X,l){if(!l.length)return{dis:1/0};for(var b,U=0,W=l.length-1;W-U>1;)b=Math.floor((U+W)/2),l[b].p<X?U=b:W=b;var f=l[U].p-X,K=l[W].p-X;return Math.abs(f)<=Math.abs(K)?{line:l[U],dis:f}:{line:l[W],dis:K}},Wi.prototype.findClosest=function(B,D,q){var x=this,U=x._interactor,H=U.gv,w=x._grid;q&&(B=cg.toWorldPosition(H,B));var T,i=x._binarySearchClosest(B.x,w.x),Y=x._binarySearchClosest(B.y,w.y),C=i.dis,L=Y.dis,j=H._zoom,J=U.getStyle("smartGuideSensitivity")/j,Q={};return Math.abs(C)<J&&"y"!==D&&(Q.x=q?C*j:C,Q.xLine=i.line,T=!0),Math.abs(L)<J&&"x"!==D&&(Q.y=q?L*j:L,Q.yLine=Y.line,T=!0),T?Q:void 0},Wi.prototype._42=function(){var v=this,Y=v._guideLine;if(Y&&!T.Default.isCtrlDown()){var k,G,i,V,P,B,r,b,A,q,N,R,j,H,L,E,t,y=v._interactor,n=y.gv,S=y._context,C=n.tx(),f=n.ty(),e=n._zoom,F=y.getStyle("guideLineTextSpacing");for(k=0,G=Y.length;G>k;k++)i=Y[k],b=i.type,A=i.p,q=i.a,N=i.b,R=i.c,j=i.d,H=Math.min(q,R),L=Math.max(N,j),"x"===b?(V=A*e+C,P=H*e+f,B=V,r=L*e+f):(V=H*e+C,P=A*e+f,B=L*e+C,r=P),cg.Icons.DrawIcon(y,S,cg.Icons.MoveLineGuide,{rect:[V,P,B,r],center:i.center}),j>=q&&N>=R||(H=q>j?j:N,L=q>j?q:R,t=L-H,"x"===b?(i.center2center||(V-=F,B=V),P=H*e+f,r=L*e+f,E=cg.Icons.MoveLineGuideDistanceV):"y"===b&&(i.center2center||(P-=F,r=P),V=H*e+C,B=L*e+C,E=cg.Icons.MoveLineGuideDistanceH),cg.Icons.DrawIcon(y,S,E,{x0:V,y0:P,x1:B,y1:r,dis:t}))}},Wi.prototype.clear=function(){this._guideLine=null},cg.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var eg=cg.Icons={},Ep=1e4,lk=null,Ff="rgb(51,153,255)",Di="rgb(183,232,135)",Pl="rgb(255,204,153)",In=6;T.Default.setImage("Icons.RectPoint",{width:In,height:In,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:Ff,rect:[0,0,In,In]}]});var ji="#e000e0";eg.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var B=eg.GroupSubEntityRect.data;if(!B)return[];var H=B.min,I=B.max;return[H.x,H.y,H.x,I.y,I.x,I.y,I.x,H.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return eg.GroupSubEntityRect.data.isKeyOb?ji:"#666666"}}}]},eg.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[eg.Line.data.P1.x,eg.Line.data.P1.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[eg.Line.data.P2.x,eg.Line.data.P2.y],In,In]}}}]},eg.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return eg.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},eg.Rect={comps:[{type:"shape",points:{func:function(){var _=eg.Rect.data;if(!_)return[];var W=_.LT,q=_.LB,g=_.RB,R=_.RT;return[W.x,W.y,q.x,q.y,g.x,g.y,R.x,R.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:Ff},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return eg.Rect.data.rotation}},rect:{func:function(){return[[eg.Rect.data.LT.x,eg.Rect.data.LT.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return eg.Rect.data.rotation}},rect:{func:function(){return[[eg.Rect.data.LB.x,eg.Rect.data.LB.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return eg.Rect.data.rotation}},rect:{func:function(){return[[eg.Rect.data.RB.x,eg.Rect.data.RB.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return eg.Rect.data.rotation}},rect:{func:function(){return[[eg.Rect.data.RT.x,eg.Rect.data.RT.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return eg.Rect.data.rotation}},visible:{func:function(){return eg.Rect.data.L?!0:!1}},rect:{func:function(){return[[eg.Rect.data.L.x,eg.Rect.data.L.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return eg.Rect.data.rotation}},visible:{func:function(){return eg.Rect.data.R?!0:!1}},rect:{func:function(){return[[eg.Rect.data.R.x,eg.Rect.data.R.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return eg.Rect.data.rotation}},visible:{func:function(){return eg.Rect.data.T?!0:!1}},rect:{func:function(){return[[eg.Rect.data.T.x,eg.Rect.data.T.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return eg.Rect.data.rotation}},visible:{func:function(){return eg.Rect.data.B?!0:!1}},rect:{func:function(){return[[eg.Rect.data.B.x,eg.Rect.data.B.y],In,In]}}}]};var $h=16;T.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:Ff,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:Ff,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),eg.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[eg.Anchor.data.POS.x,eg.Anchor.data.POS.y],$h,$h]}}}]},eg.TipShiftX=12,eg.TipShiftY=12;var _k=[8,28];eg.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[eg.TipHelper.data.helperPos.x,eg.TipHelper.data.helperPos.y,_k[0]*eg.TipHelper.data.size,_k[1]]}},background:{func:function(){return lk.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return eg.TipHelper.data.text}},rect:{func:function(){return[eg.TipHelper.data.helperPos.x,eg.TipHelper.data.helperPos.y,_k[0]*eg.TipHelper.data.size,_k[1]]}},color:{func:function(){return lk.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var cb=7;eg.ShapePoint={comps:[{type:"circle",rect:{func:function(){var h=eg.ShapePoint.data.point;return[h,cb,cb]}},background:{func:function(){var J=eg.ShapePoint.data.isEnd;return J?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:Ff}]},eg.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return eg.ShapeBgCurve.data.P}},segments:{func:function(){return eg.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:Ff}]};var Pk=8;eg.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var D=eg.ShapeHighlighPoint.data;return[[D.x,D.y],Pk,Pk]}},background:{func:function(){return lk.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Gb=10;eg.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var s=eg.ShapeHighlighRealPoint.data;return[[s.x,s.y],Gb,Gb]}},background:"#ffffff",borderWidth:2,borderColor:Ff}]};var Ik=8;eg.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var a=eg.ShapeHighlighCtrlPoint.data,D=a.x,f=a.y,J=Ik/2;return[D-J,f-J,D-J,f+J,D+J,f+J,D+J,f-J]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return lk.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return lk.getStyle("shapeCtrlPointBorderColor")||Ff}}}]};var xl=3;eg.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return eg.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:xl,borderColor:{func:function(){return lk.getStyle("curveHighlightColor")}}}]},eg.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return eg.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},eg.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return eg.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return eg.MoveLineGuide.data.center?Di:Pl}}}]};var Uf=5;eg.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var X=eg.MoveLineGuideDistanceH.data,V=X.x0,H=X.y0;return[V,H-Uf,V,H+Uf]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Pl},{type:"shape",points:{func:function(){var v=eg.MoveLineGuideDistanceH.data,u=v.x1,M=v.y1;return[u,M-Uf,u,M+Uf]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Pl},{type:"text",text:{func:function(){return Math.round(eg.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var J=eg.MoveLineGuideDistanceH.data;return[[(J.x0+J.x1)/2,J.y0-10],20,20]}},color:Pl,font:"12px Arial",align:"center"}]},eg.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var q=eg.MoveLineGuideDistanceV.data,M=q.x0,F=q.y0;return[M-Uf,F,M+Uf,F]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Pl},{type:"shape",points:{func:function(){var n=eg.MoveLineGuideDistanceV.data,D=n.x1,E=n.y1;return[D-Uf,E,D+Uf,E]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Pl},{type:"text",text:{func:function(){return Math.round(eg.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var W=eg.MoveLineGuideDistanceV.data;return[[W.x0-10,(W.y0+W.y1)/2],20,20]}},color:Pl,font:"12px Arial",align:"center"}]},T.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),eg.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var x=eg.EdgeElevationGuide.data,f=x.x,l=x.y,j=lk.getStyle("curveElevationIntersectSize"),Q=lk.getStyle("curveElevationGuideShift");return f+=Q[0],l+=Q[1],[f-j,l-j,2*j,2*j]}}}]},T.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),T.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),eg.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return eg.ConnectGuide.data.rotation}},rect:{func:function(){var D=eg.ConnectGuide.data.connect;D.x,D.y;var Z=lk.getStyle("connectGuideIntersectSize");return[[D.x,D.y],2*Z,2*Z]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var m=eg.ConnectGuide.data.cursorPos||eg.ConnectGuide.data.connect,L=lk.getStyle("connectGuideIntersectSize");return[[m.x,m.y],2*L-2,2*L-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var t=eg.ConnectGuide.data.connect,A=eg.ConnectGuide.data.cursorPos||t;return[t.x,t.y,t.x+.5*(A.x-t.x),t.y,A.x+.5*(t.x-A.x),A.y,A.x,A.y]}}}]},T.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),T.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),eg.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var U=eg.ConnectGuideGarbage.data.hover;return U?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var $=eg.ConnectGuideGarbage.data,k=lk.getStyle("connectGuideGarbageIntersectsize");return $.hover&&(k+=5),[[$.x,$.y],2*k,2*k]}}}]};var wl=6;eg.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return eg.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var m=eg.ShapeActivingCtrl.data;return[m.point.x,m.point.y,m.c1.x,m.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Ff},{type:"shape",visible:{func:function(){return eg.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var x=eg.ShapeActivingCtrl.data;return[x.point.x,x.point.y,x.c2.x,x.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Ff},{type:"shape",visible:{func:function(){return eg.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var j=eg.ShapeActivingCtrl.data.c1,e=j.x,D=j.y,V=wl/2;return"c1"===eg.ShapeActivingCtrl.data.hl&&(V+=.5),[e-V,D-V,e-V,D+V,e+V,D+V,e+V,D-V]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return lk.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===eg.ShapeActivingCtrl.data.hl?lk.getStyle("shapeCtrlPointHighlightBorder")||Ff:lk.getStyle("shapeCtrlPointBorderColor")||Ff}}},{type:"shape",visible:{func:function(){return eg.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var L=eg.ShapeActivingCtrl.data.c2,e=L.x,$=L.y,_=wl/2;return"c2"===eg.ShapeActivingCtrl.data.hl&&(_+=.5),[e-_,$-_,e-_,$+_,e+_,$+_,e+_,$-_]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return lk.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===eg.ShapeActivingCtrl.data.hl?lk.getStyle("shapeCtrlPointHighlightBorder")||Ff:lk.getStyle("shapeCtrlPointBorderColor")||Ff}}}]},eg.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:Ff,rect:{func:function(){return[[eg.RoundPoint.data.x,eg.RoundPoint.data.y],In,In]}}}]},eg.AttachPoint={comps:[{type:"rect",background:{func:function(){return eg.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:Ff,rect:{func:function(){var l=eg.AttachPoint.data.isAttach?In+4:In;return[[eg.AttachPoint.data.x,eg.AttachPoint.data.y],l,l]}}}]},cg.Icons.DrawIcon=function(B,V,h,G){h.width=h.height=Ep,h.data=G,lk=B,T.Default.drawImage(V,h,0,0,Ep,Ep)},cg.Icons.MapPoints=function(h,V){for(var D=0,r=h.length;r>D;D++)h[D]/=V},cg.roundTo=function(j,y,Y){var x=Math.abs(j%y);return Y>x||Y>y-x?y*Math.round(j/y):j},cg.toFixed=function(Z){return Math.round(100*Z)/100},cg.getDataMatrix=function(N){if(N instanceof T.Shape){var p=new T.Math.Matrix2d,f=N.getPosition();return p.translate(-f.x,-f.y).scale(N.getScale().x,N.getScale().y).rotate(N.getRotation()).translate(f.x,f.y),p}return N.getMatrix?N.getMatrix():new T.Math.Matrix2d};var Lm=cg.Math.Curve=function(){this._curves=[]};Lm.prototype={},Lm.prototype.constructor=Lm,Lm.prototype.createFromHtShape=function(K,m,H){m instanceof T.List&&(m=m.toArray());var i,v,L,E,Q,J,l,M=this,B=null,t=null,b=0,P=cg.Math.Vector2,o=cg.Math.CubicBezier,q=function(o){return new P(K[o],K[o+1],H?H[o/2]:d)};for(v=0,L=m.length;L>v;v++){switch(E=m[v],Q=null,E){case 1:t=q(b),B=t,b+=2;break;case 2:i=q(b),b+=2,Q=new o(t,t.clone(),i.clone(),i),t=i;break;case 3:J=q(b),i=q(b+2),b+=4,Q=new o(t,J.clone().sub(t).multiplyScalar(2/3).add(t),J.clone().sub(i).multiplyScalar(2/3).add(i),i),t=i;break;case 4:J=q(b),l=q(b+2),i=q(b+4),b+=6,Q=new o(t,J,l,i),t=i;break;case 5:if(!B)break;Q=new o(t,t.clone(),B.clone(),B),t=null,B=null}Q&&(Q._index=M._curves.length,M._curves.push(Q))}},Lm.prototype.checkPoint=function(c,N){var S,F,g,r,I,U=this,j=U._curves;for(S=0,F=j.length;F>S;S++)if(r=j[S],I=r.intersectRect(c,N,N),I.length)return g=0,I.forEach(function(u){g+=u.t}),g/=I.length,c=r.getPointAt(g),c.t=g,{bezier:r,intersection:c}},Lm.prototype.insertKnot=function(k,n){var X=k.insertKnot(n),B=this,T=B._curves;T.splice(k._index,1,X[0],X[1])},Lm.prototype._isCloseEnough=function(x,A){return Math.abs(x.x-A.x)<1e-6&&Math.abs(x.y-A.y)<1e-6},Lm.prototype._isSamePoint=function(E,I){return E===I},Lm.prototype.moveRealPoint=function(Q,v){var s=this,j=s._curves,r=v.clone().sub(Q);j.forEach(function(L){var m=L._p1;L._p2,L._p3;var j=L._p4;s._isSamePoint(m,Q)&&(L._p2.add(r),L._p1=v),s._isSamePoint(j,Q)&&(L._p3.add(r),L._p4=v)})},Lm.prototype.moveCtrlDueToRealPointMovement=function(S,J){var c=this,p=c._curves,j=function(p){p.add(J),p.e&&J.e&&(p.e+=J.e)};p.forEach(function(s){var M=s._p1;s._p2,s._p3;var K=s._p4;c._isSamePoint(M,S)&&j(s._p2),c._isSamePoint(K,S)&&j(s._p3)})},Lm.prototype.moveCtrlPoint=function(Y,T,F){var b=Y[F];if(b){b.e!==d&&(T.e=b.e);var g=this,O=g._curves;T.clone().sub(b),O.forEach(function(G){var L;"c2"===F?L="_p2":"c1"===F&&(L="_p3"),g._isSamePoint(G[L],b)&&(G[L]=T)}),Y[F]=T}},Lm.prototype.deleteRealPoint=function(U,z){var i,d,h,y,Q,E,f,X=this,r=X._curves,u={},Z=[],M=cg.Math.CubicBezier;for(d=0,h=r.length;h>d;d++)i=r[d],y=i._p1,Q=i._p2,E=i._p3,f=i._p4,(u[d]||!X._isSamePoint(y,U))&&(X._isSamePoint(f,U)?h>d+1&&X._isSamePoint(r[d+1]._p1,U)&&(z||Z.push(new M(y,Q,r[d+1]._p3,r[d+1]._p4))):Z.push(i));X._curves=Z},Lm.prototype.findPairs=function(Z,Y){var J,W,k,U,N,p,M,v,t=this,P=t._curves,x={},T=[];for(W=0,k=P.length;k>W;W++)J=P[W],U=J._p1,N=J._p2,p=J._p3,M=J._p4,!x[W]&&t._isSamePoint(U,Z)&&(Y?T.push({point:U,r2:M}):T.push({point:U,c2:N})),t._isSamePoint(M,Z)&&(v=Y?{point:M,r1:U}:{point:M,c1:p},k>W+1&&t._isSamePoint(P[W+1]._p1,Z)&&(Y?v.r2=P[W+1]._p4:v.c2=P[W+1]._p2,x[W+1]=!0),T.push(v));return T},Lm.prototype.toHtShape=function(){var r=this,K=r._curves,F=[],_=[],a={x:1/0,y:1/0};return K.forEach(function(Q){var o=Q._p1,j=Q._p2,$=Q._p3,w=Q._p4;return r._isCloseEnough(o,a)||(F.push(1),_.push(o.clone())),a=w,r._isCloseEnough(o,j)&&r._isCloseEnough($,w)?(F.push(2),_.push(w.clone()),void 0):(F.push(4),_.push(j.clone(),$.clone(),w.clone()),void 0)}),{segments:F,points:_}};var xf=cg.Math.CubicBezier=function(Z,W,C,l){var z=this;z._id=cg.Math.CubicBezier._globalId++,z._p1=Z,z._p2=W,z._p3=C,z._p4=l};xf._globalId=1,xf.prototype={},xf.prototype.constructor=xf,xf.prototype.toString=function(){return this._id},xf.prototype.intersectRect=function(C,m,R){var M=m/2,F=R/2,q=C.x,c=C.y,u=cg.Math.Vector2,G=new u(-M+q,-F+c),z=new u(M+q,F+c),Y=new u(z.x,G.y),Q=new u(G.x,z.y),D=this,o=D.intersectLine(G,Y),s=D.intersectLine(Y,z),V=D.intersectLine(z,Q),v=D.intersectLine(Q,G),K=o.concat(s).concat(V).concat(v);return K},xf.prototype.intersectLine=function(g,E){var $,q,y,P,H,N,f,h,v,J,s,R,A,a=this,u=g.clone().min(E),_=g.clone().max(E);P=a._p1,H=a._p2,N=a._p3,f=a._p4,$=P.clone().multiplyScalar(-1),q=H.clone().multiplyScalar(3),y=N.clone().multiplyScalar(-3),s=$.add(q).add(y).add(f),$=P.clone().multiplyScalar(3),q=H.clone().multiplyScalar(-6),y=N.clone().multiplyScalar(3),J=$.add(q).add(y),$=P.clone().multiplyScalar(-3),q=H.clone().multiplyScalar(3),v=$.add(q),h=P.clone(),A=new cg.Math.Vector2(g.y-E.y,E.x-g.x),R=g.x*E.y-E.x*g.y;for(var K=a.getRoots(A.dot(s),A.dot(J),A.dot(v),A.dot(h)+R),S=new Array,e=0,X=K.length;X>e;e++){var i=K[e];if(!(0>i||i>1)){var z=P.clone().lerp(H,i),M=H.clone().lerp(N,i),Q=N.clone().lerp(f,i),W=z.lerp(M,i),t=M.lerp(Q,i),k=W.lerp(t,i);k.t=i,g.x==E.x?u.y<=k.y&&k.y<=_.y&&S.push(k):g.y==E.y?u.x<=k.x&&k.x<=_.x&&S.push(k):k.x>=u.x&&k.y>=u.y&&k.x<=_.x&&k.y<=_.y&&S.push(k)}}return S},xf.prototype.solveTForPoint=function(T){var t,K,L,D,i=this;t=i._p1.x-T.x,K=i._p2.x-T.x,L=i._p3.x-T.x,D=i._p4.x-T.x;for(var J=i.getRoots(D-3*L+3*K-t,3*L-6*K+3*t,3*K-3*t,t),V=d,Z=1/0,a=0,y=J.length;y>a;a++){var f=J[a];if(!(0>f||f>1)){var X=i._p1.clone().lerp(i._p2,f),x=i._p2.clone().lerp(i._p3,f),c=i._p3.clone().lerp(i._p4,f),E=X.lerp(x,f),G=x.lerp(c,f),M=E.lerp(G,f);M.t=f;var o=Math.abs(M.y-T.y);Z>o&&(Z=o,V=M)}}return V},xf.prototype.getPointAt=function(E){var k=this,l=k._p1,p=k._p2,S=k._p3,O=k._p4,T=l.clone().lerp(p,E),H=p.clone().lerp(S,E),B=S.clone().lerp(O,E),X=T.lerp(H,E),z=H.lerp(B,E);return X.lerp(z,E)},xf.prototype.getRoots=function(i,G,f,V){var g,e,A,L,X,$=new Array;if(Math.abs(i)<1e-6){var g=G,e=f/g,A=V/g,L=e*e-4*A;if(L>0){var X=Math.sqrt(L);$.push(.5*(-e+X)),$.push(.5*(-e-X))}else 0==L&&$.push(.5*-e)}G/=i,f/=i,V/=i,g=(3*f-G*G)/3,e=(2*G*G*G-9*f*G+27*V)/27;var B=G/3,D=e*e/4+g*g*g/27,r=e/2;if(Math.abs(D)<=1e-6&&(D=0),D>0){var v,z,X=Math.sqrt(D);v=-r+X,z=v>=0?Math.pow(v,1/3):-Math.pow(-v,1/3),v=-r-X,v>=0?z+=Math.pow(v,1/3):z-=Math.pow(-v,1/3),$.push(z-B)}else if(0>D){var T=Math.sqrt(-g/3),y=Math.atan2(Math.sqrt(-D),-r)/3,N=Math.cos(y),s=Math.sin(y),Q=Math.sqrt(3);$.push(2*T*N-B),$.push(-T*(N+Q*s)-B),$.push(-T*(N-Q*s)-B)}else{var v;v=r>=0?-Math.pow(r,1/3):Math.pow(-r,1/3),$.push(2*v-B),$.push(-v-B)}return $},xf.prototype._70I=function(){var M=this;return M._p1.distanceToSquared(M._p2)<1e-10&&M._p3.distanceToSquared(M._p4)<1e-10},xf.prototype.insertKnot=function(s){var K=this,y=K._p1,B=K._p2,t=K._p3,w=K._p4,Q=y.clone().lerp(B,s),a=B.clone().lerp(t,s),q=t.clone().lerp(w,s),S=Q.clone().lerp(a,s),J=a.clone().lerp(q,s),C=S.clone().lerp(J,s);return K._70I()?(y.clone().lerp(w,s),[new cg.Math.CubicBezier(y,y.clone(),C.clone(),C),new cg.Math.CubicBezier(C,C.clone(),w.clone(),w)]):[new cg.Math.CubicBezier(y,Q,S,C),new cg.Math.CubicBezier(C,J,q,w)]};var Oi=T.Default.getInternal().ui().EdgeUI,kc={_47O:function(p){var $=this,r=kc.getBackups()._47O;cg.inEdit($.gv)||r.call($,p)}};cg.Inject.registAsModule(kc,Oi);var nj=T.Default.getInternal().ui().NodeUI,bg={_47O:function(Z){var y=this,L=bg.getBackups()._47O;cg.inEdit(y.gv)||L.call(y,Z)},getSelectWidth:function(){var h=this,q=h.gv,z=h._data;if(q.isEditable(z)&&cg.inEdit(q))return 0;var Z=bg.getBackup("getSelectWidth");return Z.call(h)}};cg.Inject.registAsModule(bg,nj);var _g=T.graph.GraphView,_l={_editPointSize:function(){var i=T.Default.isTouchable,g=cg.getStyle("pointSize");return g[i?0:1]}(),isPointEditable:function(d){var i=this;if(cg.inEdit(i))return i._pointEditableFunc?i._pointEditableFunc(d):!0;var U=_l.getBackup("isPointEditable");U.call(i,d)},isEditable:function(l){var i,G=this,W=_l.getBackup("isEditable");if(i=l instanceof cg.Group?!0:W.call(G,l),!cg.inEdit(G))return i;if(!(l instanceof T.Edge))return i;if(!l.s("2d.editable"))return!1;var D=G.getEditableFunc();return D?D(l):!0},_42:function(K,i){var z=this,h=_l.getBackups()._42;if(h.call(z,K,i),cg.inEdit(z)){var k=z.getEditInteractor();k.drawImpl()}}};cg.Inject.registAsModule(_l,_g);var jo=T.Default.getInternal().ui().ShapeUI,fb={_47O:function(l){var T=this,K=fb.getBackups()._47O;cg.inEdit(T.gv)||K.call(T,l)}};cg.Inject.registAsModule(fb,jo);var Jq=T.graph.DefaultInteractor,xk={handle_mousewheel:function(D){var T=this,r=xk.getBackup("handle_mousewheel");cg.inEdit(T.gv)||r.call(T,D)}};cg.Inject.registAsModule(xk,Jq);var ai=T.graph.MoveInteractor,ik={_calcShift:function(b,v){var K=this,z=ik.getBackup("_calcShift"),f=K.gv;if(!cg.inEdit(f))return z.call(K,b,v);var j=f.getEditInteractor(),J=j.getSubModule("Move").calcShift(b,v,K);return J||z.call(K,b,v)},clear:function(y){var d=this,D=ik.getBackup("clear");D.call(d,y);var V=d.gv;if(cg.inEdit(V)){var b=V.getEditInteractor();b.getSubModule("Move").clear(y)}}};cg.Inject.registAsModule(ik,ai);var Wi=cg.Rect=function(w){this.catalog="Rect",this._interactor=w};Wi.prototype={},Wi.prototype.constructor=Wi,Wi.prototype.gatherInfo=function(P,K){var Y=this;if(1===K.length){var V=K[0];return V instanceof T.Shape&&V._70I()?Y.gatherLine(P,V):nk(V,P)?!1:Y.gatherSingleTarget(P,V)}return K.length>1?Y.gatherMultiTargets(P,K):!1},Wi.prototype.gatherSingleTarget=function(I,W){if(W.getCorners){var J,E=this,z=E.info;E.target=W,J=E.screenInfo={};var R=W.getCorners();z.LT=new cg.Math.Vector2(R[0]),z.LB=new cg.Math.Vector2(R[1]),z.RB=new cg.Math.Vector2(R[2]),z.RT=new cg.Math.Vector2(R[3]),z.T=z.LT.clone().add(z.RT).divideScalar(2),z.B=z.LB.clone().add(z.RB).divideScalar(2),z.L=z.LT.clone().add(z.LB).divideScalar(2),z.R=z.RT.clone().add(z.RB).divideScalar(2);for(var S in z)J[S]=cg.toScreenPosition(I,z[S]);var p=E._interactor,V=p.getStyle("checkSize"),P=function(i,k,z){var Z=k.clone().sub(i).setLength(-V),U=z.clone().sub(i).setLength(-V),x=Z.add(U).add(i);return x};return J.rotLT=P(J.LT,J.RT,J.LB),J.rotLB=P(J.LB,J.LT,J.RB),J.rotRB=P(J.RB,J.LB,J.RT),J.rotRT=P(J.RT,J.LT,J.RB),J.rotT=J.rotLT.clone().add(J.rotRT).divideScalar(2),J.rotB=J.rotLB.clone().add(J.rotRB).divideScalar(2),J.rotL=J.rotLT.clone().add(J.rotLB).divideScalar(2),J.rotR=J.rotRT.clone().add(J.rotRB).divideScalar(2),J.rotation=W.getRotation(),E.gatherConnectInfo(),!0}},Wi.prototype.gatherConnectInfo=function(){var d=this,K=d.target,Q=d._interactor,y=d.screenInfo,I=Q.gv;if(I.isConnectActionVisible(K)&&Q.getStyle("connectGuideVisible")){var t;K.s&&(t=K.s("connectGuideShift")),t||(t=Q.getStyle("connectGuideShift"));var n=K.getAnchor(),U=K.getSize(),B=K.toGlobal({x:U.width*(t[0]-n.x),y:U.height*(t[1]-n.y)});B=cg.toScreenPosition(I,B),y.P1?B.add(y.P2.clone().sub(y.P1).setLength(t[2])):(B.add(y.RT.clone().sub(y.LT).setLength(t[2])),B.add(y.LB.clone().sub(y.LT).setLength(t[3]))),y.connect=B}},Wi.prototype.gatherMultiTargets=function(R,B){var G=cg.Group.findOrCreateGroup(B);if(!G)return!1;var l=this;return l.editing&&"rotate"!==l.editing.mode||G.calcInfo(),l.gatherSingleTarget(R,G)},Wi.prototype.gatherLine=function(g,F){this.target=F;var d=this.screenInfo={},p=F.getPoints(),s=cg.getDataMatrix(F);return d.P1=cg.toScreenPosition(g,s.apply(p.get(0))),d.P2=cg.toScreenPosition(g,s.apply(p.get(1))),this.gatherConnectInfo(),!0},Wi.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Wi.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Wi.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Wi.prototype.check=function(L,J,w){if(T.Default.isLeftButton(J)){var l=this;if(l.editing=null,l.tipInfo=null,l.screenInfo){var F=l.target,h=L.isEditable(F),r=l.screenInfo;if(h&&r.connect){var G=l._checkConnect(w);if(G)return G}if(r.P1)return l._checkLine(w);var H,y,Y,m=null,E=l._interactor,_=E.getStyle("checkSize");if(h&&L.isRectEditable(F))for(y=0;y<cg.Rect.ResizeKeys.length;y++)if(Y=cg.Rect.ResizeKeys[y],cg.checkHit(w,r[Y],_)){m=Y,H="resize";break}if(!m&&h&&L.isRotationEditable(F)&&!E.getStyle("rotateAsClock")){var M=E.getStyle("rotateCheckSize");for(y=0;y<cg.Rect.RotateKeys.length;y++)if(Y=cg.Rect.RotateKeys[y],cg.checkHit(w,r[Y],M)){m=Y,H="rotate";break}}if(!m)return E.setCursor("default"),void 0;if("rotate"===H){var p,d=L.lp(J);if(F instanceof cg.Group){var W=E.getStyle("groupRotateModeKey");"string"==typeof W&&(W=[W]);for(var P=!1,O=0,U=W.length;U>O;O++)if(J[W[O]]){P=!0;break}var q=E.getStyle("groupRotateModeDefault");p=P?"batch"===q?"block":"batch":q}var R="batch"===p?F.getAnchor2():F.getPosition(),I=Math.atan2(d.y-R.y,d.x-R.x);E._setRotateCursor(I),l.editing={mode:H,key:m,pos:R,flipY:F.getScale().y<0,rotation:F.getRotation(),hitRot:I},p&&(l.editing.groupRotateMode=p)}else{var u=cg.Rect.ResizeKeys.indexOf(m),k=cg.Rect.ResizeDirection[u],c=Math.cos(F.getRotation()),X=Math.sin(F.getRotation()),s=k.x*Math.sign(F.getScale().x),j=k.y*Math.sign(F.getScale().y),g=Math.atan2(-X*s-c*j,c*s-X*j),i=(Math.round(g/(Math.PI/4))+8)%8,n=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][i];
this._interactor.setCursor(n);var K=F.getWidth(),v=F.getHeight(),$=F.getAnchor();l.editing={mode:H,key:m,rect:{x:-K*$.x,y:-v*$.y,width:K,height:v},anchor:$,matrix:F.getMatrix()}}return m}}},Wi.prototype._checkLine=function(r){var n=this;n.screenInfo;var P,o=n._interactor.getStyle("checkSize");if(cg.checkHit(r,n.screenInfo.P1,o))P="P1";else{if(!cg.checkHit(r,n.screenInfo.P2,o))return this._interactor.setCursor("default"),void 0;P="P2"}return n.editing={mode:"line",key:P},P},Wi.prototype._checkConnect=function(T){var I=this,r=I.screenInfo,Z=I._interactor,a=Z.getStyle("connectGuideIntersectSize"),l=r.connect,O=T.x,d=l.x;if(d>O&&a>d-O&&Math.abs(l.y-T.y)<a||O>=d&&cg.checkHit(T,l,a)){var m="connect",Y=N.getConnectAction(Z.gv);if(I.editing={mode:m},Y&&Y.delete)if(I.target instanceof cg.Group){var x=!0;Z.gv.sm().getSelection().each(function(g){Y.delete.visible.call(null,Z.gv,g)||(x=!1)}),I.editing.hasDeleteAction=x}else Y.delete.visible.call(null,Z.gv,I.target)&&(I.editing.hasDeleteAction=!0);return Z.setCursor("default"),m}},Wi.prototype._fireEditEvent=function(m,L){var p=this._interactor,q=this.editing;if(q){var a=q.mode;a="rotate"===a?"Rotation":"connect"===a?"Connection":a[0].toUpperCase()+a.slice(1),p.fi({kind:m+"Edit"+a,event:L})}},Wi.prototype.startEdit=function(u,L){u.startDragging(L);var O=this;O._interactor.fi({kind:"prepareEdit",event:L});var F=O.editing,H=O.target;if(F){if(O._fireEditEvent("begin",L),"rotate"===F.mode)return F.groupRotateMode&&H.beginRotate(F),void 0;if("connect"!==F.mode)("line"===F.mode||H&&0===H.getRotation())&&(O._inSmartGuide=!0,O._interactor.rectGuide.gatherRects());else if(F.hasDeleteAction){var o=u.gv,P=O._interactor.getStyle("connectGuideGarbageShift");F.garbageInfo={x:o.getWidth()*P[0]+P[2],y:o.getHeight()*P[1]+P[3],size:O._interactor.getStyle("connectGuideGarbageIntersectsize")},u._42()}}},Wi.prototype._46O=function(D){var s,w,y=this,J=y.editing,l=y.target;if(J){if("connect"===J.mode&&!J.canceled&&!J.deleted)try{J.garbageInfo&&J.garbageInfo.hover?N.doDeleteConnectionAction(y._interactor.gv,l):N.doConnectAction(y._interactor.gv,l,J.target)}catch(b){console.error(b)}w=J.freezeFlag,s=y.editing.groupRotateMode,y._fireEditEvent("end",D),y.editing=null}y.tipInfo=null,y._inSmartGuide&&(y._interactor.rectGuide.clear(),y._inSmartGuide=!1),s&&l&&l.endRotate(),l instanceof T.Block&&(w===d?delete l._freezeSyncFromChildren:l._freezeSyncFromChildren=w,l.updateFromChildren())},Wi.prototype.handleNormalStateDelete=function(){var d=this,a=d.editing;if(a&&"connect"===a.mode&&!a.canceled&&!a.deleted){if(a.garbageInfo){try{N.doDeleteConnectionAction(d._interactor.gv,d.target)}catch(p){console.error(p)}a.garbageInfo=null}return a.cursorPos=null,a.targetCorners=null,a.deleted=!0,d._interactor._42(),!0}},Wi.prototype.handleNormalStateKeyDown=function(j){var o=this,q=o.editing;return!q||"connect"!==q.mode||q.canceled||q.deleted?void 0:T.Default.isEsc(j)?(q.cursorPos=null,q.targetCorners=null,q.canceled=!0,o._interactor._42(),!0):void 0},Wi.prototype.handleEdit=function(F,R){var n=this,J=n.editing;if(J){var c,Q,V,P,S,B=n.target,i=J.key,w=J.mode,X=F.lp(R),q=n._interactor;if("connect"===w){if(J.canceled)return;if(J.deleted)return;J.cursorPos=q._getLogicalPoint(R);var u=J.garbageInfo;return u&&cg.checkHit(J.cursorPos,u,u.size)?(u.hover=!0,J.target=null,J.targetCorners=null):(u&&(u.hover=!1),J.target=F.getDataAt(X,function(N){return F.isSelectable(N)?Np(N)?!0:!1:!1})||null,J.targetCorners=cg.getTargetCornersOnScreen(F,J.target)),q._42(),void 0}if("rotate"===w){var k,r,M=J.pos,e=Math.atan2(X.y-M.y,X.x-M.x);if(J.groupRotateMode?r=e-J.hitRot:(k=e-J.hitRot,r=J.rotation+k),r%=2*Math.PI,0>r&&(r+=2*Math.PI),!T.Default.isCtrlDown(R)){var v,z;im(R)?(v=q.getStyle("shiftRotateRound"),z=v/2):(v=q.getStyle("rotateRound"),z=q.getStyle("rotateSensitivity")),r=cg.roundTo(r,v,z)}J.groupRotateMode?(k=r-(J.lastRotation||0),0!==k&&(B.addRotation(k,J.groupRotateMode),J.lastRotation=r)):B.setRotation(r),q._setRotateCursor(e),r>Math.PI&&(r-=2*Math.PI);var x=180*(r/Math.PI);x=x.toFixed(2),c=""+x+"°"}else if("resize"===w){var j=J.rect;V=j.x,P=j.y;var o,a=j.width,m=j.height,s=J.anchor,A=J.matrix,E=B.s&&B.s("keepAspectRatio")||q.getStyle("keepAspectRatio");im(R)&&(E=!E);var b=n._unionPointMode1,h=n._unionPointMode2;if(n._inSmartGuide&&!T.Default.isCtrlDown(R)&&!E){var Z;"L"===i||"R"===i?Z="x":("T"===i||"B"===i)&&(Z="y"),n._adsorbedToClosest(X,Z),S=!0}o=A.tfi(X);var W;"LT"===i?(j=b(o,{x:V+a,y:P+m},a,m,E),W=9):"T"===i?(j=h({x:V,y:o.y},{x:V+a,y:P+m},a,m,E,"v"),W=1):"RT"===i?(j=b(o,{x:V,y:P+m},a,m,E),W=33):"L"===i?(j=h({x:o.x,y:P},{x:V+a,y:P+m},a,m,E,"h"),W=8):"R"===i?(j=h({x:V,y:P},{x:o.x,y:P+m},a,m,E,"h"),W=32):"LB"===i?(j=b(o,{x:V+a,y:P},a,m,E),W=12):"B"===i?(j=h({x:V,y:P},{x:V+a,y:o.y},a,m,E,"v"),W=4):"RB"===i&&(j=b(o,{x:V,y:P},a,m,E),W=36);var U=A.tf(j.x+j.width*s.x,j.y+j.height*s.y);B instanceof T.Block&&(J.hasOwnProperty("freezeFlag")||(J.freezeFlag=B._freezeSyncFromChildren,B._freezeSyncFromChildren=!0)),B.setPosition(U),B.setSize(j.width,j.height),S&&(Q=B.getRect(),q.rectGuide.gatherLines({node:B,x:Q.x,y:Q.y,w:Q.width,h:Q.height},Z,W)),c=""+Math.round(j.width)+" * "+Math.round(j.height)}else if("line"===w){if(im(R)){var D=B.getPoints(),Y="P1"===i?D.get(1):D.get(0),L={x:X.x-Y.x,y:X.y-Y.y},g=q.getStyle("shiftLineRotateRound"),N=n._shiftDirList;if(!N||n._shiftRotateRound!==g){n._shiftRotateRound=g,n._shiftDirList=N=[];for(var d=0;d<Math.PI;d+=g)N.push({x:f(d),y:G(d)})}for(var C,I=0,H=0,K=N.length;K>H;H++){var t=N[H],O=t.x*L.x+t.y*L.y;Math.abs(O)>Math.abs(I)&&(I=O,C=t)}X={x:Y.x+C.x*I,y:Y.y+C.y*I},q.rectGuide.clear()}else n._inSmartGuide&&!T.Default.isCtrlDown(R)&&(n._adsorbedToClosest(X),S=!0);var l=cg.getDataMatrix(B).applyInverse(X);B.setPoint("P1"===i?0:1,l,!0);var y=B.getPoints(),p=y.get(0),$=y.get(1);V=p.x-$.x,P=p.y-$.y,c=" "+Math.round(Math.sqrt(V*V+P*P))+" ",S&&(Q=B.getRect(),q.rectGuide.gatherLines({node:B,x:Q.x,y:Q.y,w:Q.width,h:Q.height}))}if(c){var _=T.Default.getLogicalPoint(R,q._canvas);_.x+=cg.Icons.TipShiftX,_.y+=cg.Icons.TipShiftY,n.tipInfo={helperPos:_,text:c,size:c.length}}n._fireEditEvent("between",R)}},Wi.prototype._unionPointMode1=function(r,E,x,R,N){if(N&&x&&R){var s=r.x-E.x,G=r.y-E.y;Math.abs(s*R)<Math.abs(G*x)?(G=Math.sign(G)*Math.abs(s*R/x),r.y=E.y+G):(s=Math.sign(s)*Math.abs(G*x/R),r.x=E.x+s)}return T.Default.unionPoint(r,E)},Wi.prototype._unionPointMode2=function(u,n,c,G,V,h){var w=T.Default.unionPoint(u,n);if(V&&c&&G){var k;"v"===h?(k=w.x+w.width/2,w.width=c*w.height/G,w.x=k-w.width/2):(k=w.y+w.height/2,w.height=G*w.width/c,w.y=k-w.height/2)}return w},Wi.prototype._adsorbedToClosest=function(x,W){var Z=this,z=Z._interactor,p=z.rectGuide.findClosest(x,W),M=z.gridGuide.findClosest(x,W),d=1/0,m=1/0;p&&(isFinite(p.x)&&(d=p.x),isFinite(p.y)&&(m=p.y)),M&&(isFinite(M.x)&&Math.abs(M.x)<Math.abs(d)&&(d=M.x),isFinite(M.y)&&Math.abs(M.y)<Math.abs(m)&&(m=M.y)),isFinite(d)&&(x.x+=d),isFinite(m)&&(x.y+=m)},Wi.prototype._42=function(d,w,n){var Q=this;Q.info={},Q.screenInfo=null;var M=Q._interactor;if(!M.editDetail&&Q.gatherInfo(w,n)){var j=Q.editing,D=j?j.groupRotateMode:null,N=Q.screenInfo;"block"!==D&&(N.P1?cg.Icons.DrawIcon(M,d,cg.Icons.Line,N):cg.Icons.DrawIcon(M,d,cg.Icons.Rect,N),N.connect&&(cg.Icons.DrawIcon(M,d,cg.Icons.ConnectGuide,{rotation:N.rotation,connect:N.connect,cursorPos:j?j.cursorPos:null}),j&&(j.targetCorners&&cg.Icons.DrawIcon(M,d,cg.Icons.NodeHoverGuide,j.targetCorners),j.garbageInfo&&cg.Icons.DrawIcon(M,d,cg.Icons.ConnectGuideGarbage,j.garbageInfo))),Q.tipInfo&&cg.Icons.DrawIcon(M,d,cg.Icons.TipHelper,Q.tipInfo)),Q.target instanceof cg.Group&&Q.target._42(M,d,w)}};var vd=cg.Anchor=function(r){this.catalog="Anchor",this._interactor=r};vd.prototype={},vd.prototype.constructor=vd,vd.prototype.gatherInfo=function(q,P){var n=this;if(1===P.length){var w=P[0];if(!w.getAnchor)return;if(w instanceof T.Shape&&w._70I())return;if(nk(w,q))return;return n.gatherSingleTarget(q,P[0])}return P.length>1?n.gatherMultiTargets(q,P):!1},vd.prototype.gatherSingleTarget=function(k,_){var e=this;return e.info.POS=_.getPosition(),e.screenInfo.POS=cg.toScreenPosition(k,e.info.POS),e.target=_,!0},vd.prototype.gatherMultiTargets=function(e,g){var v=this,c=cg.Group.findOrCreateGroup(g);return c?(v.screenInfo.POS=cg.toScreenPosition(e,c.getAnchor2()),v.target=c,!0):!1},vd.prototype.isVisible=function(){var t=this,v=t._interactor;if(v.getStyle("anchorVisible")===!1)return!1;var e=t.target;if(e){if(this.editing)return!0;var S=e.getAnchor(),D=v.getStyle("anchorOutsideVisibleThreshold");if(S.x<-D||S.x>1+D||S.y<-D||S.y>1+D)return!0;var V=e.getSize(),n=e.getScale(),K=Math.min(Math.abs(V.width*n.x),Math.abs(V.height*n.y));if(K*v.gv._zoom<v.getStyle("anchorHideThreshold"))return!1}return!0},vd.prototype.check=function(Y,q,d){if(T.Default.isLeftButton(q)){var C=this,K=C._interactor;if(C.isVisible()&&K.getStyle("anchorMovable")!==!1){C.editing=null,C.tipInfo=null;var x=C.target;if(x&&Y.isAnchorEditable(x)&&Y.isEditable(x)){var t;if(C.screenInfo&&(t=C.screenInfo.POS)&&cg.checkHit(d,new cg.Math.Vector2(t),K.getStyle("checkSize"))){if(x instanceof cg.Group)return C.editing={},!0;var B=x.getWidth(),w=x.getHeight(),s=x.getAnchor();return C.editing={rect:{x:-B*s.x,y:-w*s.y,width:B,height:w},anchor:s,matrix:x.getMatrix()},!0}}}}},vd.prototype.startEdit=function($,D){$.startDragging(D),$.fi({kind:"beginEditAnchor",event:D})},vd.prototype._46O=function(G){var e=this;e.editing&&(e.editing=null,e._interactor.fi({kind:"endEditAnchor",event:G})),e.tipInfo=null},vd.prototype.handleEdit=function(S,D){var v=this,e=v.target;if(e){var j=v.editing;if(j){var E=S.lp(D),u=v._interactor;if(e instanceof cg.Group)return e.setAnchor2(E),u._42(),void 0;var H=j.matrix,h=H.tfi(E),A=j.rect,N=(h.x-A.x)/A.width,R=(h.y-A.y)/A.height;if(!T.Default.isCtrlDown(D)){var c=u.getStyle("anchorRound"),I=u.getStyle("anchorSensitivity");N=cg.roundTo(N,c,I),R=cg.roundTo(R,c,I)}e.setAnchor(N,R,!0);var n=T.Default.getLogicalPoint(D,u._canvas);n.x+=cg.Icons.TipShiftX,n.y+=cg.Icons.TipShiftY;var _=""+N.toFixed(2)+", "+R.toFixed(2);v.tipInfo={helperPos:n,text:_,size:_.length},u.fi({kind:"betweenEditAnchor",event:D})}}},vd.prototype._42=function(E,d,q){var i=this;i.info={},i.screenInfo={};var z=i._interactor;z.editDetail||i.gatherInfo(d,q)&&i.isVisible()&&(cg.Icons.DrawIcon(z,E,cg.Icons.Anchor,i.screenInfo),i.tipInfo&&cg.Icons.DrawIcon(z,E,cg.Icons.TipHelper,i.tipInfo))};var yo=cg.RotateX=function(W){this.catalog="RotateX",this._interactor=W};yo.prototype={},yo.prototype.constructor=yo,yo.prototype.gatherInfo=function(K,F){var a=this;if(1===F.length){var h=F[0];return h instanceof T.Shape&&h._70I()||nk(h,K)?!1:a.gatherSingleTarget(K,h)}return F.length>1?a.gatherMultiTargets(K,F):!1},yo.prototype.gatherSingleTarget=function(){var Q=new T.Math.Vector2,A=new T.Math.Vector2,e=new T.Math.Vector2,i=new T.Math.Vector2,H=function(O,N){var Y=O.x-N.x,A=O.y-N.y;return Y*Y+A*A};return function(P,V){if(V.getCorners){var n=this,x=V.getCorners(),a=15,v=V.getPosition();Q.copy(x[0]),e.copy(x[1]),i.copy(x[3]),A.copy(Q).add(i).divideScalar(2).add(Q.sub(e).setLength(a/P.getZoom()));var r=Math.max(H(v,x[0]),H(v,x[1]),H(v,x[2]),H(v,x[3]));return n.info.POS=A.clone(),n.screenInfo.POS=cg.toScreenPosition(P,n.info.POS),n.screenInfo.LEN=Math.sqrt(r)*P.getZoom()+a,n.screenInfo.CENTER=cg.toScreenPosition(P,v),n.target=V,!0}}}(),yo.prototype.gatherMultiTargets=function(d,h){var q=this,N=cg.Group.findOrCreateGroup(h);if(!N)return!1;var q=this;return q.gatherSingleTarget(d,N)},yo.prototype.isVisible=function(){var i=this._interactor;if(!i.getStyle("rotateAsClock"))return!1;var A=this.target;if(!A)return!0;var j=i.gv;return j.isEditable(A)&&j.isRotationEditable(A)?!0:!1},yo.prototype.check=function(Y,i,E){var c=this,s=c._checkImpl(Y,i,E);return(s||c._clockPainted)&&c._interactor._42(),s},yo.prototype._checkImpl=function(r,d,K){if(T.Default.isLeftButton(d)){var E=this;E.editing=null,E.tipInfo=null;var y;if(E.screenInfo&&(y=E.screenInfo.POS)&&E.isVisible()){var O=E._interactor;if(cg.checkHit(K,y,O.getStyle("checkSize"))){var Z=E.target,x=r.lp(d),C=Z.getPosition(),W=Math.atan2(x.y-C.y,x.x-C.x);return O._setRotateCursor(W),E.editing={pos:C,rotation:Z.getRotation(),hitRot:W,groupRotateMode:"block",screenInfo:{CENTER:E.screenInfo.CENTER,LEN:E.screenInfo.LEN}},!0}}}},yo.prototype.startEdit=function(W,s){W.startDragging(s),W.fi({kind:"beginEditRotation",event:s}),this.target instanceof cg.Group&&this.target.beginRotate(this.editing)},yo.prototype._46O=function(G){var b=this;b.editing&&(b.editing=null,b._interactor.fi({kind:"endEditRotation",event:G})),b.target instanceof cg.Group&&b.target.endRotate(),b.tipInfo=null},yo.prototype.handleEdit=function(c,G){var D=this,E=D.editing;if(E){var X,o,v=D.target,y=c.lp(G),S=D._interactor,h=E.pos,x=Math.atan2(y.y-h.y,y.x-h.x),w=v instanceof cg.Group;if(w?o=x-E.hitRot:(X=x-E.hitRot,o=E.rotation+X),o%=2*Math.PI,0>o&&(o+=2*Math.PI),!T.Default.isCtrlDown(G)){var L,f;im(G)?(L=S.getStyle("shiftRotateRound"),f=L/2):(L=S.getStyle("rotateRound"),f=S.getStyle("rotateSensitivity")),o=cg.roundTo(o,L,f)}w?(X=o-(E.lastRotation||0),0!==X&&(v.addRotation(X,E.groupRotateMode),E.lastRotation=o)):v.setRotation(o),S._setRotateCursor(x),o>Math.PI&&(o-=2*Math.PI);var P=180*(o/Math.PI),V=""+P.toFixed(2)+"°",H=T.Default.getLogicalPoint(G,S._canvas);H.x+=cg.Icons.TipShiftX,H.y+=cg.Icons.TipShiftY,D.tipInfo={helperPos:H,text:V,size:V.length},S.fi({kind:"betweenEditRotation",event:G})}},yo.prototype._42=function(m,w,U){var P=this;P._clockPainted=!1,P.info={},P.screenInfo={};var c=P._interactor;c.editDetail||P.gatherInfo(w,U)&&P.isVisible()&&(cg.Icons.DrawIcon(c,m,cg.Icons.RoundPoint,P.screenInfo.POS),P.tipInfo&&cg.Icons.DrawIcon(c,m,cg.Icons.TipHelper,P.tipInfo),P.editing&&P.drawClock(m))},yo.prototype.drawClock=function(C){C.save();var s=this;s._clockPainted=!0;var O=s.editing||{},i=O.screenInfo||s.screenInfo,S=i.LEN,X=S+8,U=S+18;C.save(),C.translate(i.CENTER.x,i.CENTER.y),C.beginPath(),C.strokeStyle="rgb(150, 150, 150)";for(var z,n,u,R,g,p=0;360>p;p++)z=p*Math.PI/180,0===p%5&&(n=G(z)*S,u=f(z)*S,R=G(z)*X,g=f(z)*X,C.moveTo(n,u),C.lineTo(R,g)),0===p%45&&(n=G(z)*S,u=f(z)*S,R=G(z)*U,g=f(z)*U,C.moveTo(n,u),C.lineTo(R,g));C.stroke(),C.rotate(-E);var D=O.lastRotation||s.target.getRotation();C.beginPath(),C.fillStyle="rgba(255, 0, 0, 0.1)",C.strokeStyle="rgb(157, 157, 157)",C.moveTo(0,0),C.arc(0,0,U,0,D,!1),C.fill(),C.beginPath(),C.moveTo(0+U,0),C.arc(0,0,U,0,D,!1),C.stroke(),C.restore()};var Lm=cg.Curve=function(D){this.catalog="Curve",this._interactor=D};Lm.prototype={},Lm.prototype.constructor=Lm,M.defineProperties(Lm.prototype,{activing:{get:function(){return this._activing},set:function(j){var u=this;if(j)u._activing=new cg.CurveActiving(this,j);else{var V=u._activing;V&&V.dispose(),u._activing=null}}}}),Lm.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Lm.prototype.setUp=function(){var d=this,o=d._interactor;o&&o.gv.mp(d._onGraphviewPropertyChanged,d)},Lm.prototype._onGraphviewPropertyChanged=function(f){("zoom"===f.property||"translateX"===f.property||"translateY"===f.property)&&this._handleDataChanged()},Lm.prototype.tearDown=function(){var v=this,L=v._interactor;L&&L.gv.ump(v._onGraphviewPropertyChanged,v)},Lm.prototype.canEnterEditDetailMode=function(){var $=this,Z=$._interactor,n=Z._getValidSelection();if(1===n.length){var k=n[0],i=k instanceof T.Edge;if(k instanceof T.Shape||i){if(i){var B=k.s("edge.type");if(B&&"points"!==B)return}var Q=Z.gv;if(Q.isPointEditable(k)&&Q.isEditable(k))return $.target=k,!0}}},Lm.prototype.canQuitEditDetailMode=function(q){var Y=this,y=Y._interactor._getLogicalPoint(q);return Y._checkEditRealPoint(y)?void 0:Y._interactor.gv.getDataAt(q)!==Y.target?!0:void 0},Lm.prototype.preHandleScroll=function(){var x=this.editing;return x&&x.inEdit?!0:void 0},Lm.prototype.getCurrentSelectintStatus=function(){var k=this;if(k.activing&&!k.activing.selections){if(k.activing.status!=d)return k.activing.status;var D=function(x){var n=k.activing.status;k.activing.status=x,k._interactor.fp("shapePointStatus",n,x)},e=cg.Curve.PointType,m=k.activing.point,O=k.activing.pairs;if(!O||1!==O.length)return D(e.Mirrored);var t=O[0],w=t.c1&&t.c1.isNearEnough(m),U=t.c2&&t.c2.isNearEnough(m);if(!t.c1||!t.c2)return w||U?D(e.Straight):D(e.Disconnected);if(w&&U)return D(e.Straight);if(w||U)return D(e.Asymmetric);var E=t.c1.clone().sub(m),S=t.c2.clone().sub(m);return Math.abs(E.x*S.y-E.y*S.x)>1e-5||E.x*S.x>0?D(e.Disconnected):Math.abs(E.length()-S.length())>1e-5?D(e.Asymmetric):D(e.Mirrored)}},Lm.prototype.handle_keydown=function(D){var f=this;if(f._interactor.editDetail){var K=cg.Curve.PointType;"1"===D.key?f._setCurrentSelectionStatus(K.Straight):"2"===D.key?f._setCurrentSelectionStatus(K.Mirrored):"3"===D.key?f._setCurrentSelectionStatus(K.Disconnected):"4"===D.key&&f._setCurrentSelectionStatus(K.Asymmetric)}},Lm.prototype.setCurrentSelectionStatus=function(z){var w=this,R=w._interactor;if(R){var U=R.gv;U.dm().beginTransaction(),this._setCurrentSelectionStatus(z),U.dm().endTransaction()}},Lm.prototype._setCurrentSelectionStatus=function(j){var b=this,r=b.activing;if(r){var J=b.getCurrentSelectintStatus();if(null!==J&&J!==j){r.status=j;var K=b.activing.point,C=b.activing.pairs;if(C&&1===C.length){var v=C[0],S=b.screenInfo.curve,e=cg.Curve.PointType,L=function(){b._writeToHt(),b._interactor.fp("shapePointStatus",J,j)};if(j===e.Straight)return S.moveCtrlPoint(v,K,"c1"),S.moveCtrlPoint(v,K,"c2"),L(),void 0;if(J===e.Straight){var H=S.findPairs(K,!0),u=H[0],P=u.r1||K,o=u.r2||K,W=o.clone().sub(P).multiplyScalar(.25);return S.moveCtrlPoint(v,K.clone().sub(W),"c1"),S.moveCtrlPoint(v,K.clone().add(W),"c2"),L(),void 0}var R=v.c1,O=v.c2;if(R&&O){if(j===e.Mirrored)return S.moveCtrlPoint(v,K.clone().multiplyScalar(2).sub(O),"c1"),L(),void 0;if(j===e.Asymmetric&&J===e.Disconnected){var T=R.clone().sub(K).length(),W=K.clone().sub(O).setLength(T).add(K);return S.moveCtrlPoint(v,W,"c1"),L(),void 0}}r._firePointChange(),b._interactor.fp("shapePointStatus",J,j)}}}},Lm.prototype._handleDataChanged=function(){var U="points,segments,shape,position,rotation,scale".split(",");return function(w){var g=this;if(g.screenInfo&&g.target){if(w&&U.indexOf(w.property)<0)return;var k=g._interactor;g.gatherSingleTarget(k.gv,g.target,!0),g.check(k.gv,null,new cg.Math.Vector2(k._lastClientPoint)),k._42()}}}(),Lm.prototype.gatherSingleTarget=function(_,m,M){var Z,j,B=this;B.screenInfo&&B.screenInfo.curve&&(j=B.screenInfo.curve._curves);var q=B.editing;Z=q?B.screenInfo:B.screenInfo={};var A,H,x=m instanceof T.Edge;x?(A=m.s("edge.segments"),H=m.s("edge.points")||new T.List):(A=m._58O,H=m._59O),Z.S=A;var i,O=Z.P=[],p=cg.getDataMatrix(m);if(m instanceof T.Polyline&&(i=m.getElevation()||0,Z.E=[]),H.each(function(w){Z.E&&Z.E.push(w.e||i),w=p.apply(w);var r=cg.toScreenPosition(_,w);O.push(r.x,r.y)}),x){var Q=cg.toScreenPosition(_,m._lastSourcePoint),r=cg.toScreenPosition(_,m._lastTargetPoint);O.splice(0,0,Q.x,Q.y),O.push(r.x,r.y)}if(!Z.S||!Z.S.size()){Z.S=new T.List,Z.S.add(1);for(var e=0;e<O.length/2-1;e++)Z.S.add(2)}if((!q||M)&&B.convertToCubicBezier(j),B.activing&&(M||!B.editing||"realPoint"===B.editing.type)){var g=Z.curve.findPairs(B.activing.point);B.activing.pairs=g}x&&"points"!==m.s("edge.type")&&B._writeToHt()},Lm.prototype._convertToNewPoint=function(Y,T,C){var X,q,x;for(X=0,q=T.length;q>X;X++){if(x=T[X],x._p1.isNearEnough(Y))return x._p1;if(x._p4.isNearEnough(Y))return x._p4}if(C)for(X=0,q=Math.min(C.length,q);q>X;X++){if(x=C[X],x._p1===Y)return T[X]._p1;if(x._p4===Y)return T[X]._p4}},Lm.prototype.convertToCubicBezier=function(O){var o,L,B=this,a=new cg.Math.Curve,k=B.screenInfo;if(a.createFromHtShape(k.P,k.S,k.E),k.curve=a,B.activing){var A=a._curves;if(o=B.activing.point,L=B._convertToNewPoint(o,A,O),L&&(B.activing.point=L),B.activing.selections){var j=-1,u=B.activing.selections;u.forEach(function(g){j++,L=B._convertToNewPoint(g,A,O),L&&(u[j]=L)})}}},Lm.prototype.check=function(G,R,N){if(!R||T.Default.isLeftButton(R)){var r=this;if(r._interactor.setCursor("default"),r.editing=null,r.highlight=null,r.tipInfo=null,r.screenInfo){if(gb())return r._interactor._42(),!0;if(r._checkEditCtrlPoint(N))return r._interactor._42(),!0;if(r._checkEditRealPoint(N))return r._interactor._42(),!0;if(r._checkEditElevation(N))return r._interactor._42(),!0;var K=r.screenInfo.curve,v=K.checkPoint(N,r._interactor.getStyle("curveIntersectSize"));if(v){var n=r.highlight={};n.type="insertKnot",n.bezier=v.bezier,n.point=v.intersection}return r._interactor._42(),!0}}},Lm.prototype._checkEditRealPoint=function(x){var m,E,M,T,z,W,k=this,L=k.screenInfo.curve._curves,v=k._interactor.getStyle("curvePointIntersectSize"),r=1/0;for(v*=v,M=0,T=L.length;T>M;M++)m=L[M],z=m._p1,W=x.distanceToSquared(z),r>W&&(r=W,E=z),z=m._p4,W=x.distanceToSquared(z),r>W&&(r=W,E=z);if(r>v)return!1;var y=k.highlight={};return y.type="changeRealPoint",y.point=E,k.editing={type:"realPoint",point:E,shiftGuide:{point:E.clone(),dir:"x",limit:0}},k._interactor.setCursor("crosshair"),!0},Lm.prototype._checkEditElevation=function(b){var d=this;if(!d._interactor.getStyle("curveElevationVisible"))return!1;var E=d.activing;if(!E)return!1;var R=E.getCurrentEditingPoint();if(!R)return!1;var w=d._interactor,_=w.getStyle("curveElevationGuideShift"),p=w.getStyle("curveElevationIntersectSize"),a=b.distanceToSquared({x:R.x+_[0],y:R.y+_[1]});if(!(a>p*p)){var s=d.highlight={};s.type="elevation";var K=new cg.Math.Vector2(b.x,b.y,R.e);return d.editing={type:"elevation",startPoint:K},d._interactor.setCursor("crosshair"),!0}},Lm.prototype._checkEditCtrlPoint=function(A){var n=this;if(n.activing&&!n.activing.selections){var u=n.getCurrentSelectintStatus();if(u!==cg.Curve.PointType.Straight){var m=n.activing.pairs;if(m){var T=n._interactor.getStyle("curvePointIntersectSize");T*=T;var D,i,C,W,q,X,R,P,H,v=1/0;for(R=0,H=m.length;H>R;R++)for(W=m[R],P=0;2>P;P++)q=0===P?"c1":"c2",W[q]&&(X=A.distanceToSquared(W[q]),v>X&&(v=X,D=W,i=R,C=q));if(v>T)return!1;n.activing.hlpair=D,n.activing.hltype=C;var b=n.highlight={};return b.type="changeCtrlPoint",b.point=D[C],n.editing={type:"ctrlPoint",pair:D,pairId:i,ctrlType:C,direction:D[C].clone().sub(n.activing.point).normalize()},n._interactor.setCursor("crosshair"),!0}}}},Lm.prototype.startEdit=function(x,$){x.startDragging($);var W=this;W.highlight&&"insertKnot"===W.highlight.type&&(W.insertKnot(),W.gatherSingleTarget(W._interactor.gv,W.target),W.activing=null,W._checkEditRealPoint(W._interactor._getLogicalPoint($)));var E=W._activing;if(E){var j=W.editing?W.editing.type:null;"ctrlPoint"===j?E.editingCtrl={pairId:W.editing.pairId,type:E.hltype}:"realPoint"===j&&(E.editingCtrl=!1)}var K=W.highlight,t=T.Default.isCtrlDown($);if(!K||gb()){var c=W._interactor.gv;if(!c.setFocus($)||c._scrolling)return;return c.isPannable()&&fq($)&&!t&&(W._pan={tx:c.tx(),ty:c.ty()},x.fi({kind:"beginPan",event:$})),void 0}if("changeRealPoint"===K.type){var l,f=W.activing?W.activing.point:null,b=W.activing?W.activing.selections:null;if(t&&W.activing)f===K.point?(b?(W.activing={point:b[0]},b.length>1&&(b.splice(0,1),W.activing.selections=b)):W.activing=null,W.editing=null):b&&(l=b.indexOf(K.point))>=0?(b.length>1?b.splice(l,1):delete W.activing.selections,W.editing=null):b?(b.push(f),W.activing={point:K.point,selections:b}):W.activing={point:K.point,selections:[f]};else if(b)f===K.point||((l=b.indexOf(K.point))>=0?(b.splice(l,1,f),W.activing={point:K.point,selections:b}):W.activing={point:K.point});else{var R;f===K.point&&(R=W.activing.status),W.activing={point:K.point},R&&(W.activing.status=R)}x.fi({kind:"beginEditPoint",event:$})}},Lm.prototype.insertKnot=function(){var Z=this,z=Z.highlight,g=Z.screenInfo.curve;g.insertKnot(z.bezier,z.point.t),Z._writeToHt()},Lm.prototype._writeToHt=function(){var n,O,L,z,B=this,o=B.screenInfo.curve,j=o.toHtShape(),Q=j.points,A=[],u=j.segments,f=B._interactor.gv,V=B.target,E=V instanceof T.Edge,a=cg.getDataMatrix(V).invert();z=V instanceof T.Polyline,z&&(L=V.getElevation());for(var F=0,r=Q.length;r>F;F++)n=Q[F],O=cg.toWorldPosition(f,n),O=a.apply(O),n.e!=d&&n.e!==L&&(O.e=n.e),A.push(O);if(V._writing=!0,E){V.s("edge.type","points"),V.setStyle("edge.segments",u),V.setStyle("edge.points",A.slice(1,A.length-1)),V.setStyle("edge.source.offset.x",0),V.setStyle("edge.source.offset.y",0),V.setStyle("edge.target.offset.x",0),V.setStyle("edge.target.offset.y",0);var y=B._nextChangeEdgeHost;delete B._nextChangeEdgeHost,y&&("source"===y.type?V.setSource(y.host):V.setTarget(y.host)),B._writeEdgeHostAnchor("source",A[0]),B._writeEdgeHostAnchor("target",A[A.length-1])}else A.length?(V.setSegments(u),V.setPoints(A,!0)):V.removeFromDataModel();delete V._writing},Lm.prototype._writeEdgeHostAnchor=function(P,n){var v=this,j=v.target,B=v._calcHostAnchor(j,P,n);j.s("edge."+P+".anchor.x",B.x),j.s("edge."+P+".anchor.y",B.y),B.offsetX||B.offsetY?(j.s("edge."+P+".offset.x",B.offsetX),j.s("edge."+P+".offset.y",B.offsetY)):(j.s("edge."+P+".offset.x",0),j.s("edge."+P+".offset.y",0))},Lm.prototype._calcHostAnchor=function(Q,S,b,O){O||(O="source"===S?Q.getSource():Q.getTarget());var p=this._interactor.gv,g=p.calculateAttachPoint(O,b);if(g)return g.info;var A=O.getRotation(),X=O.getAnchor();if(nk(O,p)&&(A=0),A){var D=O.getMatrix(),z=D.tfi(b),P=O.getSize();return{x:z.x/P.width+X.x,y:z.y/P.height+X.y}}var y=eo(p,O),r={x:(b.x-y.x)/y.width,y:(b.y-y.y)/y.height};return r},Lm.prototype._handlePanning=function(I){var X=this,i=X._pan;if(i){i.started=!0;var V=X._interactor,q=V.gv,A=V._lastClientPoint,S=Ne(I);q.setTranslate(i.tx+S.x-A.x,i.ty+S.y-A.y),X.gatherSingleTarget(V.gv,X.target),V._42(),V.fi({kind:"betweenPan",event:I})}},Lm.prototype.handleEdit=function(p,E){var S=this,A=S.editing;if(S._pan)return S._handlePanning(E),void 0;if(A){A.inEdit=!0;var x,m,e,q=S._interactor._getLogicalPoint(E),D=T.Default.isCtrlDown(E),X=T.Default.isShiftDown(E),z=A.type,v=S.activing;if(S._guideInfo=null,"ctrlPoint"===z&&X){var s=S.editing.direction.clone();x=v.point;var n=s.dot(q.clone().sub(x));q=s.setLength(n).add(x)}else if("ctrlPoint"===z||"realPoint"===z){var s;if("realPoint"===z&&X){var G=S.editing.shiftGuide;m=G.point;var h=Math.abs(q.x-m.x),V=Math.abs(q.y-m.y);h>V&&h>G.limit&&"y"===G.dir&&(G.dir="x"),V>h&&V>G.limit&&"x"===G.dir&&(G.dir="y"),s=G.dir,"x"===s?(q.y=m.y,G.limit=Math.max(G.limit,h)):"y"===s&&(q.x=m.x,G.limit=Math.max(G.limit,V))}var t=S._isEditEdgeSourceTarget();if(t){var j=S._editEdgeSourceTarget(t,q,D);j&&(e=j.tipText)}else if(!D){var O=S._guidingToEdit(q,s),F="realPoint"===z?S._interactor.gridGuide.findClosest(q,s,!0):null,y=1/0,k=1/0;F&&(F.x&&(y=F.x),F.y&&(k=F.y));var o=!1;O&&(O.xList&&(Math.abs(O.x)<=Math.abs(y)?(o=!0,y=O.x):delete O.xList),O.yList&&(Math.abs(O.y)<=Math.abs(k)?(o=!0,k=O.y):delete O.yList),o&&(S._guideInfo=O)),isFinite(y)&&(q.x+=y),isFinite(k)&&(q.y+=k),o&&(O.v=q)}}var $=S.screenInfo.curve;if("realPoint"===A.type){x=A.point,x.e!==d&&(q.e=x.e),$.moveRealPoint(x,q),A.point=q,S.highlight.point=q;var H=v.status,_=v.selections;if(S.activing={point:q,status:H},_){var N=q.clone().sub(x),C=0;_.forEach(function(h){var V=h.clone().add(N);$.moveRealPoint(h,V),_[C++]=V}),S.activing.selections=_}}else if("ctrlPoint"===A.type){var W=v.pairs,L=W[A.pairId];$.moveCtrlPoint(L,q,A.ctrlType);var i=v.status,r=cg.Curve.PointType;if((i===r.Mirrored||i===r.Asymmetric)&&L.c1&&L.c2){var x=new cg.Math.Vector2(v.point),l="c1"===A.ctrlType?"c2":"c1";if(i===cg.Curve.PointType.Mirrored)$.moveCtrlPoint(L,x.clone().multiplyScalar(2).sub(q),l);else if(i===r.Asymmetric){var n=L[l].clone().sub(x).length(),B=x.clone().sub(L[A.ctrlType]).setLength(n).add(x);isNaN(B.x)||$.moveCtrlPoint(L,B,l)}}v._firePointChange()}else if("elevation"===A.type){m=A.startPoint;var w=m.e+(m.y-q.y)/p._zoom;S._setCurrentPointImpl("e",w),v._firePointChange(),e="E: "+cg.toFixed(w)}var I=T.Default.getLogicalPoint(E,S._interactor._canvas);if(I.x+=cg.Icons.TipShiftX,I.y+=cg.Icons.TipShiftY,!e){var M=cg.toWorldPosition(p,q);e=""+cg.toFixed(M.x)+", "+cg.toFixed(M.y)}S.tipInfo={helperPos:I,text:e,size:e.length},S._writeToHt(),S._interactor.fi({kind:"betweenEditPoint",event:E})}},Lm.prototype._setCurrentPointImpl=function(W,Z){var C=this,E=C._activing;if(!E)return!1;var D=C.target;if(!D)return!1;var f=E.getCurrentEditingPoint();if(!f)return!1;var y=E.editingCtrl;if(!y)var Q=f.clone();if("e"===W)f.e=Z;else{var n;if("x"===W||"y"===W){var _=E._lastFirePoint;n="x"===W?{x:Z,y:_?_.y:0}:{x:_?_.x:0,y:Z}}else"object"==typeof W?(n=W,W.e!==d&&(f.e=W.e)):(n={x:arguments[0],y:arguments[1]},arguments[2]!==d&&(f.e=arguments[2]));var t=cg.getDataMatrix(D);n=cg.toScreenPosition(C._interactor.gv,t.apply(n)),f.x=n.x,f.y=n.y}if(!y){var S=Q.multiplyScalar(-1).add(f);f.e&&Q.e&&(S.e=f.e-Q.e),C.screenInfo.curve.moveCtrlDueToRealPointMovement(f,S)}return!0},Lm.prototype.setCurrentPoint=function(Q,I){return this._setCurrentPointImpl(Q,I)?(this._writeToHt(),!0):!1},Lm.prototype._isEditEdgeSourceTarget=function(){var d=this,g=d.target;if(!(g instanceof T.Edge))return!1;var u=d.editing.point,G=d.screenInfo.curve._curves;return u===G[0]._p1?"source":u===G[G.length-1]._p4?"target":!1},Lm.prototype._editEdgeSourceTarget=function(Q,S,O){var D,y=this,x=y.target;if(D="source"===Q?x.getSource():x.getTarget()){var E=y._interactor.gv,A=cg.toWorldPosition(E,S),u=y._calcHostAnchor(x,Q,A,D);if(y._interactor.getStyle("edgeHostDetectPerFrame")||u.x<0||u.x>1||u.y<0||u.y>1){var P=E.getDataAt(A,function(W){return E.isSelectable(W)?Np(W)?!0:!1:!1});if(P){var j=y._calcHostAnchor(x,Q,A,P);D=P,y._nextChangeEdgeHost={type:Q,host:P},u=j}}var B;if(!O){var L=y._interactor.getStyle("anchorRound"),J=y._interactor.getStyle("anchorSensitivity");B=E.calculateAttachPoint(D,A),B?u=B.info:(u.x=cg.roundTo(u.x,L,J),u.y=cg.roundTo(u.y,L,J))}if(!O){var T=D.getAttachPosition(u.x,u.y,u.offsetX,u.offsetY),t=cg.toScreenPosition(E,T);S.x=t.x,S.y=t.y}y._edgeHostGuideInfo={corners:cg.getTargetCornersOnScreen(E,D),attach:B?B.index:-1,host:D};var I=""+u.x.toFixed(2)+", "+u.y.toFixed(2);return(u.offsetX||u.offsetY)&&(I+=" offset: "+u.offsetX.toFixed(2)+", "+u.offsetY.toFixed(2)),{host:D,anchor:u,tipText:I}}},Lm.prototype._guidingToEdit=function(N,I){var V,Z,$=this;if(V=$.screenInfo.curve){Z=V._curves;var Y,L,J,F,W,C,T,m,s=1/0,O=1/0,Q=[];for($.editing&&"realPoint"===$.editing.type&&(m=$.editing.point),W=0,C=2*Z.length;C>W;W++)T=Z[Math.floor(W/2)][W%2?"_p4":"_p1"],Q.indexOf(T)>=0||(Q.push(T),m&&m===T||(J=T.x-N.x,F=T.y-N.y,Math.abs(J)<Math.abs(s)?(s=J,Y=[T]):J===s&&Y.push(T),Math.abs(F)<Math.abs(O)?(O=F,L=[T]):F===O&&L.push(T)));var k=$._interactor.getStyle("smartGuideSensitivity");if((Math.abs(s)>k||"y"===I)&&(Y=null),(Math.abs(O)>k||"x"===I)&&(L=null),Y||L){var e=!1,l={};if(Y&&(e=!0,l.xList=Y,l.x=s),L&&(e=!0,l.yList=L,l.y=O),e)return l}}},Lm.prototype._46O=function(I){var k=this;k.editing&&(k.editing=null,k._interactor.fi({kind:"endEditPoint",event:I})),k._guideInfo=null,k._edgeHostGuideInfo=null,k._pan&&(k._pan=null,k._interactor.fi({kind:"endPan",event:I})),k.tipInfo=null},Lm.prototype._canDeletePoint=function(M,C){var $=this.target;if(!($ instanceof T.Edge))return!0;var b=M._curves[0],j=M._curves[M._curves.length-1];return b._p1===C||j._p4===C?!1:!0},Lm.prototype.handleDelete=function(){var a=this;if(a.activing&&a.screenInfo){var Z=T.Default.isShiftDown(),X=a.screenInfo.curve;a._canDeletePoint(X,a.activing.point)&&X.deleteRealPoint(a.activing.point,Z),a.activing.selections&&a.activing.selections.forEach(function(M){a._canDeletePoint(X,M)&&X.deleteRealPoint(M,Z)}),a.activing=null,delete a.editing,delete a.tipInfo,delete a._pan,a._writeToHt(),a._interactor.fp("deleteShapePoint",!1,!0)}},Lm.prototype.handleDoubleClick=function(k){var s=this,O=s._interactor._getLogicalPoint(k);if(s.screenInfo&&s._checkEditRealPoint(O)){var I=s.getCurrentSelectintStatus(),u=cg.Curve.PointType;return I=I===u.Mirrored?u.Straight:u.Mirrored,s._setCurrentSelectionStatus(I),s._interactor._42(),!0}},Lm.prototype._drawHighlight=function(b){var k=this,R=k.highlight;if(R){var s=R.bezier,n=k._interactor;s&&cg.Icons.DrawIcon(n,b,cg.Icons.ShapeHighlightCurve,[s._p1.x,s._p1.y,s._p2.x,s._p2.y,s._p3.x,s._p3.y,s._p4.x,s._p4.y]);
var X=R.point;X&&"insertKnot"===R.type&&cg.Icons.DrawIcon(n,b,cg.Icons.ShapeHighlighPoint,X)}},Lm.prototype._drawGuide=function(v){var A=this,z=A._guideInfo;if(z){var j,c,J,i,P=z.v;for(j=0;2>j;j++)if(i=0===j?z.xList:z.yList)for(c=0,J=i.length;J>c;c++)cg.Icons.DrawIcon(A._interactor,v,cg.Icons.ShapeGuideLine,[P.x,P.y,i[c].x,i[c].y])}},Lm.prototype._drawCurrentPoint=function(P){var v=this;if(v.activing){var o=v.activing,y=v.getCurrentSelectintStatus(),r=v._interactor;if(y!==cg.Curve.PointType.Straight){var x=o.pairs;o.hlpair,o.hltype;var N=o.selections,B=o.editingCtrl;if(x&&!N){var $,l,J;for(l=0,J=x.length;J>l;l++)$=x[l],B&&l===B.pairId&&$[B.type]?cg.Icons.DrawIcon(r,P,cg.Icons.ShapeActivingCtrl,{point:$.point,c1:$.c1,c2:$.c2,hl:B.type}):cg.Icons.DrawIcon(r,P,cg.Icons.ShapeActivingCtrl,$)}}cg.Icons.DrawIcon(r,P,cg.Icons.ShapeHighlighRealPoint,v.activing.point),N&&N.forEach(function(k){cg.Icons.DrawIcon(r,P,cg.Icons.ShapeHighlighRealPoint,k)})}},Lm.prototype.clear=function(){var e=this;e.editing=null,e._guideInfo=null,e.activing=null,e.highlight=null},Lm.prototype._42=function(w){var k=this;k.info={},k.editing||(k.screenInfo=null);var m=k._interactor;if(!m.editDetail)return k.clear(),void 0;var G=m.gv;if(!k.target||!G.isSelected(k.target)||!G.isVisible(k.target))return m.editDetail=!1,k.clear(),void 0;if(k.gatherSingleTarget(G,k.target),cg.Icons.DrawIcon(m,w,cg.Icons.ShapeBgCurve,k.screenInfo),k._drawHighlight(w),k._drawCurrentPoint(w),k._getRealPoint().forEach(function(A){cg.Icons.DrawIcon(m,w,cg.Icons.ShapePoint,A)}),k._drawGuide(w),k.tipInfo&&cg.Icons.DrawIcon(m,w,cg.Icons.TipHelper,k.tipInfo),k._edgeHostGuideInfo){cg.Icons.DrawIcon(m,w,cg.Icons.NodeHoverGuide,k._edgeHostGuideInfo.corners);var Z=k._edgeHostGuideInfo.host;if(Z){var a=G.getAttachPoints(Z);if(a&&a.length)for(var f=0,y=a.length;y>f;f++){var H=a[f],X=Z.getAttachPosition(H.x,H.y,H.offsetX,H.offsetY);X=cg.toScreenPosition(G,X),X.isAttach=k._edgeHostGuideInfo.attach===f,cg.Icons.DrawIcon(m,w,cg.Icons.AttachPoint,X)}}}if(k._interactor.getStyle("curveElevationVisible")&&k.target instanceof T.Polyline&&k.activing){var N=k.activing.getCurrentEditingPoint();N&&cg.Icons.DrawIcon(m,w,cg.Icons.EdgeElevationGuide,N)}},Lm.prototype._getRealPoint=function(){var $,Y=this.screenInfo,y=Y.P,V=Y.S,U=-1,d=[],W=-1,z=V.length;return V.each(function(l){W++;var u=1;if(3===l)u=2;else if(4===l)u=3;else if(5===l)return;U+=u,$=W+1>=z?!0:1===V.get(W+1)?!0:!1,d.push({point:{x:y[2*U],y:y[2*U+1]},segmentIndex:W,pointIndex:U,isEnd:$})}),d},Lm.prototype.getEditingPointsInfo=function(W){var P=this,s=P.activing;if(!s)return!1;var v=s.point;if(!v)return!1;var e=this._getRealPoint(),M=[{screen:v}];s.selections&&s.selections.forEach(function(m){M.push({screen:m})});var B,x,Z=e.length;return M.forEach(function(H){for(B=0;Z>B;B++)if(x=e[B],H.screen.isNearEnough(x.point)){H.segmentIndex=x.segmentIndex,H.pointIndex=x.pointIndex,H.point=P.target.getPoints().get(x.pointIndex);break}}),W&&M.sort(function(n,f){return n.segmentIndex-f.segmentIndex}),M};var To=cg.MoveHelper=function(y){var s=this;s.catalog="Move",s._interactor=y};To.prototype={},To.prototype.constructor=To,To.prototype.calcShift=function(G,P,j){var R,d,w=this,I=w._interactor.gv,Y=I.lp(P);if("beginMove"===G&&w._gatherGridInfo(j._lastLogicalPoint||Y),R=w._target){var F=R.downPosition;if(F){var B=w._interactor.getStyle("moveSensitivity")/I._zoom;if(F.distanceTo(Y)<B)return{x:0,y:0};delete R.downPosition}var c;d=T.Default.isShiftDown(P),d&&(Y=w._dealShiftDown(Y),c=R.shiftGuide.dir);var X,H=R.rawPos={x:R.pos.x+Y.x-R.lp.x,y:R.pos.y+Y.y-R.lp.y};if(T.Default.isCtrlDown(P)){if(X=w._calcShiftByAddon(),w._target.node instanceof cg.Group){var b=w._target.node;b._position.x+=X.x,b._position.y+=X.y}return X}for(var m,A=R.x+H.x,q=R.y+H.y,E={x:A,y:q},S={x:A+R.w/2,y:q+R.h/2},z={x:A+R.w,y:q+R.h},f=w._interactor.rectGuide,M=w._interactor.gridGuide,u=[f.findClosest(E,c),f.findClosest(S,c),f.findClosest(z,c),M.findClosest(E,c),M.findClosest(S,c),M.findClosest(z,c)],O=1/0,K=1/0,n=0,r=u.length;r>n;n++)m=u[n],m&&(A=m.x,q=m.y,isFinite(A)&&Math.abs(A)<Math.abs(O)&&(O=A),isFinite(q)&&Math.abs(q)<Math.abs(K)&&(K=q));if(isFinite(O)||(O=0),isFinite(K)||(K=0),X=w._calcShiftByAddon(O,K),w._target.node instanceof cg.Group){var b=w._target.node;b._position.x+=X.x,b._position.y+=X.y}var Q=R.node;if(!nk(Q,I)){var l=H.x+O,x=H.y+K;w._interactor.rectGuide.gatherLines({node:Q,x:R.x+l,y:R.y+x,w:R.w,h:R.h},c)}return X}},To.prototype._calcShiftByAddon=function(K,m){var Q=this._target,S=Q.rawPos,A=Q.node.getPosition();return K=K||0,m=m||0,{x:S.x-A.x+K,y:S.y-A.y+m}},To.prototype._dealShiftDown=function(P){var y=this,Z=y._target.shiftGuide,$=y._target.lp,R=Math.abs(P.x-$.x),a=Math.abs(P.y-$.y);R>a&&R>Z.limit&&"y"===Z.dir&&(Z.dir="x"),a>R&&a>Z.limit&&"x"===Z.dir&&(Z.dir="y");var L=Z.dir;return"x"===L?(P.y=$.y,Z.limit=Math.max(Z.limit,R)):"y"===L&&(P.x=$.x,Z.limit=Math.max(Z.limit,a)),P},To.prototype._gatherGridInfo=function(u){var G,P=this,r=P._interactor,S=r._getValidSelection();if(S.length){if(1===S.length){if(G=S[0],!G.getRect)return P._target=null,void 0}else if(G=cg.Group.findOrCreateGroup(S),!G)return P._target=null,void 0}else{var S=r.gv.sm().getSelection();if(S.length&&(G=S.get(0),!G.getRect))return P._target=null,void 0}var B=G.getPosition(),a=G.getRect();P._target={node:G,x:a.x-B.x,y:a.y-B.y,w:a.width,h:a.height,lp:{x:u.x,y:u.y},pos:{x:B.x,y:B.y},shiftGuide:{dir:"x",limit:0},downPosition:new cg.Math.Vector2(u)},r.rectGuide.gatherRects()},To.prototype.clear=function(){var E=this;E._interactor.rectGuide.clear(),E._interactor._42()};var mr="directional",oh="point",Gi="spot",Kk="light.color",Uh=function(K,D){Hc(D)&&dl.test(D)?Pe(K,D):Bh(D)&&D.modelType?hn(K,D):re[K]=D},mh=function(U){if(Bh(U))return U.modelType?U.uuid?re[U.uuid]:(U.uuid=T.Math.generateUUID(),hn(U.uuid,U),d):U;var O=re[U];return U&&O===d&&dl.test(U)&&(Xb&&Xb[U]||Pe(U,U)),O};Zc(N,{graph3dViewAttributes:y,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:p/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Bf,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:p/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:Uh,getShape3dModel:mh,createMatrix:function(I,p){$l(I)||(I=[I]);for(var X=I.length-1;X>=0;X--){var Q=I[X];p=Xf(Q.mat,Q.s3,Q.r3,Q.rotationMode,Q.t3,p)}return p},transformVec:function(v,I){return Vb(v,I)},createBoxModel:function(){return{vs:Jd,ns:uo,uv:dq,is:Md}},createRoundRectModel:function(z,D){return bh.roundRect(z,D)},createStarModel:function(B,K){return bh.star(B,K)},createRectModel:function(h,d){return bh.rect(h,d)},createTriangleModel:function(A,V){return bh.triangle(A,V)},createRightTriangleModel:function(Y,S){return bh.rightTriangle(Y,S)},createParallelogramModel:function(Z,D){return bh.parallelogram(Z,D)},createTrapezoidModel:function(T,W){return bh.trapezoid(T,W)},createSmoothSphereModel:function(L,c,t,b,d,q,Q){return we(new zp(L,c,t,b,d,q,Q))},createSphereModel:function(M,q,P,e,J,d){return M?rl(M,q,P,e,J,d):N.createSmoothSphereModel()},createSmoothConeModel:function(o,i,b,B,L){return vj(o,i,b,B,L)},createConeModel:function(l,B,D,o,$,P){return l?tq(l,B,D,o,$,P):vj(P)},createSmoothCylinderModel:function(J,c,j,L,X,$,Q,H){return we(new zq(J,c,j,L,X,$,Q,H))},createCylinderModel:function(S,s,f,d,$,v,z){return S?Ni(S,s,f,d,$,v,z):cl(v,z)},createSmoothTorusModel:function(P,l,Q,k,C,A){return we(new nb(P,l,Q,k,C,A))},createTorusModel:function(o,j,i,I,N,c,F){return o?id(o,j,i,I,N,c,F):Ci(c,F)},createExtrusionModel:function(J,k,V,t,E,D,Q,o){return Vi(J,k,V,t,E,D,Q,o)},createSmoothRingModel:function(P,u,J,A,S,s){for(var V=[],c=0;c<P.length-1;c+=2)V.push({x:P[c],y:P[c+1]});for(P=Or(V,u,J)[0],V=[],c=0;c<P.length;c++){var D=P[c];V.push(new sc(D.x,0,D.y))}return we(new Zk(V,s,A,S))},createTextGeometry:function(Z,c){return we(new dm(Z,c))},loadFontFace:function(x,z){N.xhrLoad(x,function(h){if(!h)return z();var m;try{m=JSON.parse(h)}catch(L){m=JSON.parse(h.substring(65,h.length-2))}cq.loadFace(m),z&&z(m.familyName.toLowerCase())},z?null:{sync:!0})},createRingModel:function(c,s,g,O,Y,E,i,n,$,d){for(var p=[],t=0;t<c.length-1;t+=2)p.push({x:c[t],y:c[t+1]});E=E||N.shapeSide,i=i||0,n=n||E;var D,Z,H,C,M,b,W,I,J,v,t,k,V,K,r,F,B,q,u=[],e=[],X=$?[]:y,z=$?[]:y,h=d?[]:y,Q=d?[]:y,S=O?[]:y,j=O?[]:y,R=Y?[]:y,o=Y?[]:y,c=Or(p,s,g),U=Lg(c),m=0,l=2*Math.PI/E;return c.forEach(function(P){if(H=P.length,H>1){if(C=P[0],O)for(b=C.x,I=C.y,t=i;n>t;t++)k=t+1,V=t*l,K=k*l,r=G(V),F=f(V),B=G(K),q=f(K),S.push(r*b,I,-F*b,B*b,I,-q*b,0,I,0),j.push(.5-.5*r,.5-.5*F,.5-.5*B,.5-.5*q,.5,.5);for(v=0;H>v;v++){for(M=P[v],b=C.x,W=M.x,I=C.y,J=M.y,D=m/U,m+=kk(C,M),Z=m/U,t=i;n>t;t++)k=t+1,V=t*l,K=k*l,r=G(V),F=f(V),B=G(K),q=f(K),u.push(r*W,J,-F*W,B*W,J,-q*W,r*b,I,-F*b,B*W,J,-q*W,B*b,I,-q*b,r*b,I,-F*b),e.push(t/E,Z,k/E,Z,t/E,D,k/E,Z,k/E,D,t/E,D),$&&t===i&&(X.push(0,I,0,0,J,0,r*W,J,-F*W,r*W,J,-F*W,r*b,I,-F*b,0,I,0),z.push(0,.5-I,0,.5-J,2*W,.5-J,2*W,.5-J,2*b,.5-I,0,.5-I)),d&&k===n&&(h.push(0,I,0,B*W,J,-q*W,0,J,0,B*W,J,-q*W,0,I,0,B*b,I,-q*b),Q.push(1,.5-I,1-2*W,.5-J,1,.5-J,1-2*W,.5-J,1,.5-I,1-2*b,.5-I));C=M}if(Y)for(b=C.x,I=C.y,t=i;n>t;t++)k=t+1,V=t*l,K=k*l,r=G(V),F=f(V),B=G(K),q=f(K),R.push(B*b,I,-q*b,r*b,I,-F*b,0,I,0),o.push(.5-.5*B,.5+.5*q,.5-.5*r,.5+.5*F,.5,.5)}}),{vs:u,uv:e,bottom_vs:R,bottom_uv:o,top_vs:S,top_uv:j,from_vs:X,from_uv:z,to_vs:h,to_uv:Q}}},!0),Zc(c,{"3d.move.mode":d,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":d,"edge.gradient.color":d,"edge.source.t3":d,"edge.target.t3":d,"light.type":oh,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":p/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Fb,"wf.short":!1,"wf.mat":d,"wf.geometry":!1,batch:d,"transparent.mask":!1,brightness:d,"select.brightness":.7,"repeat.uv.length":d,alphaTest:.4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":jd,"label.t3":d,"label.r3":d,"label.texture.scale":2,"label.rotationMode":ok,"label.light":!1,"label.blend":d,"label.reverse.flip":!1,"label.reverse.color":No,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":jd,"label2.t3":d,"label2.r3":d,"label2.texture.scale":2,"label2.rotationMode":ok,"label2.light":!1,"label2.blend":d,"label2.reverse.flip":!1,"label2.reverse.color":No,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":jd,"note.t3":d,"note.r3":d,"note.texture.scale":2,"note.rotationMode":ok,"note.light":!1,"note.blend":d,"note.reverse.flip":!1,"note.reverse.color":No,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":jd,"note2.t3":d,"note2.r3":d,"note2.texture.scale":2,"note2.rotationMode":ok,"note2.light":!1,"note2.blend":d,"note2.reverse.flip":!1,"note2.reverse.color":No,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:d,"shape3d.color":yc,"shape3d.top.color":d,"shape3d.bottom.color":d,"shape3d.from.color":d,"shape3d.to.color":d,"shape3d.image":d,"shape3d.top.image":d,"shape3d.bottom.image":d,"shape3d.from.image":d,"shape3d.to.image":d,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":d,"shape3d.side.to":d,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":d,"shape3d.opacity":d,"shape3d.reverse.flip":!1,"shape3d.reverse.color":No,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":d,"shape3d.uv.scale":d,"shape3d.top.uv.offset":d,"shape3d.top.uv.scale":d,"shape3d.bottom.uv.offset":d,"shape3d.bottom.uv.scale":d,"shape3d.from.uv.offset":d,"shape3d.from.uv.scale":d,"shape3d.to.uv.offset":d,"shape3d.to.uv.scale":d,"shape3d.top.cap":d,"shape3d.bottom.cap":d,"shape3d.start.angle":0,"shape3d.sweep.angle":t,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":d,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":yc,"all.image":d,"all.blend":d,"all.opacity":d,"all.reverse.flip":!1,"all.reverse.color":No,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":d,"all.uv.offset":d,"all.uv.scale":d,"all.discard.selectable":!0,mat:d,"left.mat":d,"right.mat":d,"top.mat":d,"bottom.mat":d,"front.mat":d,"back.mat":d},!0);var vk,Jc=!1,hh=[0,0,0,0],Fc={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Cb,2:Fq,3:Zp,4:Yg,5:jd,6:Oo}},As=function(s,P,x,$){if(P.getFaceVisible(s,x)){Ug(P,Wr(s,P.getFaceMat(s,x)||P.getMat(s)));var X=P._26I;P.getFaceReverseCull(s,x)?X.enable(X.CULL_FACE):X.disable(X.CULL_FACE),pd(X,P._prg.uFixPickReverseColor,Fc[x]),Yq(X),Jl(X,$,6),nn(X),Si(P)}},Mk=function(U){return U instanceof zl},sk=function(K){return[K.x,K.e||0,K.y]},Xl=function(t,K,d){for(var K=vo(K),Z=K[0],w=K[1],i=K[2];d--;)t.push(Z,w,i)},fo=function(y,m,E){for(var m=vo(m),S=m[0],I=m[1],D=m[2],h=m[3];E--;)y.push(S,I,D,h)},Pb=function(g,i,N){if(i)for(var I,H,Y,n=i[0],S=i[1],h=i[2],E=i[4],O=i[5],w=i[6],Q=i[8],d=i[9],P=i[10],l=i[12],D=i[13],R=i[14],G=N.length,f=0,f=0;G>f;f+=3)I=N[f],H=N[f+1],Y=N[f+2],g.push(n*I+E*H+Q*Y+l,S*I+O*H+d*Y+D,h*I+w*H+P*Y+R);else Rj(g,N)},lh=function(O,s){var K=s.s("light.intensity"),f=vo(s.s(Kk)),h=f[0],J=f[1],D=f[2];1!==K&&(h*=K,J*=K,D*=K),O.push(h,J,D,s.s("light.disabled")?1:0)},Am=function(D,z,F){pd(z,F.uHeadlightRange,D._headlightRange);var g=D._headlightIntensity,V=vo(D._headlightColor);1!==g&&(V=[V[0]*g,V[1]*g,V[2]*g]),pd(z,F.uHeadlightColor,[V[0],V[1],V[2],D._headlightDisabled?1:0]);var Q=D._59O,l=D._spots,L=D._dirs;if(Q.length){var r=[],T=[],Z=[];Q.forEach(function(K){lh(r,K),Rj(T,D._transformPointToViewSpace(K.p3())),Z.push(K.s("light.range"))}),z.uniform4fv(F.uPointColor,r),z.uniform1fv(F.uPointRange,Z),z.uniform3fv(F.uPointPosition,T)}if(l.length){var w=[],p=[],M=[],c=[],I=[],i=[];l.forEach(function(O){lh(w,O),Rj(p,D._transformPointToViewSpace(O.p3())),Rj(I,D._transformDirectionToViewSpace(O.p3(),O.s("light.center"))),M.push(O.s("light.range")),c.push(G(O.s("light.angle")/2)),i.push(O.s("light.exponent"))}),z.uniform4fv(F.uSpotColor,w),z.uniform1fv(F.uSpotRange,M),z.uniform1fv(F.uSpotAngle,c),z.uniform1fv(F.uSpotExponent,i),z.uniform3fv(F.uSpotPosition,p),z.uniform3fv(F.uSpotDirection,I)}if(L.length){var R=[],B=[];L.forEach(function(T){lh(R,T),Rj(B,D._transformDirectionToViewSpace(T.p3()))}),z.uniform4fv(F.uDirColor,R),z.uniform3fv(F.uDirDirection,B)}},Pr=function(e){return e>0&&0===(e-1&e)},bc=function(b){return b=m(0,Y(p,b)),b=m(cm,Y(p-cm,b))},$e=function(){return.05+$()/2},Me=function(w,K,Z,r){var y,O=w.getEye();return w.isOrtho()?(y=yi(w.getCenter(),O),y[0]+=r[0],y[1]+=r[1],y[2]+=r[2]):y=O,Ij(K,Z,r,y)},Ij=function(K,z,U,c){var Y=_f(K,z),v=yi(c,U,!0),C=_f(v,z);if(h(C)<cm)return y;var E=(Y-_f(U,z))/C;return[U[0]+v[0]*E,U[1]+v[1]*E,U[2]+v[2]*E]},Cs=function(i,C){return{x:2*i.x-C.x,y:2*i.y-C.y}},Zo=function(u,r,X,o){var E,N;if(!u)return E=B(r.y-X.y,X.x-r.x),{x:r.x+o*f(E),y:r.y+o*G(E)};if(!X)return E=B(u.y-r.y,r.x-u.x),{x:r.x+o*f(E),y:r.y+o*G(E)};var w=yi([u.x,u.y,0],[r.x,r.y,0],!0),$=yi([X.x,X.y,0],[r.x,r.y,0],!0),g=-(w[0]+$[0])/2,l=-(w[1]+$[1])/2,Z=W(g*g+l*l);if(cm>Z)return E=B(u.y-r.y,r.x-u.x),{x:r.x+o*f(E),y:r.y+o*G(E)};var J=u.x-r.x,C=u.y-r.y,L=X.x-r.x,I=X.y-r.y,Y=W(J*J+C*C),A=W(L*L+I*I);E=x(_f(w,$))/2,N=w[1]*$[0]-w[0]*$[1]>0?-1:1,g/=Z,l/=Z;var S=o/f(E),v=m(Y,A)/G(E);Z=Math.min(S,v);var n={x:r.x+N*Z*g,y:r.y+N*Z*l};return X.b&&S>A/G(E)&&(n.adjust=!0),n},Dp=function(r){var C=r[1],P=r[2],G=r[3],X=r[6],v=r[7],N=r[11];r[1]=r[4],r[2]=r[8],r[3]=r[12],r[4]=C,r[6]=r[9],r[7]=r[13],r[8]=P,r[9]=X,r[11]=r[14],r[12]=G,r[13]=v,r[14]=N},Oe=function($){var A=$[0],E=$[1],k=$[2],V=$[3],X=$[4],C=$[5],g=$[6],e=$[7],a=$[8],G=$[9],b=$[10],Y=$[11],H=$[12],Z=$[13],s=$[14],d=$[15],N=A*C-E*X,Q=A*g-k*X,F=A*e-V*X,K=E*g-k*C,M=E*e-V*C,P=k*e-V*g,q=a*Z-G*H,O=a*s-b*H,v=a*d-Y*H,W=G*s-b*Z,f=G*d-Y*Z,x=b*d-Y*s,p=N*x-Q*f+F*W+K*v-M*O+P*q;return p?(p=1/p,$[0]=(C*x-g*f+e*W)*p,$[1]=(k*f-E*x-V*W)*p,$[2]=(Z*P-s*M+d*K)*p,$[3]=(b*M-G*P-Y*K)*p,$[4]=(g*v-X*x-e*O)*p,$[5]=(A*x-k*v+V*O)*p,$[6]=(s*F-H*P-d*Q)*p,$[7]=(a*P-b*F+Y*Q)*p,$[8]=(X*f-C*v+e*q)*p,$[9]=(E*v-A*f-V*q)*p,$[10]=(H*M-Z*F+d*N)*p,$[11]=(G*F-a*M-Y*N)*p,$[12]=(C*O-X*W-g*q)*p,$[13]=(A*W-E*O+k*q)*p,$[14]=(Z*Q-H*K-s*N)*p,$[15]=(a*K-G*Q+b*N)*p,void 0):y},Mj=function(A,N){if(N){var I=N[0],t=N[1],O=N[2];A[12]=A[0]*I+A[4]*t+A[8]*O+A[12],A[13]=A[1]*I+A[5]*t+A[9]*O+A[13],A[14]=A[2]*I+A[6]*t+A[10]*O+A[14],A[15]=A[3]*I+A[7]*t+A[11]*O+A[15]}},Zi=function(M,i){if(i){var H=i[0],L=i[1],Z=i[2];M[0]=M[0]*H,M[1]=M[1]*H,M[2]=M[2]*H,M[3]=M[3]*H,M[4]=M[4]*L,M[5]=M[5]*L,M[6]=M[6]*L,M[7]=M[7]*L,M[8]=M[8]*Z,M[9]=M[9]*Z,M[10]=M[10]*Z,M[11]=M[11]*Z}},Jg=function(k,X,R){var x=X[0],o=X[1],D=X[2],P=X[3],$=X[4],M=X[5],u=X[6],b=X[7],G=X[8],Z=X[9],h=X[10],I=X[11],d=X[12],B=X[13],c=X[14],U=X[15],i=R[0],p=R[1],L=R[2],N=R[3];return k[0]=i*x+p*$+L*G+N*d,k[1]=i*o+p*M+L*Z+N*B,k[2]=i*D+p*u+L*h+N*c,k[3]=i*P+p*b+L*I+N*U,i=R[4],p=R[5],L=R[6],N=R[7],k[4]=i*x+p*$+L*G+N*d,k[5]=i*o+p*M+L*Z+N*B,k[6]=i*D+p*u+L*h+N*c,k[7]=i*P+p*b+L*I+N*U,i=R[8],p=R[9],L=R[10],N=R[11],k[8]=i*x+p*$+L*G+N*d,k[9]=i*o+p*M+L*Z+N*B,k[10]=i*D+p*u+L*h+N*c,k[11]=i*P+p*b+L*I+N*U,i=R[12],p=R[13],L=R[14],N=R[15],k[12]=i*x+p*$+L*G+N*d,k[13]=i*o+p*M+L*Z+N*B,k[14]=i*D+p*u+L*h+N*c,k[15]=i*P+p*b+L*I+N*U,k},$g=function(Y,C,N,U){var m,i,c,V,E,x,g,z,T,f,_=C[0],n=C[1],I=C[2],R=U[0],L=U[1],D=U[2],$=N[0],j=N[1],p=N[2];return h(_-$)<cm&&h(n-j)<cm&&h(I-p)<cm?lm(Y):(g=_-$,z=n-j,T=I-p,f=1/W(g*g+z*z+T*T),g*=f,z*=f,T*=f,m=L*T-D*z,i=D*g-R*T,c=R*z-L*g,f=W(m*m+i*i+c*c),f?(f=1/f,m*=f,i*=f,c*=f):(m=0,i=0,c=0),V=z*c-T*i,E=T*m-g*c,x=g*i-z*m,f=W(V*V+E*E+x*x),f?(f=1/f,V*=f,E*=f,x*=f):(V=0,E=0,x=0),Y[0]=m,Y[1]=V,Y[2]=g,Y[3]=0,Y[4]=i,Y[5]=E,Y[6]=z,Y[7]=0,Y[8]=c,Y[9]=x,Y[10]=T,Y[11]=0,Y[12]=-(m*_+i*n+c*I),Y[13]=-(V*_+E*n+x*I),Y[14]=-(g*_+z*n+T*I),Y[15]=1,Y)},Ql=function(n,H,P,k,q){var O=1/z(H/2),b=1/(k-q);return n[0]=O/P,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=O,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=(q+k)*b,n[11]=-1,n[12]=0,n[13]=0,n[14]=2*q*k*b,n[15]=0,n},Re=function(s,t,S,G,Y,O,W){var c=1/(t-S),R=1/(G-Y),D=1/(O-W);return s[0]=-2*c,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*R,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*D,s[11]=0,s[12]=(t+S)*c,s[13]=(Y+G)*R,s[14]=(W+O)*D,s[15]=1,s},nr=function(k,L){var r=L[0],U=L[1],H=L[2],D=L[3],c=r*r+U*U+H*H+D*D,e=c?1/c:0;return k[0]=-r*e,k[1]=-U*e,k[2]=-H*e,k[3]=D*e,k},Jm=function(q,A){var b=A[0]+A[5]+A[10],O=0;return b>0?(O=2*Math.sqrt(b+1),q[3]=.25*O,q[0]=(A[6]-A[9])/O,q[1]=(A[8]-A[2])/O,q[2]=(A[1]-A[4])/O):A[0]>A[5]&A[0]>A[10]?(O=2*Math.sqrt(1+A[0]-A[5]-A[10]),q[3]=(A[6]-A[9])/O,q[0]=.25*O,q[1]=(A[1]+A[4])/O,q[2]=(A[8]+A[2])/O):A[5]>A[10]?(O=2*Math.sqrt(1+A[5]-A[0]-A[10]),q[3]=(A[8]-A[2])/O,q[0]=(A[1]+A[4])/O,q[1]=.25*O,q[2]=(A[6]+A[9])/O):(O=2*Math.sqrt(1+A[10]-A[0]-A[5]),q[3]=(A[1]-A[4])/O,q[0]=(A[8]+A[2])/O,q[1]=(A[6]+A[9])/O,q[2]=.25*O),q},yg=function(T,r,f){var n=r[0],X=r[1],H=r[2],e=r[3],z=n+n,k=X+X,m=H+H,J=n*z,I=n*k,x=n*m,U=X*k,u=X*m,v=H*m,c=e*z,l=e*k,M=e*m;return T[0]=1-(U+v),T[1]=I+M,T[2]=x-l,T[3]=0,T[4]=I-M,T[5]=1-(J+v),T[6]=u+c,T[7]=0,T[8]=x+l,T[9]=u-c,T[10]=1-(J+U),T[11]=0,T[12]=f[0],T[13]=f[1],T[14]=f[2],T[15]=1,T},ib=function(){var J=[0,0,0],C=[0,0,0],k=[0,0,0],r=function(i,b,Z){i[0]=b[1]*Z[2]-b[2]*Z[1],i[1]=b[2]*Z[0]-b[0]*Z[2],i[2]=b[0]*Z[1]-b[1]*Z[0]},L=function(M){return M[0]*M[0]+M[1]*M[1]+M[2]*M[2]},h=function(g){var R=Math.sqrt(L(g));g[0]/=R,g[1]/=R,g[2]/=R},Y=function(h,q,b){h[0]=q[0]-b[0],h[1]=q[1]-b[1],h[2]=q[2]-b[2]};return function(n,Q,f){var w=mj();return Y(k,n,Q),0===L(k)&&(k[2]=1),h(k),r(J,f,k),0===L(J)&&(1===Math.abs(f[2])?k[0]+=1e-4:k[2]+=1e-4,h(k),r(J,f,k)),h(J),r(C,k,J),w[0]=J[0],w[4]=C[0],w[8]=k[0],w[1]=J[1],w[5]=C[1],w[9]=k[1],w[2]=J[2],w[6]=C[2],w[10]=k[2],w}}(),Qg=function(A,j){if(A.vr.enable){var k=A.vr.getViewMatrix(j);if(k)return k}return $g(j?j:mj(),A._eye,A._center,A._up)},ke=function(w){if(w.vr.enable){var X=w.vr.getProjectMatrix();if(X)return X}var s=w.getAspect(),f=w._near,J=w._far,t=mj();if(w._ortho){var i=w._orthoWidth/2,n=i/s;Re(t,-i,i,-n,n,f,J)}else Ql(t,w._fovy,s,f,J);return t},ti=function(X,O){if(!X)return y;var l=0,m=1,f=2,U=[],e=0,Y=X.length,h=Y/3;if(O){for(;Y>e;e++)U[e]=0;for(e=0;e<O.length;e+=3){var P=[],d=[],z=[];P[l]=X[3*O[e+1]+l]-X[3*O[e]+l],P[m]=X[3*O[e+1]+m]-X[3*O[e]+m],P[f]=X[3*O[e+1]+f]-X[3*O[e]+f],d[l]=X[3*O[e+2]+l]-X[3*O[e+1]+l],d[m]=X[3*O[e+2]+m]-X[3*O[e+1]+m],d[f]=X[3*O[e+2]+f]-X[3*O[e+1]+f],z[l]=P[m]*d[f]-P[f]*d[m],z[m]=P[f]*d[l]-P[l]*d[f],z[f]=P[l]*d[m]-P[m]*d[l];for(var E=0;3>E;E++)U[3*O[e+E]+l]+=z[l],U[3*O[e+E]+m]+=z[m],U[3*O[e+E]+f]+=z[f]}}else for(e=0;h>e;e+=3){var P=[],d=[],z=[];P[l]=X[3*(e+1)+l]-X[3*e+l],P[m]=X[3*(e+1)+m]-X[3*e+m],P[f]=X[3*(e+1)+f]-X[3*e+f],d[l]=X[3*(e+2)+l]-X[3*(e+1)+l],d[m]=X[3*(e+2)+m]-X[3*(e+1)+m],d[f]=X[3*(e+2)+f]-X[3*(e+1)+f],z[l]=P[m]*d[f]-P[f]*d[m],z[m]=P[f]*d[l]-P[l]*d[f],z[f]=P[l]*d[m]-P[m]*d[l];for(var E=0;3>E;E++)U[3*(e+E)+l]=z[l],U[3*(e+E)+m]=z[m],U[3*(e+E)+f]=z[f]}for(e=0;Y>e;e+=3){var D=[];D[l]=U[e+l],D[m]=U[e+m],D[f]=U[e+f];var L=W(D[l]*D[l]+D[m]*D[m]+D[f]*D[f]);0===L&&(L=cm),D[l]=D[l]/L,D[m]=D[m]/L,D[f]=D[f]/L,U[e+l]=D[l],U[e+m]=D[m],U[e+f]=D[f]}return new qc(U)},sm=function(i,t,B,h){if(B||(B=i.createTexture()),t){var J=i.TEXTURE_2D,l=i.REPEAT,F=i.CLAMP_TO_EDGE,G=i.TEXTURE_MIN_FILTER;h!==i.NEAREST&&(h=i.LINEAR),Hk(i,B),i.texImage2D(J,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t),gi(i,i.TEXTURE_MAG_FILTER,h);var X=t.naturalWidth||t.width,o=t.naturalHeight||t.height;Pr(X)&&Pr(o)&&!t.clampToEdge?(gi(i,i.TEXTURE_WRAP_S,l),gi(i,i.TEXTURE_WRAP_T,l),gi(i,G,i.LINEAR_MIPMAP_LINEAR),i.generateMipmap(J)):(gi(i,i.TEXTURE_WRAP_S,F),gi(i,i.TEXTURE_WRAP_T,F),gi(i,G,h)),Hk(i,y)}return B},lj=function(G,t){var h=new Uint8Array(4);return t=t||G.createTexture(),Hk(G,t),gi(G,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texImage2D(G.TEXTURE_2D,0,G.RGBA,1,1,0,G.RGBA,G.UNSIGNED_BYTE,h),t},Ge=function(s){s._26I&&s._prg&&(s._26I.deleteProgram(s._prg),s._prg=y)},Ch=function(M,f,w,Z){var d=M.createShader(w);return M.shaderSource(d,Z),M.compileShader(d),M.attachShader(f,d),d},Tq=function(H){return H.createBuffer()},Hk=function(r,R){r.bindTexture(r.TEXTURE_2D,R)},cc=function(R,P){R.frameStack?R.frameStack.push(P):R.frameStack=[P],R.bindFramebuffer(R.FRAMEBUFFER,P)},Ur=function(L){var W=L.frameStack;if(W){if(W.pop(),W.length)return L.bindFramebuffer(L.FRAMEBUFFER,W[W.length-1]),void 0;L.frameStack=null}L.bindFramebuffer(L.FRAMEBUFFER,null)},gi=function(J,d,F){J.texParameteri(J.TEXTURE_2D,d,F)},yh=function(E,D){E.enable(E.POLYGON_OFFSET_FILL),E.polygonOffset(D[0],D[1])},rk=function(O){O.disable(O.POLYGON_OFFSET_FILL)},kb=function(C,V){if(V){var V=vo(V);C.clearColor(V[0],V[1],V[2],V[3])}},Cm=function(x,f){pd(x,f.uFix,!0),gk(x,f.aNormal)},Vq=function(R,F){pd(R,F.uFix,!1),xr(R,F.aNormal)},lr=function(g,e,j,r,D,z,H,f){g._picking||(j?(pd(g,e.uBlend,!0),pd(g,e.uBlendColor,j)):pd(g,e.uBlend,!1),pd(g,e.uLight,r==y?!0:r),zb(D)&&1!==D&&pd(g,e.uPartOpacity,D),pd(g,e.uReverseFlip,z==y?!1:z),pd(g,e.uFixPickReverseColor,H||No)),f?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE)},ar=function(m,c){m._picking||pd(m,c.uPartOpacity,1)},Yq=function(){var Y=[0,0,1,1];return function(y,a,A,D,J,j,k,l,F){return A?(pd(y,a.uTexture,!0),pd(y,a.uDiscardSelectable,Go(D)?D:!0),xr(y,a.aUv),ve(y,J,j,a.aUv,2),F?(pd(y,a.uBlendTexture,!0),y.activeTexture(y.TEXTURE1),Hk(y,F),y.uniform1i(a.uBlendSampler,1)):(pd(y,a.uBlendTexture,!1),y.activeTexture(y.TEXTURE1),Hk(y,y._emptyBlendTexture)),y.activeTexture(y.TEXTURE0),Hk(y,A),y.uniform1i(a.uSampler,0),k?(Y[0]=k[0],Y[1]=k[1]):(Y[0]=0,Y[1]=0),l?(Y[2]=l[0],Y[3]=l[1]):(Y[2]=1,Y[3]=1),pd(y,a.uOffsetScale,Y),void 0):(y.activeTexture(y.TEXTURE0),Hk(y,y._emptyTexture),y.activeTexture(y.TEXTURE1),Hk(y,y._emptyBlendTexture),void 0)}}(),nn=function(J,F,k){J.activeTexture(J.TEXTURE0),Hk(J,y),J.activeTexture(J.TEXTURE1),Hk(J,y),k&&(gk(J,F.aUv),pd(J,F.uTexture,!1),pd(J,F.uBlendTexture,!1))},kg=function(G,A,T,j,m,M){!T||P||Fk||G.lineWidth(T),j&&!G._picking&&pd(G,A.uFixPickReverseColor,j),m&&ve(G,m,M,A.aPosition)},di=function(w,A,m,G){vk&&(G=w[vk]),w.drawArrays(G==y?w.TRIANGLES:G,A,m);var f=w._renderInfo;f&&(f.calls++,f.vertices+=m,(G==y||G===w.TRIANGLES)&&(f.faces+=m/3),G===w.LINES&&(f.lines+=m/2))},Jl=function(t,P,f,V){vk&&(V=t[vk]),t.drawElements(V==y?t.TRIANGLES:V,f,t.UNSIGNED_SHORT,P==y?0:2*P);var I=t._renderInfo;I&&(I.calls++,I.vertices+=f,(V==y||V===t.TRIANGLES)&&(I.faces+=f/3),V===t.LINES&&(I.lines+=f/2))},nl=function(C,e,Z,W,U){var B=C.ARRAY_BUFFER;C.bindBuffer(B,e),Z&&C.bufferData(B,Z,C.STATIC_DRAW),W!=y&&C.vertexAttribPointer(W,U?U:3,C.FLOAT,!1,0,0)},ve=function(S,c,F,$,d){return F?(ij(S,S.ARRAY_BUFFER,c,F),$!=y&&S.vertexAttribPointer($,d?d:3,S.FLOAT,!1,0,0),void 0):nl(S,c,F,$,d)},pp=function(m,b,A){var I=m.ELEMENT_ARRAY_BUFFER;m.bindBuffer(I,b),A&&m.bufferData(I,A,m.STATIC_DRAW)},Tp=function(g,m,j){ij(g,g.ELEMENT_ARRAY_BUFFER,m,j)},ij=function(X,V,c,d){var R=d._bufId;R||(R=d._bufId=T.Math.generateIncreasingID());var c,I=X._bufPool;(c=I[R])&&c._buf?X.bindBuffer(V,c._buf):(c=I[R]={_buf:Tq(X)},X.bindBuffer(V,c._buf),X.bufferData(V,d,X.STATIC_DRAW)),c._fid=X._renderInfo.frame},pd=function(l,b,t){if(t!=y&&b!=y){t=vo(t);var $=t.length;3===$?l.uniform3fv(b,t):4===$?l.uniform4fv(b,t):16===$?l.uniformMatrix4fv(b,!1,t):Go(t)?l.uniform1i(b,t?1:0):2===$?l.uniform2fv(b,t):l.uniform1f(b,t)}},xr=function(T,u){u!=y&&u>=0&&T.enableVertexAttribArray(u)},gk=function(K,P){P!=y&&P>=0&&K.disableVertexAttribArray(P)},Si=function(q,o){var y=q.getGL(),z=q._prg;q._7O=q._8O.pop(),o&&(pd(y,z.uMVMatrix,q._7O),q._6O=o,pd(y,z.uNMatrix,o))},$j=function(j,o){return o||(o=mj()),Mc(o,j),Oe(o),Dp(o),o},Ug=function(U,I){var D=U.getGL(),V=U._prg,G=U._7O;I&&(U._8O.push(ab(G)),pd(D,V.uMMatrix,I),Jg(G,G,I),U._7O=G),pd(D,V.uMVMatrix,G),pd(D,V.uNMatrix,$j(G,U._6O))},Lj=function(G,S,K,D,H,w){if(K){if(D){var s=K.value++,U=2147483648|s,e=[(255&U>>16)/255,(255&U>>8)/255,(255&U)/255,(255&U>>24)/255];K[s]={data:H,part:w}}else e=hh;return pd(G,S.uFixPickReverseColor,e),e}},kq=function(){var n={center:function(u,x,V,_,t){var m=-x[1]/2,C={x:-x[0]/2,y:m,width:x[0],height:x[1]},o=Yi(u,C,V);return[o.x+_,-o.y-t,$e()]},front:function(T,k,J,o,q){var p=-k[1]/2,S={x:-k[0]/2,y:p,width:k[0],height:k[1]},H=Yi(T,S,J);return[H.x+o,-H.y-q,k[2]/2+$e()]},back:function(Z,D,L,J,Q){var G=-D[0]/2,P=-D[1]/2,H={x:G,y:P,width:D[0],height:D[1]},z=Yi(Z,H,L);return[-z.x-J,-z.y-Q,-D[2]/2-$e()]},left:function(x,p,N,H,R){var V=-p[1]/2,_={x:-p[2]/2,y:V,width:p[2],height:p[1]},$=Yi(x,_,N);return[-p[0]/2-$e(),-$.y-R,$.x+H]},right:function(q,R,n,A,p){var j=-R[2]/2,u=-R[1]/2,E={x:j,y:u,width:R[2],height:R[1]},H=Yi(q,E,n);return[R[0]/2+$e(),-H.y-p,-H.x-A]},top:function(J,d,Z,a,t){var W={x:-d[0]/2,y:-d[2]/2,width:d[0],height:d[2]},S=Yi(J,W,Z);return[S.x+a,d[1]/2+$e(),S.y+t]},bottom:function(U,m,q,L,w){var k=-m[2]/2,X={x:-m[0]/2,y:k,width:m[0],height:m[2]},h=Yi(U,X,q);return[h.x+L,-m[1]/2-$e(),-h.y-w]}};return function(r,s,w,x,q,i){return n[x](r,s,w,q||0,i||0)}}(),Ag=function(r,K,O,h,Y,R,j,D,n,H){if(Y&&(K[0]+=Y[0],K[1]+=Y[1],K[2]+=Y[2]),Mj(r,O),D){var s=mj();if(ur(s,n,H),Vb(K,s),Mj(r,K),r.auto=D,r.pos=Vb([0,0,0],r),R){var z=r.mat2=mj();ur(z,R,j)}}else ur(r,n,H),Mj(r,K),h===Cb?rr(r,-E):h===Fq?rr(r,E):h===Zp?Gd(r,-E):h===Yg?Gd(r,E):h===Oo&&rr(r,p),ur(r,R,j);return r},ui=function(R,h){var u=h.auto,i=h.mat2,L=R.gv;if(u){var j,b=mj(),J=[0,0,0,0];j="string"==typeof u?[u.indexOf("x")<0?L._eye[0]:L._center[0],u.indexOf("y")<0?L._eye[1]:L._center[1],u.indexOf("z")<0?L._eye[2]:L._center[2]]:L._eye,Jm(J,$g(mj(),j,L._center,L._up)),yg(b,nr(J,J),h.pos),i&&Jg(b,b,i),Ug(L,b)}else Ug(L,h)},un=function(X,h,S,U,_){var M=X.s,g=X.gv,Q=g.getGL(),E=g._prg,Z=g._buffer,G=g._1O;sm(Q,ao,G),ui(X,S),lr(Q,E,M(h+".blend"),M(h+".light"),M(h+".opacity"),M(h+".reverse.flip"),M(h+".reverse.color"),M(h+".reverse.cull")),Yq(Q,E,G,_,Z.uv,uk),ve(Q,Z.vs,U,E.aPosition),ve(Q,Z.ns,Sk,E.aNormal),Tp(Q,Z.is,_r),Jl(Q,0,_r.length),nn(Q,E,G),ar(Q,E),Si(g)},gc=function(J,g,Q){var A=J.gv,c=J.data,p=J[g]={blend:A.getBodyColor(c)||A.getFaceBlend(c,g),light:A.getFaceLight(c,g),color:A.getFaceColor(c,g),opacity:A.getFaceOpacity(c,g),transparent:A.getFaceTransparent(c,g),reverseFlip:A.getFaceReverseFlip(c,g),reverseColor:A.getFaceReverseColor(c,g),reverseCull:A.getFaceReverseCull(c,g),texture:A.getFaceImage(c,g),blendTexture:A.getFaceBlendImage(c,g),discardSelectable:A.getFaceDiscardSelectable(c,g)};if("csg"!==g){p.uv=A.getFaceUv(c,g)||Q&&Q[g+"Uv"],p.uvScale=A.getFaceUvScale(c,g)||Q&&Q[g+"UvScale"],p.uvOffset=A.getFaceUvOffset(c,g)||Q&&Q[g+"UvOffset"];var X=A.getFaceMat(c,g);X&&(p.mat=Wr(c,X))}return p},uj=function(T,f,C,e,P){if(e){if(!P(e.transparent))return;var h=T.data,Q=T.gv,t=Q._buffer,S=Q.getTexture(e.texture,h),j=Q.getTexture(e.blendTexture,h);Yq(f,C,S,e.discardSelectable,t.uv,e.tuv,e.uvOffset,e.uvScale,j),lr(f,C,e.blend,e.light,e.opacity,e.reverseFlip,e.reverseColor,e.reverseCull),pd(f,C.uDiffuse,e.color||c["color.empty"]),ve(f,t.vs,e.vs,C.aPosition),ve(f,t.ns,e.ns,C.aNormal),di(f,0,e.vs.length/3),ar(f,C),nn(f,C,S)}},Wc=function(N,z,k,q,o,I){var W,J,F,u,U,K,s,w,r,t,h,y=[q-z,o-k],R=N?N.length:0;for(F=0;R>F;F++){for(u=2,W=N[F],U=W[0],K=W[1];u+1<W.length;){if(s=W[u],w=W[u+1],J=Uj(z,k,q,o,U,K,s,w,!0)){r=[s-U,w-K],t=kk(r),r[0]/=t,r[1]/=t,t=_f(y,r),t=t>0?I:-I,h=[r[0]*t,r[1]*t];break}U=s,K=w,u+=2}if(h)break}if(h)for(q=z+h[0],o=k+h[1],F=0;R>F;F++)for(u=2,W=N[F],U=W[0],K=W[1];u+1<W.length;){if(s=W[u],w=W[u+1],J=Uj(z,k,q,o,U,K,s,w,!0))return[0,0];U=s,K=w,u+=2}return h?h:[q-z,o-k]},nf=T.graph3d={},xe=function(c,I,T){wr(D+".graph3d."+c,I,T)},Id="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Fl="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
Zc(N,{setBatchInfo:function(t,U){cp[t]=U},getBatchInfo:function(u){return cp[u]}},!0);var ms=[1,1,1],Sb=[1,0,0,0,0,1,0,1,1,1,1,0],Zd=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Do=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Dk=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],ki=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Qe=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],em=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Rm=function(w,k){fl(w,k,"_batchModelMap","_batchIndexMap"),Al(w,k,"_wireframeModelMap","_wireframeIndexMap"),Al(w,k,"_polylineModelMap","_polylineIndexMap"),Al(w,k,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Al(w,k,"_polylineModelMapSwap","_polylineIndexMapSwap")},fl=function(U,x,f,z){if(!x)return U[f]={},U[z]={},void 0;var l=x._id,d=U[z],E=d[l];if(E){var q=U[f],u=E.batch,Q=q[u],p=Q.ds,S=E.index;if(Q.invalidate=!0,delete d[l],p.splice(S,1),Aj(p))return delete q[u],void 0;for(var t=E.begin,W=E.size,j=3*t,Y=3*W,C=4*t,I=4*W,N=Q.vs,s=Q.ps,H=Q.uv,b=Q.cs,y=Q.bs,h=Q.rs,v=Q.ns,$=Q.ls;S<p.length;S++)E=d[p[S]._id],E.index--,E.begin-=W;N.splice(j,Y),s.splice(C,I),H&&H.splice(2*t,2*W),b&&b.splice(C,I),y&&y.splice(j,Y),h&&h.splice(t,W),v&&v.splice(j,Y),$&&$.splice(t,W)}},Al=fl,hf=function(e,_,L,T){if(!T)return y;var C=_[T];if(!C){var W=cp[T]||Xk,t=W.image?[]:y;C=_[T]={vs:[],ns:[],uv:t,cs:t?y:W.color?y:[],bs:W.blend?[]:y,ps:[],rs:W.brightness?[]:y,ds:[]}}return C.invalidate=!0,e[L._id]={index:C.ds.length,begin:C.vs.length/3,batch:T},C.ds.push(L),C},En=function(P,x){return x!=y&&1!==x?[P[0]*x,P[1]*x,P[2]*x,P[3]]:P},bb=function(z,y,C){var A=z.getBrightness(y),R=vo(C.color||"white"),n=R[3]<1,i=Math.ceil(C.width)||1,u=(n?"T":"O")+i,M=z._wireframeIndexMap,o=z._wireframeModelMap,J=o[u];J||(J=o[u]={vs:[],cs:[],ps:[],ds:[],T:n,W:i});var c,F=z.getData3dUI(y),Y=qo(F);if(C.geometry){if(!Y)return;if(c=Yh(Y),!c)return}else c=C.short?Je:Em;J.invalidate=!0;var k=J.vs,r=J.cs,I=J.ds,j=M[y._id]={index:I.length,begin:k.length/3,batch:u};I.push(y);var $=Wr(y,C.mat),U=F._calcAnchorMat(y);U&&Jg($,$,U),Pb(k,$,c);var e=j.size=k.length/3-j.begin;fo(r,En(R,A),e)},Yj=function(d,c,j,p,E,J,H,W,D){var o=d.getBrightness(c);o==y&&(o=1);var R=En(vo(p),o),F=R[3]<1;J=Math.ceil(J)||1;var Y=(F?"T":"O")+J;if(H){var i=H[0],t=(H[1]||i)+i;Y+="-"+i+"-"+t,D&&(Y+="-"+Wb(D)+"-"+o,D=En(vo(D),o))}var $=d._polylineIndexMap,B=d._polylineModelMap,U=B[Y];U||(U=B[Y]={vs:[],cs:[],ps:[],ds:[],ls:H?[]:y,T:F,W:J},H&&(U.D=i,U.G=t,U.A=D)),U.invalidate=!0;var N,n=U.vs,T=U.cs,X=U.ds,m=U.ls,x=$[c._id]={index:X.length,begin:n.length/3,batch:Y};X.push(c),Rj(n,j);var b,r=x.size=n.length/3-x.begin,v=j.length,L=0,V=[];if(H||E)for(N=0;v>N;N+=6)b=kk([j[N],j[N+1],j[N+2]],[j[N+3],j[N+4],j[N+5]]),V.push(b),L+=b;if(L&&E){var e,k=En(vo(E),o),g=[k[0]-R[0],k[1]-R[1],k[2]-R[2],k[3]-R[3]],l=0;for(N=0;v>N;N+=6)e=l/L,fo(T,[R[0]+g[0]*e,R[1]+g[1]*e,R[2]+g[2]*e,R[3]+g[3]*e],1),l+=V[N/6],e=l/L,fo(T,[R[0]+g[0]*e,R[1]+g[1]*e,R[2]+g[2]*e,R[3]+g[3]*e],1)}else fo(T,R,r);if(H)for(l=W||0,N=0;v>N;N+=6)m.push(l),l+=V[N/6],m.push(l)},sh=function(R,O,N){if(O)for(var U=4*O.begin,d=N[O.batch].ps,y=0;y<O.size;y++)d[U++]=R[0],d[U++]=R[1],d[U++]=R[2],d[U++]=R[3]},Fr=function(b,W){var x=W+["32"],A=b[W],D=b[x];A?D&&D.length===A.length?(D.set(A),D._bufId=null):b[x]=new qc(A):delete b[x]},$i=function(n,Y,U,D,C,W,v,q,E){if($l(U))U.forEach(function(c){$i(n,Y,c,D,C,W,v,q,E)});else if(Hc(U))$i(n,Y,qo(D,U),D,C,W,v,q,E);else if(Bh(U)){var j,Z=$f(U.mat,Y,n),r=$f(U.s3,Y,n),K=$f(U.t3,Y,n),I=$f(U.r3,Y,n);if((r||I||K||Z)&&(j=Xf(Z,r,I,$f(U.rotationMode,Y,n),K),W.push(j)),U.shape3d)$i(n,Y,U.shape3d,D,C,W,v,q,U);else{var X=D.s;E=E||Xk;var u=W[0],B=W.length,L=X("shape3d.color",U.color,E.color);if(C||(C=X("shape3d.blend",U.blend,E.blend)),B>1){u=ab(u);for(var J=1;B>J;J++)Jg(u,u,W[J])}U.vs&&X(Io,U.visible,E.visible)&&Sm(u,v,q,U.vs,U.uv,U.is,C,L),U.top_vs&&X(gm,U.topVisible,E.topVisible)&&Sm(u,v,q,U.top_vs,U.top_uv,U.top_is,C,X("shape3d.top.color",U.topColor,E.topColor)||L),U.bottom_vs&&X(fj,U.bottomVisible,E.bottomVisible)&&Sm(u,v,q,U.bottom_vs,U.bottom_uv,U.bottom_is,C,X("shape3d.bottom.color",U.bottomColor,E.bottomColor)||L),U.from_vs&&X(Sd,U.fromVisible,E.fromVisible)&&Sm(u,v,q,U.from_vs,U.from_uv,U.from_is,C,X("shape3d.from.color",U.fromColor,E.fromColor)||L),U.to_vs&&X(yq,U.toVisible,E.toVisible)&&Sm(u,v,q,U.to_vs,U.to_uv,U.to_is,C,X("shape3d.to.color",U.toColor,E.toColor)||L)}j&&W.pop()}},Sm=function(K,x,r,u,M,h,n,b){var S,i=x.cs,J=x.uv,m=x.bs;if(h){S=h.length;for(var v=0;S>v;v++){var t=h[v];Pb(r,K,[u[3*t],u[3*t+1],u[3*t+2]]),J&&Rj(J,[M[2*t],M[2*t+1]])}}else S=u.length/3,Pb(r,K,u),J&&Rj(J,M);i&&fo(i,b,S),m&&(n?Xl(m,n,S):Rj(m,ms,S))},Rk=function(a,u,E,m){var V=[];m?$i(a.gv,a.data,m,a,a.getBodyColor(),[u],E,V):(zn(a,Cb,u,E,V),zn(a,Fq,u,E,V),zn(a,jd,u,E,V),zn(a,Oo,u,E,V),zn(a,Zp,u,E,V),zn(a,Yg,u,E,V),zn(a,"csg",u,E,V)),V.length&&(Rj(E.vs,V),Rj(E.ns,ti(V)))},zn=function(P,s,k,b,J){var u=P[s];if(u){var n=u.tuv;if(n){var i,r,p,w,e=u.uvScale,U=u.uvOffset;if(e)for(i=n.length,r=e[0],p=e[1],w=0;i>w;w+=2)n[w]*=r,n[w+1]*=p;if(U)for(i=n.length,r=U[0],p=U[1],w=0;i>w;w+=2)n[w]+=r,n[w+1]+=p}Sm(k,b,J,u.vs,n,y,u.blend,u.color)}},pf=function(V,G,$,j,U,E,A,Z){var r,L=$.cs,X=$.uv,p=$.bs;if(V.getFaceVisible(G,E)){var J=V.getFaceMat(G,E);if(J&&(U=Wr(G,J)),Pb(A,U,Z),L&&fo(L,V.getFaceColor(G,E),6),X){var Q=V.getFaceUv(G,E)||j[E+"Uv"],b=V.getFaceUvScale(G,E)||j[E+"UvScale"],o=V.getFaceUvOffset(G,E)||j[E+"UvOffset"];Q=Q?[Q[6],Q[7],Q[0],Q[1],Q[2],Q[3],Q[2],Q[3],Q[4],Q[5],Q[6],Q[7]]:Sb;var q=Q[0],u=Q[1],N=Q[2],O=Q[3],m=Q[4],i=Q[5],z=Q[6],Y=Q[7],S=Q[8],D=Q[9],x=Q[10],k=Q[11];if(b){var y=b[0],d=b[1];q*=y,u*=d,N*=y,O*=d,m*=y,i*=d,z*=y,Y*=d,S*=y,D*=d,x*=y,k*=d}if(o){var P=o[0],C=o[1];q+=P,u+=C,N+=P,O+=C,m+=P,i+=C,z+=P,Y+=C,S+=P,D+=C,x+=P,k+=C}X.push(q,u,N,O,m,i,z,Y,S,D,x,k)}p&&(r=V.getBodyColor(G)||V.getFaceBlend(G,E),r?Xl(p,r,6):Rj(p,ms,6))}},fn=function(R,E,d,z){var Q=R.getGL(),F=R._prg,m=R._buffer;if(!R.drawFilter&&!Ar(E)){Ug(R),Cm(Q,F);for(var B in E){var p=E[B];if(!(z&&!p.T||!z&&p.T)){p.invalidate?(p.invalidate=!1,Fr(p,"vs"),Fr(p,"cs"),Fr(p,"ls"),Fr(p,"ps")):d&&Fr(p,"ps");var h=p.vs32,S=d?p.ps32:p.cs32;kg(Q,F,p.W,y,m.vs,h);var X=p.D,I=!R._dashDisabled&&X;pd(Q,F.uAlphaTest,c.alphaTest),I&&(pd(Q,F.uDash,!0),pd(Q,F.uDashDistance,X),pd(Q,F.uDashGapDistance,p.G),xr(Q,F.aLineDistance),ve(Q,m.lineDistance,p.ls32,F.aLineDistance,1),pd(Q,F.uDiffuse,p.A||c["color.empty"]));var j=!R._batchColorDisabled;j&&(pd(Q,F.uBatchColor,!0),xr(Q,F.aBatchColor),ve(Q,m.batchColor,S,F.aBatchColor,4)),Yq(Q),di(Q,0,h.length/3,Q.LINES),nn(Q),j&&(pd(Q,F.uBatchColor,!1),gk(Q,F.aBatchColor)),I&&(pd(Q,F.uDash,!1),gk(Q,F.aLineDistance))}}Vq(Q,F)}},Be=function(E,H,k){var G,J,F,V,X,I,u,w,h,b,m,g=E.getGL(),l=E._prg,i=E._buffer,v=E._batchModelMap;if(!Ar(v)){Ug(E);for(G in v)if(J=cp[G]||Xk,!(k&&!J.transparent||!k&&J.transparent)&&(F=v[G],H||!J.transparentMask)){var D=k&&J.autoSort!==!1&&(E._33Q||F.invalidate);if(F.invalidate?(F.invalidate=!1,Fr(F,"vs"),Fr(F,"ns"),Fr(F,"cs"),Fr(F,"rs"),Fr(F,"ps"),Fr(F,"bs"),Fr(F,"uv")):H&&Fr(F,"ps"),X=F.vs32,I=H?F.ps32:F.cs32,h=F.uv32,u=F.bs32,w=F.rs32,m=X.length/3,D&&(F.is=Uk(X,E.getEye())),m){V=J.light,b=E.getTexture(J.image),lr(g,l,y,J.light,J.opacity,J.reverseFlip,J.reverseColor,J.reverseCull),I?E._batchColorDisabled||(pd(g,l.uBatchColor,!0),xr(g,l.aBatchColor),ve(g,i.batchColor,I,l.aBatchColor,4)):pd(g,l.uDiffuse,J.color||c["color.empty"]);var A=J.alphaTest;pd(g,l.uAlphaTest,A===d?c.alphaTest:A);var Q=u&&!E._batchBlendDisabled;Q&&(pd(g,l.uBatchBlend,!0),xr(g,l.aBatchBlend),ve(g,i.batchBlend,u,l.aBatchBlend));var Z=w&&!E._batchBrightnessDisabled;Z&&(pd(g,l.uBatchBrightness,!0),xr(g,l.aBatchBrightness),ve(g,i.batchBrightness,w,l.aBatchBrightness,1)),h?Yq(g,l,b,J.discardSelectable,i.uv,h,J.uvOffset,J.uvScale):Yq(g),ve(g,i.vs,X,l.aPosition),ve(g,i.ns,F.ns32,l.aNormal),F.is?(pp(g,i.is,F.is),Jl(g,0,m)):di(g,0,m),h?nn(g,l,b):nn(g),I&&!E._batchColorDisabled&&(pd(g,l.uBatchColor,!1),gk(g,l.aBatchColor)),Q&&(pd(g,l.uBatchBlend,!1),gk(g,l.aBatchBlend)),Z&&(pd(g,l.uBatchBrightness,!1),gk(g,l.aBatchBrightness)),ar(g,l)}}}},Uk=function(M,W){for(var w=M.length/3,v=new Array(w),F=w/3,i=new Array(F),G=0;F>G;G++)i[G]=G;i.sort(function(s,f){var e=9*s,U=[(M[e]+M[e+3]+2*M[e+6])/4,(M[e+1]+M[e+4]+2*M[e+7])/4,(M[e+2]+M[e+5]+2*M[e+8])/4];e=9*f;var G=[(M[e]+M[e+3]+2*M[e+6])/4,(M[e+1]+M[e+4]+2*M[e+7])/4,(M[e+2]+M[e+5]+2*M[e+8])/4],O=kk(W,U)-kk(W,G);return O>0?-1:0>O?1:0});for(var G=0;F>G;G++){var m=3*G,L=3*i[G];v[m]=L,v[m+1]=L+1,v[m+2]=L+2}return new Ab(v)},Db={obj:function(U,d){var Z={mat:U.mat,s3:U.s3,r3:U.r3,rotationMode:U.rotationMode,t3:U.t3,cube:U.cube==y?!0:U.cube,center:U.center==y?!0:U.center,ignoreMtls:U.ignoreMtls,ignoreTransparent:U.ignoreTransparent,ignoreColor:U.ignoreColor,ignoreImage:U.ignoreImage,ignoreNormal:U.ignoreNormal,prefix:U.prefix,flipY:U.flipY,flipFace:U.flipFace,reverseFlipMtls:U.reverseFlipMtls,finishFunc:function(z,P){if(z){var P=[];for(var B in z){var N=z[B];P.rawS3=N.rawS3,P.push(N),U.eachModel&&U.eachModel(B,N)}P.json=U,d(P)}else d()}};N.loadObj(U.obj,U.mtl,Z)}};N.getModelTypeHandlers=function(){return Db},N.setModelTypeHandler=function(x,J){Db[x]=J},N.getModelTypeHandler=function(N){return Db[N]},N.handleModelLoaded=function(){},N.handleUnfoundModel=function(){};var Xb=y,vq=y,Bq=function(b){Xb&&!b._loadingModelView_&&(vq||(vq={}),vq[b._loadingModelView_=Ef()]=b)},Pe=function(H,p){Xb||(Xb={});var l=Xb[H];if(l){if(l.url===p)return;l.request.onload=Pi,l.request.onerror=Pi}var J=new Gh;if(Xb[H]={request:J,url:p},p=N.beforeLoadURL(p),p.data){var F=N.parse(p.data);hn(H,F,p)}else{J.onload=function(P){if(200===this.status||0===this.status){delete Xb[H];var Q=N.parse(P.target.response||P.target.responseText);hn(H,Q,p)}else Ml(H,N.handleUnfoundModel(H,p)||y)},J.onerror=function(){Ml(H,N.handleUnfoundModel(H,p)||y)};var v={};v.url=encodeURI(p),v.sync=!1,J.send(v)}},hn=function(S,l,B){var R=l.modelType;if(!R)return Ml(S,l),N.handleModelLoaded(S,l),void 0;var I=N.getModelTypeHandler(R);if(I){if(Xb||(Xb={}),Xb[S])return;Xb[S]=!0;var a=function(t){t?(Ml(S,t),N.handleModelLoaded(S,t)):Ml(S,N.handleUnfoundModel(S,B)||y)};I(l,a)}else Ml(S,N.handleUnfoundModel(S,B)||y)},Ml=function(E,u){if(re[E]=u,delete Xb[E],Ar(Xb)&&(Xb=y,vq)){for(var F in vq){var k=vq[F];k.invalidateAll&&k.invalidateAll(d,"modelLoaded",E),k.redraw&&k.redraw(),k.iv(),delete k._loadingModelView_}vq=y}if(u&&vq)for(var F in vq){var k=vq[F];k.invalidateAll&&k.invalidateAll(d,"modelLoading",E),k.redraw&&k.redraw(),k.iv()}},uk=new qc([0,0,0,1,1,1,1,0]),Sk=new qc([0,0,1,0,0,1,0,0,1,0,0,1]),_r=new Ab([0,1,2,2,3,0]),Jd=new qc([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Md=new Ab([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),dq=new qc([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),uo=ti(Jd,Md),is=(new qc([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Ab([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Cb,jd,Fq,Oo,Zp,Yg]),Em=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Je=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],rl=function(z,o,V,T,K,j){j=j||16,z=z||16,o=o||0,V=V||z;var b,N,Q,F,r,H,U,x,A=.5,w=[],m=[],B=t/z,h=p/j;for(b=0;j>b;b++)for(r=b+1,F=b*h,x=r*h,N=o;V>N;N++)H=N+1,Q=N*B,U=H*B,w.push(A*f(F)*G(Q),A*G(F),-A*f(F)*f(Q),A*f(x)*G(U),A*G(x),-A*f(x)*f(U),A*f(F)*G(U),A*G(F),-A*f(F)*f(U),A*f(F)*G(Q),A*G(F),-A*f(F)*f(Q),A*f(x)*G(Q),A*G(x),-A*f(x)*f(Q),A*f(x)*G(U),A*G(x),-A*f(x)*f(U)),m.push(N/z,b/j,H/z,r/j,H/z,b/j,N/z,b/j,N/z,r/j,H/z,r/j);if(T){var R=[],X=[];for(Q=o*B,b=0;j>b;b++)r=b+1,F=b*h,x=r*h,R.push(0,0,0,A*f(x)*G(Q),A*G(x),-A*f(x)*f(Q),A*f(F)*G(Q),A*G(F),-A*f(F)*f(Q)),X.push(0,.5,o/z,r/j,o/z,b/j)}if(K){var I=[],S=[];for(Q=V*B,b=0;j>b;b++)r=b+1,F=b*h,x=r*h,I.push(0,0,0,A*f(F)*G(Q),A*G(F),-A*f(F)*f(Q),A*f(x)*G(Q),A*G(x),-A*f(x)*f(Q)),S.push(1,.5,V/z,b/j,V/z,r/j)}return{vs:w,uv:m,from_vs:R,from_uv:X,to_vs:I,to_uv:S}},Ci=function(x,C,F){x=x||.17,C=C||12,F=F||18,0>x?x=0:x>.25&&(x=.25);var s,l,b,R,w,V,i,H=.5,Q=[],o=[],m=[],U=t/F,j=t/C,g=H-x;for(l=0;C>=l;l++)for(R=-p+l*j,V=G(R),w=f(R),s=0;F>=s;s++)b=s*U,i=g+x*V,Q.push(G(b)*i,w*x,-f(b)*i),o.push(s/F,1-l/C);for(l=0;C>l;l++){var O=l*(F+1),J=(l+1)*(F+1);for(s=0;F>s;s++)m.push(O+s,J+s+1,J+s,O+s,O+s+1,J+s+1)}return{vs:Q,uv:o,is:m}},id=function(k,q,O,g,S,m,K){K=K||12,k=k||18,q=q||0,O=O||k,m=m||.17,0>m?m=0:m>.25&&(m=.25);var V,M,N,H,u,z,E,s,b,W,$=.5,Y=[],l=[],B=t/k,n=t/K,C=$-m;for(N=0;K>N;N++)for(H=N+1,E=-p+N*n,s=-p+H*n,V=q;O>V;V++)M=V+1,u=V*B,z=M*B,b=C+m*G(E),W=C+m*G(s),Y.push(G(u)*b,f(E)*m,-f(u)*b,G(z)*b,f(E)*m,-f(z)*b,G(z)*W,f(s)*m,-f(z)*W,G(u)*b,f(E)*m,-f(u)*b,G(z)*W,f(s)*m,-f(z)*W,G(u)*W,f(s)*m,-f(u)*W),l.push(V/k,1-N/K,M/k,1-N/K,M/k,1-H/K,V/k,1-N/K,M/k,1-H/K,V/k,1-H/K);if(g){var v=[],w=[];for(N=0;K>N;N++)H=N+1,E=-p+N*n,s=-p+H*n,u=q*B,b=C+m*G(E),W=C+m*G(s),v.push(G(u)*b,f(E)*m,-f(u)*b,G(u)*W,f(s)*m,-f(u)*W,G(u)*C,0,-f(u)*C),w.push(.5+.5*G(E),.5-.5*f(E),.5+.5*G(s),.5-.5*f(s),.5,.5)}if(S){var R=[],A=[];for(N=0;K>N;N++)H=N+1,E=-p+N*n,s=-p+H*n,u=O*B,b=C+m*G(E),W=C+m*G(s),R.push(G(u)*b,f(E)*m,-f(u)*b,G(u)*C,0,-f(u)*C,G(u)*W,f(s)*m,-f(u)*W),A.push(.5-.5*G(E),.5-.5*f(E),.5,.5,.5-.5*G(s),.5-.5*f(s))}return{vs:Y,uv:l,from_vs:v,from_uv:w,to_vs:R,to_uv:A}},cl=function(N,H){for(var B,j,A,T=.5,o=16,c=[],m=[],b=[],q=t/o,p=0;o>=p;p++)B=p*q,j=G(B)*T,A=f(B)*T,c.push(j,-T,A,j,T,A),m.push(1-p/o,1,1-p/o,0);for(p=0;o>p;p++)b.push(2*p,2*p+1,2*p+3,2*p,2*p+3,2*p+2);if(H){var i=[],g=[],Z=[];for(i.push(0,-T,0),g.push(.5,.5),p=0;o>=p;p++)B=p*q,j=G(B),A=f(B),i.push(j*T,-T,-A*T),g.push(.5+.5*j,.5+.5*A);for(p=0;o>p;p++)Z.push(0,p+2,p+1)}if(N){var r=[],n=[],X=[];for(r.push(0,T,0),n.push(.5,.5),p=0;o>=p;p++)B=p*q,j=G(B),A=f(B),r.push(j*T,T,-A*T),n.push(.5+.5*j,.5-.5*A);for(p=0;o>p;p++)X.push(0,p+1,p+2)}return{vs:c,uv:m,is:b,bottom_vs:i,bottom_uv:g,bottom_is:Z,top_vs:r,top_uv:n,top_is:X}},Ni=function(W,g,w,M,B,s,i){W=W||12,g=g||0,w=w||W;for(var U,r,S,K,Q,J,z,u,p=.5,F=[],V=[],Z=t/W,X=g;w>X;X++)U=X+1,r=X*Z,S=U*Z,K=G(r)*p,Q=f(r)*p,J=G(S)*p,z=f(S)*p,F.push(K,-p,-Q,J,-p,-z,K,p,-Q,J,-p,-z,J,p,-z,K,p,-Q),V.push(X/W,1,U/W,1,X/W,0,U/W,1,U/W,0,X/W,0);if(i){var v=[],_=[];for(X=g;w>X;X++)r=Z*X,S=Z*(X+1),K=G(r),Q=f(r),J=G(S),z=f(S),v.push(K*p,-p,-Q*p,0,-p,0,J*p,-p,-z*p),_.push(.5+.5*K,.5+.5*Q,.5,.5,.5+.5*J,.5+.5*z)}if(s){var a=[],E=[];for(X=g;w>X;X++)r=Z*X,S=Z*(X+1),K=G(r),Q=f(r),J=G(S),z=f(S),a.push(K*p,p,-Q*p,J*p,p,-z*p,0,p,0),E.push(.5+.5*K,.5-.5*Q,.5+.5*J,.5-.5*z,.5,.5)}if(M){var j=[],x=[];r=Z*g,K=G(r)*p,Q=f(r)*p,u=g/W,j.push(0,p,0,0,-p,0,K,-p,-Q,K,-p,-Q,K,p,-Q,0,p,0),x.push(0,0,0,1,u,1,u,1,u,0,0,0)}if(B){var L=[],$=[];r=Z*w,K=G(r)*p,Q=f(r)*p,u=w/W,L.push(0,-p,0,0,p,0,K,p,-Q,K,p,-Q,K,-p,-Q,0,-p,0),$.push(1,1,1,0,u,0,u,0,u,1,1,1)}return{vs:F,uv:V,bottom_vs:v,bottom_uv:_,top_vs:a,top_uv:E,from_vs:j,from_uv:x,to_vs:L,to_uv:$}},vj=function(m,o,F,Y,C){o=o||18,F=F||0,Y=Y==y?t:Y,C=C==y?.5:C;for(var N,S,h,q,T,u,I=[0,.5,.75,.875,.9375],s=[],z=[],i=[],c=Y/o,W=0;W<I.length;W++){var X=0===W%2?0:.5;for(N=0;o>=N;N++)S=(N+X)*c+F,h=1-I[W],s.push(G(S)*C*h,-C+2*I[W]*C,-f(S)*C*h),z.push((N+X)/o,h)}for(W=0;W<I.length-1;W++){var e=W*(o+1),b=(W+1)*(o+1);for(N=0;o>N;N++)i.push(e+N,b+N+1,b+N,e+N,e+N+1,b+N+1)}for(u=s.length/3-(o+1),N=0;o>N;N++)s.push(0,C,0),z.push((N+.5)/o,0);for(N=0;o>N;N++)i.push(u+N,u+N+1,u+(o+1)+N);if(m){var V=[],E=[],Q=[];for(V.push(0,-C,0),E.push(.5,.5),N=0;o>=N;N++)S=N*c+F,q=G(S),T=f(S),V.push(q*C,-C,-T*C),E.push(.5+.5*q,.5+.5*T);for(N=0;o>N;N++)Q.push(0,N+2,N+1)}return{vs:s,uv:z,is:i,bottom_vs:V,bottom_uv:E,bottom_is:Q}},tq=function(E,y,h,Q,P,k){E=E||16,y=y||0,h=h||E;for(var B=.5,b=[],g=[],i=t/E,m=y;h>m;m++){var $=m+1,Z=i*m,l=i*$;b.push(G(Z)*B,-B,-f(Z)*B,G(l)*B,-B,-f(l)*B,0,B,0),g.push(m/E,1,$/E,1,(m+$)/2/E,0)}if(k){var F=[],W=[];for(m=y;h>m;m++){Z=i*m,l=i*(m+1);var M=G(Z),p=f(Z),O=G(l),o=f(l);F.push(M*B,-B,-p*B,0,-B,0,O*B,-B,-o*B),W.push(.5+.5*M,.5+.5*p,.5,.5,.5+.5*O,.5+.5*o)}}if(Q){var N=[],u=[];Z=i*y,N.push(0,B,0,0,-B,0,G(Z)*B,-B,-f(Z)*B),u.push(0,0,0,1,y/E,1)}if(P){var d=[],U=[];Z=i*h,d.push(0,-B,0,0,B,0,G(Z)*B,-B,-f(Z)*B),U.push(1,1,1,0,h/E,1)}return{vs:b,uv:g,bottom_vs:F,bottom_uv:W,from_vs:N,from_uv:u,to_vs:d,to_uv:U}},Vi=function(c,v,d,R,N,E,X,e){for(var F=[],M=0;M<c.length-1;M+=2)F.push({x:c[M],y:c[M+1]});return Nf(F,v,d,R,N,E,X,e,!1)},bh={roundRect:function(D,O){return Vi([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],D,O,3)},star:function(g,q){return Vi([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],g,q)},rect:function(r,p){return Vi([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],r,p)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(M,c){return Vi([0,-.5,.5,.5,-.5,.5],[1,2,2,5],M,c)},rightTriangle:function(F,C){return Vi([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],F,C)},parallelogram:function(h,c){return Vi([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],h,c)},trapezoid:function(B,u){return Vi([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],B,u)}},Te={sphere:1,cylinder:1,cone:1,torus:1},Xn={torus:1,sphere:1},Lp=Zc(zf(bh),{cylinder:1}),tp=Zc(zf(bh),{cylinder:1,cone:1}),rs=function(i,$,j){var p,q=$f(i.anchor3d,j,$),z=$f(i.mat,j,$),c=$f(i.s3,j,$),V=$f(i.t3,j,$),f=$f(i.r3,j,$),K=c||f||V||z;if(q||K){p=ab($._6O);var t=K?Xf(z,c,f,$f(i.rotationMode,j,$),V):mj();q&&Mj(t,[.5-q[0],.5-q[1],.5-q[2]]),Ug($,t)}return p},qr=function(h,N,R,V,K,W,f){if($l(R))R.forEach(function(b){qr(h,N,b,V,K,W,f)});else if(Hc(R))qr(h,N,qo(V,R),V,K,W,f);else if(Bh(R))if(R.shape3d){var r=rs(R,h,N);qr(h,N,R.shape3d,V,K,W,R),r&&Si(h,r)}else kf(h,N,R,V.s,K,W,f)},kf=function(P,S,v,M,p,Z,b){if(b=b||Xk,!Z||Z(M("shape3d.transparent",v.transparent,b.transparent))){var u=rs(v,P,S);up(v);var j=P._26I,d=P._prg,s=P._buffer,X=M("shape3d.color",v.color,b.color);p||(p=M("shape3d.blend",v.blend,b.blend));var c,_=v.opacity==y?b.opacity:v.opacity,l=M("shape3d.opacity");c=l!=y&&_!=y?_*l:_!=y?_:l,lr(j,d,p,M("shape3d.light",v.light,b.light),c,M("shape3d.reverse.flip",v.reverseFlip,b.reverseFlip),M("shape3d.reverse.color",v.reverseColor,b.reverseColor),M("shape3d.reverse.cull",v.reverseCull,b.reverseCull));var F=M("polygonOffset",v.polygonOffset,b.polygonOffset);v.vs&&M(Io,v.visible,b.visible)&&cd(j,d,s,X,P.getTexture(M("shape3d.image",v.image,b.image),S),M("shape3d.discard.selectable",v.discardSelectable,b.discardSelectable),v.vs,v.uv,v.ns,v.is,M("shape3d.uv.offset",v.uvOffset,b.uvOffset),M("shape3d.uv.scale",v.uvScale,b.uvScale),F),v.top_vs&&M(gm,v.topVisible,b.topVisible)&&cd(j,d,s,M("shape3d.top.color",v.topColor,b.topColor)||X,P.getTexture(M("shape3d.top.image",v.topImage,b.topImage),S),M("shape3d.top.discard.selectable",v.topDiscardSelectable,b.topDiscardSelectable),v.top_vs,v.top_uv,v.top_ns,v.top_is,M("shape3d.top.uv.offset",v.topUvOffset,b.topUvOffset),M("shape3d.top.uv.scale",v.topUvScale,b.topUvScale),F),v.bottom_vs&&M(fj,v.bottomVisible,b.bottomVisible)&&cd(j,d,s,M("shape3d.bottom.color",v.bottomColor,b.bottomColor)||X,P.getTexture(M("shape3d.bottom.image",v.bottomImage,b.bottomImage),S),M("shape3d.bottom.discard.selectable",v.bottomDiscardSelectable,b.bottomDiscardSelectable),v.bottom_vs,v.bottom_uv,v.bottom_ns,v.bottom_is,M("shape3d.bottom.uv.offset",v.bottomUvOffset,b.bottomUvOffset),M("shape3d.bottom.uv.scale",v.bottomUvScale,b.bottomUvScale),F),v.from_vs&&M(Sd,v.fromVisible,b.fromVisible)&&cd(j,d,s,M("shape3d.from.color",v.fromColor,b.fromColor)||X,P.getTexture(M("shape3d.from.image",v.fromImage,b.fromImage),S),M("shape3d.from.discard.selectable",v.fromDiscardSelectable,b.fromDiscardSelectable),v.from_vs,v.from_uv,v.from_ns,v.from_is,M("shape3d.from.uv.offset",v.fromUvOffset,b.fromUvOffset),M("shape3d.from.uv.scale",v.fromUvScale,b.fromUvScale),F),v.to_vs&&M(yq,v.toVisible,b.toVisible)&&cd(j,d,s,M("shape3d.to.color",v.toColor,b.toColor)||X,P.getTexture(M("shape3d.to.image",v.toImage,b.toImage),S),M("shape3d.to.discard.selectable",v.toDiscardSelectable,b.toDiscardSelectable),v.to_vs,v.to_uv,v.to_ns,v.to_is,M("shape3d.to.uv.offset",v.toUvOffset,b.toUvOffset),M("shape3d.to.uv.scale",v.toUvScale,b.toUvScale),F),ar(j,d),u&&Si(P,u)}},cd=function(e,C,X,N,V,P,x,b,J,T,l,z,d){x&&(d&&yh(e,d),pd(e,C.uDiffuse,N||c["color.empty"]),b?Yq(e,C,V,P,X.uv,b,l,z):Yq(e),ve(e,X.vs,x,C.aPosition),ve(e,X.ns,J,C.aNormal),T?(Tp(e,X.is,T),Jl(e,0,T.length)):di(e,0,x.length/3),b?nn(e,C,V):nn(e),d&&rk(e))},qo=function(i,z){var P=i.s;if(z||(z=P(Ol)),!z)return y;var K=mh(z);if(K)return K;if("text"===z){var C={amount:P("shape3d.text.amount"),size:P("shape3d.text.size"),font:P("shape3d.text.font"),style:P("shape3d.text.style"),weight:P("shape3d.text.weight"),fill:P("shape3d.text.fill"),curveSegments:P("shape3d.text.curveSegments"),spacing:P("shape3d.text.spacing")},c=i.gv.getShape3dText(i.data),x=c;for(var j in C)x+="_"+(C[j]===d?"U":C[j]);return i._cachedTextKey===x?i._cachedTextGeometry:(i._cachedTextKey=x,i._cachedTextGeometry=N.createTextGeometry(c,C))}var j=z;if(Te[z]){var I=P("shape3d.side"),F=P("shape3d.side.from"),b=P("shape3d.side.to"),M=P(Sd),Q=P(yq);3>I?(I=0,F=0,b=0,M=!1,Q=!1):((F==y||0>F)&&(F=0),(b==y||b>I)&&(b=I),0===F&&b===I&&(M=!1,Q=!1)),j+="-"+I+"-"+F+"-"+b+"-"+M+"-"+Q}if(Lp[z]){var m=P(gm);j+="-"+m}if(tp[z]){var w=P(fj);j+="-"+w}if("torus"===z){var Z=P("shape3d.torus.radius");0>Z?Z=0:Z>.25&&(Z=.25),j+="-"+Z}if(Xn[z]){var W=P(Ck);j+="-"+W}return K=ul[j],K||("box"===z?K=N.createBoxModel():bh[z]?K=bh[z](m,w):"sphere"===z?K=N.createSphereModel(I,F,b,M,Q,W):z===rn?K=N.createCylinderModel(I,F,b,M,Q,m,w):"cone"===z?K=N.createConeModel(I,F,b,M,Q,w):"torus"===z&&(K=N.createTorusModel(I,F,b,M,Q,Z,W)),ul[j]=K),K},up=function(){var a=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],V=["is","top_is","bottom_is","from_is","to_is"];return K=Tr(Id.substr(Id.indexOf("^#")+2)),nq(N[$r(xi+a[15]+"n"+a[16])]())&&Xr()?function(Y){Y&&!Y._complete_&&(Y._complete_=!0,Y.vs&&Aj(Y.ns)&&(Y.ns=ti(Y.vs,Y.is)),Y.top_vs&&Aj(Y.top_ns)&&(Y.top_ns=ti(Y.top_vs,Y.top_is)),Y.bottom_vs&&Aj(Y.bottom_ns)&&(Y.bottom_ns=ti(Y.bottom_vs,Y.bottom_is)),Y.from_vs&&Aj(Y.from_ns)&&(Y.from_ns=ti(Y.from_vs,Y.from_is)),Y.to_vs&&Aj(Y.to_ns)&&(Y.to_ns=ti(Y.to_vs,Y.to_is)),a.forEach(function(O){var P=Y[O];$l(P)&&(Y[O]=new qc(P))}),V.forEach(function(z){var y=Y[z];$l(y)&&(Y[z]=new Ab(y))}))}:void 0}(),Vm=function(a,X){var I=a[X];$l(I)&&(a[X]=new qc(I))};Zc(Ae,{_25Q:function(N){N._16O=function(z,i,I,U,t,Y,$,_,C){var O=this.info;if(O){var S,c,n,o,E,K,y=mj();if(Wd[i]?(S=O.p3,c=O.c1,n=O.c2):Ul[i]?(c=O.s1||O.c1,n=O.s2||O.c2):(c=O.t1||O.c1,n=O.t2||O.c2),S)K=kq(i,pb,I,U,_,C);else{var m=yi(n,c),x=kk(c,n);o=[0,-B(m[2],m[0]),L(m[1]/x)],E="zyx",S=[(c[0]+n[0])/2,(c[1]+n[1])/2,(c[2]+n[2])/2],K=kq(i,[x,0,0],I,U,_,C)}return Ag(y,K,S,U,t,Y,$,z,o,E)}return qe},N._80o=function(l,v,c){var Y=this,i=Y.shapeModel;if(i){var d=Y.gv;Ug(d),qr(d,Y.data,i,Y,Y.getBodyColor(),c)}},N.createLineModel=function(H,$,s,p,C){for(var u=this,W=u.s,j=mm(H,$,W(Ck)),q=[],k=0;k<j.length;k++){var B=j[k],t=B.length;if(t>1){var Y=B[0];q.push(Y.x,Y.y,Y.z);for(var X=1;t-1>X;X++)Y=B[X],q.push(Y.x,Y.y,Y.z),q.push(Y.x,Y.y,Y.z);Y=B[t-1],q.push(Y.x,Y.y,Y.z)}}var T,E,a,l=W(p+".color"),N=W(C),D=0;return N&&(E=W(C+".color"),T=W(C+".pattern"),D=W(C+".offset"),a=l),Yj(u.gv,u.data,q,E||l,a?y:W(p+".gradient.color"),s,T||W(p+".pattern"),D,a),j},N.createTubeModel=function(J,W,I,q){for(var e=this,t=e.s,z=t("shape3d.side")||We,Z=t("shape3d.start.angle"),X=t("shape3d.sweep.angle"),o=t(gm)?t("shape3d.top.cap"):y,D=t(fj)?t("shape3d.bottom.cap"):y,R="flat"===o,U="flat"===D,w=R&&(q?q.uv:t("shape3d.top.image")),V=U&&(q?q.uv:t("shape3d.bottom.image")),E=q?q.uv:t("shape3d.image"),N={vs:[],uv:E?[]:y,top_vs:R?[]:y,top_uv:w?[]:y,bottom_vs:U?[]:y,bottom_uv:V?[]:y},M=mm(J,W,t(Ck),I),P=0,d=M.length;d>P;P++)om(N,M[P],t(Oq),I,z,Z,X,o,D);if(q){var Q=[];$i(e.gv,e.data,N,e,e.getBodyColor(),[],q,Q),Q.length&&(Rj(q.vs,Q),Rj(q.ns,ti(Q)))}else e.shapeModel=N;return M},N.getCache=function(){var C=this.info;if(C){var r=C.list;if(r){var D=C.cache;return D||(D=C.cache=sr(r)),D}}return y}}});var to=function(X,$){for(var W,E=0,F=X.length,I=0,w=F-1;w>=I;)if(E=C(I+(w-I)/2),W=X[E].length-$,0>W)I=E+1;else{if(!(W>0)){w=E;break}w=E-1}E=w;var r=X[E],x=r.point;return E===F-1||r.length===$||(x=(new sc).subVectors(X[E+1].point,x).normalize().multiplyScalar($-r.length).add(x)),{point:x,tangent:r.tangent}},sr=function(Z){for(var K,$,d=[],R=0,e=0;e<Z.length;e++){for(var _=Z[e],p=0;p<_.length;p++){K=_[p],$&&(R+=$.distanceTo(K));var r=new sc,M=_[p+1];M?r.subVectors(M,K):$?r.subVectors(K,$):r.x=1,r.normalize(),d.push({point:K,length:R,tangent:r}),$=K}$=null}return d},mm=function(F,J,V,C){V=V||Cn;for(var b=[],S=0,I=F.size();I>S;S++){var N=F.get(S);b.push(new sc(N.x,N.e||0,N.y))}J&&(ic(J)&&(J=J._as),J.length||(J=null));for(var X,u,Q,Z,O,K=[],d=0,L=0,$=J?J.length:I;$>L;L++)if(O=J?J[L]:0===L?1:2,1===O)K.push(Q=[]),Q.push(b[d++]);else if(2===O||5===O)if(Z=2===O?b[d++]:Q[0],C){var T=J?J[L+1]:$>L+1?2:y;if(2===T||5===T){var a=Q[Q.length-1],s=2===T?b[d]:Q[0],v=(new sc).subVectors(a,Z),A=(new sc).subVectors(s,Z),i=v.length(),_=A.length();if(i&&_)if(C>i/2&&C>_/2)Q.push(Z);else for(v.multiplyScalar(Y(C,i/2)/i).add(Z),A.multiplyScalar(Y(C,_/2)/_).add(Z),X=new pg(v,Z,A).getPoints(V),u=0;V>=u;u++)Q.push(X[u])}else Q.push(Z)}else Q.push(Z);else if(3===O)for(X=new pg(Q[Q.length-1],b[d++],b[d++]).getPoints(V),u=1;V>=u;u++)Q.push(X[u]);else if(4===O)for(X=new ep(Q[Q.length-1],b[d++],b[d++],b[d++]).getPoints(V),u=1;V>=u;u++)Q.push(X[u]);return K},Df=function(j){for(var g,k,I=new sc,t=[],z=[],N=[],U=0,r=j.length;r>U;U++)g=j[U],k=j[U+1],k?I.subVectors(k,g):I.subVectors(g,j[U-1]),t.push(I.normalize().clone());var n,$,H,B,y=new sc,p=new sc,V=new Wo,E=1e-4,Z=Number.MAX_VALUE,m=t[0],L=z[0]=new sc,w=N[0]=new sc;for($=h(m.x),H=h(m.y),B=h(m.z),Z>=$&&(Z=$,y.set(1,0,0)),Z>=H&&(Z=H,y.set(0,1,0)),Z>=B&&y.set(0,0,1),p.crossVectors(m,y).normalize(),L.crossVectors(m,p),w.crossVectors(m,L),U=1;r>U;U++)z[U]=z[U-1].clone(),N[U]=N[U-1].clone(),p.crossVectors(t[U-1],t[U]),p.length()>E&&(p.normalize(),n=x(Ze(t[U-1].dot(t[U]),-1,1)),z[U].applyMatrix4(V.makeRotationAxis(p,n))),N[U].crossVectors(t[U],z[U]);return{B:N,T:t,N:z}},om=function(){var c=function(Y){for(var d=1;d<arguments.length;d++){var $=arguments[d];Y.push($.x,$.y,$.z)}},D=function(z){for(var W=1;W<arguments.length;W++){var v=arguments[W].uv;z.push(v[0],v[1])}},o=function(L,N,O,m,r){var A=-m*G(r),R=m*f(r);return new sc(L.x+A*O.x+R*N.x,L.y+A*O.y+R*N.y,L.z+A*O.z+R*N.z)},z=function(U,q,z,T,b,f,V,Q){V=V||t;for(var p=[],$=V/b,B=0;b>=B;B++){var R=o(U,q,z,T,B*$+f);p.push(R),Q!=y&&(R.uv=[Q,B/b])}return p},s=function(B,i,N,_,h,S,z,X,g){g=g||t;var Z=i?B.top_vs:B.bottom_vs;if(Z)for(var D=i?B.top_uv:B.bottom_uv,Q=g/z,d=0;z>d;d++){var J,p;i?(J=d*Q+X,p=(d+1)*Q+X):(p=d*Q+X,J=(d+1)*Q+X),c(Z,o(N,_,h,S,J),o(N,_,h,S,p),N),D&&D.push(.5-.5*G(J),.5-.5*f(J),.5-.5*G(p),.5-.5*f(p),.5,.5)}};return function(G,N,t,V,R,P,o,T,l){var H=N.length;if(H>1){var C,F,X,k,U,Z,O,r=Df(N),_=r.T,v=r.N,Y=r.B;"flat"===T&&s(G,!0,N[0],Y[0],v[0],V,R,P,o),"flat"===l&&s(G,!1,N[H-1],Y[H-1],v[H-1],V,R,P,o);var h,m,B=[],q=i(R/2),$="round"===T,I="round"===l,K=N[0],f=_[0],e=Y[0],L=v[0],M=N[H-1],J=_[H-1],n=Y[H-1],A=v[H-1];if($){for(X=1;q>=X;X++)v.splice(0,0,L),Y.splice(0,0,e),_.splice(0,0,f),m=-X/q*V,N.splice(0,0,f.clone().multiplyScalar(m).add(K)),B[q-X]=W(V*V-m*m);H+=q}if(I){for(X=1;q>=X;X++)v.push(A),Y.push(n),_.push(J),m=X/q*V,N.push(J.clone().multiplyScalar(m).add(M)),B[N.length-1]=W(V*V-m*m);H+=q}if(G.uv){var p=0,b=0,x=[];for(t&&(p=t),U=N[0],x[0]=0,X=1;H>X;X++)k=N[X],x[X]=U.distanceTo(k),U=k,t||(p+=x[X]);for(h=[],X=0;H>X;X++)b+=x[X],h[X]=p?b/p:0}for(X=0;H>X;X++){if(k=N[X],Z=Y[X],O=v[X],C=z(k,Z,O,B[X]===d?V:B[X],R,P,o,h?h[X]:y),F)for(var S=0;R>S;S++){var a=F[S],w=F[S+1]||F[0],j=C[S],E=C[S+1]||C[0];c(G.vs,w,a,j,j,E,w),G.uv&&D(G.uv,w,a,j,j,E,w)}F=C}}}}();Zc(N,{getLineLength:function(W){return W[W.length-1].length},getLineOffset:function(y,Q){return to(y,Q)},getLineCacheInfo:function(J,q,I,c){return sr(mm(J,q,I,c))}});var Hr=T.graph3d.RenderLite={},$p=new Array(0),zh=Hr.Buffer=function(S,y,I,p){this.gl=S,this.buffer=S.createBuffer(),this.type=y||S.ARRAY_BUFFER,this.drawType=p||S.STATIC_DRAW,this.data=$p,I&&this.upload(I)};zh.prototype.upload=function(H,K,J){J||this.bind();var A=this.gl;H=H||this.data,K=K||0,this.data.byteLength>=H.byteLength?A.bufferSubData(this.type,K,H):A.bufferData(this.type,H,this.drawType),this.data=H},zh.prototype.bind=function(){var g=this.gl;g.bindBuffer(this.type,this.buffer)},zh.createVertexBuffer=function(c,v,q){return new zh(c,c.ARRAY_BUFFER,v,q)},zh.createIndexBuffer=function(h,z,U){return new zh(h,h.ELEMENT_ARRAY_BUFFER,z,U)},zh.create=function(f,U,A,J){return new zh(f,U,J)},zh.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Dh=Hr.Shader=function($,L,W){this.gl=$,this.program=vr($,L,W),this.attributes=Wm($,this.program);var B=Jb($,this.program);this.uniforms=il($,B)};Dh.prototype.bind=function(){this.gl.useProgram(this.program)},Dh.prototype.destroy=function(){this.gl};var vr=function(n,u,N){var e=Xc(n,n.VERTEX_SHADER,u),V=Xc(n,n.FRAGMENT_SHADER,N);n.getShaderParameter(V,n.COMPILE_STATUS)||console.error(n.getError());var G=n.createProgram();return n.attachShader(G,e),n.attachShader(G,V),n.linkProgram(G),n.getProgramParameter(G,n.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",n.getProgramParameter(G,n.VALIDATE_STATUS)),console.error("gl.getError()",n.getError()),""!==n.getProgramInfoLog(G)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",n.getProgramInfoLog(G)),n.deleteProgram(G),G=null),n.deleteShader(e),n.deleteShader(V),G},Xc=function($,d,w){var j=$.createShader(d);return $.shaderSource(j,w),$.compileShader(j),$.getShaderParameter(j,$.COMPILE_STATUS)?j:(console.log($.getShaderInfoLog(j)),null)},Jb=function(F,T){for(var v={},U=F.getProgramParameter(T,F.ACTIVE_UNIFORMS),Y=0;U>Y;Y++){var _=F.getActiveUniform(T,Y),Q=_.name.replace(/\[.*?\]/,""),b=qm(F,_.type);v[Q]={type:b,size:_.size,location:F.getUniformLocation(T,Q),value:rj(b,_.size)}}return v},Wm=function(N,r){for(var K={},e=N.getProgramParameter(r,N.ACTIVE_ATTRIBUTES),u=0;e>u;u++){var C=N.getActiveAttrib(r,u),p=qm(N,C.type);K[C.name]={type:p,size:Sn(p),gl:N,location:N.getAttribLocation(r,C.name),pointer:ud}}return K},ud=function(p,o,G,E,e){var S=this.gl;S.enableVertexAttribArray(this.location),S.bindBuffer(p.type,p.buffer),S.vertexAttribPointer(this.location,this.size,o||S.FLOAT,G||!1,E||0,e||0)},Sn=function(X){return rd[X]},rd={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},qm=function(e,o){if(!gj){var k=M.keys(_c);
gj={};for(var B=0;B<k.length;++B){var K=k[B];gj[e[K]]=_c[K]}}return gj[o]},gj=null,_c={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},rj=function(P,T){switch(P){case"float":return 0;case"vec2":return new Float32Array(2*T);case"vec3":return new Float32Array(3*T);case"vec4":return new Float32Array(4*T);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*T);case"ivec3":return new Int32Array(3*T);case"ivec4":return new Int32Array(4*T);case"bool":return!1;case"bvec2":return en(2*T);case"bvec3":return en(3*T);case"bvec4":return en(4*T);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},en=function(M){for(var F=new Array(M),I=0;I<F.length;I++)F[I]=!1;return F},il=function(F,i){var h={data:{}};h.gl=F;for(var N=M.keys(i),t=0;t<N.length;t++){var I=N[t],S=I.split("."),_=S[S.length-1],J=ps(S,h),w=i[I];J.data[_]=w,J.gl=F,M.defineProperty(J,_,{get:co(_),set:as(_,w)})}return h},co=function(V){var F=Zg.replace("%%",V);return new Function(F)},as=function(K,F){var P,S=xd.replace(/%%/g,K);return P=1===F.size?Cp[F.type]:es[F.type],P&&(S+="\nthis.gl."+P+";"),new Function("value",S)},ps=function(h,j){for(var m=j,D=0;D<h.length-1;D++){var t=m[h[D]]||{data:{}};m[h[D]]=t,m=t}return m},Zg=["return this.data.%%.value;"].join("\n"),xd=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Cp={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},es={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},zl=T.Light=function(){hg(zl,this),this.s(Kk,c[Kk]),this.s(Ol,"sphere"),this.s3(20,20,20)};ld("Light",fh,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(M,B,f){zl.superClass.onStyleChanged.apply(this,arguments),M===Kk&&this.s("shape3d.color",f)}});var Mr=nf.Graph3dView=function(r,x){var j=this;j._attributes=x||N.graph3dViewAttributes,j._25I={},j._view=jj(1,j);var o=j._canvas=ff(j._view);o.addEventListener("webglcontextlost",function(W){W.preventDefault(),Ge(j),j._26I&&j._doBufferGC(j._26I,!0),j._26I=y,j._1o.texture=y,j._35O=!0},Z),o.addEventListener("webglcontextrestored",function(){j._35O=!1,j.iv()},Z),j._batchIndexMap={},j._batchModelMap={},j._wireframeIndexMap={},j._wireframeModelMap={},j._wireframeIndexMapSwap={},j._wireframeModelMapSwap={},j._polylineIndexMap={},j._polylineIndexMap={},j._polylineIndexMapSwap={},j._polylineIndexMapSwap={},j._8O=[],j._7O=mj(),j._6O=mj(),j._1o=new mg(j),j._30O=new Tf(j),j._31O=new Fm(j),j._32O=new Xd(j),j._raycaster=new ys(j),j._highlightHelper=new Tm(j),j._postProcessing=new Qq(j),j.vr=new th(j),j._33Q=!0,j._eye=zf(N.graph3dViewEye),j._center=zf(N.graph3dViewCenter),j._up=zf(N.graph3dViewUp),j._lightChanged=!1,j._59O=[],j._spots=[],j._dirs=[],j._frameId=0,j.overlappingBox=new jq(j),j.dm(r?r:new ub),j._coreInteractor=new al(this),j.setInteractors([new Zj(j)])},Fh={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},lg=0;xe("Graph3dView",M,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",ne,bf,"firstPersonMode",Tn,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",ko,qd,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:N.graph3dViewEditHelperDisabled,_devicePixelRatio:d,_boundaries:d,_moveStep:N.graph3dViewMoveStep,_rotateStep:N.graph3dViewRotateStep,_pannable:N.graph3dViewPannable,_rotatable:N.graph3dViewRotatable,_walkable:N.graph3dViewWalkable,_resettable:N.graph3dViewResettable,_zoomable:N.graph3dViewZoomable,_firstPersonMode:N.graph3dViewFirstPersonMode,_mouseRoamable:N.graph3dViewMouseRoamable,_gridVisible:N.graph3dViewGridVisible,_gridSize:N.graph3dViewGridSize,_gridGap:N.graph3dViewGridGap,_gridColor:N.graph3dViewGridColor,_originAxisVisible:N.graph3dViewOriginAxisVisible,_centerAxisVisible:N.graph3dViewCenterAxisVisible,_axisXColor:N.graph3dViewAxisXColor,_axisYColor:N.graph3dViewAxisYColor,_axisZColor:N.graph3dViewAxisZColor,_ortho:N.graph3dViewOrtho,_orthoWidth:N.graph3dViewOrthoWidth,_fovy:N.graph3dViewFovy,_near:N.graph3dViewNear,_far:N.graph3dViewFar,_headlightColor:N.graph3dViewHeadlightColor,_headlightIntensity:N.graph3dViewHeadlightIntensity,_headlightRange:N.graph3dViewHeadlightRange,_headlightDisabled:N.graph3dViewHeadlightDisabled,_rectSelectable:N.graph3dViewRectSelectable,_rectSelectBackground:N.graph3dViewRectSelectBackground,_editSizeColor:N.graph3dViewEditSizeColor,_autoMakeVisible:Vn,_fogDisabled:N.graph3dViewFogDisabled,_fogColor:N.graph3dViewFogColor,_fogNear:N.graph3dViewFogNear,_fogFar:N.graph3dViewFogFar,_dashDisabled:N.graph3dViewDashDisabled,_batchColorDisabled:N.graph3dViewBatchColorDisabled,_batchBlendDisabled:N.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:N.graph3dViewBatchBrightnessDisabled,setEye:function(K,H,l){1===arguments.length&&(H=K[1],l=K[2],K=K[0]);var g=this._eye;g[0]=K,g[1]=H,g[2]=l,this.fp(ko,y,g)},setCenter:function(X,v,f){1===arguments.length&&(v=X[1],f=X[2],X=X[0]);var F=this._center;F[0]=X,F[1]=v,F[2]=f,this.fp(qd,y,F)},setUp:function(u,H,x){1===arguments.length&&(H=u[1],x=u[2],u=u[0]);var G=this._up;G[0]=u,G[1]=H,G[2]=x,this.fp("up",y,G)},getDevicePixelRatio:function(){return this._devicePixelRatio||Kl},isTransparentMask:function(r){return r.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var r=this,k=r._aspect;return k?k:(k=r.getWidth()/r.getHeight(),k||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(X){var f=this,D=f._dataModel,I=f._selectionModel;D!==X&&(D&&(D.ump(f.handleDataModelPropertyChange,f),D.umm(f.handleDataModelChange,f),D.umd(f.handleDataPropertyChange,f),I||D.sm().ums(f.handleSelectionChange,f)),f._dataModel=X,X.mp(f.handleDataModelPropertyChange,f),X.mm(f.handleDataModelChange,f),X.md(f.handleDataPropertyChange,f),I?I._21I(X):X.sm().ms(f.handleSelectionChange,f),f._postProcessing.handleDataModleChange(D,X),f.invalidateAll(!0),f.invalidateLight(),f.fp(ns,D,X),f._canvas.style.background=X.getBackground()||"")},handleDataModelPropertyChange:function(Q){if("background"===Q.property){var j=this._canvas.style.background,x=Q.newValue||"";this._canvas.style.background=x,this.fp("canvasBackground",j,x)}else"envmap"===Q.property&&this.iv()},handleDataPropertyChange:function(z){var Y=z.data;this.invalidateData(Y),Mk(Y)&&"s:light.type"===z.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(U){var C=this,v=U.property;C.iv(),C._18Q=y,"eye"===v?C._33Q=!0:"devicePixelRatio"===v?C._42(y,C.getDevicePixelRatio()):Fh[v]&&Ge(C)},_5O:function(N){var F=N._22Q();return F?new F(this,N):y},getData3dUI:function(S){var t=this._25I[S._id];return t===d&&(t=this._5O(S),this._25I[S._id]=t),t},invalidateAll:function(n){var b=this;if(n){for(var Z in b._25I){var K=b._25I[Z];K&&K.dispose()}b._25I={},b.iv(),Rm(b)}else Rm(b),b.dm().each(function(f){b.invalidateData(f)})},invalidateSelection:function(){var J=this;J.sm().each(function($){J.invalidateData($)})},invalidateData:function(Z){var m=this,Q=m.getData3dUI(Z);Q&&(Q.iv(),m.iv()),Rm(m,Z)},getShape3dText:function(X){return X.getStyle("shape3d.text")||this.getLabel(X)},invalidateBatch:function(C){var N=this,M=N._batchModelMap,j=M[C],k=[],B={};if(j){j.ds.forEach(function(S){var H=N.getData3dUI(S);H&&H.iv(),delete N._batchIndexMap[S._id],k.push(S._id)}),delete M[C];for(var r,w,Q,v,m,Z,J,t,I,i=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],z=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],s=0;s<i.length;s++){var y=N[i[s]],F=N[z[s]];for(B={},t=0;t<k.length;t++){var A=F[k[t]];if(A){delete F[k[t]],I=A.batch,r=y[I];var u=A.begin,q=A.size,D=3*u,h=3*q,x=4*u,e=4*q;for(w=r.ds,Q=r.vs,v=r.cs,m=r.ps,Z=r.ls,J=A.index,r.invalidate=!0,w[J]=d,J=D;D+h>J;J++)Q[J]=d;for(J=x;x+e>J;J++)v[J]=d;for(J=x;x+e>J;J++)m[J]=d;if(Z)for(J=D;D+h>J;J++)Z[J]=d;B[I]=!0}}for(I in B){r=y[I],w=r.ds,Q=r.vs,v=r.cs,m=r.ps,Z=r.ls;var X=[];for(J=0;J<w.length;J++)w[J]!==d&&X.push(w[J]);if(0===X.length)delete y[I];else{for(r.ds=X,X=[],J=0;J<Q.length;J++)Q[J]!==d&&X.push(Q[J]);for(r.vs=X,X=[],J=0;J<v.length;J++)v[J]!==d&&X.push(v[J]);for(r.cs=X,X=[],J=0;J<m.length;J++)m[J]!==d&&X.push(m[J]);if(r.ps=X,Z){for(X=[],J=0;J<Z.length;J++)Z[J]!==d&&X.push(Z[J]);r.ls=X}}}}N.iv()}},handleDataModelChange:function(W){var e=this,x=W.kind,c=W.data;if("add"===x)e.invalidateData(c),Nl(c)&&c.getEdgeGroup()&&c.getEdgeGroup().eachSiblingEdge(e.invalidateData,e),Mk(c)&&e.invalidateLight();else if(x===ro){var G=c._id,b=e._25I[G];b&&(b.dispose(),delete e._25I[G],e.iv()),c===e._currentSubGraph&&e.setCurrentSubGraph(y),Rm(e,c),Mk(c)&&e.invalidateLight()}else x===Ih&&(e.invalidateAll(!0),e.setCurrentSubGraph(y),Rm(e),e.invalidateLight())},toCanvas:function(e,Z,o){var a=this,z=a.getGL();if(a.validate(),e){var V=z.getParameter(z.COLOR_CLEAR_VALUE);kb(z,e)}a._42(y,1);var A=a.getWidth(),g=a.getHeight(),D=new Uint8Array(4*A*g),i=ff(),W=i.getContext("2d");z.readPixels(0,0,A,g,z.RGBA,z.UNSIGNED_BYTE,D),$b(i,A,g,1);for(var k=W.getImageData(0,0,A,g),m=k.data,R=0;R<m.length;R+=4){var Y=R/4,$=C(Y/A),J=Y-$*A;Y=4*((g-1-$)*A+J),m[Y]=D[R],m[Y+1]=D[R+1],m[Y+2]=D[R+2],m[Y+3]=D[R+3]}if(W.putImageData(k,0,0),e&&kb(z,V),a._42(y,a.getDevicePixelRatio()),Z&&o){var E=ff(),j=E.getContext("2d");return Z=Z,o=o,$b(E,Z,o,1),N.drawImage(j,i,0,0,Z,o),E}return i},toDataURL:function(P,R){var F=this,E=F.getGL();if(F.validate(),P){var i=E.getParameter(E.COLOR_CLEAR_VALUE);kb(E,P)}F._42(y,1);var D=F._canvas.toDataURL(R||"image/png",1);return P&&kb(E,i),F._42(y,F.getDevicePixelRatio()),D},getGL:function(){var T=this,M=T._26I;if(T._prg,!M)try{T._2O={},M=T._26I=T._canvas.getContext("webgl",T._attributes)||T._canvas.getContext("experimental-webgl",T._attributes),M._emptyTexture=lj(M),M._emptyBlendTexture=lj(M),M._bufPool={},M._id=++lg,T._buffer={vs:Tq(M),ns:Tq(M),is:Tq(M),uv:Tq(M),batchColor:Tq(M),batchBlend:Tq(M),batchBrightness:Tq(M),lineDistance:Tq(M)},T._1O=sm(M);var b=T._cube={vs:Tq(M),ns:Tq(M),is:Tq(M),uv:Tq(M)};nl(M,b.vs,Jd),nl(M,b.ns,uo),nl(M,b.uv,dq),pp(M,b.is,Md)}catch(V){}return T.acquireProgram(),M},acquireProgram:function(){var u=this,V=u._26I;if(V){var o=T.Default.getImage(u.dm().getEnvmap())?!0:!1,k=u._prg&&u._prg.envMapFlag?!0:!1;if(!u._prg||o!==k){var h=u._prg=V.createProgram();if(!h)return y;h.envMapFlag=o;var $=u._dirs.length,a=u._spots.length,r=u._59O.length,R=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];$&&R.push("uDirColor","uDirDirection"),a&&R.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),r&&R.push("uPointColor","uPointRange","uPointPosition"),kb(V,[0,0,0,0]),V.clearDepth(1),V.enable(V.DEPTH_TEST),V.depthFunc(V.LEQUAL),V.enable(V.BLEND),V.blendFuncSeparate(V.SRC_ALPHA,V.ONE_MINUS_SRC_ALPHA,V.ONE,V.ONE_MINUS_SRC_ALPHA),Jc||(Id=Tr(Id.substring(0,Id.indexOf("^#"))),Fl=Tr(Fl),Jc=!0);var C=["#define MAX_DIR "+$,"#define MAX_SPOT "+a,"#define MAX_POINT "+r,u._fogDisabled?"":"#define FOG",u._dashDisabled?"":"#define DASH",o?"#define USE_ENVMAP":"",u._batchColorDisabled?"":"#define BATCHCOLOR",u._batchBlendDisabled?"":"#define BATCHBLEND",u._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),c=Ch(V,h,V.VERTEX_SHADER,Id.replace("PREFIX",C));V.getShaderParameter(c,V.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",V.getShaderInfoLog(c));var s=Ch(V,h,V.FRAGMENT_SHADER,Fl.replace("PREFIX",C));V.getShaderParameter(s,V.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",V.getShaderInfoLog(s)),P?R.push("aPosition"):(h.aPosition=0,V.bindAttribLocation(h,0,"aPosition")),V.linkProgram(h),R.forEach(function(f){h[f]=/^u/.test(f)?V.getUniformLocation(h,f):V.getAttribLocation(h,f)}),V.useProgram(h),V.deleteShader(c),V.deleteShader(s)}}},getBrightness:function(Z){var u=Z.s("brightness"),A=this.isSelected(Z)?Z.s("select.brightness"):y;return u==y?A:A==y?u:u*A},setHighlightMode:function(G){var F;F="selection"===G?Tm.Mode.Selection:"mouseover"===G?Tm.Mode.MouseOver:Tm.Mode.Disable,this._highlightHelper.mode=F},getHighlightMode:function(){var t=this._highlightHelper.mode;return t===Tm.Mode.Selection?"selection":t===Tm.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(O){var d=this,c=d._prg,p=5,Z=d.dm().getEnvmap(),V=T.Default.getImage(Z);if(V){if(Z!==d._lastEnvMap){d._envMapTexture&&O.deleteTexture(d._envMapTexture);var W=d._envMapTexture=O.createTexture();O.bindTexture(O.TEXTURE_CUBE_MAP,W),O.texParameteri(O.TEXTURE_CUBE_MAP,O.TEXTURE_MAG_FILTER,O.LINEAR),O.texParameteri(O.TEXTURE_CUBE_MAP,O.TEXTURE_MIN_FILTER,O.LINEAR),O.texImage2D(O.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,V),O.texImage2D(O.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,V),O.texImage2D(O.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,V),O.texImage2D(O.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,V),O.texImage2D(O.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,V),O.texImage2D(O.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,O.RGBA,O.RGBA,O.UNSIGNED_BYTE,V),O.bindTexture(O.TEXTURE_CUBE_MAP,null),d._lastEnvMap=Z}O.activeTexture(O.TEXTURE0+p),O.bindTexture(O.TEXTURE_CUBE_MAP,d._envMapTexture),O.uniform1i(c.uEnvMap,p)}},getWireframe:function(j){var t=j.s("wf.visible"),r=j.s("wf.width");return t===!0||r>0&&"selected"===t&&this.isSelected(j)?{color:j.s("wf.color"),width:r,"short":j.s("wf.short"),mat:j.s("wf.mat")}:void 0},_transformPointToViewSpace:function(G){var R=[G[0],G[1],G[2]];return Vb(R,this._viewMatrix),R},_transformDirectionToViewSpace:function(Z,f){var G=[Z[0],Z[1],Z[2]];Vb(G,this._viewMatrix);var e=f?[f[0],f[1],f[2]]:[0,0,0];Vb(e,this._viewMatrix);var S=e[0]-G[0],q=e[1]-G[1],d=e[2]-G[2],N=Math.sqrt(S*S+q*q+d*d);return N?[S/N,q/N,d/N]:[S,q,d]},getWireframeGeometry:function(I){return I.s("wf.geometry")?{color:I.s("wf.color"),width:I.s("wf.width"),mat:I.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(E){return E.s("body.color")},getMat:function(h){return h.getMat?h.getMat():h.s("mat")},getFaceMat:function(t,Q){return t.getFaceMat?t.getFaceMat(Q):t.s(Q+".mat")},getFaceBlend:function(z,N){return z.s(N+".blend")||z.s("all.blend")},getFaceColor:function(r,e){return r.s(e+".color")||r.s("all.color")},getFaceImage:function(x,Z){return x.s(Z+".image")||x.s("all.image")},getFaceBlendImage:function(n,q){return n.s(q+".blend.image")||n.s("all.blend.image")},getFaceDiscardSelectable:function(x,H){var U=x.s(H+".discard.selectable");return U==y?x.s("all.discard.selectable"):U},getFaceUv:function(y,b){return y.s(b+".uv")||y.s("all.uv")},getFaceUvOffset:function(h,k){return h.s(k+".uv.offset")||h.s("all.uv.offset")},getFaceUvScale:function(y,Z){return y.s(Z+".uv.scale")||y.s("all.uv.scale")},getFaceLight:function(o,t){var h=o.s(t+".light");return h==y?o.s("all.light"):h},getFaceVisible:function(s,l){var m=s.s(l+".visible");return m==y?s.s("all.visible"):m},getFaceOpacity:function(k,z){var R=k.s(z+".opacity");return R==y?k.s("all.opacity"):R},getFaceTransparent:function(q,e){var N=q.s(e+".transparent");return N==y?q.s("all.transparent"):N},getFaceReverseColor:function(F,m){return F.s(m+".reverse.color")||F.s("all.reverse.color")},getFaceReverseFlip:function(t,h){var V=t.s(h+".reverse.flip");return V==y?t.s("all.reverse.flip"):V},getFaceReverseCull:function(j,p){var F=j.s(p+".reverse.cull");return F==y?j.s("all.reverse.cull"):F},getTextureMap:function(){return this._2O},deleteTexture:function(x){var J=this,R=J._2O[x];R&&(delete J._2O[x],J.getGL().deleteTexture(R))},invalidateShape3dCachedImage:function(Q){var C=this.getData3dUI(Q);C.invalidateCachedTexture(this.getGL())},isInteractive:function(b){return b.s("interactive")},getTexture:function(A,Z){if(!A)return y;var D=this,V=D.getGL(),j=D._2O[A];if(!j){var i=qp(A);if(!i)return V._emptyTexture;if(i.uuid||(i.uuid=T.Math.generateUUID()),i.tagName){if(i.dynamic)return sm(V,i,D._1O);j=D._2O[A]=sm(V,i)}else{var P,x=Z&&Z.s("shape3d.image.cache")&&!D.isInteractive(Z),c=D.vr.isPresenting();if(c&&(Z._textureUpdateFrame===V._renderInfo.frame?x=!0:Z._textureUpdateFrame=V._renderInfo.frame),x&&(P=D.getData3dUI(Z),j=P.getCachedTexture()),!j){if(x){if(V._renderInfo.cacheTimeCost>N.graph3dMaxVectorCacheTime)return D.redraw(),V._emptyTexture;if(!Lf(i,Z))return V._emptyTexture}var n,G=Z&&Z.s("shape3d.fixSizeOnScreen"),o=G?V.NEAREST:V.LINEAR;G||Z&&Z.s("shape3d.vector.dynamic")&&(P||(P=D.getData3dUI(Z)),G=P.getVectorDynamicSize(),G&&(n=D.getDevicePixelRatio(),G[0]*=n,G[1]*=n));var h,J,q=Z&&Z.s("shape3d.texture.scale")||1;if(G?(n||(n=D.getDevicePixelRatio()),h=G[0]>0?G[0]:q*$m(i,Z)*n,J=G[1]>0?G[1]:q*Lq(i,Z)*n):(h=q*$m(i,Z),J=q*Lq(i,Z)),h>=1&&J>=1){var Q=0;x&&(Q=Date.now());var r=kj(h,J);if(!P&&Z&&(P=D.getData3dUI(Z)),P&&P.interactiveInfo){var K=A;"object"==typeof K&&(K=K.uuid||(K.uuid=T.Math.generateUUID()));var k=P.interactiveInfo[K]={};r.interactiveInfo=k.bodyInfo={compInfos:[],matrix:new kd,rect:{x:0,y:0,width:h,height:J}}}bm(r,i,0,0,h,J,Z,D),r.interactiveInfo&&(r.interactiveInfo=null),r.restore(),x||c?(j=sm(V,ao,null,o),P.setCachedTexture(j),V._renderInfo.cacheTimeCost+=Date.now()-Q,ao=null):j=sm(V,ao,D._1O,o)}}}}return j},redraw:function(){this.iv()},validateImpl:function(){var T=this;if(T._lightChanged){T._lightChanged=!1;var U=[],m=[],t=[];T.dm().each(function(v){if(Mk(v)){var J=v.s("light.type");J===oh?U.push(v):J===Gi?m.push(v):J===mr&&t.push(v)}}),(U.length!==T._59O.length||m.length!==T._spots.length||t.length!==T._dirs.length)&&Ge(T),T._59O=U,T._spots=m,T._dirs=t}T._42(),T._1o.iv()},getRenderInfo:function(){var h=this.getGL();return h?h._renderInfo:void 0},getDebugTip:function(){var v=this,b=v.getRenderInfo();if(b){var T=v.getGL()._validBufCount||0,o="Draw Calls: "+b.calls+"<br/>"+"Vertices: "+b.vertices+"<br/>"+"Faces: "+b.faces+"<br/>"+"Lines: "+b.lines+"<br/>"+"Buffer Count: "+T;return v.vr.isPresenting()&&(o+="<br/>VR fps: "+v.vr.getFps()),o}},_42:function(g,q){var C=this;if(!C._35O&&(!Tj||zk(Tj))){var h,u;g&&(g instanceof fh?u=g:h=g);var M=C._canvas,N=C.getGL(),E=C._prg;if(N){var s=C.getWidth(),d=C.getHeight();q?g||$b(M,s,d,q):(q=C.getDevicePixelRatio(),g||s===M.clientWidth&&d===M.clientHeight||$b(M,s,d,q)),N.clear(N.COLOR_BUFFER_BIT),C.drawFilter||(N._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:g?C._frameId:++C._frameId,cacheTimeCost:0});var Y=function(){if(C.overlappingBox.clear(),C._81O=y,N.clear(N.DEPTH_BUFFER_BIT),pd(N,E.uBrightness,1),pd(N,E.uOpacity,1),pd(N,E.uPartOpacity,1),N._picking=!!g,pd(N,E.uPick,!!g),pd(N,E.uTexture,!1),pd(N,E.uBlendTexture,!1),pd(N,E.uAlphaTest,c.alphaTest),pd(N,E.uTransparent,!1),pd(N,E.uFix,!1),pd(N,E.uBatchColor,!1),pd(N,E.uBatchBlend,!1),pd(N,E.uBatchBrightness,!1),pd(N,E.uReflectivity,C._envmapReflectivity||.5),pd(N,E.uCameraPosition,C.getEye()),pd(N,E.uPMatrix,C._projectMatrix=ke(C)),pd(N,E.uViewMatrix,Qg(C,C._7O)),C.bindEnvMap(N),C._viewMatrix=ab(C._7O),g||(Am(C,N,E),C._fogDisabled||(pd(N,E.uFogColor,C._fogColor),pd(N,E.uFogNear,C._fogNear),pd(N,E.uFogFar,C._fogFar))),xr(N,E.aPosition),xr(N,E.aNormal),gk(N,E.aUv),gk(N,E.aBatchColor),gk(N,E.aBatchBlend),gk(N,E.aBatchBrightness),gk(N,E.aLineDistance),u){var f=N.getParameter(N.COLOR_CLEAR_VALUE);N.clearColor(0,0,0,0),N.disable(N.BLEND),gk(N,E.aNormal),nl(N,C._cube.vs,y,E.aPosition),pp(N,C._cube.is),As(u,C,Cb,0),As(u,C,jd,6),As(u,C,Fq,12),As(u,C,Oo,18),As(u,C,Zp,24),As(u,C,Yg,30),xr(N,E.aNormal),kb(N,f)}else if(h){h.value=2;var f=N.getParameter(N.COLOR_CLEAR_VALUE);N.clearColor(0,0,0,0),N.disable(N.BLEND),C._95I(N,E,h),Be(C,h),fn(C,C._polylineModelMap,h),fn(C,C._wireframeModelMap,h),pd(N,E.uTransparent,!0),C._95I(N,E,h,!0),Be(C,h,!0),fn(C,C._polylineModelMap,h,!0),fn(C,C._wireframeModelMap,h,!0),pd(N,E.uTransparent,!1),N.clear(N.DEPTH_BUFFER_BIT),C._swapLineMap(),C._95I(N,E,h,!1,!0),fn(C,C._polylineModelMap,h),fn(C,C._wireframeModelMap,h),C._swapLineMap(),C._swapLineMap(),C._95I(N,E,h,!1,!0),fn(C,C._polylineModelMap,h),fn(C,C._wireframeModelMap,h),pd(N,E.uTransparent,!0),C._95I(N,E,h,!0,!0),fn(C,C._polylineModelMap,h,!0),fn(C,C._wireframeModelMap,h,!0),pd(N,E.uTransparent,!1),C._swapLineMap(),N.disable(N.DEPTH_TEST),C.drawFilter||C._30O._42(N,E,h),N.enable(N.DEPTH_TEST),kb(N,f)}else N.disable(N.BLEND),C.drawSky(N,E),C._31O._42(N,E),C._95I(N,E),Be(C),fn(C,C._polylineModelMap),fn(C,C._wireframeModelMap),N.enable(N.BLEND),pd(N,E.uTransparent,!0),N.depthMask(!1),C._95I(N,E,y,!0),Be(C,y,!0),fn(C,C._polylineModelMap,y,!0),fn(C,C._wireframeModelMap,y,!0),N.depthMask(!0),pd(N,E.uTransparent,!1),N.clear(N.DEPTH_BUFFER_BIT),C._swapLineMap(),N.disable(N.BLEND),C._95I(N,E,y,!1,!0),fn(C,C._polylineModelMap),fn(C,C._wireframeModelMap),N.enable(N.BLEND),pd(N,E.uTransparent,!0),N.depthMask(!1),C._95I(N,E,y,!0,!0),fn(C,C._polylineModelMap,y,!0),fn(C,C._wireframeModelMap,y,!0),N.depthMask(!0),pd(N,E.uTransparent,!1),C._swapLineMap(),N.disable(N.DEPTH_TEST),N.disable(N.BLEND),C._32O._42(N,E),C._30O._42(N,E),C._highlightHelper._42(N,E),N.enable(N.DEPTH_TEST);nl(N,y),pp(N,y)},p=!1,t=s*q,P=d*q,D=C.vr;D.enable&&D._42(N,t,P,Y)&&(p=!0);var B=C.envRenderer;B&&B.enable&&B._42(N,t,P,Y)&&(p=!0);var v=C._postProcessing;v._42(N,t,P,Y,g)&&(p=!0),p||(C.setViewport(N,0,0,s*q,d*q),Y()),C._33Q=!1,C.drawFilter||C.countFrame(),C._doBufferGC(N)}}},enablePostProcessing:function(g,a){return this._postProcessing.enableModule(g,a)},getPostProcessingModule:function(T){return this._postProcessing.getModule(T)},setViewport:function(j,r,_,N,l){this._viewport=[r,_,N,l],j.viewport(r,_,N,l)},getViewport:function(){return this._viewport},setBufferGCInterval:function(E){this._bufferGCInterval=E},_doBufferGC:function(K,B){var w,c,e=K._bufPool,q=0,R=0,h=K._renderInfo.frame,Z=this._bufferGCInterval||10;for(w in e)q++,c=e[w],c&&(B||h-c._fid>Z?(K.deleteBuffer(c._buf),c._buf=null,e[w]=null):R++);if(q/2>R&&q>128){var M={};for(w in e)e[w]&&(M[w]=e[w]);K._bufPool=M}K._validBufCount=R},_swapLineMap:function(){var j=this;q=j._polylineModelMap,j._polylineModelMap=j._polylineModelMapSwap,j._polylineModelMapSwap=q,q=j._wireframeModelMap,j._wireframeModelMap=j._wireframeModelMapSwap,j._wireframeModelMapSwap=q,q=j._polylineIndexMap,j._polylineIndexMap=j._polylineIndexMapSwap,j._polylineIndexMapSwap=q,q=j._wireframeIndexMap,j._wireframeIndexMap=j._wireframeIndexMapSwap,j._wireframeIndexMapSwap=q},_updateSkyBox:function(o){if(this._skyBox&&o){var v=o.property,q=!1,Z=this._skyBox;if("eye"===v||"forceUpdate"===v){var A=this._eye;Z.p3(A[0],A[1],A[2]),q=!0}if("near"===v||"far"===v||"forceUpdate"===v){var u=this._near,V=this._far,G=Z.getFinalScale3d();if(G[0]/=2,G[1]/=2,G[2]/=2,G[0]<=u||G[0]>=V||G[1]<=u||G[1]>=V||G[2]<=u||G[2]>=V){var F=2*u*V/(u+V),z=Math.min(G[0],G[1],G[2]),B=F/z,m=Z.getScale3d();Z.setScale3d(m[0]*B,m[1]*B,m[2]*B),q=!0}}q&&this.invalidateData(Z)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(y){var b=this._skyBox;b&&(this._skyBoxStyleMap&&b.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&b.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&b.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=y,this.ump(this._updateSkyBox,this),y&&(y.dm()&&y.dm().remove(y),this._skyBoxStyleMap=T.Default.clone(y.getStyleMap()),this._skyBoxAnchor3d=y.getAnchor3d(),y.setAnchor3d(.5,.5,.5),this._skyBoxP3=y.p3().slice(0),y.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",b,y)},drawSky:function(l,e,q){var d=this,j=d._skyBox;if(j){var $=d._headlightIntensity,V=vo(d._headlightColor),e=d._prg;1!==$&&(V=[V[0]*$,V[1]*$,V[2]*$]),pd(l,e.uHeadlightColor,[V[0],V[1],V[2],1]);var Q=d.getData3dUI(j);Q&&Q._42(l,e,q,function(){return!0}),l.clear(l.DEPTH_BUFFER_BIT),pd(l,e.uHeadlightColor,[V[0],V[1],V[2],d._headlightDisabled?1:0])}},_95I:function(u,T,g,l,M){function G(F){if(!!F.s("shape3d.alwaysOnTop")==!!M&&o.isVisible(F)&&(!k||I)){if(!g&&o.isTransparentMask(F))return;var n=o.getData3dUI(F);n&&n._42(u,T,g,K)}}var o=this,K=function(P){return l?P:!P};o.sky&&u.clear(u.DEPTH_BUFFER_BIT);var Y=o.drawFilter;Y?o.dm().each(function(D){Y(D)||G(D)}):o.dm().each(function(D){G(D)})},getLogicalPoint:function(k){return Zf(k,this._canvas)},isRectOverlapping:function(E){var U=this.getData3dUI(E);return U._rectOverlapping},getHitFaceInfo:function(o){o.target&&(o=this.lp(o));var $=this.getDataInfoAt(o);if($){var n=this._1o.face($.data,ii(o.x,o.y));if(n)return{data:$.data,face:n}}return y},unproject:function(A,p){var h=this,E=h.getWidth(),T=h.getHeight(),o=A.target?h.lp(A):A,c=o.x-E/2,i=o.y-T/2,X=2*(c/E),Z=2*(-1*i/T);p=p||0;var y=mj(),x=ke(h),l=Qg(h);Jg(y,x,l),Oe(y);var P=Ee([X,Z,p,1],y);return[P[0]/P[3],P[1]/P[3],P[2]/P[3]]},getDataAt:function(r){var n=this.getDataInfoAt(r);return n?n.data:y},getDataInfoAt:function(u,s){return u.target&&(u=this.lp(u)),this._1o.get(ii(u.x,u.y,s),!0)},getDatasInRect:function(E){return this._1o.get(E)},setEditable:function(B){var q=this,N=q._editable;q._editable=B,this.fp(Km,N,B)},isEditable:function(Y){var J=this;return J._editable?Np(Y)?Y.s("3d.editable")?J._editableFunc?J._editableFunc(Y):!0:!1:!1:!1},isSelectable:function(q){return q.s("3d.selectable")&&this.sm().isSelectable(q)},isMovable:function(u){var C=this;return Nl(u)&&u.getStyle(Zn)!==ph?!1:u.s("3d.movable")?C._movableFunc?C._movableFunc(u):!0:!1},isSizeEditable:function(W){return Np(W)?this._sizeEditableFunc?this._sizeEditableFunc(W):!0:!1},isRotationEditable:function(J){return Np(J)&&J.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(J):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(M){this.setZoom(tk,M)},zoomOut:function(W){this.setZoom(1/tk,W)},setZoom:function(b,q){if(1!==b){var w=this;if(w._ortho)return w.setOrthoZoom(b,q),void 0;w._14o&&w._14o.stop(!0);var p=1/b,a=w._eye,Q=w._center,e=Q[0]+(a[0]-Q[0])*p-a[0],d=Q[1]+(a[1]-Q[1])*p-a[1],L=Q[2]+(a[2]-Q[2])*p-a[2];if(!(kk(a,Q)<w._moveStep&&1>p)){if(q=yk(q)){var A=zf(a);return q.action=function(g){w.fi({kind:w._zooming?"betweenZoom":"beginZoom"}),w._zooming=1,a[0]=A[0]+e*g,a[1]=A[1]+d*g,a[2]=A[2]+L*g,w.fp(ko,y,a)},q._37o=function(){delete w._14o,delete w._zooming,w.fi({kind:"endZoom"}),w.onZoomEnded()},w._14o=Sh(q)}a[0]+=e,a[1]+=d,a[2]+=L,w.fp(ko,y,a)}}},setOrthoZoom:function(u,X){if(1!==u){var W=this;W._14o&&W._14o.stop(!0);var A=W._orthoWidth,U=A/u-A;if(!(A<W._moveStep&&u>1))return(X=yk(X))?(X.action=function(n){W.fi({kind:W._zooming?"betweenZoom":"beginZoom"}),W._zooming=1,W.setOrthoWidth(A+U*n)},X._37o=function(){delete W._14o,delete W._zooming,W.fi({kind:"endZoom"}),W.onZoomEnded()},W._14o=Sh(X)):(W.setOrthoWidth(A/u),void 0)}},getPositionInfo:function(n){var g=this,e=g._eye,h=g._center,O=g.getAspect(),E=n?_f(yi(h,e,!0),yi(n,e)):kk(e,h);if(g._ortho){var A=g._orthoWidth;return{length:E,height:A/O,width:A}}var Y=2*z(g._fovy/2)*E;return{length:E,height:Y,width:Y*O}},getCenterInfo:function(){var $=this;return $._81O||($._81O=$.getPositionInfo()),zf($._81O)},rotate:function(n,U,u,A){var M=this;if(n||U){A==y&&(A=M._firstPersonMode),M._88O&&M._88O.stop(!0);var H=M._center,z=M._eye,_=M.getCenterInfo().length,L=A?H:z,o=A?z:H,E=yi(L,o),d=B(E[0],E[2]),X=B(W(E[0]*E[0]+E[2]*E[2]),E[1]),D=A?qd:ko;return A&&(U=-U),(u=yk(u))?(u.action=function(O){M.fi({kind:M._rotating?"betweenRotate":"beginRotate"}),M._rotating=1;var p=d+n*O,H=X+U*O;H=bc(H),E[0]=_*f(H)*f(p),E[1]=_*G(H),E[2]=_*f(H)*G(p),L[0]=o[0]+E[0],L[1]=o[1]+E[1],L[2]=o[2]+E[2],M.fp(D,y,L)},u._37o=function(){delete M._88O,delete M._rotating,M.fi({kind:"endRotate"}),M.onRotateEnded()},M._88O=Sh(u)):(d+=n,X+=U,X=bc(X),E[0]=_*f(X)*f(d),E[1]=_*G(X),E[2]=_*f(X)*G(d),L[0]=o[0]+E[0],L[1]=o[1]+E[1],L[2]=o[2]+E[2],M.fp(D,y,L),void 0)}},pan:function(R,Q,n,e){if(R||Q){var t=this;e==y&&(e=t._firstPersonMode),t._89O&&t._89O.stop(!0);var $=Qg(t),L=[$[0]*R,$[4]*R,$[8]*R],w=[$[1]*Q,$[5]*Q,$[9]*Q],j=L[0]+w[0],d=L[1]+w[1],U=L[2]+w[2],I=t._center,g=t._eye;if(e){var r=Wc(t.getBoundaries(),g[0],g[2],g[0]+j,g[2]+U,W(j*j+U*U));j=r[0],U=r[1]}if(n=yk(n)){var a=zf(g),v=zf(I);return n.action=function(x){t.fi({kind:t._panning?"betweenPan":"beginPan"}),t._panning=1,I[0]=v[0]+j*x,I[1]=v[1]+d*x,I[2]=v[2]+U*x,g[0]=a[0]+j*x,g[1]=a[1]+d*x,g[2]=a[2]+U*x,t.fp(ko,y,g),t.fp(qd,y,I)},n._37o=function(){delete t._89O,delete t._panning,t.fi({kind:"endPan"}),t.onPanEnded()},t._89O=Sh(n)}I[0]+=j,I[1]+=d,I[2]+=U,g[0]+=j,g[1]+=d,g[2]+=U,t.fp(ko,y,g),t.fp(qd,y,I)}},walk:function(u,G,X){if(u){var f=this;X==y&&(X=f._firstPersonMode),f._90O&&f._90O.stop(!0);var t=f._center,Y=f._eye,Q=yi(t,Y,!0);if(X){var Z=Wc(f.getBoundaries(),Y[0],Y[2],Y[0]+Q[0]*u,Y[2]+Q[2]*u,h(u));if(u=kk(Z),!u)return;Q=[Z[0]/u,0,Z[1]/u]}if(G=yk(G)){var J=zf(Y),l=zf(t);return G.action=function(r){f.fi({kind:f._walking?"betweenWalk":"beginWalk"}),f._walking=1;var g=u*r;Y[0]=J[0]+Q[0]*g,Y[1]=J[1]+Q[1]*g,Y[2]=J[2]+Q[2]*g,t[0]=l[0]+Q[0]*g,t[1]=l[1]+Q[1]*g,t[2]=l[2]+Q[2]*g,f.fp(ko,y,Y),f.fp(qd,y,t)},G._37o=function(){delete f._90O,delete f._walking,f.fi({kind:"endWalk"}),f.onWalkEnded()
},f._90O=Sh(G)}Y[0]+=Q[0]*u,Y[1]+=Q[1]*u,Y[2]+=Q[2]*u,t[0]+=Q[0]*u,t[1]+=Q[1]*u,t[2]+=Q[2]*u,f.fp(ko,y,Y),f.fp(qd,y,t)}},handleScroll:function(Q,v){Q.preventDefault();var r=this,N=r._moveStep,e=r.getDataInfoAt(Q);if(e){var G=e.data;if(G&&r.isInteractive(G)){var C=r.intersectObject(Q,G);if(C){var q=C.part,A=qp(G.s(q+".image")||G.s("shape3d."+q+".image")||G.s("all.image")||G.s("shape3d.image"));if(A&&$f(A.scrollable,G,r))return}}}r.isFirstPersonMode()?r.isPannable()&&r.pan(0,v>0?N:-N):r.isZoomable()&&r.setZoom(0>v?1/Pd:Pd)},handlePinch:function(y,d){this.isZoomable()&&this.setZoom(d>y?1/Zl:Zl)},reset:function(){this.setCenter(N.graph3dViewCenter),this.setEye(N.graph3dViewEye),this.setUp(N.graph3dViewUp)},moveSelection:function(n,c,t){var o=this;o.dm().beginTransaction(),ze(this.sm().toSelection(this.isMovable,this),n,c,t),o.dm().endTransaction()},getMoveMode:function(N,s){var D=s.s("3d.move.mode");if(D)return D;var i="88",B="89",z="90";return im(N)||cn[i]&&cn[B]&&cn[z]?"xyz":cn[i]&&cn[B]?"xy":cn[i]&&cn[z]?"xz":cn[B]&&cn[z]?"yz":cn[i]?"x":cn[B]?"y":cn[z]?"z":"xz"},handleTick:function(){var A=this,d=!1,q=A._moveStep,B=q,T=!1,r=!0,f=A._rotateStep*(r?-1:1);if(A.isWalkable()||(B=0),A.isPannable()||(q=0),A.isRotatable()||(f=0),A._32Q){var l=(vb()-A._32Q)/50;B*=l,q*=l,f*=l}A._31Q&&(vn(A._31Q),delete A._31Q,delete A._32Q),Ji()&&(d=!0,A.pan(-q,0,T,r)),mc()&&(d=!0,A.pan(q,0,T,r)),Gc()&&(d=!0,im()?A.pan(0,q,T,r):A.walk(B,T,r)),Pg()&&(d=!0,im()?A.pan(0,-q,T,r):A.walk(-B,T,r)),Oc()&&(d=!0,A.rotate(-f,0,T,r)),pe()&&(d=!0,A.rotate(f,0,T,r)),kr()&&(d=!0,A.rotate(0,-f/2,T,r)),bq()&&(d=!0,A.rotate(0,f/2,T,r)),d&&(A._32Q=vb(),A._31Q=_o(A.handleTick,A))},handleKeyDown:function(K){var n=this;!xj(K)&&gh[K.keyCode]?n.handleTick():Yf(K)?n.selectAll():ol(K)?n.handleDelete(K):gb(K)&&this.isResettable()&&n.reset()},checkDoubleClickOnNote:function(Q,$,A){var N=this;if(A===yj){if($.s("note.toggleable"))return $.s(_n,!$.s(_n)),N.fi({kind:"toggleNote",event:Q,data:$,part:A}),!0}else if(A===zi&&$.s("note2.toggleable"))return $.s(xn,!$.s(xn)),N.fi({kind:"toggleNote2",event:Q,data:$,part:A}),!0;return!1},checkDoubleClickOnRotation:function(n,L,d){return d===Zb?(L.setRotationX(0),!0):d===gd?(L.setRotationY(0),!0):d===on?(L.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(S){var g=this;if(g.isOrtho())return g.getWidth()/g.getOrthoWidth();var k=g.getCenter(),L=g.getHeight(),y=g.getEye(),H=[k[0]-y[0],k[1]-y[1],k[2]-y[2]],x=[S[0]-y[0],S[1]-y[1],S[2]-y[2]],M=Math.sqrt(H[0]*H[0]+H[1]*H[1]+H[2]*H[2]),m=1/Math.tan(g.getFovy()/2);return L*M*m/(x[0]*H[0]+x[1]*H[1]+x[2]*H[2])},inViewSpace:function(M){var s,w=this,P=w._transformPointToViewSpace(M),T=w.getAspect(),i=w.getNear(),r=w.getFar();return-P[2]<i||-P[2]>r?!1:w.isOrtho()?(s=w.getOrthoWidth()/2,Math.abs(P[0])<=s&&Math.abs(P[1]*T)<=s):(s=Math.sqrt(P[0]*P[0]+P[1]*P[1]+P[2]*P[2])*Math.tan(w.getFovy()/2),Math.abs(P[1]<=s)&&Math.abs(P[0])<=s*T)},toViewPosition:function(s){var M=this,w=M.getWidth()/2,k=M.getHeight()/2,S=M._18Q;return S&&S._wh===w/k||(S=ke(M),M._18Q=Jg(S,S,Qg(M)),M._18Q._wh=w/k),s=Ee([s[0],s[1],s[2],1],S),{x:w+w*s[0]/s[3],y:k-k*s[1]/s[3]}},getHitPosition:function(O,K,D){var _=this,B=_.getWidth(),b=_.getHeight(),C=O.target?_.lp(O):O,E=C.x-B/2,t=C.y-b/2,S=_.getCenterInfo(),h=Qg(_);K=K?K:[0,0,0],D=D?D:[0,1,0],E=E/B*S.width,t=-1*t/b*S.height;var m=[h[0]*E,h[4]*E,h[8]*E],V=[h[1]*t,h[5]*t,h[9]*t],q=[m[0]+V[0],m[1]+V[1],m[2]+V[2]],k=_.getCenter(),e=Me(_,K,D,[q[0]+k[0],q[1]+k[1],q[2]+k[2]]);return e?e:[0,0,0]},intersectObject:function(w,U){return this._raycaster.intersectObject(w,U)},intersectObjects:function(E,l,s){return this._raycaster.intersectObjects(E,l,s)},getLineLength:function(O){this.validate();var V=this.getData3dUI(O);if(V&&V.getCache){var _=V.getCache();if(_)return _[_.length-1].length}return 0},getLineOffset:function(V,p){var m=this.getData3dUI(V);if(m&&m.getCache){var z=m.getCache();if(z)return to(z,p)}return y},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(c,j,g){var V=this,C=V.getEye();C=[C[0],C[1],C[2]];var W=V.getCenter();if(W=[W[0],W[1],W[2]],c||(c=C),j||(j=W),V._flyAnim&&V._flyAnim.stop(!0),g=yk(g),!g)return V.setEye(c[0],c[1],c[2]),V.setCenter(j[0],j[1],j[2]),delete V._flyAnim,!0;var R=[c[0]-C[0],c[1]-C[1],c[2]-C[2]],k=[j[0]-W[0],j[1]-W[1],j[2]-W[2]];return g.action=function(e){V.setCenter(W[0]+k[0]*e,W[1]+k[1]*e,W[2]+k[2]*e),V.setEye(C[0]+R[0]*e,C[1]+R[1]*e,C[2]+R[2]*e)},g._37o=function(){delete V._flyAnim},V._flyAnim=Sh(g)},flyTo:function(){function $(M,X,A){if(A instanceof T.Node){w.fromArray(Wr(A,X.getMat(A)));var q=A.getAnchor3d();M.push((new jf).set(0-q.x,0-q.y,0-q.z).applyMatrix4(w)),M.push((new jf).set(0-q.x,0-q.y,1-q.z).applyMatrix4(w)),M.push((new jf).set(0-q.x,1-q.y,0-q.z).applyMatrix4(w)),M.push((new jf).set(0-q.x,1-q.y,1-q.z).applyMatrix4(w)),M.push((new jf).set(1-q.x,0-q.y,0-q.z).applyMatrix4(w)),M.push((new jf).set(1-q.x,0-q.y,1-q.z).applyMatrix4(w)),M.push((new jf).set(1-q.x,1-q.y,0-q.z).applyMatrix4(w)),M.push((new jf).set(1-q.x,1-q.y,1-q.z).applyMatrix4(w))}}var p=new jf,L=new jf,B=new jf,x=new jf,w=new El,O=new T.Math.Quaternion,X=new Xj;return function(r,n,E){var J=this;if(E!==d)n={animation:n,ratio:E};else{var S=typeof n;("boolean"===S||"object"===S&&n.duration)&&(n={animation:n})}n=n||{},p.fromArray(J.getEye()),L.fromArray(J.getCenter());var u,v,Z=[],A=n.center,V=n.distance===d;if(A&&B.fromArray(A),r instanceof T.Node)A||B.fromArray(r.p3()),V&&($(Z,J,r),u=Z.length);else{if(r||(r=J.dm().getDatas()),!r.length)return;if((V||!A)&&(Z=[],r.forEach(function(L){$(Z,J,L)}),u=Z.length),!u)return;if(!A){for(B.set(0,0,0),v=0;u>v;v++)B.add(Z[v]);B.multiplyScalar(1/u)}}if(J.setCenter(B.x,B.y,B.z),x.subVectors(p,L),n.direction||n.worldDirection){!n.worldDirection&&r instanceof T.Node?O.setFromEuler(X.set(r.r3(),r.getRotationMode(),!0)):O.set(0,0,0,1);var q=x.length();x.fromArray(n.worldDirection||n.direction).applyQuaternion(O).setLength(q)}if(V){for(var W,c,h,M,o,C=J.getNear(),K=10,E=n.ratio||.8;K--;){for(J._eye[0]=x.x+B.x,J._eye[1]=x.y+B.y,J._eye[2]=x.z+B.z,W=ke(J),Jg(W,W,Qg(J)),M=!0,o=-1/0,v=0;u>v;v++){if(h=Z[v],c=Ee([h.x,h.y,h.z,1],W),c[3]<C&&K){x.multiplyScalar(2),M=!1;break}o=Math.max(o,Math.max(Math.abs(c[0]),Math.abs(c[1]))/E-c[3])}if(M)break}x.setLength(o+x.length()).add(B)}else x.setLength(n.distance).add(B);J._flyAnim&&J._flyAnim.stop(!0);var m=yk(n.animation);if(m){J.setEye(p.x,p.y,p.z),J.setCenter(L.x,L.y,L.z);var H=(new jf).subVectors(x,p),G=(new jf).subVectors(B,L),I=new jf,w=new jf;return m.action=function(S){I.copy(p).addScaledVector(H,S),w.copy(L).addScaledVector(G,S),J.setCenter(w.x,w.y,w.z),J.setEye(I.x,I.y,I.z)},m._37o=function(){delete J._flyAnim},{lastEye:p,lastCenter:L,eye:x,center:B,animation:J._flyAnim=Sh(m)}}return J.setEye(x.x,x.y,x.z),delete J._flyAnim,{lastEye:p,lastCenter:L,eye:x,center:B}}}(),getBoundingBox:function(){function u(F,S,G){C.fromArray(Wr(G,S.getMat(G)));var t=G.getAnchor3d();F.push((new jf).set(0-t.x,0-t.y,0-t.z).applyMatrix4(C)),F.push((new jf).set(0-t.x,0-t.y,1-t.z).applyMatrix4(C)),F.push((new jf).set(0-t.x,1-t.y,0-t.z).applyMatrix4(C)),F.push((new jf).set(0-t.x,1-t.y,1-t.z).applyMatrix4(C)),F.push((new jf).set(1-t.x,0-t.y,0-t.z).applyMatrix4(C)),F.push((new jf).set(1-t.x,0-t.y,1-t.z).applyMatrix4(C)),F.push((new jf).set(1-t.x,1-t.y,0-t.z).applyMatrix4(C)),F.push((new jf).set(1-t.x,1-t.y,1-t.z).applyMatrix4(C))}var C=new El;return function(c){if(c=c||this.sm().getSelection(),c instanceof T.Node&&(c=[c]),0===c.length)return y;var Y=[];c.forEach(function(I){u(Y,this,I)},this);var D=[1/0,1/0,1/0],m=[-1/0,-1/0,-1/0];return Y.forEach(function(f){D[0]=Math.min(f.x,D[0]),D[1]=Math.min(f.y,D[1]),D[2]=Math.min(f.z,D[2]),m[0]=Math.max(f.x,m[0]),m[1]=Math.max(f.y,m[1]),m[2]=Math.max(f.z,m[2])}),{min:D,max:m}}}()}),nf.RenderEnv=function(S){this.gv=S,this.enable=!1},M.defineProperties(nf.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(S){this._debugOn=S,this.capture&&this.capture()}}}),M.assign(nf.RenderEnv.prototype,{renderEnvToCube:function($,Z,H,C){var q=this,N=q.gv;if(!$||!Z||!H)return q.enable=!1,q._42=null,void 0;q.enable=!0;var z=Math.floor(C/$*Z),X=N.getGL(),j=q._renderTargets;j?j.length<H&&(j=q._renderTargets=j.concat(new Array(H-j.length))):j=q._renderTargets=new Array(H);for(var R=0;H>R;R++)j[R]?j[R].setSize(X,C,z):j[R]=new nf.RenderTarget(N,X,C,z);var S=!1;q.capture=function(){S=!0,N._42(),S=!1};var I=new jf,F=new jf,Q=new jf,_=new jf,o=(new jf).setY(0),x=2*Math.PI/H,K=$/2/Math.tan(Math.PI/H),h=2*Math.atan2(Z/2,K),n=$/Z;q._42=function(T,U,b,m){var X=q._debugOn;if(!S&&!X)return!1;I.copy(N.getEye()),_.copy(N.getCenter()).sub(I);var r=Math.atan2(_.z,_.x),f=N.getNear(),R=N.getFovy(),e=N.getAspect();F.copy(N.getCenter());for(var C,l=0;H>l;l++)if(C=j[l],o.setZ(Math.cos(r)).setX(Math.sin(r)).multiplyScalar(K),r-=x,Q.addVectors(I,o),N.setNear(K),N.setCenter([Q.x,Q.y,Q.z]),N.setFovy(h),N.setAspect(n),X){var y=Math.round(U/H);T.viewport(y*l,0,y,b),m()}else cc(T,C.frame),T.viewport(0,0,C.width,C.height),T.clear(T.COLOR_BUFFER_BIT),m(),Ur(T),C.assureTexture();return N.setNear(f),N.setCenter([F.x,F.y,F.z]),N.setFovy(R),N.setAspect(e),!0},q.capture()},getTextureInfo:function(C){var n=this._renderTargets;if(!n)return null;var K=this._renderTargets[C];return K?{index:C,texture:K.texture,textureName:K.uuid}:null}}),M.assign(nf.Graph3dView.prototype,{renderEnvToCube:function(M,S,B,j){var H=this;H.envRenderer||(H.envRenderer=new nf.RenderEnv(H)),H.envRenderer.renderEnvToCube(M,S,B,j)}}),nf.RenderTarget=function(L,I,H,A,R){var M=this;R=R||{},M.uuid=T.Math.generateUUID(),M.gv=L,M.init(L,I,R),M.setSize(I,H,A)},M.assign(nf.RenderTarget.prototype,{init:function(T,e,S){var I=this,V=I.texture=e.createTexture();e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,V),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,S.minFilter||e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,S.magFilter||e.LINEAR),e.bindTexture(e.TEXTURE_2D,null),I.render=e.createRenderbuffer(),I.frame=e.createFramebuffer(),T._2O[I.uuid]=V},assureTexture:function(){var T=this,I=T.uuid,l=T.gv._2O;l[I]||(l[I]=T.texture)},setSize:function(q,K,j){var D=this;if(D.width!==K||D.height!==j){var c=q.RGBA,L=q.TEXTURE_2D,z=q.RENDERBUFFER,w=q.FRAMEBUFFER;Hk(q,D.texture),q.texImage2D(L,0,c,K,j,0,c,q.UNSIGNED_BYTE,y),q.bindRenderbuffer(z,D.render),q.renderbufferStorage(z,q.DEPTH_COMPONENT16,K,j),cc(q,D.frame),q.framebufferTexture2D(w,q.COLOR_ATTACHMENT0,L,D.texture,0),q.framebufferRenderbuffer(w,q.DEPTH_ATTACHMENT,z,D.render),Hk(q,y),q.bindRenderbuffer(z,y),Ur(q),D.width=K,D.height=j}},toCanvas:function(){var Z=this,p=Z.gv.getGL();cc(p,Z.frame);var l=Z.width,U=Z.height,v=new Uint8Array(4*l*U);p.readPixels(0,0,l,U,p.RGBA,p.UNSIGNED_BYTE,v),Ur(p);var y=r.createElement("canvas");y.width=l,y.height=U;var G=y.getContext("2d"),D=G.createImageData(l,U);return D.data.set(v),G.putImageData(D,0,0),y}});var _i=nf.Interactor=function(X){this.gv=X};xe("Interactor",M,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Zj=nf.DefaultInteractor=function(a){hg(Zj,this,[a])};xe("DefaultInteractor",_i,{handle_contextmenu:function(q){Mf(q)},handle_mousewheel:function(L){this.gv.handleScroll(L,L.wheelDelta/40)},handle_DOMMouseScroll:function(R){2===R.axis&&this.gv.handleScroll(R,-R.detail)},handle_keydown:function(p){this.gv.handleKeyDown(p)},handle_mousedown:function(v){this.handle_touchstart(v)},handle_touchstart:function(M){Mf(M);var S=this,_=S.gv,T=fq(M),i=_.getDataInfoAt(M),f=i?i.data:y,v=i?i.part:y,g=_.sm(),w=Hg(M),m=kl(M);_.setFocus(M)&&(S._62O=y,S._57I=y,f?xj(M)?g.co(f)?g.rs(f):g.as(f):g.co(f)||g.ss(f):T&&(xj(M)?_.isRectSelectable()&&(S._62O=Bi):S._57I=Ne(M)),S._31Q&&(vn(S._31Q),delete S._31Q,delete S._32Q),S._62O||(_.isFirstPersonMode()&&(im(M)||m>2?S._62O="pan":_.isMouseRoamable()||jm?(S._62O="roaming",S.foward=w&&fq(M),S._32Q=vb(),S._31Q=_o(S.tick,S)):T||(S._62O="roaming")),S._62O||(T&&w&&wn[v]?(S._62O=v,S.p3=f.p3()):T&&w&&Np(f)&&_.isSelected(f)?_.isMovable(f)?(S._62O="move",S.p3=f.p3(),S.movedata=f):_.isInteractive(f)&&(S._62O="none"):jm&&(m>2?S._62O="pan":2===m&&(S.dist=_d(M),S._62O="pinch")))),S.point=_.lp(M),Ej(S,M),_h(M)?_.handleDoubleClick(M,f,v):_.handleClick(M,f,v))},tick:function(){var c=this,T=c.gv,z=T._moveStep;c.point&&T.isWalkable()&&(c._32Q&&(z*=(vb()-c._32Q)/50),T.walk(c.foward?z:-z),c._32Q=vb(),c._31Q=_o(c.tick,c))},handle_mouseup:function(z){this.handle_touchend(z)},handle_touchend:function(Z){var f=this._57I;f&&(kk(f,Ne(Z))<=1&&this.gv.sm().cs(),this._57I=y)},handleWindowMouseMove:function(V){this.handleWindowTouchMove(V)},handleWindowTouchMove:function(z){var O,i,p=this,q=p.gv,D=p._62O,w=p.point,Z=q.dm(),f=q.lp(z),Q=f.x-w.x,B=f.y-w.y,C=q.getWidth(),g=q.getHeight();if(C&&g){var x=-t*Q/C,W=-t*B/g;if("roaming"===D)p.rotate(z,x/2,W/2);else if(D===Zb||D===gd||D===on)q._86O||Z.beginTransaction(),q.fi({kind:q._86O?"betweenEditRotation":"beginEditRotation",event:z}),q._86O=1,q.sm().each(function(Z){if(Np(Z)&&q.isRotationEditable(Z)){var Y=h(x)>h(W)?x:W;D===Zb?Z.setRotationX(Z.getRotationX()+Y):D===gd?Z.setRotationY(Z.getRotationY()+Y):D===on&&Z.setRotationZ(Z.getRotationZ()+Y)}});else if("move"===D||wn[D]){D===Ti||D===de||D===Zh?(q._87O||Z.beginTransaction(),q.fi({kind:q._87O?"betweenEditScale":"beginEditScale",event:z}),q._87O=1):(q._moving||Z.beginTransaction(),q.fi({kind:q._moving?"betweenMove":"beginMove",event:z}),q._moving=1);var n,r=p.p3,X=q.getPositionInfo(r),J=Qg(q);n=D===pc?"x":D===lf?"y":D===dp?"z":D===Ti?"sx":D===de?"sy":D===Zh?"sz":q.getMoveMode(z,p.movedata),Q=Q/C*X.width,B=-1*B/g*X.height;var m,v,l=[J[0]*Q,J[4]*Q,J[8]*Q],e=[J[1]*B,J[5]*B,J[9]*B],T=l[0]+e[0],U=l[1]+e[1],H=l[2]+e[2],M=[r[0]+T,r[1]+U,r[2]+H],N=yi(q.getEye(),M,!0);if("xyz"===n?(m=M,q.moveSelection(T,U,H)):"xz"===n?(m=Me(q,r,[0,1,0],M),m&&q.moveSelection(m[0]-r[0],0,m[2]-r[2])):"xy"===n?(m=Me(q,r,[0,0,1],M),m&&q.moveSelection(m[0]-r[0],m[1]-r[1],0)):"yz"===n?(m=Me(q,r,[1,0,0],M),m&&q.moveSelection(0,m[1]-r[1],m[2]-r[2])):"x"===n||"sx"===n?(N[0]=0,m=Me(q,r,N,M),m&&(v=m[0]-r[0],"x"===n?q.moveSelection(v,0,0):q.sm().each(function(K){Np(K)&&q.isSizeEditable(K)&&(O=K.getScaleX()+v/100,i=O/K.getScaleX(),K.setScaleX(O),im(z)&&(K.setScaleY(K.getScaleY()*i),K.setScaleTall(K.getScaleTall()*i)))}))):"y"===n||"sy"===n?(N[1]=0,m=Me(q,r,N,M),m&&(v=m[1]-r[1],"y"===n?q.moveSelection(0,v,0):q.sm().each(function(n){Np(n)&&q.isSizeEditable(n)&&(O=n.getScaleTall()+v/100,i=O/n.getScaleTall(),n.setScaleTall(O),im(z)&&(n.setScaleY(n.getScaleY()*i),n.setScaleX(n.getScaleX()*i)))}))):("z"===n||"sz"===n)&&(N[2]=0,m=Me(q,r,N,M),m&&(v=m[2]-r[2],"z"===n?q.moveSelection(0,0,v):q.sm().each(function(n){Np(n)&&q.isSizeEditable(n)&&(O=n.getScaleY()+v/100,i=O/n.getScaleY(),n.setScaleY(O),im(z)&&(n.setScaleX(n.getScaleX()*i),n.setScaleTall(n.getScaleTall()*i)))}))),!m)return;p.p3=m}else if(D===Bi){var R=p.div;R||(R=p.div=Mg(),Ah(p.getView(),R),R.op=w,R.style.background=q.getRectSelectBackground()),q.fi({kind:q._rectSelecting?"betweenRectSelect":"beginRectSelect",event:z}),q._rectSelecting=1,R.rect=wm(R.op,f),Ce(R,R.rect)}else if("pinch"===D&&2===kl(z)){q.fi({kind:q._pinching?"betweenPinch":"beginPinch",event:z}),q._pinching=1;var v=_d(z);q.handlePinch(v,p.dist),p.dist=v}else"pan"===D||im(z)?p.pan(z,Q,B):"none"===D||q.isFirstPersonMode()||(fq(z)?p.rotate(z,x,W):(p.pan(z,Q,0),q.isWalkable()&&(q.fi({kind:q._walking?"betweenWalk":"beginWalk",event:z}),q._walking=1,q.walk(B/q.getHeight()*q.getCenterInfo().height))));p.point=f}},pan:function(C,n,H){var _=this.gv;if(_.isPannable()){var N=_.getWidth(),W=_.getHeight();if(!N||!W)return;var O=_.getCenterInfo(),a=n/N*O.width,m=-1*H/W*O.height;_.fi({kind:_._panning?"betweenPan":"beginPan",event:C}),_._panning=1,_.pan(-a,-m)}},rotate:function(U,j,z){var h=this.gv;h.isRotatable()&&(h.fi({kind:h._rotating?"betweenRotate":"beginRotate",event:U}),h._rotating=1,h.rotate(j,z))},handleWindowMouseUp:function(s){this.handleWindowTouchEnd(s)},handleWindowTouchEnd:function(J){var b=this,S=b.gv,M=S.dm(),F=b.div;if(F){var e=S.getDatasInRect(F.rect);if(!e.isEmpty()){var A=S.sm(),U=A.toSelection();e.each(function(d){A.co(d)?U.remove(d):U.add(d)}),A.ss(U)}Hm(F)}S._moving&&(delete S._moving,S.fi({kind:"endMove",event:J}),S.onMoveEnded(),M.endTransaction()),S._panning&&(delete S._panning,S.fi({kind:"endPan",event:J}),S.onPanEnded()),S._rotating&&(delete S._rotating,S.fi({kind:"endRotate",event:J}),S.onRotateEnded()),S._86O&&(delete S._86O,S.fi({kind:"endEditRotation",event:J}),M.endTransaction()),S._87O&&(delete S._87O,S.fi({kind:"endEditScale",event:J}),M.endTransaction()),S._pinching&&(delete S._pinching,S.fi({kind:"endPinch",event:J}),S.onPinchEnded()),S._rectSelecting&&(delete S._rectSelecting,S.fi({kind:"endRectSelect",event:J}),S.onRectSelectEnded()),S._walking&&(delete S._walking,S.fi({kind:"endWalk",event:J}),S.onWalkEnded()),b.dist=b.point=b._62O=b.p3=b.movedata=b.div=b._57I=b._32Q=b._31Q=b.foward=y}});var qs=nf.MapInteractor=function(e){hg(qs,this,[e]),this._minPhi=0,this._maxPhi=5*p/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right"};xe("MapInteractor",_i,{handle_contextmenu:function(B){Mf(B)},handle_mousewheel:function(x){this.gv.handleScroll(x,x.wheelDelta/40)},handle_DOMMouseScroll:function(y){2===y.axis&&this.gv.handleScroll(y,-y.detail)},handle_keydown:function(B){this.gv.handleKeyDown(B)},handle_mousedown:function(l){this.handle_touchstart(l)},handle_touchstart:function(v){Mf(v);var t=this,H=t.gv;if(H.setFocus(v)){H.lp(v);var a=H.getDataInfoAt(v),g=a?a.data:y,S=a?a.part:y;if(!g||!H.isInteractive(g)){var U=t.editing={point:H.lp(v)};jm?U.touch=!0:(U.touch=!1,U.pan="left"===this.panButton===fq(v)),Ej(t,v)}_h(v)?H.handleDoubleClick(v,g,S):H.handleClick(v,g,S)}},handle_mouseup:function(d){this.handle_touchend(d)},handle_touchend:function(){},handleWindowMouseMove:function(J){this.handleWindowTouchMove(J)},handleWindowTouchMove:function(c){var i=this,O=i.gv,C=i.editing;if(C){var U=O.lp(c),F=C.point,x=U.x-F.x,K=U.y-F.y;if(!C.moved){if(Math.abs(x)<i.threshold&&Math.abs(K)<i.threshold&&!(c.touches&&c.touches.length>1))return;C.moved=!0}if(C.point=U,C.touch){var h=c.touches.length;if(2!==h)i.pan(c,x,K);else{if(1>=h)return;var k=c.touches,X={x:k[0].clientX,y:k[0].clientY},z={x:k[1].clientX,y:k[1].clientY},d={x:z.x-X.x,y:z.y-X.y},Q=C.lastCenter,S=Math.atan2(d.y,d.x),m=C.theta,s=0;m==y?m=C.theta=S:(s=S-m,C.thetaStarted||Math.abs(s)>i.touchRotateThreshold?(C.thetaStarted=!0,C.theta=S):s=0);var H=p*(X.y+z.y)/2/O.getHeight(),V=C.phi,r=0;V==y?V=C.phi=H:(r=H-V,C.phiStarted||Math.abs(r)>i.touchRotateThreshold?(C.phiStarted=!0,C.phi=H):r=0);var v,u=Math.sqrt(d.x*d.x+d.y*d.y),l=C.vlen;if(l){var A=X.x-Q.x,W=X.y-Q.y,D=z.x-Q.x,q=z.y-Q.y,j=Math.sqrt(A*A+W*W),M=Math.sqrt(D*D+q*q),E=l/2,w=i._sign2(j-E),L=i._sign2(M-E);0>w*L||0===w&&0===L?(v=1,C.vlen=u):(v||(v=u/l),C.scaleStarted||Math.abs(v-1)>i.touchScaleThreshold?(C.vlen=u,C.scaleStarted=!0):v=1)}else l=C.vlen=u,v=1;1!==v&&O.setZoom(v),(r||s)&&i.rotate(c,s,-r),C.lastCenter={x:(z.x+X.x)/2,y:(z.y+X.y)/2}}}else if(C.pan)i.pan(c,x,K);else{var Y=O.getWidth(),B=O.getHeight();if(!Y||!B)return;var o=-t*x/Y,J=-t*K/B;i.rotate(c,o,J)}}},_sign2:function(P){return Math.abs(P)<this._touchScaleCheckAccuracy?0:P>0?1:-1},handleWindowMouseUp:function(C){this.handleWindowTouchEnd(C)},handleWindowTouchEnd:function(W){var X=this,Q=X.editing;if(X.editing=null,Q){var d=X.gv;if(!Q.moved&&Q.pan){var O=d.getDataAt(W);O?d.sm().setSelection([O]):d.sm().clearSelection()}else d._panning=null,d._rotating=null,d.fi({kind:Q.pan?"endPan":"endRotate",event:W})}},pan:function(k,M,Z){var r=this,B=r.gv;if(B.isPannable()){var u=B.getWidth(),_=B.getHeight();if(u&&_){var c=B.getCenterInfo(),U=-M/u*c.width,A=1*Z/_*c.height;B.fi({kind:B._panning?"betweenPan":"beginPan",event:k}),B._panning=1;var f=r.keepHorizon,J=r.editing.touch;if((J&&k.touches&&k.touches.length>1||!J&&im(k))&&(f=!f),!f)return B.pan(U,A);if(U||A){var t=Qg(B),F=[t[0]*U,t[4]*U,t[8]*U],p=[t[1],0,t[9]],E=Math.sqrt(p[0]*p[0]+p[2]*p[2]);E&&(p=[p[0]/E*A,0,p[2]/E*A]);var b=F[0]+p[0],j=F[1]+p[1],q=F[2]+p[2],C=B._center,l=B._eye;C[0]+=b,C[1]+=j,C[2]+=q,l[0]+=b,l[1]+=j,l[2]+=q,B.fp(ko,y,l),B.fp(qd,y,C)}}}},rotate:function(c,L,b){var e=this,v=e.gv;if(v.isRotatable()){var i=v._center,w=v._eye,y=yi(w,i),q=B(W(y[0]*y[0]+y[2]*y[2]),y[1]),T=q+b;T=Math.max(e.minPhi,Math.min(e.maxPhi,T)),b=T-q,v.fi({kind:v._rotating?"betweenRotate":"beginRotate",event:c}),v._rotating=1,v.rotate(L,b)}}}),M.defineProperties(qs.prototype,{panButton:{get:function(){return this._panButton},set:function(F){this._panButton=F}},minPhi:{get:function(){return this._minPhi},set:function(U){this._minPhi=U}},maxPhi:{get:function(){return this._maxPhi},set:function(S){this._maxPhi=S}},keepHorizon:{get:function(){return this._keepHorizon},set:function(l){this._keepHorizon=l}},threshold:{get:function(){return this._threshold},set:function(L){this._threshold=L}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(J){this._touchScaleThreshold=J}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(R){this._touchRotateThreshold=R}}});var mg=function(t){this.gv=t};wr(mg,M,{_iv:!0,iv:function(){this._iv=!0},face:function(r,N){var p=this,V=p.gv.getGL();if(!V||!Np(r))return y;var L=N.x,h=N.width,U=N.height,D=p.height-N.y-U,q=C(h/2),n=new Uint8Array(4*h*U),J=0;for(p.iv(),p.validate(r),cc(V,p.frame),V.readPixels(L,D,h,U,V.RGBA,V.UNSIGNED_BYTE,n),Ur(V),p.iv();q>=J;J++)for(var B=q-J,e=q+J,$=B;e>=$;$++)for(var c=B;e>=c;c++)if($===B||$===e||c===B||c===e){var m=Fc.m[n[4*($*h+c)]];if(m)return m}},get:function(K,n){this.validate();var k=this,t=k.gv.getGL();if(!t)return y;var U,R,g=K.x,M=K.width,Q=K.height,G=k.height-K.y-Q,q=C(M/2),j=new Uint8Array(4*M*Q),O=0,A=j.length,D=n?y:new wk,i=n?y:{};if(cc(t,k.frame),t.readPixels(g,G,M,Q,t.RGBA,t.UNSIGNED_BYTE,j),Ur(t),n){for(;q>=O;O++)for(var H=q-O,e=q+O,F=H;e>=F;F++)for(var f=H;e>=f;f++)if((F===H||F===e||f===H||f===e)&&(U=k.info(j,4*(F*M+f))))return U}else for(;A>O;O+=4)U=k.info(j,O),U&&(R=U.data,i[R._id]||(D.add(R),i[R._id]=R));return D},info:function(j,A){return this.colorMap[(j[A]<<16)+(j[A+1]<<8)+j[A+2]+((127&j[A+3])<<24)]},validate:function(G){var K=this,H=K.gv,D=H.getGL();if(D){var r=H.getWidth(),e=H.getHeight(),g=D.RGBA,R=D.TEXTURE_2D,s=D.RENDERBUFFER,o=D.FRAMEBUFFER;K.texture||(K.texture=sm(D),K.render=D.createRenderbuffer(),K.frame=D.createFramebuffer()),(K.width!==r||K.height!==e)&&(Hk(D,K.texture),D.texImage2D(R,0,g,r,e,0,g,D.UNSIGNED_BYTE,y),gi(D,D.TEXTURE_MIN_FILTER,D.LINEAR),D.bindRenderbuffer(s,K.render),D.renderbufferStorage(s,D.DEPTH_COMPONENT16,r,e),cc(D,K.frame),D.framebufferTexture2D(o,D.COLOR_ATTACHMENT0,R,K.texture,0),D.framebufferRenderbuffer(o,D.DEPTH_ATTACHMENT,s,K.render),Hk(D,y),D.bindRenderbuffer(s,y),Ur(D),K.width=r,K.height=e),K._iv&&(K._iv=!1,cc(D,K.frame),H._42(G||(K.colorMap={}),1),Ur(D))}}});var Fm=function(k){this.gv=k};wr(Fm,M,{gap:0,size:0,_42:function(A,I){var i=this,g=i.gv,P=g._gridGap,e=g._gridSize;if(g._gridVisible){if(i.gap!==P||i.size!==e){for(var C=[],f=g._gridSize/2,F=P*f,K=0;2*f+1>K;K++){var L=6*K,n=6*(2*f+1)+L;C[L]=-F,C[L+1]=0,C[L+2]=-F+K*P,C[L+3]=F,C[L+4]=0,C[L+5]=-F+K*P,C[n]=-F+K*P,C[n+1]=0,C[n+2]=-F,C[n+3]=-F+K*P,C[n+4]=0,C[n+5]=F}i.vs=new qc(C),i.gap=P,i.size=e}Ug(g),Cm(A,I),Yq(A),kg(A,I,1,g._gridColor,g._buffer.vs,i.vs),di(A,0,i.vs.length/3,A.LINES),nn(A),Vq(A,I)}else i.vs=i.gap=i.size=y}});var Xd=function(E){this.gv=E};wr(Xd,M,{_42:function(F,S){var R=this.gv,t=R._buffer.vs,j=R._axisXColor,o=R._axisYColor,J=R._axisZColor,H=R._originAxisVisible,K=R._centerAxisVisible;if(H||K){var I=P?F.TRIANGLES:F.TRIANGLE_FAN,u=F.LINES;if(Ug(R),Cm(F,S),Yq(F),H){var E=R.getCenterInfo(),i=Y(E.width,E.height)/5,x=.8*i,f=.05*i;kg(F,S,1.5,j,t,new qc([0,0,0,i,0,0,x,f,0,x,0,f,x,-f,0,x,0,-f,x,f,0,0,0,0,0,i,0,f,x,0,0,x,f,-f,x,0,0,x,-f,f,x,0,0,0,0,0,0,i,f,0,x,0,f,x,-f,0,x,0,-f,x,f,0,x])),di(F,0,2,u),di(F,1,6,I),kg(F,S,y,o),di(F,7,2,u),di(F,8,6,I),kg(F,S,y,J),di(F,14,2,u),di(F,15,6,I)}if(K){var L=R._center,v=L[0],g=L[1],W=L[2],E=R.getPositionInfo(L);i=Y(E.width,E.height)/20,kg(F,S,1.5,j,t,new qc([v,g,W,v+i,g,W,v,g,W,v,g+i,W,v,g,W,v,g,W+i])),di(F,0,2,u),kg(F,S,y,o),di(F,2,2,u),kg(F,S,y,J),di(F,4,2,u)}nn(F),Vq(F,S)}}});var Tm=function(b){this.gv=b,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Tm.Mode.Disable};Tm.Mode={Disable:0,Selection:1,MouseOver:2},wr(Tm,M,{onMouseOver:function(s){N.preventDefault(s);var X=this.gv.getDataAt(s);X!==this.mouseOverData&&(this.mouseOverData=X,this.gv.iv())},setFetchTargetFunc:function(U){this.fetchTargetFunc=U},_42:function(M,x){var l,O=this,o=O._mode;if(o!==Tm.Mode.Disable&&(o===Tm.Mode.Selection?l=O.gv.sm().getSelection().toArray(function($){return $.s("highlight.visible")}):o===Tm.Mode.MouseOver&&O.mouseOverData&&O.mouseOverData.s("highlight.visible")&&(l=[O.mouseOverData]),O.fetchTargetFunc&&(l=O.fetchTargetFunc(l)),l&&l.length)){var U=O.gv,W=U.vr.isPresenting(),z=U.getWidth();if(W){var v=U.getWidth;z/=2,U.getWidth=function(){return z};var q=U.getViewport()}var P,D=U.getDevicePixelRatio(),E=z*D,V=U.getHeight()*D;(P=O._renderTarget)?P.setSize(M,E,V):O._renderTarget=P=new nf.RenderTarget(U,M,E,V),cc(M,P.frame),U.drawFilter=function(q){return l.indexOf(q)<0?!0:void 0},U._42({}),U.drawFilter=null,Ur(M),W&&(U.getWidth=v,U.setViewport(M,q[0],q[1],q[2],q[3])),O.shader||(O.shader=new Hr.Shader(M,Ed.vs,Ed.fs));var Q=O.shader;if(O.shader.bind(),M.enable(M.BLEND),M.activeTexture(M.TEXTURE0+0),M.bindTexture(M.TEXTURE_2D,P.texture),Q.uniforms.image=0,Q.uniforms.textureSize=[E,V],Q.uniforms.edgeWidth=c["highlight.width"],O.highlightColor!==c["highlight.color"]){var p=Wb(O.highlightColor=c["highlight.color"]);O.highlightColorData=[p[0]/255,p[1]/255,p[2]/255,p[3]/255]}Q.uniforms.edgeColor=O.highlightColorData,O.ibuffer?(O.ibuffer.upload(),O.vbuffer.upload()):(O.ibuffer=Hr.Buffer.createIndexBuffer(M,new Uint16Array([0,2,1,1,2,3])),O.vbuffer=Hr.Buffer.createVertexBuffer(M,new Float32Array([0,0,1,0,0,1,1,1]))),Q.attributes.pos.pointer(O.vbuffer),M.drawElements(M.TRIANGLES,6,M.UNSIGNED_SHORT,0),M.disable(M.BLEND),M.bindTexture(M.TEXTURE_2D,null),M.useProgram(x)}}}),M.defineProperties(Tm.prototype,{mode:{get:function(){return this._mode},set:function(C){var t=this._mode;C!==t&&(this._mode=C,C===Tm.Mode.MouseOver?this.gv.getView().addEventListener("mousemove",this.onMouseOver,!1):t===Tm.Mode.MouseOver&&this.gv.getView().removeEventListener("mousemove",this.onMouseOver))}}});var Ed={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Tf=function(s){this.gv=s},pc="edit_tx",lf="edit_ty",dp="edit_tz",Zb="edit_rx",gd="edit_ry",on="edit_rz",Ti="edit_sx",de="edit_sy",Zh="edit_sz",wn={};wn[pc]=1,wn[lf]=1,wn[dp]=1,wn[Zb]=1,wn[gd]=1,wn[on]=1,wn[Ti]=1,wn[de]=1,wn[Zh]=1,wr(Tf,M,{_42:function(d,R,I){var X=this,S=X.gv,D=S.sm().ld();if(D&&S.isEditable(D)&&!S.isEditHelperDisabled()&&Np(D)&&(!S.isFirstPersonMode()||!S.isMouseRoamable()&&!jm)){Ug(S);var t,e,k=S.isMovable(D),p=S.isRotationEditable(D),g=S.isSizeEditable(D),m=S._axisXColor,U=S._axisYColor,O=S._axisZColor,T=S._editSizeColor,E=D.p3(),i=kk(S.getEye(),E)/10,W=i/(I?5:10),F=.7*i,V=.4*F,K=E[0],w=E[1],q=E[2];t=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],k&&X._17O(d,R,D,I,pc,m,t,[K,w-W,q,K+F,w-W,q,K+F,w,q,K+F,w,q,K,w,q,K,w-W,q,K,w-W,q+W,K+F,w-W,q+W,K+F,w-W,q,K+F,w-W,q,K,w-W,q,K,w-W,q+W]),e=K+F,g&&X._17O(d,R,D,I,Ti,T,t,[e,w-W,q,e+V,w-W,q,e+V,w,q,e+V,w,q,e,w,q,e,w-W,q,e,w-W,q+W,e+V,w-W,q+W,e+V,w-W,q,e+V,w-W,q,e,w-W,q,e,w-W,q+W]),e+=V,p&&X._17O(d,R,D,I,Zb,m,t,[e,w-W,q,e+V,w-W,q,e+V,w,q,e+V,w,q,e,w,q,e,w-W,q,e,w-W,q+W,e+V,w-W,q+W,e+V,w-W,q,e+V,w-W,q,e,w-W,q,e,w-W,q+W]),t=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],k&&X._17O(d,R,D,I,lf,U,t,[K,w,q,K,w+F,q,K-W,w+F,q,K-W,w+F,q,K-W,w,q,K,w,q,K,w,q,K,w,q-W,K,w+F,q-W,K,w+F,q-W,K,w+F,q,K,w,q]),e=w+F,g&&X._17O(d,R,D,I,de,T,t,[K,e,q,K,e+V,q,K-W,e+V,q,K-W,e+V,q,K-W,e,q,K,e,q,K,e,q,K,e,q-W,K,e+V,q-W,K,e+V,q-W,K,e+V,q,K,e,q]),e+=V,p&&X._17O(d,R,D,I,gd,U,t,[K,e,q,K,e+V,q,K-W,e+V,q,K-W,e+V,q,K-W,e,q,K,e,q,K,e,q,K,e,q-W,K,e+V,q-W,K,e+V,q-W,K,e+V,q,K,e,q]),t=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],k&&X._17O(d,R,D,I,dp,O,t,[K,w,q,K,w,q+F,K,w-W,q+F,K,w-W,q+F,K,w-W,q,K,w,q,K,w-W,q,K-W,w-W,q,K-W,w-W,q+F,K-W,w-W,q+F,K,w-W,q+F,K,w-W,q]),e=q+F,g&&X._17O(d,R,D,I,Zh,T,t,[K,w,e,K,w,e+V,K,w-W,e+V,K,w-W,e+V,K,w-W,e,K,w,e,K,w-W,e,K-W,w-W,e,K-W,w-W,e+V,K-W,w-W,e+V,K,w-W,e+V,K,w-W,e]),e+=V,p&&X._17O(d,R,D,I,on,O,t,[K,w,e,K,w,e+V,K,w-W,e+V,K,w-W,e+V,K,w-W,e,K,w,e,K,w-W,e,K-W,w-W,e,K-W,w-W,e+V,K-W,w-W,e+V,K,w-W,e+V,K,w-W,e])}},_17O:function(O,g,V,x,s,M,D,z){var L=this.gv._buffer;Lj(O,g,x,!0,V,s),lr(O,g,y,!0,y,!0,y,!1),pd(O,g.uDiffuse,M),nl(O,L.vs,new qc(z),g.aPosition),nl(O,L.ns,new qc(D),g.aNormal),Yq(O),di(O,0,12),nn(O),ar(O,g)}});var ys=T.Raycaster=function(_){this.gv=_,this.maxTriangleTest=1/0};ld("Raycaster",M,{intersect:function(u){var L=this,g=L.gv,o=g.getDataAt(u);return o?L.intersectObject(u,o):null},intersectObjects:function(n,J,q){var e,b,j,P,S=this,T=1/0,o=n.origin||(new jf).fromArray(S.gv.getEye()),E=S.maxTriangleTest,C=[];return J.forEach(function(v){q&&q(v)===!1||v.s("intersect")!==!1&&C.push(v)}),C.sort(function(X,Y){return o.distanceToSquared2(X.p3())-o.distanceToSquared2(Y.p3())}),S.countTriangles=0,C.forEach(function(J){S.countTriangles>E||(e=S.intersectObject(n,J),e&&(b=o.distanceToSquared(e.world),T>b&&(j=J,P=e,T=b)))}),S.countTriangles=0,{data:j,intersect:P}},intersectObject:function(s,a){if(s instanceof Yp)return this._intersectObjectImpl(s,a);var j,M,q=this,k=q.gv;M=k.unproject(s);var i=k.getEye();k.isOrtho()?(j=yi(k.getCenter(),i),j[0]+=j[0],j[1]+=j[1],j[2]+=j[2]):j=i,j=new jf(j);var I=new jf(M).sub(j).normalize(),W=new T.Math.Ray(j,I);return q._intersectObjectImpl(W,a)},_intersectObjectImpl:function(){function r(){var z=new jf;return z.subVectors(P,B),l.subVectors($,B),z.cross(l).normalize(),z}function z(B,p,W,t,x,J,F){return bk.barycoordFromPoint(B,p,W,t,m),x.multiplyScalar(m.x),J.multiplyScalar(m.y),F.multiplyScalar(m.z),x.add(J).add(F),x.clone()}var x=new El,p=new El,j=new Yp,o=new jf,y=new jf,Q=new jf,L=new jf,u=new jf,$=new jf,B=new jf,P=new jf,R=new Ie,G=new Ie,b=new Ie,l=new jf,h={vs:Jd,is:Md,uv:dq},m=new jf;return function(K,q){var S=this.gv.getData3dUI(q),f=q.mat||S.mat;if(f){x.fromArray(f),p.getInverse(x),j.copy(K).applyMatrix4(p);var n,N,W="body",i=S.shapeModel;if(i||(i=qo(S)),i||(q instanceof T.Node&&!(q instanceof T.Shape)?(n=!0,i=h):(N=!0,i=[S.left,S.front,S.right,S.back,S.top,S.bottom])),!i)return console.log("Can not find shape model."),null;
$l(i)||(i=[i]);var C,a,w,A,E,v,J,M,X,U,e,k,D,V,g,H,c=1/0,Z=["","top_","bottom_"],Y=!1;for(C=0,a=i.length;a>C;C++)if(D=i[C])for(w=0,A=Z.length;A>w;w++)if(V=Z[w],J=D[V+"vs"],M=D[V+"is"],X=D[V+"uv"]||D[V+"tuv"],J){if(g=D[V+"boundingBox"]){var e=j.intersectBox(g);if(!e)continue;if(j.origin.distanceTo(e)>c)continue;H=!1}else D[V+"boundingBox"]=g=new T.Math.Box3,H=!0;for(E=0,v=M?M.length:J.length/3;v>E;E+=3)this.countTriangles++,M?(y.fromArray(J,3*M[E]),Q.fromArray(J,3*M[E+1]),L.fromArray(J,3*M[E+2])):(y.fromArray(J,3*E),Q.fromArray(J,3*(E+1)),L.fromArray(J,3*(E+2))),H&&(g.expandByPoint(y),g.expandByPoint(Q),g.expandByPoint(L)),U=j.intersectTriangle(y,Q,L,!0,o),U&&(k=j.origin.distanceTo(U),c>k&&(c=k,u.copy(U),$.copy(y),B.copy(Q),P.copy(L),""!==V?W=V.slice(0,-1):n?W=is[Math.floor(E/6)]:N&&(W=is[C]),X&&(Y=!0,M?(R.fromArray(X,2*M[E]),G.fromArray(X,2*M[E+1]),b.fromArray(X,2*M[E+2])):(R.fromArray(X,2*E),G.fromArray(X,2*(E+1)),b.fromArray(X,2*(E+2))))))}if(!isFinite(c))return null;var s,O=u.clone().applyMatrix4(x);Y&&(s=z(u,$,B,P,R,G,b));var m=r($,B,P),l=r($.applyMatrix4(x),B.applyMatrix4(x),P.applyMatrix4(x)),I=j.direction.dot(m);return I>0&&(m.multiplyScalar(-1),l.multiplyScalar(-1)),{world:O,local:u.clone(),worldNormal:l,normal:m,uv:s,part:W}}}}()});var Wp=function(D,k){this.gv=D,this.s=function(o,B,v){return B==y&&(B=v),B==y?k.getStyle(o):$f(B,k,D)},this.data=k};wr(Wp,M,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(p,J,Y,x){var K=this,F=K.data;if(!(F instanceof oj)){var i,E,j,r,t,X,c,$=K.gv,V=F._id,a=K.s("shape3d.alwaysOnTop")?null:K.s("batch"),H=$._batchIndexMap,s=$._batchModelMap,B=$.isSelectable(F),D=$.getBrightness(F),_=D!=y&&1!==D;if(K.needValidate(p)){if(j=hf(H,s,F,a),K.validate(j,a?cp[a]||Xk:y),j&&(r=H[V],t=r.size=j.vs.length/3-r.begin,c=j.rs))for(D=_?D:1,X=0;t>X;X++)c.push(D);if(Np(F)){var m=$.getWireframeGeometry(F);if(m)bb($,F,m);else{var b=$.getWireframe(F);b&&bb($,F,b)}}K.labelInfo=K.label2Info=K.noteInfo=K.note2Info=K._38o=y,K._24O(Rh,"getLabel"),K._24O(Xp,"getLabel2"),K._26O(yj,"getNote"),K._26O(zi,"getNote2"),K._15O(),K.interactiveInfo=$.isInteractive(F)?{}:y,K._iv=!1}_&&pd(p,J.uBrightness,D),pd(p,J.uAlphaTest,K.s("alphaTest")),pd(p,J.uUseEnvMap,F.s("envmap")?!0:!1),pd(p,J.uReflectivity,F.s("envmap")||.01),E=Lj(p,J,Y,B,F,of),E&&(sh(E,H[V],s),sh(E,$._polylineIndexMap[V],$._polylineModelMap),sh(E,$._wireframeIndexMap[V],$._wireframeModelMap)),H[V]||K._80o(p,J,x),$.isLabelVisible(F)&&((i=K.labelInfo)&&(Lj(p,J,Y,B,F,Rh),K._28O(i,Rh,x)),(i=K.label2Info)&&(Lj(p,J,Y,B,F,Xp),K._28O(i,Xp,x))),$.isNoteVisible(F)&&((i=K.noteInfo)&&(Lj(p,J,Y,B,F,yj),K._29O(i,yj,x)),(i=K.note2Info)&&(Lj(p,J,Y,B,F,zi),K._29O(i,zi,x))),(i=K._38o)&&K._99O(p,J,i,Y,B,x),_&&pd(p,J.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return qe},_80o:function(){},dispose:function(){},_calcAnchorMat:function(V){if(V.hasOwnProperty("_anchor")||V.hasOwnProperty("_anchorElevation")){var Q=V.getAnchor3d(),m={x:Q.x-.5,y:Q.y-.5,z:Q.z-.5},I=mj();return Mj(I,[-m.x,-m.y,-m.z]),I}},getBodyColor:function(x){var V=this.data,N=this.gv.getBodyColor(V);return N?N:x?V.getStyle(x):y},_24O:function(d,r){var C=this,T=C.data,Y=C.gv,L=C.s,F=Y[r](T);if(F!=y){var j=L(d+".scale"),O=L(d+".max"),x=C[d+"Info"]={label:F,textureScale:L(d+".texture.scale"),color:Y[r+"Color"](T),font:L(d+".font"),align:L(d+".align"),background:Y[r+"Background"](T)},u=x.rect=dg(x,F);O>0&&O<u.width&&(x.labelWidth=u.width,u.width=O),u.x=u.y=0,u.width*=j,u.height*=j,x.mat=C._16O(L(d+".autorotate"),L(d+".position"),u,L(d+".face"),L(d+".t3"),L(d+".r3"),L(d+".rotationMode"));var q=u.width/2,M=u.height/2;x.vs=new qc([-q,M,0,-q,-M,0,q,-M,0,q,M,0]),u.width/=j,u.height/=j}},_26O:function($,J){var K=this,q=K.data,h=K.gv,s=K.s,C=h[J](q);if(C!=y){var f=s($+".scale"),n=this[$+"Info"]={note:C,textureScale:s($+".texture.scale"),expanded:s($+".expanded"),font:s($+".font"),color:s($+".color"),align:s($+".align"),borderWidth:s($+".border.width"),borderColor:s($+".border.color"),background:h[J+"Background"](q)};if(n.expanded){var R=s($+".max"),H=dg(n,C);H.width+=6,H.height+=2,R>0&&R<H.width&&(n.labelWidth=H.width,H.width=R);var v={x:-H.width/2,y:-8-H.height,width:H.width,height:H.height+8}}else v={x:-6,y:-18,width:12,height:18};n.mat=K._16O(s($+".autorotate"),s($+".position"),y,s($+".face"),s($+".t3"),s($+".r3"),s($+".rotationMode")),n.rect=v,1!==f&&(v=zf(v),v.x*=f,v.height*=f,v.y=-v.height,v.width*=f);var p=v.x,I=v.y,X=v.width,N=v.height;n.vs=new qc([p,-I,0,p,-I-N,0,p+X,-I-N,0,p+X,-I,0])}},_28O:function(c,$,p){if(p(this.s($+".transparent"))){var n=c.rect,U=c.textureScale,r=n.width*U,K=n.height*U;if(r>=1&&K>=1){var j=kj(r,K);1!==U&&(j.translate(j,n.x,n.y),j.scale(U,U),j.translate(j,-n.x,-n.y)),dc(j,c),j.restore(),un(this,$,c.mat,c.vs,!0)}}},_29O:function(D,Z,F){if(F(this.s(Z+".transparent"))){var g=D.rect,c=D.textureScale,R=g.x,$=g.y,a=g.width*c,G=g.height*c;if(a>=1&&G>=1){g.x=g.y=0;var B=kj(a,G);1!==c&&B.scale(c,c),br(B,D),B.restore(),g.x=R,g.y=$,un(this,Z,D.mat,D.vs,!1)}}},_99O:function(W,E,u,P,k,D){if(u){var A=this,K=A.gv,U=A.data,b=K._buffer,L=K._1O,Q=u.icons;for(var Z in Q){var V=Q[Z],d=u.rects[Z];if(d&&D($f(V.transparent,U,K))){Lj(W,E,P,k,U,Z);var $=$f(V.shape3d,U,K),l=$?[$]:$f(V.names,U,K),S=l?l.length:0,a=$f(V.textureScale,U,K)||1,R=$f(V.light,U,K);R==y&&(R=$?!0:!1),lr(W,E,$f(V.blend,U,K),R,$f(V.opacity,U,K),$f(V.reverseFlip,U,K),$f(V.reverseColor,U,K),$f(V.reverseCull,U,K));for(var f=0;S>f;f++){var q=l[f],p=d[f];if(ui(A,p.mat),$)qr(K,U,qo(A,$),A);else{var J=qp(q);if(J){var i=p.width*a,z=p.height*a;if(i>=1&&z>=1){var g=kj(i,z);bp(g,J,$f(V.stretch,U,K),0,0,i,z,U,K),g.restore(),sm(W,ao,L),Yq(W,E,L,$f(V.discardSelectable,U,K),b.uv,uk),nl(W,b.vs,p.vs,E.aPosition),ve(W,b.ns,Sk,E.aNormal),Tp(W,b.is,_r),Jl(W,0,_r.length),nn(W,E,L)}}}Si(K)}ar(W,E)}}}}});var tn=function(k,M){hg(tn,this,[k,M])};wr(tn,Wp,{_16O:function(X,B,o,y,f,i,J,N,S){var T=this.data,H=T.getFinalScale3d(),e=kq(B,H,o,y,N,S);if(T.hasOwnProperty("_anchor")||T.hasOwnProperty("_anchorElevation")){var F=T.getAnchor3d();e[0]-=(F.x-.5)*H[0],e[1]-=(F.y-.5)*H[1],e[2]-=(F.z-.5)*H[2]}return Ag(mj(),e,T.p3(),y,f,i,J,X,T.getFinalRotation3d(),T.getRotationMode())},clear:function(){var j=this;j.faceMat=j.mat=j.shapeModel=j.left=j.right=j.front=j.back=j.top=j.bottom=j.csg=y},needValidate:function(O){if(this._iv)return this._validateFrameId=O._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var e=O._renderInfo.frame;if(this._validateFrameId!==e)return this._validateFrameId=e,!0}return!1},validate:function(F,u){var R=this,Q=R.gv,q=R.data,i=R.shapeName=R.s(Ol),h=qo(R,i);R._updateAutoRotation(),R._updateFixSize2d(),R._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(Al(Q,q,"_wireframeModelMap","_wireframeIndexMap"),Al(Q,q,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var D=Wr(q,Q.getMat(q),h?R.s("shape3d.scaleable"):!0),k=R._calcAnchorMat(q);if(k&&Jg(D,D,k),q.mat=D,R.clear(),h||i==y)if(F){var e=[];h?$i(Q,q,h,R,R.getBodyColor(),[D],F,e):(pf(Q,q,F,u,D,Cb,e,Zd),pf(Q,q,F,u,D,Fq,e,Do),pf(Q,q,F,u,D,Zp,e,Dk),pf(Q,q,F,u,D,Yg,e,ki),pf(Q,q,F,u,D,jd,e,Qe),pf(Q,q,F,u,D,Oo,e,em)),e.length&&(Rj(F.vs,e),Rj(F.ns,ti(e)))}else R.mat=D,(R.shapeModel=h)||(R._cubeUvs=null,R.vf(Cb,0),R.vf(Fq,16),R.vf(jd,8),R.vf(Oo,24),R.vf(Zp,32),R.vf(Yg,40))},_updateAutoRotation:function(){var d=new Xj;return function(){var v=this,j=v.data,E=v.s("shape3d.autorotate");if(!E)return j._dynamicRotation&&delete j._dynamicRotation,void 0;var x,i=v.gv;x="string"==typeof E?[E.indexOf("x")<0?i._eye[0]:i._center[0],E.indexOf("y")<0?i._eye[1]:i._center[1],E.indexOf("z")<0?i._eye[2]:i._center[2]]:i._eye;var Q=i._center,B=j.p3(),S=ib([B[0]+x[0]-Q[0],B[1]+x[1]-Q[1],B[2]+x[2]-Q[2]],B,i._up),X=j.r3();d.set(0,0,0,j.getRotationMode(),!0).setFromRotationMatrix(S),Math.abs(X[0]-d.x)<1e-5&&Math.abs(X[1]-d.y)<1e-5&&Math.abs(X[2]-d.z)<1e-5||(j._dynamicRotation=[d.x,d.y,d.z])}}(),_updateFixSize2d:function(){var F=this,U=F.data,k=F.s("shape3d.fixSizeOnScreen");if(!k)return U._dynamicScale3d&&delete U._dynamicScale3d,void 0;var r=F.gv;U.getFinalScale3d();var L=Wr(U,r.getMat(U)),g=Vb([0,0,0],L),D=r.toViewPosition(g);if(!isNaN(D.x)&&!isNaN(D.y)){var S=Vb([1,0,0],L),V=r.toViewPosition(S),h=Vb([0,1,0],L),T=r.toViewPosition(h),v=V.x-D.x,Z=T.y-D.y;if(v&&Z){var B=U._dynamicScale3d||[1,1,1],X=qp(U.s("shape3d.image")),y=k[0]>0?k[0]:X?$m(X,U):20,H=k[1]>0?k[1]:X?Lq(X,U):20,K=Math.abs(v/y),J=Math.abs(Z/H);Math.abs(K-1)<.001&&Math.abs(J-1)<.001||(U._dynamicScale3d=[B[0]/K,B[1]/J,B[2]])}}},_updateOverlapping:function(){var z=this,m=z.s("hide.overlapping.group");if(!m)return z._rectOverlapping&&(z._rectOverlapping=d),void 0;var P,p,q,R=z.gv,Q=z.data,Y=Wr(Q,R.getMat(Q)),J=1/0,E=1/0,t=-1/0,K=-1/0,O=Q.getAnchor3d(),v=O.x,g=O.y,l=O.z;for(P=0;8>P;P++){if(p=Vb([(P>>2)-v,(1&P>>1)-g,(1&P)-l],Y),q=R.toViewPosition(p),isNaN(q.x)||isNaN(q.y))return;J=Math.min(J,q.x),t=Math.max(t,q.x),E=Math.min(E,q.y),K=Math.max(K,q.y)}var W={x:J,y:E,w:t-J,h:K-E};z._rectOverlapping=R.overlappingBox.isOverlapping(m,W)},getVectorDynamicSize:function(){var L,C=this,I=C.s("shape3d"),Z=C.data;if("billboard"===I||"plane"===I||(L=Z._currentCubeElementId)!=y){var u,K,e=C.gv,i=Wr(Z,e.getMat(Z)),X=Z.getAnchor3d(),w=.5-X.x,N=.5-X.y,J=.5-X.z,s=C.s("shape3d.vector.dynamic.maxsize"),r=function(U,B){U[0]+=w,U[1]+=N,U[2]+=J,B[0]+=w,B[1]+=N,B[2]+=J;var c=e.toViewPosition(Vb(U,i)),g=e.toViewPosition(Vb(B,i)),S=c.x-g.x,F=c.y-g.y;return Math.min(s,Math.sqrt(S*S+F*F))};if("billboard"===I)u=r([-.5,0,0],[.5,0,0]),K=r([0,-.5,0],[0,.5,0]);else if("plane"===I)u=r([-.5,0,0],[.5,0,0]),K=r([0,0,-.5],[0,0,.5]);else if(Z._currentCubeElementId!=y){var B=3*Md[L+1],j=3*Md[L],U=3*Md[L+2];u=r([Jd[B],Jd[B+1],Jd[B+2]],[Jd[U],Jd[U+1],Jd[U+2]]),K=r([Jd[B],Jd[B+1],Jd[B+2]],[Jd[j],Jd[j+1],Jd[j+2]])}return[u,K]}},getCachedTexture:function(){var $=this,d=$.data,I=d._currentCubeElementId;return I!=y?$._cubeCachedImage?$._cubeCachedImage[I]:null:$._shape3dCachedImage},setCachedTexture:function(b){var I=this,p=I.data,E=p._currentCubeElementId;E!=y?(I._cubeCachedImage||(I._cubeCachedImage={}),I._cubeCachedImage[E]=b):I._shape3dCachedImage=b},invalidateCachedTexture:function(t){var N,W,T,M=this;if((T=M._shape3dCachedImage)&&(t.deleteTexture(T),M._shape3dCachedImage=null),W=M._cubeCachedImage){for(N in W)t.deleteTexture(W[N]);M._cubeCachedImage=null}},vf:function(c,r){var a=this;if(a.gv.getFaceVisible(a.data,c)){var D=gc(a,c);D.mat&&(a.faceMat=!0);var C=D.uv;if(C){var P=a._cubeUvs;P||(P=a._cubeUvs=new qc([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var g=0;8>g;g++)P[r+g]=C[g]}return D}},_80o:function(z,$,w){var a=this;if(a._rectOverlapping)return!0;var s=a.shapeModel;if(s||a.shapeName==y){var R=a.gv,l=a.data,j=R._cube;Ug(R,a.mat),s?qr(R,l,s,a,a.getBodyColor(),w):(nl(z,j.vs,y,$.aPosition),nl(z,j.ns,y,$.aNormal),pp(z,j.is),a._18O(z,$,a.left,0,w),a._18O(z,$,a.front,6,w),a._18O(z,$,a.right,12,w),a._18O(z,$,a.back,18,w),a._18O(z,$,a.top,24,w),a._18O(z,$,a.bottom,30,w)),Si(R),a.faceMat&&(a._18O(z,$,a.left,0,w,!0),a._18O(z,$,a.front,6,w,!0),a._18O(z,$,a.right,12,w,!0),a._18O(z,$,a.back,18,w,!0),a._18O(z,$,a.top,24,w,!0),a._18O(z,$,a.bottom,30,w,!0))}},_18O:function(M,I,w,f,O,G){if(w){if(!O(w.transparent))return;if(G&&!w.mat||!G&&w.mat)return;var g=this.data.s("polygonOffset");g&&yh(M,g),G&&Ug(this.gv,w.mat);var Z=this,t=Z.data;t._currentCubeElementId=f;var P=Z.gv,C=P.getTexture(w.texture,t),z=w.uv,X=w.uvScale,u=w.uvOffset,L=w.discardSelectable;C?z?Yq(M,I,C,L,P._buffer.uv,Z._cubeUvs,u,X):Yq(M,I,C,L,P._cube.uv,y,u,X):Yq(M),lr(M,I,w.blend,w.light,w.opacity,w.reverseFlip,w.reverseColor,w.reverseCull),pd(M,I.uDiffuse,w.color||c["color.empty"]),Jl(M,f,6),ar(M,I),nn(M,I,C),G&&Si(P),g&&rk(M),t._currentCubeElementId=null}}});var bs=function(M,H){hg(bs,this,[M,H])};wr(bs,Wp,{_25Q:1,validate:function(z){var q=this,b=q.gv,L=q.data,M=q.s,G=M("edge.width"),o=L._40I,l=L._41I;if(q.shapeModel=q.info=y,o&&l){var O,C,g,d,I,s,U,S,A,p,m=L.isLooped(),T=M(Zn),e=N.getEdgeType(T);if(e){var D=e(L,Ye(q,b,L,m,T),b,q._19Q);if(!D.points||D.points.isEmpty())return;s=q.info={},U=D.segments,I=D.points,S=I.size();for(var W=o.getElevation(),K=l.getElevation(),f=0;S>f;f++){var j=I.get(f);j.e==y&&(j.e=W+(K-W)*f/(S-1))}A=sk(I.get(0)),p=sk(I.get(S-1));var R=S%2;0===R?(s.c1=sk(I.get(S/2-1)),s.c2=sk(I.get(S/2))):s.p3=sk(I.get((S-R)/2)),s.s1=A,s.s2=sk(I.get(1)),s.t1=sk(I.get(S-2)),s.t2=p}else{I=new wk,s=q.info={};var V=M("edge.offset"),E=M("edge.center"),Q=M("edge.source.t3"),k=M("edge.target.t3"),w=o.p3(),t=l.p3();if(Q&&(w[0]+=Q[0],w[1]+=Q[1],w[2]+=Q[2]),k&&(t[0]+=k[0],t[1]+=k[1],t[2]+=k[2]),T===ph){U=M("edge.segments");var x=s.points=M(xp)||po;if(S=x.size()){A=sk(x.get(0)),p=sk(x.get(S-1)),!E&&V&&(g=yi(A,w,!0),V=Y(V,kk(w,A)),w=[w[0]+g[0]*V,w[1]+g[1]*V,w[2]+g[2]*V],g=yi(t,p,!0),V=Y(V,kk(p,t)),t=[t[0]-g[0]*V,t[1]-g[1]*V,t[2]-g[2]*V]);var R=S%2;0===R?(O=sk(x.get(S/2-1)),C=sk(x.get(S/2))):s.p3=sk(x.get((S-R)/2)),s.s1=w,s.s2=A,s.t1=p,s.t2=t}else!E&&V&&(g=yi(t,w,!0),d=kk(w,t),V=Mh(V,d),w=[w[0]+g[0]*V,w[1]+g[1]*V,w[2]+g[2]*V],t=[t[0]-g[0]*V,t[1]-g[1]*V,t[2]-g[2]*V]),O=w,C=t;I.add({x:w[0],y:w[2],e:w[1]}),I.addAll(x),I.add({x:t[0],y:t[2],e:t[1]})}else{var H=Ye(q,b,L,m,T);if(q._19Q||(H=-H),m){var P=w[0],h=w[1],X=w[2],i=o.getTall()/2+H;O=[P-H,h+i,X],C=[P+H,h+i,X],I.add({x:P-H,y:X,e:h}),I.add({x:P-H,y:X,e:h+i}),I.add({x:P+H,y:X,e:h+i}),I.add({x:P+H,y:X,e:h})}else{g=yi(t,w,!0),d=kk(w,t);var u={x:w[0],y:w[2]},$={x:t[0],y:t[2]},c=Zo(y,u,$,H),B=c.x-u.x,n=c.y-u.y;V=Mh(V,d),g[0]*=V,g[1]*=V,g[2]*=V,O=[w[0]+g[0]+B,w[1]+g[1],w[2]+g[2]+n],C=[t[0]-g[0]+B,t[1]-g[1],t[2]-g[2]+n],E?(I.add({x:w[0],y:w[2],e:w[1]}),I.add({x:O[0],y:O[2],e:O[1]}),I.add({x:C[0],y:C[2],e:C[1]}),I.add({x:t[0],y:t[2],e:t[1]})):(I.add({x:O[0],y:O[2],e:O[1]}),I.add({x:C[0],y:C[2],e:C[1]}))}}s.c1=O,s.c2=C}s.list=M(Ol)===rn?q.createTubeModel(I,U,G/2,z):q.createLineModel(I,U,G,"edge","edge.dash")}}});var Zm=function(N,d){hg(Zm,this,[N,d])};wr(Zm,tn,{_80o:function(U,R,f){var L=this,h=L.gv,$=L.shapeModel;Ug(h,L.mat),$?qr(h,L.data,$,L,L.getBodyColor(),f):(uj(L,U,R,L.left,f),uj(L,U,R,L.front,f),uj(L,U,R,L.right,f),uj(L,U,R,L.back,f),uj(L,U,R,L.top,f),uj(L,U,R,L.bottom,f)),Si(h)},validate:function(t,l){var r,_,S=this,O=S.s,R=S.data,I=R.p3(),x=R._thickness/2,e=R.isClosePath(),s=R.getPoints(),G=R.getSegments(),v=O(Ck),W=t&&t.uv;if(S.clear(),0>x)_=S.shapeModel=Nf(s,G,O(gm),O(fj),v,O(Oq),R.getTall(),R.getShapeElevation(),e),O(Io)?O("shape3d.image")||delete _.uv:(delete _.vs,delete _.ns,delete _.uv),O("shape3d.top.image")||delete _.top_uv,O("shape3d.bottom.image")||delete _.bottom_uv;else if(O(Ol)===rn)r=Or(s,G,v,e),_=S.shapeModel={vs:[]},O("shape3d.image")&&(_.uv=[],_.sum=O(Oq)||Lg(r)||1,_.len=0),O(gm)&&!e&&(_.top_vs=[],O("shape3d.top.image")&&(_.top_uv=[])),O(fj)&&!e&&(_.bottom_vs=[],O("shape3d.bottom.image")&&(_.bottom_uv=[])),S._12O(r,x);else{var Q,K,P,F,u,L,T,h,i,Y;if(r=Or(s,G,v,e),u=S.vf(jd,W,!1,l),x&&(L=S.vf(Oo,W,!1,l),T=e?y:S.vf(Cb,W,!1,l),h=e?y:S.vf(Fq,W,!1,l),i=S.vf(Zp,W,!1,l),Y=S.vf(Yg,W,!1,l)),x){for(var w=0,A=r.length;A>w;w++)r[w]=S._tryRemoveBezierPoints(r[w],x);S._12O(r,x)}else u&&r.forEach(function(J){if(F=J.length,F>0)for(Q=J[0],P=1;F>P;P++)K=J[P],S.addV(u.vs,Q,K),Q=K});S._20Q(r),t||(u&&(u.ns=ti(u.vs),Vm(u,"vs"),Vm(u,Qj)),x&&(L&&(L.ns=ti(L.vs),Vm(L,"vs"),Vm(L,Qj)),T&&(T.ns=ti(T.vs),Vm(T,"vs"),Vm(T,Qj)),h&&(h.ns=ti(h.vs),Vm(h,"vs"),Vm(h,Qj)),i&&(i.ns=ti(i.vs),Vm(i,"vs"),Vm(i,Qj)),Y&&(Y.ns=ti(Y.vs),Vm(Y,"vs"),Vm(Y,Qj))))}var B=S.mat=mj();Mj(B,I),ur(B,R.getFinalRotation3d(),R.getRotationMode());var N=R.getScale3d(),M=R._dynamicScale3d;M&&(N[0]*=M[0],N[1]*=M[1],N[2]*=M[2]),Zi(B,N),Mj(B,Op(I)),t&&(Rk(S,B,t,_),S.clear())},_20Q:function(w){var l,s,u,E,I,F,k,T=this,V=T.front,j=T.back,v=T.top,O=T.bottom,c=V?V.tuv:y,R=j?j.tuv:y,P=v?v.tuv:y,r=O?O.tuv:y,t=0;(c||R||P||r)&&(l=T.s(Oq)||Lg(w)||1,w.forEach(function(m){if(s=m.length,s>0)for(F=m[0],u=1;s>u;u++)k=m[u],E=t/l,t+=kk(F,k),I=t/l,T._14O(V,E,I),T._14O(j,1-I,1-E),T._14O(v,E,I),T._14O(O,E,I),F=k}))},_14O:function(G,Y,B){if(G){var W=G.uv,e=G.tuv;if(e){if(W)var J=W[0]+(W[6]-W[0])*Y,v=W[1]+(W[7]-W[1])*Y,Q=W[2]+(W[4]-W[2])*Y,E=W[3]+(W[5]-W[3])*Y,w=W[2]+(W[4]-W[2])*B,M=W[3]+(W[5]-W[3])*B,k=W[0]+(W[6]-W[0])*B,V=W[1]+(W[7]-W[1])*B;else J=Y,v=0,Q=Y,E=1,w=B,M=1,k=B,V=0;e.push(Q,E,w,M,k,V,k,V,J,v,Q,E)}}},_13O:function(Q){var A=Q.uv,c=Q.tuv;c&&(A?c.push(A[2],A[3],A[4],A[5],A[6],A[7],A[6],A[7],A[0],A[1],A[2],A[3]):c.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(g,A){var x=g.length;if(4>x)return g;var m,p,F,r,s,l,L=!1,R=function(I){return g[I]},i=function(D){return g[x-1-D]};for(s=0;1>=s;s++)for(l=s?i:R,p=l(0),F=l(1),m=2;x-1>m;m++)if(r=l(m),!r.remove)if(r.b){var q=Zo(p,F,r,A);q.adjust?(r.remove=!0,L=!0):(p=F,F=r)}else p=F,F=r;if(!L)return g;var Q=[];for(m=0;x>m;m++)g[m].remove||Q.push(g[m]);return Q},_12O:function(_,z){var L,k,J,l,D,Z=this;_.forEach(function(Y){if(D=Y.length,D>0)for(L={p:Y[0],n:!0},l=1;D>l;l++)k=Y[l],J=D-1>l?Y[l+1]:y,Z.addPoint(L,k,J,z,Y)})},addPoint:function(v,I,E,i,W){var S,q,d,u,M,X,F,s,r,g=this,h=v.p,p=v.f,w=v.b,Z=g.s("shape3d.side")||We,l=g.s("shape3d.start.angle"),O=g.s("shape3d.sweep.angle"),z=g.shapeModel,A=g.data.isClosePath();if(v.n&&(v.n=!1,p=A&&W.length>2?Zo(W[W.length-2],h,I,i):Zo(y,h,I,i),w=Cs(h,p),z?z.top_vs&&g._10O(w,p,Z,l,O,z.top_vs,z.top_uv):(S=g.left)&&(g.addV(S.vs,w,p),g._13O(S))),q=E?Zo(h,I,E,i):A&&W.length>2?Zo(h,I,W[1],i):Zo(h,I,y,i),d=Cs(I,q),z){var t,K,f=z.vs,L=z.uv,e=z.sum;for(L&&(t=z.len/e,z.len+=kk(h,I),K=z.len/e),X=g._9O(w,p,Z,l,O),F=g._9O(d,q,Z,l,O),s=0;Z>s;s++)r=s+1,Rj(f,X[r]),Rj(f,F[s]),Rj(f,X[s]),Rj(f,F[s]),Rj(f,X[r]),Rj(f,F[r]),L&&(u=s/Z,M=r/Z,L.push(t,M,K,u,t,u,K,u,t,M,K,M));!E&&z.bottom_vs&&g._10O(d,q,Z,l,O,z.bottom_vs,z.bottom_uv,!0)}else!E&&(S=g.right)&&(g.addV(S.vs,q,d),g._13O(S)),(S=g.front)&&g.addV(S.vs,p,q),(S=g.back)&&g.addV(S.vs,d,w),(S=g.top)&&g.addH(S.vs,p,q,d,w,!0),(S=g.bottom)&&g.addH(S.vs,w,d,q,p);v.p=I,v.f=q,v.b=d},_10O:function(N,$,F,S,e,C,K,s){var W,P,B=this,a=B.data,Q=B._9O(N,$,F,S,e),J=(N.x+$.x)/2,m=(N.y+$.y)/2,i=a.getShapeElevation(),k=0;for(k=0;F>k;k++)s?(Rj(C,Q[k]),Rj(C,Q[k+1])):(Rj(C,Q[k+1]),Rj(C,Q[k])),Rj(C,[J,i,m]),K&&(s?(W=t*(k+1)/F+S,P=t*k/F+S):(W=t*k/F+S,P=t*(k+1)/F+S),K.push(.5-.5*G(P),.5-.5*f(P),.5-.5*G(W),.5-.5*f(W),.5,.5))},_9O:function(q,o,v,A,m){var E,k,X=this,r=X.data,p=[],O=(q.x+o.x)/2,Y=(q.y+o.y)/2,i=r.getTall()/2,L=r.getShapeElevation(),b=0;for(m=m||t;v>=b;b++)E=m*b/v+A,k=G(E),p.push([O+(q.x-O)*k,L+i*f(E),Y+(q.y-Y)*k]);return p},addV:function(C,e,i){var n=e.x,h=e.y,D=i.x,w=i.y,q=this.data,O=q.getShapeElevation(),H=q.getTall()/2;C.push(n,O-H,h,D,O-H,w,D,O+H,w,D,O+H,w,n,O+H,h,n,O-H,h)},addH:function(t,Z,U,L,w,B){var G=this.data,h=G.getTall()/2,Y=G.getShapeElevation()+(B?h:-h);t.push(Z.x,Y,Z.y,U.x,Y,U.y,L.x,Y,L.y,L.x,Y,L.y,w.x,Y,w.y,Z.x,Y,Z.y)},vf:function(h,J,T,D){var k,o=this,u=o.gv.getFaceVisible(o.data,h);return(T||u)&&(k=gc(o,h,D),k.vs=[],k.tuv=u&&(k.texture||J)?[]:y,k.visible=u),k}});var cr=function(j,G){hg(cr,this,[j,G])};wr(cr,Wp,{_25Q:1,validate:function(u){var C=this,Y=C.data,p=C.s,m=Y.getPoints(),v=m.size();if(C.shapeModel=C.info=y,v>1){var o=C.info={},L=Y.getSegments(),w=Y.getThickness(),g=sk(m.get(0)),h=sk(m.get(v-1)),q=v%2;0===q?(o.c1=sk(m.get(v/2-1)),o.c2=sk(m.get(v/2))):o.p3=sk(m.get((v-q)/2)),o.s1=g,o.s2=sk(m.get(1)),o.t1=sk(m.get(v-2)),o.t2=h,o.list=p(Ol)===rn?C.createTubeModel(m,L,w/2,u):C.createLineModel(m,L,w,"shape.border","shape.dash")}var t=Y.p3(),x=C.mat=mj();Mj(x,t),ur(x,Y.getFinalRotation3d(),Y.getRotationMode());var G=Y.getScale3d(),n=Y._dynamicScale3d;n&&(G[0]*=n[0],G[1]*=n[1],G[2]*=n[2]),Zi(x,G),Mj(x,Op(t))},_80o:function(H,x,A){var N=this,F=N.shapeModel;if(F){var p=N.gv;Ug(p,N.mat),qr(p,N.data,F,N,N.getBodyColor(),A),Si(p)}}});var th=T.graph3d.VR=function(m){var D=this;D.gv=m,D._controllers=[],D.switch=new Oh(D),D._enable=!1,D._defaultCallLater=T.Default.callLater,D._defaultCancelLater=vn,"undefined"!=typeof U&&"VRFrameData"in U&&(D._frameData=new U.VRFrameData),D.measureOflength=1,D.eyesOffset=[0,0,0],D._orientation=new T.Math.Quaternion,D._lastHeadPose=[0,0,0],D._offsetToBeAdd=[0,0,0],D._fpsInfo={time:0,fps:0,frames:0}};wr(th,M,{ms_fire:!0,_42:function(M,m,B,z){var i=this,N=i.gv;if(!N.drawFilter&&i._deviceInAction){var v=i._device;if(v){var h=i._measureOflength;v.depthNear=N.getNear()*h,v.depthFar=N.getFar()*h;var H=i._offsetToBeAdd;if(i.eyesOffset[0]+=H[0],i.eyesOffset[1]+=H[1],i.eyesOffset[2]+=H[2],H[0]=0,H[1]=0,H[2]=0,v.isPresenting===!1)return i._controllers.forEach(function(K){K&&K.update()}),N.iv(),!1;var L=i._frameData;v.getFrameData(L);var I=L.pose.position;if(I){var $=i.toViewPosition(I);N.setEye($),i._orientation.fromArray(L.pose.orientation);var V=new T.Math.Vector3(0,0,-10*i._scaleFactor);V.applyQuaternion(i._orientation),N.setCenter([$[0]+V.x,$[1]+V.y,$[2]+V.z])}i._controllers.forEach(function(O){O&&O.update()}),N.setViewport(M,0,0,m/2,B),i._viewMatrix=i._copyViewMatrix(L.leftViewMatrix),i._projectMatrix=i._copyProjectMatrix(L.leftProjectionMatrix),z(),N.setViewport(M,m/2,0,m/2,B),i._viewMatrix=i._copyViewMatrix(L.rightViewMatrix),i._projectMatrix=i._copyProjectMatrix(L.rightProjectionMatrix),z(),i._lastViewMatrix=i._viewMatrix,i._lastProjectMatrix=i._projectMatrix,i._viewMatrix=null,i._projectMatrix=null,i.submitFrame();var A=Date.now(),W=i._fpsInfo;return A-W.time>1e3?(W.fps=Math.round(1e3*(W.frames+1)/(A-W.time)),W.time=A,W.frames=0):W.frames++,!0}}},onVRDisplayPresentChange:function(){var M=this.isPresenting();this._injectGraphView(M),this.fp("present",!M,M)},getOrientation:function(){return this._orientation},addController:function(k){k=k||0;var L=this,s=L.getController(k);return s?s:(s=new wb(L,k),L._controllers.push(s),s)},getController:function(C){C=C||0;for(var b=this._controllers,O=0,z=b.length;z>O;O++)if(b[O]&&b[O].id===C)return b[O];return null},removeController:function(s){s=s||0;for(var J=this._controllers,E=0,D=J.length;D>E;E++)if(J[E]&&J[E].id===s)return J.splice(E,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(r,X){var o=this,t=o._scaleFactor,Q=o._eyesOffset,R=o._lastHeadPose;return R[0]=r[0]*t,R[1]=r[1]*t,R[2]=r[2]*t,X?(X[0]=R[0]+Q[0],X[1]=R[1]+Q[1],X[2]=R[2]+Q[2],X):[R[0]+Q[0],R[1]+Q[1],R[2]+Q[2]]},addEyesOffset:function(F,V,I){var C=this._offsetToBeAdd;C[0]+=F,C[1]+=V,C[2]+=I},_copyViewMatrix:function(h){var g=this.dup(h),b=this._scaleFactor;g[12]*=b,g[13]*=b,g[14]*=b;var Q=this._eyesOffset;if(Q&&(Q[0]||Q[1]||Q[2])){var V=Q[0],x=Q[1],N=Q[2];g[12]-=g[0]*V+g[4]*x+g[8]*N,g[13]-=g[1]*V+g[5]*x+g[9]*N,g[14]-=g[2]*V+g[6]*x+g[10]*N}return g},shutdown:function(){var Q=this._device;Q&&Q.isPresenting&&Q.exitPresent()},isPresenting:function(){var B=this._device;return B&&B.isPresenting},_copyProjectMatrix:function(l){var j=this.dup(l),F=this._scaleFactor;return j[14]*=F,j},dup:function(x,e){for(var U=x.length,r=e||new Array(U);U--;)r[U]=x[U];return r},getViewMatrix:function(G){var F=this._viewMatrix;return F?this.dup(F,G):void 0},getProjectMatrix:function(){var T=this._projectMatrix;return T?this.dup(T):void 0},submitFrame:function(){var v=this;if(v._enable&&v._deviceInAction){var D=v._device;D&&D.isPresenting&&(D.submitFrame(),v.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(Q){var n=this.gv;return n.intersectObjects(Q,n.dm().getDatas())},setDevice:function(B){var s=this;s._device=B},_injectGraphView:function(){var A,d,T;return function(J){var i=this.gv;if(!J)return A&&(i.getWidth=A,i.getHeight=d,i.getDevicePixelRatio=T),void 0;var y=this._device,H=y.getEyeParameters("left"),P=H.renderWidth,D=H.renderHeight;A=i.getWidth,d=i.getHeight,T=i.getDevicePixelRatio,i.getWidth=function(){return 2*P},i.getHeight=function(){return D},i.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(P){var L=this;if(!P)return _o=T.Default.callLater=L._defaultCallLater,vn=T.Default.cancelLater=L._defaultCancelLater,void 0;var L=this;_o=T.Default.callLater=function(V,N,j,b){var P=L._device;return P&&P.isPresenting?b?X(function(){_o(V,N,j)},b):P.requestAnimationFrame(function(){L._deviceInAction=!0,V.apply(N,j),L._deviceInAction=!1}):L._defaultCallLater(V,N,j,b)},vn=T.Default.cancelLater=function(h,d){var c=L._device;return c&&c.isPresenting?d?b(h):c.cancelAnimationFrame(h):L._defaultCancelLater(h,d)}}}),M.defineProperties(th.prototype,{enable:{get:function(){return this._enable},set:function(V){var D=this;D._enable!==V&&(D._enable=V,V?(D.switch.showButton(),D._injectCallLaterFunc(!0)):(D.shutdown(),D.switch.hideButton(),D._injectCallLaterFunc(!1)),D.fp("enable",!V,V))}},measureOflength:{get:function(){return this._measureOflength},set:function(H){this._measureOflength=H;var s=this._scaleFactor=1/H;this._controllers.forEach(function(y){y&&y._setScaleFactor(s)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(L){this._eyesOffset=L}},controllerModel:{get:function(){return this._controllerModel},set:function(Q){var V;"object"==typeof Q?(V=Q.mtl,Q=Q.obj):(V=Q+".mtl",Q+=".obj");var B=this,r=B._controllerModel;r&&r.obj===Q&&r.mtl===V||(r=B._controllerModel={obj:Q,mtl:V},N.loadObj(Q,V,{finishFunc:function(w,u){B._controllerModel===r&&N.setShape3dModel("vrControllerModel",u)}}))}},interactive:{get:function(){return!!this._interactive},set:function(Y){!!Y!=!!this._interactive&&(this._interactive=Y,Y&&this.addController(0),this.gv.getCoreInteractor().enableVR(Y))}}});var wb=function(h,W){function k(A){var F=navigator.getGamepads&&navigator.getGamepads();if(F)for(var m=0,j=0,Y=F.length;Y>m;m++){var P=F[m];if(P){var p=P.id;if("OpenVR Gamepad"===p||"OpenVR Controller"===p||0===p.indexOf("Oculus Touch")||0===p.indexOf("Spatial Controller")){if(j===A)return P;j++}}}}function m(o,t,h){return Math.abs(o[0]-t[0])<h&&Math.abs(o[1]-t[1])<h&&Math.abs(o[2]-t[2])<h?!0:!1}var R=this;R.vr=h,R.id=W;var D,l,U=[0,0],V=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],w=new fh;w.s("shape3d","vrControllerModel"),w.isController=!0,w.s("intersect",!1),R.getGamepad=function(){return l},R.isButtonPressed=function(Q){for(var n,P=0,M=V.length;M>P;P++)if(n=V[P],n.id===Q)return n.pressed;return!1},R.getNode=function(){return w};var Z=.003;R.setRotationEpsilon=function(x){Z=x};var s=5e-4,H=s;R.setPositionEpsilon=function(C){s=C,H=C*R.vr._scaleFactor},R._setScaleFactor=function(C){w.s3(C,C,C),H=s*C},R._setScaleFactor(R.vr._scaleFactor);var $,Y=new um,v=new El,_=[0,0,0],J=[0,0,0],T=new Xj,q=new jf,B=new Yp;R.getRay=function(){return $?(B.origin.fromArray(_),B.direction.copy(q),$=!1,B):B},R.update=function(){if(D=l,l=k(W),D!=l&&console.log("gamepad changed",l),!l||l.pose===d)return l=null,w.s("3d.visible",!1),void 0;if(N.getShape3dModel("vrControllerModel")){w.dm()||h.gv.dm().add(w),w.s("3d.visible",!0);var K=l.pose;if(null!==K){K.position&&(R.vr.toViewPosition(K.position,_),m(w.p3(),_,H)||($=!0,w.p3(_))),K.orientation&&(Y.fromArray(K.orientation),q.set(0,0,-1).applyQuaternion(Y).normalize(),v.makeRotationFromQuaternion(Y),T.set(0,0,0,w.getRotationMode(),!0).setFromRotationMatrix(v),J[0]=T.x,J[1]=T.y,J[2]=T.z,m(w.r3(),J,Z)||($=!0,w.r3(J))),$&&h.fp("gamepad.pose",null,{position:_,rotation:J,id:W});var A=l.axes;(U[0]!==A[0]||U[1]!==A[1])&&(U=[A[0],A[1]],h.fp("gamepad.axes",null,{id:W,axes:U}));var B,Q,n,M,u=l.buttons;for(B=0,Q=u.length;Q>B;B++)if(n=u[B],M=n.pressed,M!==V[B].pressed){V[B].pressed=M;var j={id:W},g="state";j[g]=j._62O=M?"down":"up",h.fp("gamepad.button."+V[B].id,null,j)}}}}},Oh=function(o){this.vr=o,this._button=null};wr(Oh,M,{showButton:function(){var y=this.assureButton();if(!y.parentNode){var f=this.vr.gv,a=f.getView();f._79O?a.insertBefore(y,f._79O):a.appendChild(y)}},hideButton:function(){var e=this._button;e&&e.parentNode&&e.parentNode.removeChild(e)},assureButton:function(){var M=this._button;return M?M:this._button=this.createButton(this.vr.gv)},createButton:function(K){function C(q,U){q.textContent=U&&U.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function b(v){B.style.display="",B.style.cursor="pointer",B.style.left="calc(50% - 50px)",B.style.width="100px",C(B,v),B.onmouseenter=function(){B.style.opacity="1.0"},B.onmouseleave=function(){B.style.opacity="0.5"},B.onclick=function(){v.isPresenting?v.exitPresent():v.requestPresent([{source:K.getCanvas()}])},K.vr.setDevice(v)}function M(){B.style.display="",B.style.cursor="auto",B.style.left="calc(50% - 75px)",B.style.width="150px",C(B,null),B.onmouseenter=null,B.onmouseleave=null,B.onclick=null,K.vr.setDevice(null)}function s(m){m.style.position="absolute",m.style.bottom="20px",m.style.padding="12px 6px",m.style.border="1px solid #fff",m.style.borderRadius="4px",m.style.color="#000",m.style.font="normal 13px sans-serif",m.style.textAlign="center",m.style.opacity="0.5",m.style.outline="none",m.style.zIndex="999"}if("getVRDisplays"in navigator){var B=this._button=r.createElement("button");return B.style.display="none",s(B),U.addEventListener("vrdisplayconnect",function(E){b(E.display)},Z),U.addEventListener("vrdisplaydisconnect",function(){M()},Z),U.addEventListener("vrdisplaypresentchange",function(o){C(B,o.display),K.vr.onVRDisplayPresentChange()},Z),navigator.getVRDisplays().then(function(e){e.length>0?b(e[0]):M()}),B}var P=r.createElement("a");return P.href="https://webvr.info",P.innerHTML="当前不支持 webvr",P.style.left="calc(50% - 90px)",P.style.width="180px",P.style.textDecoration="none",s(P),P}}),M.defineProperties(Oh.prototype,{});var Qq=T.graph3d.PostProcessing=function(X){function $(){if(!D){var V=X.getGL();D=new nf.RenderTarget(X,V),B=new Hr.Shader(V,y.vs,y.fs),H=Hr.Buffer.createIndexBuffer(V,new Uint16Array([0,2,1,1,2,3])),n=Hr.Buffer.createVertexBuffer(V,new Float32Array([0,0,1,0,0,1,1,1]))}}var D,B,H,n,O=this,N={},R=!1;!function(){M.keys(Qq).forEach(function(O){N[O]=new Qq[O](X)})}(),O.getModule=function(s){return s?N[s]:N},O.getModuleList=function(){return M.keys(N)},O.handleDataModleChange=function(b,x){b&&(b.setPostProcessingData(O.serialize()),b.removeSerializeListener(O.onDataModelSerialize,O)),x&&(x.addSerializeListener(O.onDataModelSerialize,O),O.deserialize(x.getPostProcessingData()))},O.onDataModelSerialize=function(u){"serialize"===u.type?X.dm()._postProcessingData=O.serialize():"deserialize"===u.type&&O.deserialize(X.dm().getPostProcessingData())},O.serialize=function(){var t,O,W,U={};for(t in N)O=N[t],U[t]={enable:O.enable},W=O.serializeProperties,W&&W.forEach(function(P){U[t][P]=O[P]});return U},O.deserialize=function(F){if(F){var a,X,b,Z;for(a in F)if(X=N[a]){b=F[a],O.enableModule(a,b.enable);for(Z in b)"enable"!==Z&&(X[Z]=b[Z])}}else{var a,X;for(a in N)X=N[a],X.enable=!1,X.resetProperties&&X.resetProperties()}},O.enableModule=function(G,O){var e,p,_,l=G.split(",");for(e=0,p=l.length;p>e;e++)_=l[e].trim(),N[_]&&(N[_].enable=O);R=!1;for(_ in N)if(N[_].enable){R=!0;break}R&&$()};var y={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};O._42=function(b,f,S,G,g){if(R&&!g){D.setSize(b,f,S),cc(b,D.frame),b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT),X.setViewport(b,0,0,f,S),G();var C,$=D;for(C in N)$=N[C]._42(b,$)||$;return Ur(b),X.setViewport(b,0,0,f,S),b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT),B.bind(),b.activeTexture(b.TEXTURE0+0),b.bindTexture(b.TEXTURE_2D,$.texture),B.uniforms.image=0,H.upload(),n.upload(),B.attributes.pos.pointer(n),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0),b.bindTexture(b.TEXTURE_2D,null),b.useProgram(X._prg),!0}}},ge=T.graph3d.PostProcessing.Bloom=function(V){function i(){var M=V.getWidth(),g=V.getHeight();if(M&&g){U=[M,g],n=!0;var w,h=V.getGL(),x=Math.round(U[0]/2),f=Math.round(U[1]/2);for(N=new nf.RenderTarget(V,h,x,f),w=0;m>w;w++)C.push(new nf.RenderTarget(V,h,x,f)),H.push(new nf.RenderTarget(V,h,x,f)),x=Math.round(x/2),f=Math.round(f/2);
c=new Hr.Shader(h,ge.highPassShader.vs,ge.highPassShader.fs);for(var w=0;m>w;w++)O[w]=new Hr.Shader(h,ge.blurShader.vs,ge.blurShader.fs.replace(/DEFINE_VALUE/g,K[w]));l=new Hr.Shader(h,ge.compositeShader.vs,ge.compositeShader.fs.replace(/NUM_MIPS/g,m)),k=new Hr.Shader(h,ge.finalShader.vs,ge.finalShader.fs),J=Hr.Buffer.createIndexBuffer(h,new Uint16Array([0,2,1,1,2,3])),z=Hr.Buffer.createVertexBuffer(h,new Float32Array([0,0,1,0,0,1,1,1]))}}var X,u,T,J,z,h=this,I=!1,n=!1;this.serializeProperties="strength,threshold,radius".split(","),this.resetProperties=function(){X=1.5,u=.55,T=.4},M.defineProperties(h,{enable:{get:function(){return I},set:function(V){!!I!=!!V&&(I=V,V&&!n&&i())}},strength:{get:function(){return X},set:function(B){X=B}},threshold:{get:function(){return u},set:function(t){u=t}},radius:{get:function(){return T},set:function(W){T=W}}}),this.resetProperties();var N,c,l,k,U=[256,256],C=[],H=[],m=5,K=[3,5,7,9,11],O=[];h._42=function(F,Y){function A(i,O,H,N){cc(F,O.frame),V.setViewport(F,0,0,O.width,O.height),N?N(F):F.clear(F.COLOR_BUFFER_BIT|F.DEPTH_BUFFER_BIT),w!==i&&i.bind();var A=0;for(var G in H){var g=H[G];g instanceof WebGLTexture&&(F.activeTexture(F.TEXTURE0+A),F.bindTexture(F.TEXTURE_2D,g),g=A,A++),i.uniforms[G]=g}for(w!==i&&(J.upload(),z.upload(),i.attributes.pos.pointer(z),w=i),F.drawElements(F.TRIANGLES,6,F.UNSIGNED_SHORT,0);A--;)F.activeTexture(F.TEXTURE0+A),F.bindTexture(F.TEXTURE_2D,null);Ur(F)}if(I){n||i();var w;A(c,N,{smoothWidth:.01,luminosityThreshold:u,tDiffuse:Y.texture});var D,W=N,R=Math.round(U[0]/2),M=Math.round(U[1]/2);for(D=0;m>D;D++)A(O[D],C[D],{colorTexture:W.texture,direction:[1,0],texSize:[R,M]}),A(O[D],H[D],{colorTexture:C[D].texture,direction:[0,1],texSize:[R,M]}),R=Math.round(R/2),M=Math.round(M/2),W=H[D];return A(l,C[0],{blurTexture1:H[0].texture,blurTexture2:H[1].texture,blurTexture3:H[2].texture,blurTexture4:H[3].texture,blurTexture5:H[4].texture,bloomStrength:X,bloomRadius:T,bloomTintColor:[1,1,1]}),A(k,Y,{image:C[0].texture},function(x){x.enable(x.BLEND),x.blendEquation(x.FUNC_ADD),x.blendFunc(x.SRC_ALPHA,x.ONE)}),F.blendEquationSeparate(F.FUNC_ADD,F.FUNC_ADD),F.blendFuncSeparate(F.SRC_ALPHA,F.ONE_MINUS_SRC_ALPHA,F.ONE,F.ONE_MINUS_SRC_ALPHA),Y}}};ge.highPassShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D tDiffuse;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","vec4 outputColor = vec4(0.0, 0.0, 0.0, 0.0);","float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","gl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},ge.blurShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D colorTexture;","uniform vec2 texSize;","uniform vec2 direction;","#define KERNEL_RADIUS DEFINE_VALUE","#define SIGMA DEFINE_VALUE","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float fSigma = float(SIGMA);","float weightSum = gaussianPdf(0.0, fSigma);","vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;","for( int i = 1; i < KERNEL_RADIUS; i ++ ) {","float x = float(i);","float w = gaussianPdf(x, fSigma);","vec2 uvOffset = direction * invSize * x;","vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;","vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;","diffuseSum += (sample1 + sample2) * w;","weightSum += 2.0 * w;","}","gl_FragColor = vec4(diffuseSum/weightSum, 1.0);","}"].join("\n")},ge.compositeShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D blurTexture1;","uniform sampler2D blurTexture2;","uniform sampler2D blurTexture3;","uniform sampler2D blurTexture4;","uniform sampler2D blurTexture5;","uniform sampler2D dirtTexture;","uniform float bloomStrength;","uniform float bloomRadius;","uniform vec3 bloomTintColor;","float lerpBloomFactor(const in float factor) {","float mirrorFactor = 1.2 - factor;","return mix(factor, mirrorFactor, bloomRadius);","}","void main() {","gl_FragColor = bloomStrength * ( lerpBloomFactor(1.0) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture1, vUv) + ","lerpBloomFactor(0.8) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture2, vUv) + ","lerpBloomFactor(0.6) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture3, vUv) + ","lerpBloomFactor(0.4) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture4, vUv) + ","lerpBloomFactor(0.2) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture5, vUv) );","}"].join("\n")},ge.finalShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")},Zc(N,{accordionViewExpandIcon:sb(og),accordionViewCollapseIcon:sb(og,!0),accordionViewLabelColor:Qh,accordionViewLabelFont:oc,accordionViewTitleBackground:Ai,accordionViewSelectBackground:Fb,accordionViewSelectWidth:3,accordionViewSeparatorColor:d,splitViewDividerSize:1,splitViewDividerBackground:Ai,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Ki,rect:[2,2,12,12],background:og}]},propertyViewLabelColor:_j,propertyViewLabelSelectColor:Qh,propertyViewLabelFont:oc,propertyViewExpandIcon:sb(Ke),propertyViewCollapseIcon:sb(Ke,!0),propertyViewBackground:kn,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:fg,propertyViewColumnLineColor:fg,propertyViewSelectBackground:Fb,listViewLabelColor:_j,listViewLabelSelectColor:Qh,listViewLabelFont:oc,listViewRowLineVisible:!1,listViewRowLineColor:fg,listViewSelectBackground:Fb,treeViewLabelColor:_j,treeViewLabelSelectColor:Qh,treeViewLabelFont:oc,treeViewExpandIcon:sb(Eg),treeViewCollapseIcon:sb(Eg,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:fg,treeViewSelectBackground:Fb,treeViewDoubleClickToToggle:!0,tableViewLabelColor:_j,tableViewLabelSelectColor:Qh,tableViewLabelFont:oc,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:fg,tableViewColumnLineColor:fg,tableViewSelectBackground:Fb,treeTableViewLabelColor:_j,treeTableViewLabelSelectColor:Qh,treeTableViewLabelFont:oc,treeTableViewExpandIcon:sb(Eg),treeTableViewCollapseIcon:sb(Eg,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:fg,treeTableViewColumnLineColor:fg,treeTableViewSelectBackground:Fb,tableHeaderLabelColor:_j,tableHeaderLabelFont:oc,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Mp,tableHeaderBackground:kn,tableHeaderMoveBackground:Kq,tableHeaderInsertColor:Fb,tableHeaderSortDescIcon:Fo(Ke,!0),tableHeaderSortAscIcon:Fo(Ke),tabViewTabGap:1,tabViewLabelColor:Qh,tabViewLabelFont:oc,tabViewTabBackground:Ai,tabViewSelectWidth:3,tabViewSelectBackground:Fb,tabViewMoveBackground:Kq,tabViewInsertColor:Fb,toolbarLabelColor:_j,toolbarLabelSelectColor:Qh,toolbarLabelFont:oc,toolbarBackground:kn,toolbarSelectBackground:Fb,toolbarItemGap:8,toolbarSeparatorColor:fs},!0);var Lh={translateX:1,sortColumn:1},dk={sortable:1,sortOrder:1,sortFunc:1},Yk={focusData:1},zd={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Se={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},ei=function(U,q){q.add(U),U.hasChildren()&&U.eachChild(function(U){ei(U,q)})},Co=function(r,B,e,S,$,v,Y,H,E,l,o){var Z,C=e.getValueType(l),b=e.getAlign(l);if(e.getEnumValues(l)){var G=e.toEnumLabel(B,l),T=Ec||0,P=0,Q=v,I=N.getTextSize(S,G).width;return Z=qp(e.toEnumIcon(B,l)),Z&&(P=v+Ec/2,"center"===b?P+=(H-(T+I))/2:"right"===b&&(P=P+H-(T+I)),xh(r,Z,P,Y+E/2,l,o),Q=P+Ec/2),G!=y&&(Z?Ek(r,G,S,$,Q,Y,H-(Q-v),E):Ek(r,G,S,$,v,Y,H,E,b)),void 0}return B=e.formatValue(B),B!=y?C===js?(Gf(r,v,Y,H,E,B),void 0):C===Uo||!C&&Go(B)?(Z=qp(B?eb:eq),xh(r,Z,v+H/2,Y+E/2,l,o),void 0):(Ek(r,B,S,$,v,Y,H,E,b),void 0):void 0},Xm=function(Q,o){var P=o.view,w=Il(Q),i=o.column||o.property;P.getDataModel().beginTransaction(),o.editor=Q,Q.info=o,P.setCurrentEditor(Q),P.getView().insertBefore(w,P._79O),Ce(Q,o.editorRect),Q.setFocus?Q.setFocus():ql(Q),Q.commitValue=function(X,t){Q._17Q&&(Q=Q._17Q),t||P.setValue(o.data,i,Q.getValue?Q.getValue():Q.value),Q.close&&Q.close(),Hm(w)},i.onEditorCreated&&i.onEditorCreated(o)},Gr=function(z,E,U,K,c){var F=Vd(z,U),X=E.value,j=E.view,x=c.getValueType(E.data);return F.onblur=F.onchange=function(){j.endEditing()},"input"===z?(X=c.formatValue(X),X!=y&&(F.value=X),F.onkeydown=function(R){Of(R)?j.endEditing():Fd(R)&&j.endEditing(!0)},(x===xi||x===$d)&&F.addEventListener(Gq,N.numberListener,Z)):z===Bi&&K.forEach(function(m){var J=r.createElement("option");J.innerHTML=c.toEnumLabel(m),J.value=m,c.isEnumEqual(X,m)&&(J.selected=!0),Ah(F,J)}),Xm(F,E),F},cs=T.widget={},Qb=function(C,l,y){wr(D+".widget."+C,l,y)};Zc(Ae,{ms_value:function(v){v.getValue=function(A){var d=this.getItemById(A),S=d.element;return Hc(S)?S:S?S.getValue?S.getValue():S.value:d.selected},v.setValue=function(q,S){var c=this.getItemById(q);if(c){var d=c.element;d&&!Hc(d)?d.setValue?d.setValue(S):d.value=S:Go(S)?(c.selected=S,this.iv()):(c.element=S,this.iv())}},v.v=function(Z,c){var d=this;if(2===arguments.length)d.setValue(Z,c);else{if(!Bh(Z))return d.getValue(Z);for(var u in Z)d.setValue(u,Z[u])}return d}},_46o:function(F){F._icon=y,F._accessType=y,F._valueType=y,F._editable=!1,F._batchEditable=!0,F._align=Cb,F._nullable=!0,F._emptiable=!1,F.setParent=Rp,F.formatValue=function(T){var u=this,I=u._valueType;return u.getEnumValues()?u.toEnumLabel(T):I===Uo?!!T:T!=y&&I===xi?e(T):T},F.setEnum=function(Q,X,p,h,O,E,b){var w=this;Q&&!$l(Q)&&Q.values&&(h=Q.editable,p=Q.icons,X=Q.labels,O=Q.strict,E=Q.maxHeight,b=Q.dropDownWidth,Q=Q.values),ic(Q)&&(Q=Q._as),ic(X)&&(X=X._as),ic(p)&&(p=p._as),w._enumValues=Q,w._enumLabels=X,w._enumIcons=p,w._enumEditable=h,w._enumStrict=O==y?!0:O,w._enumMaxHeight=E,w._enumDropDownWidth=b,Q&&Q.length&&zb(Q[0])&&(w._valueType=$d),w.fp("enum",!1,!0)},F.getEnumDropDownWidth=function(){return this._enumDropDownWidth},F.getEnumMaxHeight=function(){return this._enumMaxHeight},F.isEnumEditable=function(){return this._enumEditable},F.getEnumValues=function(){return this._enumValues},F.getEnumLabels=function(){return this._enumLabels},F.getEnumIcons=function(){return this._enumIcons},F.isEnumStrict=function(){return this._enumStrict},F.isEnumEqual=function(y,o){return this._enumStrict?y===o:y==o},F.toEnumLabel=function(O,b){var F=this,w=F.getEnumValues(b),y=F.getEnumLabels(b);if(w&&y)for(var e=0;e<w.length;e++)if(F.isEnumEqual(O,w[e]))return y[e];return O},F.toEnumIcon=function(L,e){var g=this,f=g.getEnumValues(e),o=g.getEnumIcons(e);if(f&&o)for(var w=0;w<f.length;w++)if(g.isEnumEqual(L,f[w]))return o[w];return d}},_45o:function(i){i._87o=function(k,T,r,z,E,Q){if(k){var p=this,G=p._90I,x=Mg(1);p._columnLineVisible&&(E-=1),p._rowLineVisible&&(Q-=1),0>=E||0>=Q||(p._90I||(G=p._90I={}),G[T]||(G[T]=new wk),Ce(x,p.tx()+r,p.ty()+z,E,Q),Ah(x,k),p._view.insertBefore(x,p._79O),k.onParentAdded&&k.onParentAdded(x),G[T].add(x))}},i._76o=function(){var G=this,Z=G._90I;if(Z){for(var w in Z)Z[w].each(function(R){Hm(R)});delete G._90I}},i._77o=function(G){var K=this;if(K._90I){var c=K._90I[G];c&&(c.each(function(i){Hm(i)}),delete K._90I[G])}}},_47o:function(O){O.getValue=function(H,x){return x.getValue?x.getValue(H,x,this):yl(H,x.getAccessType(),x.getName())},O.setValue=function(L,m,b){if(m.isEmptiable(L)||""!==b||(b=d),m.isNullable(L)||b!=y){var u=this,$=m.getName(L),Y=m.getAccessType(L),H=m.getValueType(L);H===xi&&Hc(b)?b=S(b):H===$d&&Hc(b)?b=parseFloat(b):H===Uo&&Hc(b)&&(b="true"===b),u._batchEditable&&m._batchEditable&&u.isSelected(L)?u.sm().each(function(f){m.setValue?m.setValue(f,m,b,u):On(f,Y,$,b)}):m.setValue?m.setValue(L,m,b,u):On(L,Y,$,b)}},O.setCurrentEditor=function(i){this.endEditing(),this._currentEditor=i,this.redraw()},O.isEditing=function(w,J){var A=this,Q=A._currentEditor;if(!Q)return!1;if(J){var B=Q.info;return B?(B.column||B.property)===J&&B.data===w:!1}return!0},O.endEditing=function(J){var z=this,H=z._currentEditor;H&&(delete z._currentEditor,H.commitValue&&H.commitValue(H.info,J),z.redraw(),z.getDataModel().endTransaction())},O.beginEditing=function(r){this.endEditing();var W=this,U=r.column||r.property;if(U.beginEditing)U.beginEditing(r);else{var G=r.data,b=r.value,n=W.getSelectBackground(G),j=U.getEnumValues(G),f=U.getSlider(G),k=U.getColorPicker(G);if(f){var S=rb(cs.Slider,f);return S.setValue(b),S.getView().onblur=function(){W.endEditing()},S.isInstant()&&(S.onValueChanged=function(){W.setValue(G,U,S.getValue())}),Xm(S,r),void 0}if(k||U.getValueType(G)===js){var F=rb(cs.ColorPicker,k);return F.setValue(b),F.onClosed=function(){W.endEditing()},F.isInstant()&&(F.onValueChanged=function(o,l){W.setValue(G,U,l)}),Xm(F,r),F.open(),void 0}if(j){if(cs.ComboBox){var h=new cs.ComboBox;h.setValue(b),h.setValues(j),h.setLabels(U.getEnumLabels(G)),h.setIcons(U.getEnumIcons(G)),h.setEditable(U.isEnumEditable(G)),h.setStrict(U.isEnumStrict(G)),h.setMaxHeight(U.getEnumMaxHeight(G)),h.setDropDownWidth(U.getEnumDropDownWidth(G)),h.onClosed=function(){W.endEditing()},Xm(h,r),h.open()}else Gr(Bi,r,n,j,U);return}var w=U.getValueType(G);if(w===Uo||Go(b))return W.setValue(G,U,!b),void 0;if(U.getItemEditor(G)){var d=Ic(U.getItemEditor(G)),c=new d(G,U,W,r),Z=c.getView();return Z._17Q=c,c.setValue(b),sq(Z),Xm(Z,r),c.editBeginning&&c.editBeginning(),void 0}Gr("input",r,n,y,U)}}},_44o:function(j){j.init=function(h){var B=this,P=B.th=new Td(h),Y=B._view=jj(1,B);B.tv=B._tableView=h,Ah(Y,P.getView()),Ah(Y,h.getView()),P.mp(function(F){F.property===Fi&&B.iv()}),B.iv()},j.getTableView=function(){return this.tv},j.getTableHeader=function(){return this.th},j.getDataModel=function(){return this.tv.dm()},j.getColumnModel=function(){return this.tv.getColumnModel()},j.setColumns=function(R){this.tv.setColumns(R)},j.addColumns=function(o){this.tv.addColumns(o)},j.endEditing=function(){this.tv.endEditing()},j.validateImpl=function(){var H=this,F=H.th,u=tf(F),D={x:0,y:0,width:H.getWidth(),height:u};Ce(F,D),D.y=u,D.height=m(0,H.getHeight()-u),Ce(H.tv,D)}},ms_vs:function(R){R._41o=function(){return this._29I.height<this._59I},R._43o=function(){var v=this;v._41o()&&(v._58I||(X(function(){v._94O()},lb),v.iv()),v._58I=new Date)},R._94O=function(){var U=this;if(U._58I){var N=new Date;N.getTime()-U._58I.getTime()>=lb?(delete U._58I,U.iv()):X(function(){U._94O()},lb)}},R._93I=function(){var n=this,_=n._27I;if(n._58I||!n._autoHideScrollBar){_||Ah(n._79O,_=n._27I=Mg());var p=n._29I,u=p.height,D=n._59I,a=n.getScrollBarSize(),d=p.width-a-2,H=u*(-n.ty()/D),N=u*(u/D),e=_.style;D>u?(Ib>N&&(H=H+N/2-Ib/2,0>H&&(H=0),H+Ib>u&&(H=u-Ib),N=Ib),e.visibility=nc,e.background=n.getScrollBarColor(),e.borderRadius=a/2+Tg,Ce(_,d,H,a,N)):e.visibility=ie}else _&&(_.style.visibility=ie)}},ms_hs:function(Y){Y._40o=function(){return this._29I.width<this._91I},Y._42o=function(){var M=this;M._40o()&&(M._95O||(X(function(){M._94I()},lb),M.iv()),M._95O=new Date)},Y._94I=function(){var e=this;if(e._95O){var m=new Date;m.getTime()-e._95O.getTime()>=lb?(delete e._95O,e.iv()):X(function(){e._94I()},lb)}},Y._92I=function(){var O=this,A=O._28I;if(O._95O||!O._autoHideScrollBar){A||Ah(O._79O,A=O._28I=Mg());var G=O._29I,f=G.width,s=O._91I,a=O.getScrollBarSize(),g=G.height-a-2,c=f*(-O.tx()/s),p=f*(f/s),I=A.style;s>f?(Ib>p&&(c=c+p/2-Ib/2,0>c&&(c=0),c+Ib>f&&(c=f-Ib),p=Ib),I.visibility=nc,I.background=O.getScrollBarColor(),I.borderRadius=a/2+Tg,Ce(A,c,g,p,a)):I.visibility=ie}else A&&(A.style.visibility=ie)}}}),hj(eb,fk(16,16,[{type:Cg,rect:[1,1,14,14],background:Fb},{type:te,rect:[1,1,14,14],width:1,color:qk},{type:Kg,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),hj(eq,fk(16,16,{type:te,rect:[1,1,14,14],width:1,color:qk})),hj(wi,fk(16,16,[{type:gs,rect:[2,2,12,12],borderWidth:1,borderColor:qk,background:"#FFF"},{type:gs,rect:[4,4,8,8],background:Fb}])),hj(lp,fk(16,16,{type:gs,rect:[2,2,12,12],borderWidth:1,borderColor:qk})),Ae._15Q=function(f){f._29I=Eo,f._59I=0,f._91I=0,f._5o=function(y){var D=this;D._30I=new wk,D._rows=new wk,D._rowMap={},D._31I=0,D._14I=0,D._view=jj(1,D),D._canvas=ff(D._view),Ah(D._view,D._79O=Mg()),D.dm(y?y:new ub)},f.getCheckIcon=function(H){var g=this.sm(),O=g.co(H);return g.sg()?qp(O?wi:lp):qp(O?eb:eq)},f.checkData=function($){var f=this.sm(),y=f.co($);f.sg()&&y||(this._32o=1,y?f.rs($):f.as($),delete this._32o)},f.getDataAt=function(s){s.target&&(s=this.lp(s));var h=C(s.y/this._rowHeight),z=this._rows;return 0>h||h>=z.size()?y:z.get(h)},f.onDataDoubleClicked=function(){},f.onDataClicked=function(){},f.adjustTranslateX=function(){return 0},f.adjustTranslateY=function(r){var J=this.getHeight()-this._59I;return J>r&&(r=J),r>0?0:e(r)},f.onPropertyChanged=function($){var L=this,o=$.property;zd[o]?L.ivm():Yk[o]||L.redraw(),o===Pj?L._42o():o===Sj&&L._43o()},f.getLabel=function(J){return J.toLabel()},f.getLabelFont=function(){return this._labelFont},f.getLabelColor=function(c){var d=this;if(d.isCheckMode()){if(d._focusData===c)return d._labelSelectColor}else if(d.isSelected(c))return d._labelSelectColor;return d._labelColor},f.getStartRowIndex=function(){return this._31I},f.getEndRowIndex=function(){return this._14I},f.getRowDatas=function(){return this._rows},f.getRowIndex=function(B){return this._rowMap[B._id]},f.getRowSize=function(){return this._rows.size()},f.getViewRect=function(){return zf(this._29I)},f.isVisible=function(h){return this._visibleFunc?this._visibleFunc(h):!0},f.getCurrentSortFunc=function(){return this._sortFunc},f.setDataModel=function(X){var v=this,N=v._dataModel,g=v._selectionModel;N!==X&&(N&&(N.umm(v.handleDataModelChange,v),N.umd(v.handleDataPropertyChange,v),N.umh(v.handleHierarchyChange,v),g||N.sm().ums(v.handleSelectionChange,v)),v._dataModel=X,X.mm(v.handleDataModelChange,v),X.md(v.handleDataPropertyChange,v),X.mh(v.handleHierarchyChange,v),g?g._21I(X):X.sm().ms(v.handleSelectionChange,v),v.fp("dataModel",N,X))},f.validateModel=function(){var h=this;h._rows.clear(),h._rowMap={},h.buildChildren(h._dataModel._roots);var r=h._rows=h._rows.toList(h.isVisible,h),Q=0,p=h.getCurrentSortFunc(),H=r.size();for(p&&r.sort(p);H>Q;Q++)h._rowMap[r.get(Q)._id]=Q},f.buildChildren=function(f){var s=this;f.each(function(P){s._rows.add(P),s.buildChildren(P._children)})},f.handleDataModelChange=function(){this.ivm()},f.handleDataPropertyChange=function(l){"parent"===l.property?this.ivm():this.invalidateData(l.data)},f.handleHierarchyChange=function(){this.ivm()},f.handleSelectionChange=function(o){o.datas.each(this.invalidateData,this),this.onSelectionChanged(o)},f.onSelectionChanged=function(W){var T=this,o=T.sm();!T.isAutoMakeVisible()||1!==o.size()||"set"!==W.kind&&"append"!==W.kind||T._32o||T.makeVisible(o.ld())},f.handleBackgroundClick=function(E){fq(E)&&!this.isCheckMode()&&this.sm().cs()},f.makeVisible=function(r){r&&(this._23I=r,this.iv())},f.scrollToIndex=function(Z){var G=this,t=G._29I,_=t.height,f=G._rowHeight,l=f*Z;Z>=0&&Z<G._rows.size()&&_>0&&(l+f>t.y+_?G.ty(-l+_-f):l<t.y&&G.ty(-l))},f.autoScroll=function(f,p){var d=this,S=d._rowHeight,R=S,V=S/4,C=d._29I,e=d.lp(f),s={x:d.tx(),y:d.ty()};return S>0&&C&&(e.x-C.x<R?d.translate(V,0):C.x+C.width-e.x<R&&d.translate(-V,0),e.y-C.y<R?d.translate(0,V):C.y+C.height-e.y<R&&d.translate(0,-V)),s.x=d.tx()-s.x,s.y=d.ty()-s.y,p&&(p.x+=s.x,p.y+=s.y),s},f.getTopRowOrderSelection=function(){var r=this.sm().getTopSelection(),m={},$=new wk;return r.each(function(V){m[V._id]=V}),this._rows.each(function(M){m[M._id]&&$.add(M)}),$},f.getRowOrderSelection=function(){var r=new wk;return this._rows.each(function(J){this.isSelected(J)&&r.add(J)},this),r},f.ivm=function(){this.invalidateModel()},f.invalidateModel=function(){var o=this;o._96I||(o._96I=1,o._32I=1,delete o._24I),o.iv()},f.redraw=function(){var S=this;S._32I||(S._32I=1,delete S._24I,S.iv())},f.invalidateData=function(t){var R=this;g?R.redraw():R._32I||(R._24I||(R._24I={}),R._24I[t._id]=t,R.iv())},f.getFocusData=function(){return this._focusData},f.setFocusDataById=function(P){this.setFocusData(this.dm().getDataById(P))},f.setFocusData=function(e){var i=this,q=i._focusData;q!==e&&(i._focusData=e,i.fp("focusData",q,e),q&&i.invalidateData(q),e&&(i.invalidateData(e),i.isAutoMakeVisible()&&i.makeVisible(e)))},f.drawRowBackground=function(z,G,j,H,D,f,_){var w=this,K=w.isCheckMode();(G===w._focusData&&K||j&&!K)&&Gf(z,H,D,f,_,w.getSelectBackground(G))},f.drawData=function(w,H,A){var f=this,g=f._rowHeight,t=g*A,R=f._29I,D=R.x,q=R.width;w.save(),w.beginPath(),w.rect(D,t,q,g),w.clip(),f._87o(f.drawRow(w,H,f.isSelected(H),D,t,q,g),A,D,t,q,g),w.restore(),f._rowLineVisible&&Gf(w,D,t+g-1,q,1,f._rowLineColor)},f._12I=function(R){var Z=this,H=Z._31I,A=Z._29I,t=A.x,B=A.y,d=A.width,D=A.height;for(R.beginPath(),R.rect(t,B,d,D),R.clip(),R.clearRect(t,B,d,D),Z._76o(),Z._93db(R);H<Z._14I;H++)Z.drawData(R,Z._rows.get(H),H);Z._92db(R)},f._13I=function(O){for(var p,s=this,D=s._rowHeight,z=s._29I,Q=z.x,i=z.width,h=s._31I,V=s._30I;h<s._14I;h++)p=s._rows.get(h),s._24I[p._id]&&V.add({data:p,index:h});V.isEmpty()||(O.beginPath(),V.each(function(c){O.rect(Q,c.index*D,i,D)}),O.clip(),V.each(function(j){O.clearRect(Q,j.index*D,i,D)}),V.each(function(y){s._77o(y.index)}),s._93db(O),V.each(function(j){s.drawData(O,j.data,j.index)}),s._92db(O),V.clear())},f.preValidateModel=function(){this.endEditing&&this.endEditing()},f.validateImpl=function(){var l=this,h=l._canvas,Q=l.getWidth(),b=l.getHeight(),f=l._rowHeight,B=l._32I;(Q!==h.clientWidth||b!==h.clientHeight)&&($b(h,Q,b),B=1);var T=k&&!I;l._96I&&!T&&(l.preValidateModel(),l.validateModel());var t=l._29I,_={x:-l.tx(),y:-l.ty(),width:Q,height:b},M=l._rows.size(),v=Hl(h),q=l._23I;B||be(_,t)||(B=1),l._29I=_,l._59I=M*f+l.getScrollBarSize(),l._31I=C(_.y/f),l._14I=i((_.y+_.height)/f),l._31I<0&&(l._31I=0),l._14I>M&&(l._14I=M),l._99I&&B&&l._99I(),ls(v,l.tx(),l.ty(),1),B?l._12I(v):l._24I&&l._13I(v),l._93I(),l._92I(),v.restore(),l._32I=l._24I=l._96I=y,q&&(l.scrollToIndex(l.getRowIndex(q)),delete l._23I),l.tx(l.tx()),l.ty(l.ty())}},Ae._48o=function(s){s._rootVisible=!0,s._rootData=y,s._35o=function(){this._expandMap={},this._levelMap={}},s.validateModel=function(){var D=this,_=D._rootData;D._rows.clear(),D._levelMap={},D._rowMap={},D._currentLevel=0,_?D._rootVisible?D.isVisible(_)&&D.buildData(_):D.buildChildren(_):D.buildChildren(),delete D._currentLevel},s.buildData=function(d){var l=this,t=d._id,m=l._rows;l._rowMap[t]=m.size(),m.add(d),l._levelMap[t]=l._currentLevel,l.isExpanded(d)&&(l._currentLevel++,l.buildChildren(d),l._currentLevel--)},s.buildChildren=function(v){var F=this,f=v?v._children:F._dataModel._roots,h=F.getCurrentSortFunc();h&&F.isChildrenSortable(v)?f.toList(F.isVisible,F).sort(h).each(F.buildData,F):f.each(function(w){F.isVisible(w)&&F.buildData(w)})},s.getLevel=function(M){return this._levelMap[M._id]},s.getToggleIcon=function(e){var I=this,D=I._loader,_=I._collapseIcon;return D&&!D.isLoaded(e)?_:e.hasChildren()?I.isExpanded(e)?I._expandIcon:_:y},s.isCheckMode=function(){return this._checkMode!=y},s.isChildrenSortable=function(){return!0},s.handleDataModelChange=function(V){var _=this;V.kind===ro?delete _._expandMap[V.data._id]:V.kind===Ih&&(_._expandMap={}),_.ivm()},s.toggle=function($){var G=this;G.isExpanded($)?G.collapse($):G.expand($)},s.isExpanded=function(b){return 1===this._expandMap[b._id]},s.expand=function($){var s=this,q=s._loader;s.isExpanded($)||(q&&!q.isLoaded($)&&q.load($),s._expandMap[$._id]=1,s.ivm(),s.onExpanded($))},s.onExpanded=function(){},s.collapse=function(J){var D=this;D.isExpanded(J)&&(delete D._expandMap[J._id],D.ivm(),D.onCollapsed(J))},s.onCollapsed=function(){},s.expandAll=function(D){if(D)this.expand(D),D.eachChild(function(Q){this.expandAll(Q)},this);else{var U=this;U._dataModel.each(function(I){I.hasChildren()&&(U._expandMap[I._id]=1)}),U.ivm()}},s.collapseAll=function(){this._expandMap={},this.ivm()},s.makeVisible=function(F){if(F){var o=this;if(!o._rootData||F.isDescendantOf(o._rootData)){for(var C=F._parent;C;)o.expand(C),C=C._parent;o._23I=F,o.iv()}}},s.checkData=function(T){var r,z=this,p=z._checkMode,_=z.sm(),u=_.co(T);if(!_.sg()||!u){if(z._32o=1,p===Dc)u?_.rs(T):_.as(T);else if(p===Kc)r=new wk(T),r.addAll(T._children);else if("descendant"===p)r=new wk,ei(T,r);else if("all"===p&&(r=new wk,ei(T,r),!u))for(var Y=T._parent;Y;)r.add(Y),Y=Y._parent;r&&(u?_.rs(r):_.as(r)),delete z._32o}},s._97I=function(M,Y,Z,i,e,J,B){var Q=this,h=Q._indent,D=Q._levelMap[Y._id],q=Q.getIconWidth(Y),r=qp(Q.getToggleIcon(Y));r?(i+=h*D,xh(M,r,i+h/2,e+B/2,Y,Q),i+=h):i+=h*(D+1),Q._checkMode&&(xh(M,Q.getCheckIcon(Y),i+h/2,e+B/2,Y,Q),i+=h),Q.drawIcon(M,Y,i,e,q,B),Q.drawLabel(M,Y,i+q,e,B)}},Ae._14Q=function(i){i.getIcon=function(g){return g.getIcon()},i.getIconWidth=function(l){return this.getIcon(l)?this._indent:0},i.drawIcon=function(C,m,S,d,v,p){if(v){var r=this,f=r.getBodyColor(m),D=qp(r.getIcon(m),f);D&&(p-=r.isRowLineVisible()?1:0,bp(C,D,jl,S,d,v,p,m,r,f),yp(C,r.getBorderColor(m),S,d,v,p))}},i.drawLabel=function(w,J,W,Y,g){var F=this;Ek(w,F.getLabel(J),F.getLabelFont(J),F.getLabelColor(J),W,Y,0,g)}},Ae._50o=function(N){N._98I=function(){var Y=this,C=Y._39o=new ub;Y._60I=new wk,C.mm(Y._17o,Y),C.md(Y._18o,Y),C.mh(Y._19o,Y)},N.setColumns=function(W){this._39o.clear(),this.addColumns(W)},N.addColumns=function(i){var H=this._39o;i.forEach(function(S){if(!(S instanceof Gn)){var u=Ic(S.className);S=rb(u?u:Gn,S)}H.add(S)})},N.onColumnClicked=function(){},N.onCheckColumnClicked=function(){},N._3Q=function(D){for(var V,$=0,U=this._60I,q=U.size();q>$;$++)if(V=U.get($),V.column===D)return V;return y},N.getColumnAt=function(T){var w=this._4Q(T);return w?w.column:y},N._4Q=function(k){for(var q=this,j=k.target?q.lp(k).x:k.x,Y=q._60I,E=0;E<Y.size();E++){var U=Y.get(E),m=U.startX;if(j>=m&&j<m+U.column.getWidth())return U}return y},N.getToolTip=function(o){var P=this,z=P.getDataAt(o),S=P.getColumnAt(o);return z&&S?S.getToolTip(z,P):y},N.adjustTranslateX=function(y){var Q=this.getWidth()-this._91I;return Q>y&&(y=Q),y>0?0:e(y)},N._99I=function(){var u=this,x=u._29I,r=u._60I;r.clear(),u._91I=0,u._39o._roots.each(function(N){if(N.isVisible()){var t=u._91I+N.getWidth();u._91I<=x.x+x.width&&t>=x.x&&r.add({column:N,startX:u._91I}),u._91I=t}}),u._91I+=u.getScrollBarSize()},N.drawData=function(f,U,h){var A=this,W=A._rowHeight,j=W*h,Z=A.isSelected(U),q=A._29I,c=q.x,m=q.width;A.drawRowBackground(f,U,Z,c,j,m,W),A._60I.each(function(D){var L=D.column,v=D.startX,k=L.getWidth();k>0&&!A.isEditing(U,L)&&(f.save(),f.beginPath(),f.rect(v,j,k,W),f.clip(),A._87o(A.drawCell(f,U,Z,L,v,j,k,W),h,v,j,k,W),A._columnLineVisible&&Gf(f,v+k-1,j,1,W,A._columnLineColor),f.restore())}),A._rowLineVisible&&Gf(f,c,j+W-1,m,1,A._rowLineColor)},N.drawCell=function(D,X,j,T,R,h,v,f){var I=this;if(T.drawCell)return T.drawCell(D,X,j,T,R,h,v,f,I);var b=I.getValue(X,T);Co(D,b,T,I.getLabelFont(X,T,b),I.getLabelColor(X,T,b),R,h,v,f,X,I)},N.getColumnModel=function(){return this._39o},N._17o=function(){this.redraw()},N._18o=function(t){var P=this;t.data===P._sortColumn&&dk[t.property]?P.ivm():(P._42o(),P.redraw())},N._19o=function(){this.redraw()},N.getCurrentSortFunc=function(){var u=this,t=u._sortColumn;if(t&&t.isSortable()){var v=t.getSortFunc(),m=bj===t.getSortOrder()?1:-1;return v||(v=Nn),function(Q,M){return v.call(u,u.getValue(Q,t),u.getValue(M,t),Q,M)*m}}return u._sortFunc},N.isCellEditable=function(P,A,W){return A.isEditable()&&this.isEditable()?A.isCellEditable?A.isCellEditable(P,A,W,this):!0:!1},N._37O=function(S,b){if(fq(b))for(var B=this,m=B.lp(b),q=B._60I,A=B._rowHeight,T=B._29I,J=T.x,j=T.y,n=T.width,L=T.height,G=0;G<q.size();G++){var Y=q.get(G),l=Y.startX,Q=Y.column,o=Q.getWidth();if(Q!==B._31o&&Q!==B._4o&&m.x>=l&&m.x<l+o&&B.isCellEditable(S,Q,b)){var g={x:l,y:B.getRowIndex(S)*A,width:o,height:A},D={x:g.x+B.tx(),y:g.y+B.ty(),width:g.width,height:g.height},E=0,c=0;return g.x<J?E=g.x-J:g.x+g.width>J+n&&(E=g.x+g.width-J-n),E&&(B.tx(B.tx()-E),D.x-=E),g.y<j?c=g.y-j:g.y+A>j+L&&(c=g.y+A-j-L),c&&(B.ty(B.ty()-c),D.y-=c),B.beginEditing({data:S,column:Q,value:B.getValue(S,Q),event:b,rect:g,editorRect:D,view:B}),void 0}}}},cs.BaseItemEditor=function(I,Z,a,p){this._data=I,this._column=Z,this._master=a,this._editInfo=p},Qb("BaseItemEditor",M,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var $c=T.Tab=function(){hg($c,this)};ld("Tab",gl,{ms_ac:["view","closable","disabled"],_icon:y,_closable:!1,_disabled:!1,setParent:Rp});var Gn=T.Column=function(){hg(Gn,this)};ld("Column",gl,{_46o:1,ms_ac:["accessType","valueType",nc,Km,ae,Nr,"align",js,"sortOrder",lc,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:bj,_sortFunc:y,_sortable:!0,_clickable:!0,setWidth:function(K){16>K&&(K=16);var A=this._width;this._width=K,this.fp(Nr,A,K)},getToolTip:function(r,T){return this.formatValue(T.getValue(r,this))}});var ir=T.Property=function(){hg(ir,this)};ld("Property",gl,{_46o:1,ms_ac:["accessType","valueType",Km,ae,"categoryName",js,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:y,getToolTip:function(H,M,j){var k=this;return M?k.formatValue(j.getValue(H,k)):j.getPropertyName(k)}}),cs.AccordionView=function(){var g=this;g._20o={},g._21o=new wk,g._10o=y,g._9o=y,g._11o=y,g._view=jj(0,g),g.iv()},Qb("AccordionView",M,{ms_v:1,ms_fire:1,ms_ac:[Cr,Ve,"titleHeight",Nq,Wj,"titleBackground","selectWidth",Xo,"orientation","separatorColor"],_expandIcon:N.accordionViewExpandIcon,_collapseIcon:N.accordionViewCollapseIcon,_titleHeight:Im,_labelColor:N.accordionViewLabelColor,_labelFont:N.accordionViewLabelFont,_titleBackground:N.accordionViewTitleBackground,_selectBackground:N.accordionViewSelectBackground,_selectWidth:N.accordionViewSelectWidth,_orientation:"v",_separatorColor:N.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(Q,r,X,P){var q=this,C=Mg();if(q._20o[Q])throw Q+" already exists";C.onmousedown=Mf,C.style.cursor=Rb,C.addEventListener(jm?uf:Kd,function(J){Mf(J)},Z),C.addEventListener(jm?wj:aj,function(V){Mf(V),fq(V)&&(q._10o===Q?q.collapse():q.expand(Q))},Z),Ah(q._view,C),q._20o[Q]={content:r,div:C,canvas:ff(C),icon:P},q._21o.add(Q),X&&q.expand(Q),q.iv()},remove:function(X){var Z=this,J=Z._20o[X];J&&(Hm(J.div),delete Z._20o[X],Z._21o.remove(X),Z.iv())},clear:function(){var q=this;q._21o.toArray().forEach(q.remove,q),q._20o={},q._21o.clear(),q.iv()},isExpanded:function(d){return this._10o===d},expand:function(M){var f=this;f._20o[M]&&f._10o!==M&&(f._10o=M,f.onExpanded(M),f.iv())},onExpanded:function(){},collapse:function(){var N=this;N._10o&&(N.onCollapsed(N._10o),delete N._10o,N.iv())},onCollapsed:function(){},initCanvas:function(T,u,y){$b(T,u,y);var $=Hl(T);return ls($,0,0,1),$.clearRect(0,0,u,y),$},drawTitle:function(r,O,F,y,$){var I=this,l=qp($.icon),e=I.isExpanded(O),P=I._titleHeight,X=I._titleBackground,h=I._selectWidth,i=I._separatorColor,x=qp(e?I._expandIcon:I._collapseIcon),Q=h+4;Gf(r,0,0,F,y,X),e&&h&&Gf(r,0,0,h,y,I._selectBackground),(e||I._21o.get(I._21o.size()-1)!==O)&&Gf(r,0,y-1,F,1,i?i:Vp(X)),l&&(xh(r,l,Q+$m(l)/2,P/2),Q+=$m(l)+2),Ek(r,O,I.getLabelFont(O),I.getLabelColor(O),Q,0,0,P),x&&xh(r,x,F-$m(x)/2-4,P/2)
},validateImpl:function(){var t=this,H=t._view,F=0,v=0,l=t.getWidth(),u=t.getHeight(),I=t._titleHeight,K=t._21o.size()*I,h=t._11o,g=t._9o;delete t._11o,delete t._9o,t._21o.each(function(C){var y,W,D=t._20o[C],S=D.content,z=t._10o===C;er(t)?(Ce(D.div,F,0,I,u),y=t.initCanvas(D.canvas,I,u),Gj(y,0,u),mn(y,-E),t.drawTitle(y,C,u,I,D),y.restore(),z?(W=m(0,l-K),S&&(t._11o=S,t._9o=Il(S),Ce(S,F+I,0,W,u)),F+=I+W):F+=I):(Ce(D.div,0,v,l,I),y=t.initCanvas(D.canvas,l,I),t.drawTitle(y,C,l,I,D),y.restore(),z?(W=m(0,u-K),S&&(t._11o=S,t._9o=Il(S),Ce(S,0,v+I,l,W)),v+=I+W):v+=I)});var J=t._9o;h&&h!==t._11o&&h.endEditing&&h.endEditing(),J&&J!==g&&Ah(H,J),g&&g!==J&&Hm(g)}}),cs.SplitView=function(z,k,c,S){var i=this,C=i._dividerDiv=Mg(),g=i._60O=ff(),O=i._61O=ff(),A=g.style,K=O.style;i._view=jj(1,i),Ah(i._view,C),A.msTouchAction=$k,A.pointerEvents=$k,A.cursor=Rb,K.msTouchAction=$k,K.pointerEvents=$k,K.cursor=Rb,z&&i.setLeftView(z),k&&i.setRightView(k),c&&i.setOrientation(c),S!=y&&i.setPosition(S),i.setStatus(Og),new Jr(i)},Qb("SplitView",M,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:N.splitViewDividerSize,_dividerBackground:N.splitViewDividerBackground,_dragOpacity:N.splitViewDragOpacity,_toggleIcon:N.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(Q,l){var t=this,X=t._position;isNaN(Q)||(l||(t._82O=0>Q?-1:Q>1?1:0),t._position=Q,t.fp(hp,X,Q))},getLeftView:function(){return this._leftView},setLeftView:function(A){var d=this,M=d._leftView,T=d._view;if(d._leftView!==A){if(M&&M!==d._rightView){var w=Il(M);w.parentNode===T&&Hm(w)}if(d._leftView=A,A){var K=Il(A);K.parentNode!==T&&T.insertBefore(K,d._dividerDiv)}d.fp("leftView",M,A)}},getRightView:function(){return this._rightView},setRightView:function(A){var W=this,J=W._rightView,n=W._view;if(W._rightView!==A){if(J&&J!==W._leftView){var q=Il(J);q.parentNode===n&&Hm(q)}if(W._rightView=A,A){var V=Il(A);V.parentNode!==n&&n.insertBefore(V,W._dividerDiv)}W.fp("rightView",J,A)}},validateImpl:function(){var M=this,G=M._draggable,t=M._position,g=M.getWidth(),X=M.getHeight(),h=M._dividerSize,I=M._dividerBackground,H=jm?18:8,c=M._dividerDiv,v=M._82O,C=M._60O,s=M._61O,o=M._toggleIcon,$=M._status,d=c.style,r=null,w=jm?20:4,B=o.comps[0];h>=H||0===h?M._coverDiv&&(Hm(M._coverDiv),delete M._coverDiv):M._coverDiv||(M._coverDiv=Mg(),P&&(M._coverDiv.style.background=Mn),Ah(c,M._coverDiv)),M._togglable?C.parentNode||(Ah(c,C),Ah(c,s)):(Hm(C),Hm(s));var q=M._coverDiv,l=M._leftView,K=M._rightView;if(er(M)){if(h>g&&(h=g),$===Og)if(1===v)var a=Y(t,g),W=m(0,g-h-a);else-1===v?(W=Y(-t,g),a=m(0,g-h-W)):(a=e((g-h)*t),W=m(0,g-h-a));else"cl"===$?(a=0,W=m(0,g-h)):"cr"===$&&(W=0,a=m(0,g-h));l&&Ce(l,0,0,a,X),K&&Ce(K,a+h,0,W,X),Ce(c,a,0,h,X),M._22o=a,q&&(Ce(q,h/2-H/2,0,H,X),q.style.cursor=G?zo:""),c.style.cursor=G?zo:"";var x=c.clientHeight/2,i=c.clientWidth;$b(C,i,i),Ce(C,0,x-i-w,i,i),r=Hl(C),ls(r,0,0,1),B.rotation=-E,bm(r,o,0,0,i,i),r.restore(),$b(s,i,i),Ce(s,0,x+w,i,i),r=Hl(s),ls(r,0,0,1),B.rotation=E,bm(r,o,0,0,i,i),r.restore()}else{if(h>X&&(h=X),$===Og)if(1===v)var j=Y(t,X),V=m(0,X-h-j);else-1===v?(V=Y(-t,X),j=m(0,X-h-V)):(j=e((X-h)*t),V=m(0,X-h-j));else"cl"===$?(j=0,V=m(0,X-h)):"cr"===$&&(V=0,j=m(0,X-h));l&&Ce(l,0,0,g,j),K&&Ce(K,0,j+h,g,V),Ce(c,0,j,g,h),M._22o=j,q&&(Ce(q,0,h/2-H/2,g,H),q.style.cursor=G?mk:""),d.cursor=G?mk:"";var u=c.clientWidth/2,i=c.clientHeight;$b(C,i,i),Ce(C,u-i-w,0,i,i),r=Hl(C),ls(r,0,0,1),B.rotation=0,bm(r,o,0,0,i,i),r.restore(),$b(s,i,i),Ce(s,u+w,0,i,i),r=Hl(s),ls(r,0,0,1),B.rotation=p,bm(r,o,0,0,i,i),r.restore()}d.background=I}});var Jr=function(j){this.sv=j,this.addListeners()};wr(Jr,M,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(c){var D=this,h=D.sv,u=h._dividerDiv,w=h._60O,S=h._61O,W=h._status,P=c.target;if(P===w)W===Og?h.setStatus("cl"):"cr"===W&&h.setStatus(Og);else if(P===S)W===Og?h.setStatus("cr"):"cl"===W&&h.setStatus(Og);else if(Hg(c)&&(P===u||P===h._coverDiv)&&(Mf(c),h.isDraggable())){h.getLeftView(),h.getRightView();var H=D.maskDiv=Mg();if(H.style.left=0,H.style.top=0,H.style.width=h.getWidth()+"px",H.style.height=h.getHeight()+"px",h.getView().appendChild(H),!h.isContinuousLayout()){var a=D.resizeDiv=Mg();a.style.left=u.style.left,a.style.top=u.style.top,a.style.width=u.style.width,a.style.height=u.style.height,a.style.opacity=h.getDragOpacity(),a.style.background=h.getDividerBackground(),Ah(D.getView(),a)}D._lastAbsPosition=h._22o,D._86o=er(h)?Ne(c).x:Ne(c).y,Ej(D,c)}},handleWindowTouchMove:function(a){Hg(a)&&this.update(a,this.sv.isContinuousLayout())},handleWindowTouchEnd:function($){var Q=this;Q.update($,!0),Q.sv.setStatus(Og),Q.maskDiv&&Hm(Q.maskDiv),Q.resizeDiv&&Hm(Q.resizeDiv),Q.maskDiv=Q.resizeDiv=y},handle_mousedown:function(S){fq(S)&&this.handle_touchstart(S)},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowMouseUp:function(n){this.handleWindowTouchEnd(n)},update:function(Z,b){var L=this,i=L.sv,v=er(i)?i.getWidth():i.getHeight(),f=i._dividerSize,T=L._lastAbsPosition-L._86o;er(i)?(T+=Ne(Z).x,T>v-f&&(T=v-f),0>T&&(T=0),L.resizeDiv&&(L.resizeDiv.style.left=T+Tg)):(T+=Ne(Z).y,T>v-f&&(T=v-f),0>T&&(T=0),L.resizeDiv&&(L.resizeDiv.style.top=T+Tg)),b&&v!==f&&(1===i._82O?i.setPosition(T,1):-1===i._82O?i.setPosition(T-v+f,1):i.setPosition(T/(v-f),1))}}),cs.TabView=function(){var Z=this,Q=Z._view=jj(1,Z),z=Z._91O=Mg(1),B=Z._tabModel=new ub,j=B.sm(),T=Z.invalidate;Z._7o=new wk,Z._canvas=ff(z),Ah(Q,z),Ah(Q,Z._92O=Mg(1)),j.setSelectionMode(fe),j.ms(Z.handleSelectionChange,Z),B.mm(T,Z),B.md(T,Z),B.mh(T,Z),Z._interactor=new Gl(Z),Z.iv()},Qb("TabView",M,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Nq,Wj,"tabBackground","selectWidth",Xo,"moveBackground","insertColor"],_tabPosition:Zp,_tabHeight:Im,_tabGap:N.tabViewTabGap,_labelColor:N.tabViewLabelColor,_labelFont:N.tabViewLabelFont,_tabBackground:N.tabViewTabBackground,_selectWidth:N.tabViewSelectWidth,_selectBackground:N.tabViewSelectBackground,_moveBackground:N.tabViewMoveBackground,_insertColor:N.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(K,f,R){var g,Y=this._tabModel;return K instanceof $c?(g=K,f&&g.setView(f)):(g=new $c,g.setName(K),g.setView(f)),Y.add(g),R&&Y.sm().ss(g),g},getLabel:function(J){return J.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(t){this._23o=t,this.iv()},get:function(O){var i=this,E=i._tabModel;if(zb(O))return E._roots.get(O);if(Hc(O)){var d;return E.each(function(D){O===i.getLabel(D)&&(d=D)}),d}return O instanceof $c?O:y},select:function(v){this._tabModel.sm().ss(this.get(v))},remove:function(O){var c=this;if(O=c.get(O)){var C=c._tabModel,m=C._roots.indexOf(O);c._tabModel.remove(O),c.selectByIndex(--m)}},getCurrentTab:function(){return this._8o},hideTabView:function(E,g){g.parentNode===this._92O&&(af(g)?(g.style.display=Pf,g._tab_=E):Hm(g),Dn())},showTabView:function(E,X){af(X)&&(X.style.display="block",X._tab_=E),X.parentNode!==this._92O&&(Ah(this._92O,X),Dn())},_24o:function(){var R,e=this,c=e._8o,u=e._9o,T=e._tabModel.sm().ld();T&&(R=Il(T.getView())),R!==u&&(u&&(c.getView()&&c.getView().endEditing&&c.getView().endEditing(),e.hideTabView(c,u)),R&&e.showTabView(T,R)),e._8o=T,e._9o=R,c!==T&&e.onTabChanged(c,T)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(c,p){this.selectByIndex(--p)},selectByIndex:function(V){var x=this,U=x._tabModel,K=U.size();if(K&&!U.sm().ld()){V==y&&(V=0),V>=K&&(V=K-1),0>V&&(V=0);for(var u=V;u>=0;u--){var s=x.get(u);if(!s.isDisabled())return x.select(s),s}for(u=V+1;K>u;u++)if(s=x.get(u),!s.isDisabled())return x.select(s),s}},getTabWidth:function(e){var $=4,w=qp(e.getIcon());w&&($+=$m(w,e)+4);var p=this.getLabel(e);return p&&($+=iq(this.getLabelFont(e),p).width+4),e.isClosable()&&($+=10),$},drawTab:function(Z,Q,S,g,m,K,t){var i,c=this,V=c._tabPosition,C=S+4,o=c._selectWidth,n=qp(Q.getIcon()),q=Q.isDisabled(),H=c.getLabelColor(Q),h=c.getLabelFont(Q),l=c.getLabel(Q),A=c._selectBackground,M=V===Cb+"-vertical",$=V===Fq+"-vertical";(M||$)&&(C=g+4),q&&(Z.globalAlpha=el),Gf(Z,S,g,m,K,t),Q===c._8o&&o&&(V===Zp?Gf(Z,S,g+K-o,m,o,A):V===Cb?Gf(Z,S+m-o,g,o,K,A):V===Fq?Gf(Z,S,g,o,K,A):M?Gf(Z,S+m-o,g,o,K,A):$?Gf(Z,S,g,o,K,A):Gf(Z,S,g,m,o,A));var w=m/2;if(M&&(Gj(Z,w,g+K/2),mn(Z,p),Gj(Z,-w,-g-K/2)),n){var f=Lq(n,Q),d=$m(n,Q);if(M||$){var j=S+m/2,T=C+f/2;Gj(Z,j,T),mn(Z,E),Gj(Z,-j,-T),xh(Z,n,S+m/2,C+f/2,Q,c),Gj(Z,j,T),mn(Z,-E),Gj(Z,-j,-T),C+=f+4}else xh(Z,n,C+d/2,g+K/2,Q,c),C+=d+4}return M||$?(Gj(Z,m/2,C+m/2),mn(Z,E),Gj(Z,-m/2,-C-m/2),Ek(Z,l,h,H,S,C,K,m),Gj(Z,m/2,C+m/2),mn(Z,-E),Gj(Z,-m/2,-C-m/2)):Ek(Z,l,h,H,C,g,m,K),M&&(Gj(Z,w,g+K/2),mn(Z,-p),Gj(Z,-w,-g-K/2)),Q.isClosable()&&(i=$?{x:S+m-12,y:g+K-12,width:12,height:12}:{x:S+m-12,y:g+2,width:12,height:12},this.drawCloseIcon(Q,Z,H,i)),q&&(Z.globalAlpha=1),i},drawCloseIcon:function(g,V,C,D){var n=D.x,t=D.y;V.strokeStyle=C,V.lineWidth=1,V.beginPath(),V.moveTo(n+2,t+8),V.lineTo(n+8,t+2),V.moveTo(n+8,t+8),V.lineTo(n+2,t+2),V.stroke()},getTabAt:function(s){var D=this._interactor._8Q(s);return D?D.tab:null},validateImpl:function(){var a=this;a._24o();var p,g=a._canvas,h=a._tabPosition,y=a._91O,w=a._92O,H=a._tabModel,D=a.getWidth(),O=a.getHeight(),q=a._tabHeight,B=a._7o,o=a._tabGap,I=h===Zp,J=h===Cb,N=h===Fq,f=h===Cb+"-vertical",U=h===Fq+"-vertical",u=a._23o,z=0;if((J||N)&&H._roots.each(function(A){z=m(a.getTabWidth(A),z)}),I?(Ce(y,0,0,D,q),p={x:0,y:q,width:D,height:m(0,O-q)}):J?(Ce(y,0,0,z,O),p={x:z,y:0,width:m(0,D-z),height:O}):N?(Ce(y,D-z,0,z,O),p={x:0,y:0,width:m(0,D-z),height:O}):f?(Ce(y,0,0,q,O),p={x:q,y:0,width:m(0,D-q),height:O}):U?(Ce(y,D-q,0,q,O),p={x:0,y:0,width:m(0,D-q),height:O}):(Ce(y,0,O-q,D,q),p={x:0,y:0,width:D,height:m(0,O-q)}),Ce(w,p),f||U){a._9o&&(p.x=0,Ce(a._8o.getView(),p)),$b(g,q,O);var M=Hl(g),n=0;if(ls(M,0,a.ty(),1),M.clearRect(0,0,q,O),B.clear(),H._roots.each(function(p){var z,h=a.getTabWidth(p);u&&u.tab===p||(z=a.drawTab(M,p,0,n,q,h,a._tabBackground)),B.add({_75o:z,tab:p,startY:n,endY:n+h,height:h}),n+=h+o}),a._23Q=m(0,n-o),u){var Y=u.position;a.drawTab(M,u.tab,0,u.startY,q,u.height,a._moveBackground),Gf(M,0,Y,q,1,a._insertColor)}if(M.restore(),a._selectionChanged){a._selectionChanged=!1;for(var S=a.ty(),k=0;k<B.size();k++){var E=B.get(k);if(E.tab===a._8o){if(E.endY+S<0){a.ty(-E.startY);break}if(E.startY+S>O){a.ty(O-E.endY);break}}}}a.ty(a.ty())}else if(J||N){a._9o&&(p.x=0,Ce(a._8o.getView(),p)),$b(g,z,O);var M=Hl(g),n=0;if(ls(M,0,a.ty(),1),M.clearRect(0,0,z,O),B.clear(),H._roots.each(function(C){var Y;u&&u.tab===C||(Y=a.drawTab(M,C,0,n,z,q,a._tabBackground)),B.add({_75o:Y,tab:C,startY:n,endY:n+q,height:q}),n+=q+o}),a._23Q=m(0,n-o),u){var Y=u.position;a.drawTab(M,u.tab,0,u.startY,z,u.height,a._moveBackground),Gf(M,0,Y,z,1,a._insertColor)}if(M.restore(),a._selectionChanged){a._selectionChanged=!1;for(var S=a.ty(),k=0;k<B.size();k++){var E=B.get(k);if(E.tab===a._8o){if(E.endY+S<0){a.ty(-E.startY);break}if(E.startY+S>O){a.ty(O-E.endY);break}}}}a.ty(a.ty())}else{a._9o&&(p.y=0,Ce(a._8o.getView(),p)),$b(g,D,q);var M=Hl(g),C=0;if(ls(M,a.tx(),0,1),M.clearRect(0,0,D,q),B.clear(),H._roots.each(function(P){var X,d=a.getTabWidth(P);u&&u.tab===P||(X=a.drawTab(M,P,C,0,d,q,a._tabBackground)),B.add({_75o:X,tab:P,startX:C,endX:C+d,width:d}),C+=d+o}),a._64I=m(0,C-o),u){var Y=u.position;a.drawTab(M,u.tab,u.startX,0,u.width,q,a._moveBackground),jg(M,a._insertColor,Y,0,q)}if(M.restore(),a._selectionChanged){a._selectionChanged=!1;for(var A=a.tx(),k=0;k<B.size();k++){var E=B.get(k);if(E.tab===a._8o){if(E.endX+A<0){a.tx(-E.startX);break}if(E.startX+A>D){a.tx(D-E.endX);break}}}}a.tx(a.tx())}for(var T=[],t=w.children,k=0;k<t.length;k++){var d=t[k],e=d._tab_;e&&!H.contains(e)&&T.push(d)}T.forEach(function(r){w.removeChild(r)})}});var Gl=function(l){this.tv=l,this.addListeners()};wr(Gl,M,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(w){this.handleScroll(w,10*(w.wheelDelta/40))},handle_DOMMouseScroll:function(I){this.handleScroll(I,10*-I.detail)},handleScroll:function(G,v){Mf(G);var D=this.tv,S=D._tabPosition;!D._40o()||S!==Zp&&S!==Yg||D.tx(this.tv.tx()+v),!D._41o()||S!==Cb&&S!==Fq&&S!==Cb+"-vertical"&&S!==Fq+"-vertical"||D.ty(this.tv.ty()+v)},_8Q:function(X){var R,j,w=this.tv,L=w._tabPosition,J=w._7o;if(L===Zp||L===Yg){var m=w.lp(X).x;for(R=0;R<J.size();R++)if(j=J.get(R),j.startX<=m&&m<=j.endX)return j}else if(L===Cb||L===Fq||L===Cb+"-vertical"||L===Fq+"-vertical"){var z=w.lp(X).y;for(R=0;R<J.size();R++)if(j=J.get(R),j.startY<=z&&z<=j.endY)return j}return y},isClickable:function(Q){var Y=this.tv,R=Y._tabPosition,v=this._73o=this._8Q(Q);return!Y._40o()||R!==Zp&&R!==Yg?!Y._41o()||R!==Cb&&R!==Fq&&R!==Cb+"-vertical"&&R!==Fq+"-vertical"?v&&(!v.tab.isDisabled()||Y.isMovable()):!0:!0},handle_mousemove:function(C){var Y=this;Tk?Y._74o=Y._8Q(C):Y.getView().style.cursor=Y.isClickable(C)?Rb:""},handle_mousedown:function(L){this.handle_mousemove(L),this.handle_touchstart(L)},handle_touchstart:function(r){var k=this,g=k.tv,o=g._tabPosition;Mf(r),fq(r)&&k.isClickable(r)&&(o===Zp||o===Yg?(k.x=Ne(r).x,k.lp=g.lp(r),k.tx=g.tx()):(k.y=Ne(r).y,k.lp=g.lp(r),k.ty=g.ty()),Ej(k,r))},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowTouchMove:function(g){var B,x=this,u=x.tv,v=u._tabPosition,d=x._73o;if(v===Zp||v===Yg){if(B=Ne(g).x-x.x,!x._25o&&!x.moving&&h(B)>2&&(u._40o()&&!xj(g)?x._25o=1:d&&u.isMovable()&&(x.moving=1)),x._25o)u.tx(x.tx+B);else if(x.moving){var L=x.lp.x+B,H=u._tabGap/2;u._7o.each(function(D){var c=D.endX,j=L-D.startX<c-L;L>=D.startX&&c>=L&&u._7Q({tab:d.tab,startX:d.startX+B,width:d.width,front:j,insertTab:D.tab,position:j?m(0,D.startX-H):Y(u._64I,c+H)})})}}else if(B=Ne(g).y-x.y,!x._25o&&!x.moving&&h(B)>2&&(u._41o()&&!xj(g)?x._25o=1:d&&u.isMovable()&&(x.moving=1)),x._25o)u.ty(x.ty+B);else if(x.moving){var S=x.lp.y+B,H=u._tabGap/2;u._7o.each(function($){var W=$.endY,G=S-$.startY<W-S;S>=$.startY&&W>=S&&u._7Q({tab:d.tab,startY:d.startY+B,height:d.height,front:G,insertTab:$.tab,position:G?m(0,$.startY-H):Y(u._23Q,W+H)})})}},handleWindowMouseUp:function(Z){this.handleWindowTouchEnd(Z)},handleWindowTouchEnd:function(){var F=this,C=F.tv,e=C._tabPosition,p=C.getTabModel(),X=p._roots,U=F._73o;if(F.moving){var l=C._23o;if(l&&l.insertTab!==l.tab){var Z=l.tab,D=X.remove(Z),R=X.indexOf(l.insertTab);R>=0&&(l.front||R++,R<=X.size()&&(X.add(Z,R),p._38I(Z,D,R)))}C._7Q(y),delete F.moving}else if(!F._25o&&U){Z=U.tab;var b=F._74o;if(!b||b.tab===Z)if(!Z.isDisabled()&&Hi(U._75o,F.lp)){var _=function(){var Y=X.indexOf(Z);p.remove(Z),C.onTabClosed(Z,Y)};C.onTabClosing(Z,_)&&_()}else Z.isDisabled()||C._8o===Z||p.sm().ss(Z)}F._25o=F._73o=F._74o=e===Zp||e===Yg?F.x=F.lp=F.tx=y:F.y=F.lp=F.ty=y}}),cs.PropertyView=function(n){var J=this;J._view=jj(1,J),J._canvas=ff(J._view),Ah(J._view,J._79O=Mg()),J._rows=new wk,J._28o=new wk,J._26o={},J._26Q={};var H=J._propertyModel=new ub,V=J.ivm;H.mm(V,J),H.md(V,J),H.mh(V,J),J.dm(n?n:new ub),new jp(J)},Qb("PropertyView",M,{ms_ac:[Nq,Fg,Wj,Km,ae,"categorizable",rf,lc,Tn,Cr,Ve,Zq,nm,vi,"selectRowIndex",Xo,"background",sn,yr,Xg,Jp,$n],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Eo,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Ec,_background:N.propertyViewBackground,_expandIcon:N.propertyViewExpandIcon,_collapseIcon:N.propertyViewCollapseIcon,_scrollBarColor:Li,_scrollBarSize:mq,_autoHideScrollBar:Br,_selectBackground:N.propertyViewSelectBackground,_rowHeight:ni,_rowLineVisible:N.propertyViewRowLineVisible,_rowLineColor:N.propertyViewRowLineColor,_10I:.5,_columnLineVisible:N.propertyViewColumnLineVisible,_columnLineColor:N.propertyViewColumnLineColor,_labelColor:N.propertyViewLabelColor,_labelSelectColor:N.propertyViewLabelSelectColor,_labelFont:N.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(s){0>s&&(s=0),s>1&&(s=1);var g=this,_=g._10I;g._10I=s,g.fp("columnPosition",_,s)},getPropertyName:function(o){return o.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(o,M,V){return V===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(D,e){return e===this._selectRowIndex?this._labelSelectColor:D.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(r){var x=this.getHeight()-this._59I;return x>r&&(r=x),r>0?0:e(r)},isExpanded:function(q){if(!q)return!0;var U=this._26o[q];return U?U.isExpanded:!(this._26Q[q]===!1)},toggle:function(J){var a=this;a.isExpanded(J)?a.collapse(J):a.expand(J)},expandAll:function(){this.validate();for(var l in this._26o)this.expand(l)},expand:function(u){if(u&&u!==Pf){var J=this,t=J._26o[u];t&&!t.isExpanded&&(t.isExpanded=!0,J.onExpanded(u),J.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var M in this._26o)this.collapse(M)},collapse:function(w){if(w&&w!==Pf){var N=this,A=N._26o[w];A&&A.isExpanded&&(A.isExpanded=!1,N.onCollapsed(w),N.ivm())}},onCollapsed:function(){},getCategoryName:function(H){if(!this.isCategorizable())return Pf;var G=H.getCategoryName();return G?G:Pf},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(l){var W=this,V=W._dataModel;V!==l&&(V&&(V.umd(W.handlePropertyChange,W),W._selectionModel||V.sm().ums(W.handleSelectionChange,W)),W._dataModel=l,l.md(W.handlePropertyChange,W),W._selectionModel?W._selectionModel._21I(l):l.sm().ms(W.handleSelectionChange,W),W.fp(ns,V,l))},isVisible:function(e){return this._visibleFunc?this._visibleFunc(e):!0},onPropertyChanged:function(h){var A=this,U=h.property;Se[U]?A.ivm():A.iv(),U===Sj&&A._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:po},handlePropertyChange:function(D){this._27o===D.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var h=this;h._96I||(h.setSelectRowIndex(-1),h._96I=1,h.iv())},redraw:function(){this.iv()},validateModel:function(){var R=this,Y=R._rows,U=R._28o,X={},Z=new wk,j=R._27o;R.updateCurrentData(),j!==R._27o&&R.endEditing(),Y.clear(),U.clear(),R.getRawProperties().each(function(L){if(R.isVisible(L)){Z.add(L);var w=R.getCategoryName(L);X[w]||(U.add(w,w===Pf?0:d),X[w]={isExpanded:R.isExpanded(w),properties:new wk})}}),R._sortFunc&&Z.sort(R._sortFunc);for(var E in R._26o)R._26Q[E]=R.isExpanded(E);R._26o=X,U.each(function(m){m!==Pf&&Y.add(m);var t=X[m];t.isExpanded&&Z.each(function(V){R.getCategoryName(V)===m&&(t.properties.add(V),Y.add({property:V,data:R._27o}))},R)})},validateImpl:function(){var Q=this;Q._76o(),Q._96I&&(Q.validateModel(),delete Q._96I);var g=Q._canvas,t=Q.getWidth(),W=Q.getHeight(),B=-Q.ty(),k=Q._rowHeight,N=Q._indent,s=t-N,M=Q._rows,L=M.size(),D=Q._9I=N+s*Q._10I,f=Q._59I=L*k;$b(g,t,W),Q._29I={x:0,y:B,width:t,height:W},Q._31I=C(B/k),Q._14I=i((B+W)/k),Q._31I<0&&(Q._31I=0),Q._14I>L&&(Q._14I=L);var K,A=Hl(g),u=Q._background;ls(A,0,-B,1),A.beginPath(),A.rect(0,B,t,W),A.clip(),A.clearRect(0,B,t,W),Q._93db(A),u&&Gf(A,0,0,N,f,u);for(var r=Q._31I;r<Q._14I;r++){var O=M.get(r),B=k*r;if(Hc(O))u&&Gf(A,N,B,s,k,u),K=qp(Q.isExpanded(O)?Q._expandIcon:Q._collapseIcon),K&&bp(A,K,jl,0,B,N,k),A.save(),A.beginPath(),A.rect(N,B,s,k),A.clip(),Q.drawCategoryName(A,O,r,N,B,s,k),A.restore();else{var w=O.property,c=O.data,K=qp(w.getIcon()),J=Q._selectRowIndex===r?Q.getSelectBackground():y;if(K&&bp(A,K,jl,0,B,N,k),J&&Gf(A,N,B,s,k,J),A.save(),A.beginPath(),A.rect(N,B,D-N,k),A.clip(),Q.drawPropertyName(A,w,r,N,B,D-N,k),A.restore(),!Q.isEditing(c,w)){var P=D+1,X=t-D-1;A.save(),A.beginPath(),A.rect(P,B,X,k),A.clip(),Q._87o(Q.drawPropertyValue(A,w,Q.getValue(c,w),r,P,B,X,k,c),r,P,B,X,k),A.restore()}}Q._rowLineVisible&&Gf(A,N,B+k-1,s,1,Q._rowLineColor)}Q._columnLineVisible&&(Gf(A,D,0,1,f,Q._columnLineColor),Gf(A,t-1,0,1,f)),Q._92db(A),Q._93I(),A.restore(),Q.ty(Q.ty())},drawCategoryName:function(n,X,a,b,l,s,O){Ek(n,X,this.getCategoryFont(X),this.getCategoryColor(X),b,l,s,O)},drawPropertyName:function(n,Y,h,o,N,X,f){return Y.drawPropertyName?(Y.drawPropertyName(n,Y,h,o,N,X,f,this),void 0):(Ek(n,this.getPropertyName(Y),this.getPropertyFont(Y,h),this.getPropertyColor(Y,h),o,N,X,f),void 0)},drawPropertyValue:function(T,E,y,I,G,A,R,w,s){return E.drawPropertyValue?E.drawPropertyValue(T,E,y,I,G,A,R,w,s,this):(Co(T,y,E,this.getLabelFont(E,y,I),this.getLabelColor(E,y,I),G,A,R,w,s,this),void 0)},isPropertyEditable:function(U){return U.isEditable()&&this.isEditable()},setProperties:function(c){this._propertyModel.clear(),this.addProperties(c)},addProperties:function(_){if(_){var o=this._propertyModel;_.forEach(function(b){if(!(b instanceof ir)){var V=Ic(b.className);b=rb(V?V:ir,b)}o.add(b)})}},getRowIndexAt:function(K){var $=this,I=C($.lp(K).y/$._rowHeight);return I>=0&&I<$._rows.size()?I:-1},getPropertyAt:function(M){var J=this,h=J.getRowIndexAt(M);return h>=0?J._rows.get(h).property:y},getToolTip:function(T){var u=this,O=u.getPropertyAt(T),E=u._27o;return O&&E?O.getToolTip(E,u._9I<u.lp(T).x,u):y}});var jp=function(d){this.pv=d,this.addListeners()};wr(jp,M,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(g){this.getView().style.cursor=g},clear:function(){var k=this;k._62O=k.cp=k.ty=k.p=y,k.setCursor(Dc)},handle_mousedown:function(C){this.handle_touchstart(C)},handle_touchstart:function(R){var W=this,A=W.pv;Mf(R),A.setFocus(R)&&(fq(R)?(W.cp=Ne(R),W.ty=A.ty(),W.p=A.getColumnPosition(),W.handle_touchmove(R)):A.setSelectRowIndex(A.getRowIndexAt(R)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(F){this.handle_touchend(F)},handle_touchend:function(q){var e=this;if(e.cp&&!e._62O){var M=e.pv,D=M.lp(q),Y=D.x,K=D.y,r=M._indent,E=M.getRowIndexAt(q),$=M._9I;if(E>=0){var I=M._rowHeight,H=I*E,X=M._rows.get(E),V=X.property;if(Hc(X))qp(M.isExpanded(X)?M._expandIcon:M._collapseIcon)&&Y>=0&&r>=Y&&K>=H&&H+I>=K?M.toggle(X):_h(q)&&M.toggle(X);else if(Y>$&&M.isPropertyEditable(V,q)){var L={x:$+1,y:H,width:M.getWidth()-$-1,height:I},U={x:L.x+M.tx(),y:L.y+M.ty(),width:L.width,height:L.height},N=0,i=M._29I;L.y<i.y?N=L.y-i.y:L.y+I>i.y+i.height&&(N=L.y+I-i.y-i.height),N&&(M.ty(M.ty()-N),U.y-=N),M.beginEditing({data:X.data,property:V,value:M.getValue(X.data,V),event:q,rect:L,editorRect:U,view:M})}}M.setSelectRowIndex(E)}e.clear()},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowTouchMove:function(n){var C=this,f=C.pv,L=C.ty,u=C.cp,I=Ne(n),r=C._62O;if("p"===r)f.setTranslateY(L+I.y-u.y);else if("c"===r){var x=f.getWidth()-f._indent;if(x>16){var G=C.p-(u.x-I.x)/x,A=16/x;A>G&&(G=A),G>1-A&&(G=1-A),f.setColumnPosition(G)}}else"s"===r&&f.setTranslateY(L+(u.y-I.y)*f._59I/f._29I.height)},handle_mousemove:function(u){this.handle_touchmove(u)},handle_touchmove:function(y){if(!Tk&&fq(y)){var c=this,Z=c.pv,o=h(Z.lp(y).x-Z._9I)<=(jm?8:3);c.cp?c._62O||(o?(c._62O="c",Ej(c)):h(Ne(y).y-c.cp.y)>=2&&(c._62O=c.isV(y)?"s":"p",Ej(c))):(o?c.setCursor(zo):c.setCursor(Dc),c.isV(y)&&Z._43o())}},isV:function(l){var p=this.pv,Q=p._29I;return p._41o()&&Q.x+Q.width-p.lp(l).x<zm},handle_mousewheel:function(e){this.handleScroll(e,e.wheelDelta/40)},handle_DOMMouseScroll:function(s){2===s.axis&&this.handleScroll(s,-s.detail)},handleScroll:function(H,k){var g=this.pv;Mf(H),g.endEditing(),g.translate(0,k*g.getRowHeight())},handle_keydown:function(I){var G=this.pv,d=G._rows.size(),v=G._selectRowIndex+(kr(I)?-1:1);(kr(I)||bq(I))&&(0>v&&(v=0),v>=d&&(v=d-1),G.setSelectRowIndex(v))}}),cs.ListView=function(M){this._5o(M),new Ac(this)},Qb("ListView",M,{ms_ac:[Nq,Fg,Wj,sn,rf,yr,Xg,lc,Tn,Zq,nm,vi,bf,Xo],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Ec,_rowHeight:ni,_rowLineVisible:N.listViewRowLineVisible,_rowLineColor:N.listViewRowLineColor,_scrollBarColor:Li,_scrollBarSize:mq,_autoMakeVisible:Vn,_autoHideScrollBar:Br,_selectBackground:N.listViewSelectBackground,_labelColor:N.listViewLabelColor,_labelSelectColor:N.listViewLabelSelectColor,_labelFont:N.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(G){var n=this,H=n._checkMode;n._checkMode=G,n.fp(Yo,H,G)},drawRow:function(u,K,b,$,z,y,X){var T=this,i=0,N=T._indent,m=T.getIconWidth(K);T.drawRowBackground(u,K,b,$,z,y,X),T._checkMode&&(xh(u,qp(T.getCheckIcon(K)),i+N/2,z+X/2,K,T),i+=N),T.drawIcon(u,K,i,z,m,X),T.drawLabel(u,K,i+m,z,X)}});var Ac=function(S){this.list=S,this._lastSelectDataTime=vb(),this.addListeners()};wr(Ac,M,{ms_listener:1,getView:function(){return this.list._view},clear:function(J){var N=this,L=N.list;J&&"d"===N._62O&&!N.dragCancel&&L.handleDragAndDrop(J,"end"),L.draggingData&&(L.draggingData=null,L.redraw()),N.dragCancel=N._62O=N._isV=N._isH=N.cp=N.tx=N.ty=y},handle_mousedown:function(b){this.handle_touchstart(b)},handle_touchstart:function(O){var P=this,V=P.list;if(Mf(O),V.setFocus(O)){var i=V.getDataAt(O);P.cp=Ne(O),P.tx=V.tx(),P.ty=V.ty(),fq(O)?i&&V.handleDragAndDrop&&!P.isV(O)&&!P.isH(O)&&(V.draggingData=i,V.redraw(),V.handleDragAndDrop(O,"prepare")):(i&&P._33o(O,i),P.clear(O))}},handleWindowMouseUp:function(j){this.clear(j)},handleWindowTouchEnd:function(x){this.clear(x)},handle_mouseup:function(v){this.handle_touchend(v)},handle_touchend:function(Q){var c=this,Z=c.list;if(!c._isV&&!c._isH&&c.cp&&!c._62O){var Y=Z.getDataAt(Q);Y?(Z.isCheckMode()?c._34o(Q,Y):c._33o(Q,Y),_h(Q)?Z.onDataDoubleClicked(Y,Q):Z.onDataClicked(Y,Q)):Z.handleBackgroundClick(Q)}c.clear(Q)},handleWindowMouseMove:function(P){this.handleWindowTouchMove(P)},handleWindowTouchMove:function(D){var u=this,E=u.list,h=u._62O,m=u.tx,W=u.ty,L=u.cp,$=Ne(D),U=E._29I;"p"===h?E.setTranslate(m+$.x-L.x,W+$.y-L.y):"v"===h?E.ty(W+(L.y-$.y)*E._59I/U.height):"h"===h?E.tx(m+(L.x-$.x)*E._91I/U.width):"d"===h&&(u.dragCancel||E.handleDragAndDrop(D,"between"))},handle_mousemove:function(g){this.handle_touchmove(g)},handle_touchmove:function(T){if(!Tk&&fq(T)){var Y=this,C=Y.list;if(Y._isV=Y.isV(T),Y._isH=Y.isH(T),Y.cp){if(!Y._62O){if(kk(Ne(T),Y.cp)<2)return;Y._isV?Y._62O="v":Y._isH?Y._62O="h":C.draggingData&&!this.dragCancel?(Y._62O="d",C.handleDragAndDrop(T,"begin")):Y._62O="p",Y._62O&&"d"!==Y._62O&&C.draggingData&&(C.draggingData=null,C.redraw()),Ej(Y)}}else Y._isV&&C._43o(),Y._isH&&C._42o()}},isV:function(x){var X=this.list,C=X._29I;return X._41o()&&C.x+C.width-X.lp(x).x<zm},isH:function(f){var U=this.list,R=U._29I;return U._40o()&&R.y+R.height-U.lp(f).y<zm},handle_mousewheel:function(h){this.handleScroll(h,h.wheelDelta/40,h.wheelDelta!==h.wheelDeltaX)},handle_DOMMouseScroll:function(M){this.handleScroll(M,-M.detail,1)},handleScroll:function(R,P,w){var O=this.list;Mf(R),O.endEditing&&O.endEditing(),w&&O._41o()?O.translate(0,P*O.getRowHeight()):O._40o()&&O.translate(10*P,0)},handle_keydown:function(g){if(!N.isInput(g.target)){var L,Z=this.list,h=Z.sm(),b=Z._rows,p=b.size();if(Yf(g))Z.selectAll();else if(ol(g))Z.handleDelete&&Z.handleDelete(g);else if(Fd(g))"d"!==this._62O||this.dragCancel||(Z.handleDragAndDrop(g,"cancel"),this.dragCancel=!0);else if(gb(g))Z.isCheckMode()&&(L=Z.getFocusData(),L&&Z.checkData(L));else if(kr(g)||bq(g)){var Y=Z.isCheckMode();if(L=Y?Z.getFocusData():h.ld()){var r=Z.getRowIndex(L);r>=0&&(kr(g)?0!==r&&(L=b.get(r-1),Y?Z.setFocusData(L):h.ss(L)):r!==p-1&&(L=b.get(r+1),Y?Z.setFocusData(L):h.ss(L)))}else p>0&&(L=b.get(0),Y?Z.setFocusData(L):h.ss(L))}}},_34o:function(N,Z){var P=this.list,L=P.lp(N).x;return L>=0&&L<=P._indent?(P.checkData(Z),void 0):(P.setFocusData(Z),void 0)},_33o:function(g,e){var H=this.list,b=H.sm(),n=b.ld();if(xj(g))H.isSelected(e)?b.rs(e):b.as(e);else if(im(g))if(n)for(var F=H.getRowIndex(n),r=H.getRowIndex(e);F!==r;)F+=r>F?1:-1,b.as(H._rows.get(F));else b.ss(e);else if(fq(g)){var k=vb();if(b.contains(e)){var U=k-this._lastSelectDataTime;H.handleDataDoubleSelect&&U>500&&1500>U&&H.handleDataDoubleSelect(g,e)}b.ss(e),this._lastSelectDataTime=k}else b.contains(e)||b.ss(e)}}),cs.TreeView=function(v){var s=this;s._35o(),s._5o(v),new Sl(s)},Qb("TreeView",M,{ms_ac:[Nq,Fg,Wj,"rootVisible",Yo,"rootData",lc,Tn,Zq,nm,vi,rf,sn,yr,Xg,Cr,Ve,bf,Xo,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:y,_indent:Ec,_rowHeight:ni,_rowLineVisible:N.treeViewRowLineVisible,_rowLineColor:N.treeViewRowLineColor,_scrollBarColor:Li,_scrollBarSize:mq,_autoHideScrollBar:Br,_expandIcon:N.treeViewExpandIcon,_collapseIcon:N.treeViewCollapseIcon,_autoMakeVisible:Vn,_selectBackground:N.treeViewSelectBackground,_labelColor:N.treeViewLabelColor,_labelSelectColor:N.treeViewLabelSelectColor,_labelFont:N.treeViewLabelFont,_doubleClickToToggle:N.treeViewDoubleClickToToggle,drawRow:function(X,j,F,A,d,e,Q){var O=this;O.drawRowBackground(X,j,F,A,d,e,Q),O._97I(X,j,F,0,d,e,Q)},isOnToggleIcon:function(Q){var E=this.getDataAt(Q);if(E){var f=this.getIndent(),$=this.lp(Q).x;if(qp(this.getToggleIcon(E))){var U=f*this.getLevel(E);if($>=U&&U+f>=$)return!0}}return!1}});var Sl=function(z){hg(Sl,this,[z])};wr(Sl,Ac,{toggle:function(G,y,Q,u){var I=this.list,z=I.lp(G).x;if(qp(I.getToggleIcon(y))){var M=Q*u;if(z>=M&&M+Q>=z)return I.toggle(y),!0}return I.isDoubleClickToToggle()&&_h(G)?(I.toggle(y),!0):!1},_34o:function(R,w){var y=this.list,F=y.lp(R).x,H=y._levelMap[w._id],Q=y._indent,z=Q*(H+1);return F>=z&&z+Q>=F?(y.checkData(w),void 0):(this.toggle(R,w,Q,H)||y.setFocusData(w),void 0)},_33o:function(s,Z){var X=this,o=X.list;X.toggle(s,Z,o._indent,o.getLevel(Z))||Sl.superClass._33o.call(X,s,Z)},handle_keydown:function(L){if(Oc(L)||pe(L)){var Q=this.list,z=Q._rows,h=Q.isCheckMode(),l=Q.sm(),y=h?Q.getFocusData():l.ld();y?y.hasChildren()&&(Oc(L)?Q.collapse(y):Q.expand(y)):z.size()>0&&(y=z.get(0),h?Q.setFocusData(y):l.ss(y))}else Sl.superClass.handle_keydown.call(this,L)}});var Ho=cs.TableView=function(N){this._98I(),this._5o(N),new df(this)};Qb("TableView",M,{ms_ac:[Nq,Fg,Wj,"sortMode",Km,ae,sn,yr,Xg,Jp,$n,"sortColumn",lc,Tn,Zq,nm,vi,bf,Xo],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Jk,_editable:!0,_batchEditable:!1,_rowHeight:ni,_rowLineVisible:N.tableViewRowLineVisible,_rowLineColor:N.tableViewRowLineColor,_columnLineVisible:N.tableViewColumnLineVisible,_columnLineColor:N.tableViewColumnLineColor,_scrollBarColor:Li,_scrollBarSize:mq,_autoHideScrollBar:Br,_autoMakeVisible:Vn,_selectBackground:N.tableViewSelectBackground,_labelColor:N.tableViewLabelColor,_labelSelectColor:N.tableViewLabelSelectColor,_labelFont:N.tableViewLabelFont,getCheckColumn:function(){var u=this;if(!u._31o){var x=u._31o=new Gn;x.setEditable(!0),x.setWidth(40),x.getValue=u.getCheckColumValue,x.drawCell=u.drawCheckColumnCell}return u._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(C){var o=this,K=o._39o,D=o.getCheckColumn();C!==o.isCheckMode()&&(C?K.add(D,0):K.remove(D),o.fp(Yo,!C,C))},getCheckColumValue:function(y,z,q){return q.isSelected(y)},drawCheckColumnCell:function(N,L,v,V,A,u,t,X,Q){xh(N,Q.getCheckIcon(L),A+t/2,u+X/2,L,Q)}});var df=function(t){hg(df,this,[t])};wr(df,Ac,{_34o:function(S,f){var K=this.list,O=K._31o;if(K.isCellEditable(f,O,S)){var k=K._3Q(O),$=K.lp(S).x;
if(k&&$>=k.startX&&$<k.startX+O.getWidth())return K.checkData(f),void 0}K._37O(f,S),K.setFocusData(f)},_33o:function(w,t){this.list._37O(t,w),df.superClass._33o.apply(this,arguments)}});var ss=cs.TreeTableView=function(p){var J=this,u=J._4o=new Gn;J._35o(),J._98I(),J._5o(p),u.setDisplayName("Name"),u.setEditable(!0),u.setWidth(180),u.drawCell=Eh,u.getValue=vh,J._39o.add(u),new wh(J)},Eh=function(a,N,w,y,s,J,E,A,L){L._97I(a,N,w,s,J,E,A)},vh=function(L,v,l){return l.getLabel(L)};Qb("TreeTableView",M,{ms_ac:[Nq,Fg,Wj,"sortMode",Km,ae,rf,Yo,"rootData","rootVisible",lc,Tn,"sortColumn",Cr,Ve,Zq,nm,vi,bf,Xg,sn,yr,Jp,$n,Xo,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Jk,_checkMode:y,_editable:!0,_batchEditable:!1,_indent:Ec,_rowHeight:ni,_rowLineVisible:N.treeTableViewRowLineVisible,_rowLineColor:N.treeTableViewRowLineColor,_columnLineVisible:N.treeTableViewColumnLineVisible,_columnLineColor:N.treeTableViewColumnLineColor,_expandIcon:N.treeTableViewExpandIcon,_collapseIcon:N.treeTableViewCollapseIcon,_scrollBarColor:Li,_scrollBarSize:mq,_autoHideScrollBar:Br,_autoMakeVisible:Vn,_selectBackground:N.treeTableViewSelectBackground,_labelColor:N.treeTableViewLabelColor,_labelSelectColor:N.treeTableViewLabelSelectColor,_labelFont:N.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var wh=function(q){hg(wh,this,[q])};wr(wh,Ac,{_34o:function(d,f){var Z=this.list,l=Z._4o,e=Z._3Q(l),E=Z.lp(d).x;if(e){var t=Z._indent,C=e.startX+t*Z.getLevel(f);if(qp(Z.getToggleIcon(f))&&E>=C&&C+t>=E)return Z.toggle(f),void 0;if(Z.isCellEditable(f,l)&&(C+=t,E>=C&&C+t>=E))return Z.checkData(f),void 0}Z._37O(f,d),Z.setFocusData(f)},_33o:function(k,W){var _=this.list,i=_.lp(k).x;if(qp(_.getToggleIcon(W))){var V=_._3Q(_._4o);if(V){var D=_._indent,X=V.startX+D*_.getLevel(W);if(i>=X&&X+D>=i)return _.toggle(W),void 0}}_._37O(W,k),wh.superClass._33o.apply(this,arguments)}});var Td=cs.TableHeader=function(F){var z=this,X=z._view=jj(1,z),$=z._39o=F.getColumnModel(),p=z.iv;z.tv=z._tableView=F,z._60I=new wk,z._canvas=ff(X),X.style.background=N.tableHeaderBackground||"",X.style.height=td+Tg,$.mm(p,z),$.md(p,z),$.mh(p,z),F.mp(function(n){Lh[n.property]&&z.iv()},z),new Lk(z),z.iv()};Qb("TableHeader",M,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Nq,Wj,rf,"moveBackground","insertColor",Jp,$n,"resizable","movable"],_checkIcon:eq,_movable:!0,_resizable:!0,_labelColor:N.tableHeaderLabelColor,_labelFont:N.tableHeaderLabelFont,_columnLineColor:N.tableHeaderColumnLineColor,_columnLineVisible:N.tableHeaderColumnLineVisible,_sortDescIcon:N.tableHeaderSortDescIcon,_sortAscIcon:N.tableHeaderSortAscIcon,_moveBackground:N.tableHeaderMoveBackground,_insertColor:N.tableHeaderInsertColor,_indent:Ec,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(p){return p.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(L){return L.getColor()||this._labelColor},getLabelAlign:function(E){return E._align},onPropertyChanged:function(){this.iv()},_5Q:function(m){this._61I=m,this.iv()},getLogicalPoint:function(l){return Zf(l,this._canvas,this.tv.tx())},validateImpl:function(){var Z=this,X=Z._canvas,L=Z.getWidth(),b=Z.getHeight(),N=Z.tv,B=Z._60I,U=Z._61I,h=-N.tx(),k=0;(L!==X.clientWidth||b!==X.clientHeight)&&$b(X,L,b),B.clear(),Z._39o._roots.each(function(U){if(U.isVisible()){var d=k+U.getWidth();h+L>=k&&d>=h&&B.add({column:U,startX:k}),k=d}});var g=Hl(X);if(ls(g,-h,0,1),g.beginPath(),g.rect(h,0,L,b),g.clip(),g.clearRect(h,0,L,b),B.each(function(e){var V=e.column,j=e.startX,n=V.getWidth();n>0&&(g.save(),g.beginPath(),g.rect(j,0,n,b),g.clip(),U&&U.column===V||Z.drawColumn(g,V,j,0,n,b),Z._columnLineVisible&&Gf(g,j+n-1,0,1,b,Z._columnLineColor),g.restore())}),U){var n=U.column,k=U.startX,E=U.position,c=n.getWidth();g.save(),g.beginPath(),g.rect(k,0,c,b),g.clip(),g.fillStyle=Z._moveBackground,g.fill(),Z.drawColumn(g,n,k,0,c,b),g.restore(),jg(g,Z._insertColor,E,0,b)}g.restore()},_6Q:function(D){var i=this.tv;return i._31o===D&&i.sm().getSelectionMode()===sj},drawColumn:function(W,B,f,j,p,m){var u=this,P=u.tv,z=qp(B.getIcon()),t=u.getLabelAlign(B);if(u._6Q(B)){var v=qp(u._checkIcon);xh(W,v,f+p/2,j+m/2,B,u)}else{var U=u.getLabel(B),E=u.getLabelFont(B),L=u.getLabelColor(B),S=iq(E,U).width,M=z?u._indent:0;t===Cb?(z&&bp(W,z,jl,f,j,M,m),Ek(W,U,E,L,f+M,j,p,m,Cb)):t===Fq?(z&&bp(W,z,jl,f+p-S-M,j,M,m),Ek(W,U,E,L,f,j,p,m,Fq)):(z&&bp(W,z,jl,f+(p-S-M)/2,j,M,m),Ek(W,U,E,L,f+(p-S+M)/2,j,0,m,Cb))}if(B.isSortable()&&P.getSortColumn()===B&&(z=qp(B.getSortOrder()===bj?u._sortAscIcon:u._sortDescIcon))){var w=$m(z,B)/2+2;xh(W,z,t===Fq?f+w:f+p-w,j+m/2,B,P)}}});var Lk=function(H){var t=this;t.th=H,t.tv=H._tableView,t.addListeners()};wr(Lk,M,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(G){this.getView().style.cursor=G},handle_mousemove:function(s){if(!Tk){var j=this;delete j._29o,j.setCursor(Dc);for(var g=j.th,e=g._60I,v=g.lp(s).x,Z=e.size()-1;Z>=0;Z--){var w=e.get(Z),N=w.column,R=w.startX+N.getWidth();if(g.isResizable()&&h(R-v)<=(jm?10:3))return j._29o=w,j.setCursor(zo),void 0;v>w.startX&&R>v&&(j._29o=w),(N.isClickable()||N.isSortable()||g.isMovable()||j.tv.getCheckColumn&&N===j.tv.getCheckColumn())&&v>w.startX&&R>v&&j.setCursor(Rb)}}},handle_mousedown:function(v){this.handle_touchstart(v)},handle_touchstart:function(q){var V=this;Mf(q),V.tv.endEditing(),V.handle_mousemove(q),V._29o&&(V.x=Ne(q).x,V.lx=V.th.lp(q).x,V.w=V._29o.column.getWidth(),Ej(V,q))},handleWindowMouseMove:function(c){this.handleWindowTouchMove(c)},handleWindowTouchMove:function(M){var e=this,$=e.th,c=e.getView().style.cursor,l=e._29o,t=Ne(M).x-e.x;if(e.resizing||e.moving||(c===zo?e.resizing=1:$.isMovable()&&c===Rb&&h(t)>2&&(e.moving=1)),e.resizing)l.column.setWidth(e.w+t);else if(e.moving){var f=e.lx+t;$._60I.each(function(E){var p=E.startX,j=p+E.column.getWidth();if(f>=p&&j>=f){var s={column:l.column,startX:l.startX+t,front:j-f>f-p,insertColumn:E.column};s.position=s.front?p:j,$._5Q(s)}})}},_16Q:function(S,C){var T=this,V=T.tv,m=T.th,X=m._checkIcon;if(m._6Q(S)){var U=qp(X),u=T.lx,b=S.getWidth(),K=$m(U,S);if(u>=C+b/2-K&&C+b/2+K>=u){m.setCheckIcon(X===eb?eq:eb);var h=V.sm(),y=V._rows;return X===eb?h.rs(y):h.ss(y),V.onCheckColumnClicked(S),!0}}return!1},handleWindowMouseUp:function(l){this.handleWindowTouchEnd(l)},handleWindowTouchEnd:function(F){var M=this,j=M.tv,o=M.th,E=M._29o;if(M.moving){var T=o._61I;if(T&&T.insertColumn!==T.column){var Q=T.column,R=j.getColumnModel()._roots,D=R.remove(Q),i=R.indexOf(T.insertColumn);i>=0&&(T.front||i++,i<=R.size()&&(R.add(Q,i),j.getColumnModel()._38I(Q,D,i)))}o._5Q(y),delete M.moving}else if(!M.resizing&&E){Q=E.column;var B=o.lp(F).x,w=E.startX,G=!0;if(o.onColumnClicked){var _=o.onColumnClicked(Q,F,w);_===!1&&(G=!1)}if(G&&B>=w&&B<=w+Q.getWidth()&&!M._16Q(Q,w)){if(Q.isSortable()){var p=j.getSortMode(),x=Q.getSortOrder();p===Jk?j.getSortColumn()===Q?(x===Hb&&j.setSortColumn(y),Q.setSortOrder(x===bj?Hb:bj)):j.setSortColumn(Q):"bistate"===p&&(j.getSortColumn()===Q?Q.setSortOrder(x===bj?Hb:bj):j.setSortColumn(Q))}j.onColumnClicked(Q,F,w)}}M._29o=M.resizing=M.x=M.lx=M.w=y}}),cs.TablePane=function(T){this.init(new Ho(T))},Qb("TablePane",M,{ms_v:1,_44o:1}),cs.TreeTablePane=function(t){this.init(new ss(t))},Qb("TreeTablePane",M,{ms_v:1,_44o:1}),cs.Toolbar=function(W){var n=this,K=n._view=jj(1,n),C=K.style;C.background=N.toolbarBackground||"",C.height=Im+Tg,n._canvas=ff(K),n._30o=new wk,n._90I=new wk,n.setItems(W||[]),K.handleGroupSelectedChanged=function(Q){if(Q.isSelected()){var L=Q.getGroupId();null!=L&&n._items.forEach(function(O){var f=O.element;f&&f!==Q&&f.setSelected&&f.getGroupId&&f.getGroupId()===L&&f.setSelected(!1)})}},new Xq(n)},Qb("Toolbar",M,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[aq,Nq,Wj,Fg,Xo,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:N.toolbarLabelColor,_labelSelectColor:N.toolbarLabelSelectColor,_labelFont:N.toolbarLabelFont,_selectBackground:N.toolbarSelectBackground,_itemGap:N.toolbarItemGap,_separatorColor:N.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(b){var x=this.getItemInfoAt(b);return x?x.item.toolTip:y},getLabelColor:function(n){return n&&n.selected&&n.type!==eb&&n.type!==Hd?this._labelSelectColor:this._labelColor},onPropertyChanged:function(w){this.iv(),w.property===aq&&this._items.forEach(function(g){od(g)})},redraw:function(){this.iv()},addItem:function(S,W){var B=this._items;W==y?B.push(S):B.splice(W,0,S),this.fp(aq,y,B)},removeItem:function(b){if(b)for(var h=this._items,M=0;M<h.length;M++)b===h[M]&&(h.splice(M,1),this.fp(aq,y,h))},removeItemById:function(L){if(L!=y)for(var H=this._items,J=0;J<H.length;J++)if(L===H[J].id){var S=H.splice(J,1)[0];return this.fp(aq,y,H),S}},getItemById:function($){if($!=y)for(var c=this._items,h=0;h<c.length;h++){var H=c[h];if($===H.id)return H}},setItemVisible:function(o,d){var u=this.getItemById(o);u&&(u.visible=d)},getItemInfos:function(){return this._30o},getItemInfoAt:function(b){var S=this,u=0,W=S._30o,K=S.lp(b),a=K.x,f=K.y;if(f>=0&&f<=S.getHeight())for(;u<W.size();u++){var e=W.get(u);if(e.startX<=a&&a<=e.endX)return e}return y},drawItem:function(s,g,w,S,W){if(g.visible===!1)return 0;if(Lc(g.visible)&&!g.visible())return 0;var H=this,U=g.disabled;U&&(s.globalAlpha=el);var c=H.drawItemImpl(s,g,w,S,W),N=H._itemGap;return U&&(s.globalAlpha=1),this._currentItem!==g||"separator"===g||g.separator===!0||g.unfocusable||yp(s,H._separatorColor,w-N/2,0,c+N,S),c},drawItemImpl:function($,B,i,Q,G){var n=this,d=n._view,w=n._itemGap,j=Q/2,F=B.type,e=B.element,c=B.label;Hc(e)&&(c=e,e=y);var S,x=n.getLabelFont(B),V=n.getLabelColor(B),Z=B.selected,C=qp(B.icon),m=$m(C,B),r=0,D=m+(c?iq(x,c).width:0);if("separator"===B||B.separator===!0)return jg($,n._separatorColor,i,Q/4,j),1;if(e){C&&xh($,C,i+m/2,j,B,n),Ek($,c,x,V,i+m,0,0,Q);var Y=Il(e);G||n._90I.add(Y),Y.parentNode!==d&&Ah(d,Y),e.iv&&e.iv(),e.validate&&e.validate();var q=Y.getBoundingClientRect(),O=q.width,L=Y.style;return sq(Y),L.left=n.tx()+i+D+Tg,L.top=(Q-q.height)/2+Tg,D+O}return F===Hd?S=qp(Z?wi:lp):F===eb&&(S=qp(Z?eb:eq)),S?(r=$m(S,B),xh($,S,i+r/2,j,B,n),i+=r,D+=r):Z&&Gf($,i-w/2,0,D+w,Q,n.getSelectBackground(B)),C&&xh($,C,i+m/2,j,B,n),Ek($,c,x,V,i+m,0,0,Q),D},validateImpl:function(){var t=this,B=t._canvas,Z=t.getWidth(),G=t.getHeight(),M=t._30o,W=t._items;$b(B,Z,G);var I=Hl(B),D=t._itemGap,J=D/2;ls(I,t.tx(),0,1),I.clearRect(0,0,Z,G);var f=t._90I;t._90I=new wk,M.clear(),W.forEach(function(K){var y=t.drawItem(I,K,J,G);M.add({item:K,startX:J,endX:J+y,width:y}),y&&(J+=y+D)}),f.each(function(m){t._90I.contains(m)||Hm(m)});var Y=t._64I;t._64I=m(0,J),I.restore(),t._stickToRight?(t._65O=0,I=Hl(B),J=Z-t._64I+D,ls(I,0,0,1),I.clearRect(0,0,Z,G),M.clear(),W.forEach(function(n){var q=t.drawItem(I,n,J,G,!0);M.add({item:n,startX:J,endX:J+q,width:q}),q&&(J+=q+D)}),I.restore()):t.tx(t.tx()),Y!==t._64I&&t.onSumWidthChanged(Y,t._64I)},onSumWidthChanged:function(){},handleClick:function(N,C){var d=this,S=N.type,t=N.action,$=N.groupId,o=N.selected;N.disabled||($!=y?o||(N.selected=!0,this._items.forEach(function(I){I.groupId===$&&N!==I&&(I.selected=!1)}),t&&N.action(N,d,C)):S===eb||"toggle"===S?(N.selected=!o,t&&N.action(N,d,C)):t&&N.action(N,d,C)),Dn(),d.iv()}});var Xq=function(j){this.tb=j,this.addListeners()};wr(Xq,M,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(H){this.handleScroll(H,10*(H.wheelDelta/40))},handle_DOMMouseScroll:function(A){this.handleScroll(A,10*-A.detail)},handleScroll:function(n,E){Mf(n);var g=this.tb;g.isScrollable()&&!g._stickToRight&&(g.tx(g.tx()+E),cf())},handle_mousemove:function(O){var W=this;Tk||W.setItem(O)},handle_mouseout:function(E){var H=this;E.target===H.getView()?H.tb.setCurrentItem(y):H.handle_mousemove(E)},handle_mousedown:function(A){this.handle_mousemove(A),this.handle_touchstart(A)},handle_touchstart:function(s){var k=this,S=k.tb,i=s.target;fq(s)&&(i===k.getView()||i===S._canvas)&&(Mf(s),S.setFocus(s)&&(this.setItem(s,!0),(S.isScrollable()||k.info&&!k.info.item.disabled)&&(k.x=Ne(s).x,k.tx=S.tx(),Ej(k,s))))},handleWindowMouseMove:function(T){this.handleWindowTouchMove(T)},handleWindowTouchMove:function(Q){var b=this,p=b.tb;if(!p._stickToRight){var d=Ne(Q).x-b.x;!b._25o&&h(d)>2&&p.isScrollable()&&(b._25o=1),b._25o&&p.tx(b.tx+d)}},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(s){var D=this,K=D.tb,e=D.info,L=D.tb.getItemInfoAt(s);if(!D._25o&&e){var j=e.item;L&&L.item===j&&K.handleClick(j,s)}D._25o=D.x=D.tx=y,D.setItem()},setItem:function(G,J){var B=this,T=B.tb,o=B.info=G?T.getItemInfoAt(G):y,L=o?o.item:y;T.setCurrentItem(L),J&&L&&Lc(L.onDown)&&L.onDown(G)}}),cs.BorderPane=function(){this._view=jj(1,this),this.iv()},Qb("BorderPane",M,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(k,A){this._12o("leftView",k),A!=y&&this.setLeftWidth(A)},getRightView:function(){return this._rightView},setRightView:function(V,P){this._12o("rightView",V),P!=y&&this.setRightWidth(P)},getTopView:function(){return this._topView},setTopView:function($,w){this._12o("topView",$),w!=y&&this.setTopHeight(w)},getBottomView:function(){return this._bottomView},setBottomView:function(n,_){this._12o("bottomView",n),_!=y&&this.setBottomHeight(_)},getCenterView:function(){return this._centerView},setCenterView:function(d){this._12o("centerView",d)},_12o:function(C,K){var U=this,$="_"+C,p=U._view,X=U[$];X!==K&&(X&&(X.getView?Hm(X.getView()):Hm(X)),U[$]=K,K&&(K.getView?Ah(p,K.getView(),1):Ah(p,K,1)),U.fp(C,X,K))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var H=this,t=H._topView,P=H._bottomView,I=H._leftView,G=H._rightView,f=H._centerView,s=H.getWidth(),d=H.getHeight(),N=0,_=0,B=s,c=d,n=0,O=0,w=0,v=0;t&&(n=H._topHeight==y?tf(t):H._topHeight,_=n),P&&(O=H._bottomHeight==y?tf(P):H._bottomHeight,c=d-O),I&&(w=H._leftWidth==y?Nk(I):H._leftWidth,N=w),G&&(v=H._rightWidth==y?Nk(G):H._rightWidth,B=s-v);var X=m(0,B-N),M=m(0,c-_);t&&Ce(t,0,0,s,n),P&&Ce(P,0,c,s,O),I&&Ce(I,0,_,w,M),G&&Ce(G,B,_,v,M),f&&Ce(f,N,_,X,M)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);